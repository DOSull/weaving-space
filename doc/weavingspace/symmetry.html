<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="pdoc 14.1.0"/>
    <title>weavingspace.symmetry API documentation</title>

    <style>/*! * Bootstrap Reboot v5.0.0 (https://getbootstrap.com/) * Copyright 2011-2021 The Bootstrap Authors * Copyright 2011-2021 Twitter, Inc. * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE) * Forked from Normalize.css, licensed MIT (https://github.com/necolas/normalize.css/blob/master/LICENSE.md) */*,::after,::before{box-sizing:border-box}@media (prefers-reduced-motion:no-preference){:root{scroll-behavior:smooth}}body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Liberation Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;background-color:#fff;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}hr{margin:1rem 0;color:inherit;background-color:currentColor;border:0;opacity:.25}hr:not([size]){height:1px}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem;font-weight:500;line-height:1.2}h1{font-size:calc(1.375rem + 1.5vw)}@media (min-width:1200px){h1{font-size:2.5rem}}h2{font-size:calc(1.325rem + .9vw)}@media (min-width:1200px){h2{font-size:2rem}}h3{font-size:calc(1.3rem + .6vw)}@media (min-width:1200px){h3{font-size:1.75rem}}h4{font-size:calc(1.275rem + .3vw)}@media (min-width:1200px){h4{font-size:1.5rem}}h5{font-size:1.25rem}h6{font-size:1rem}p{margin-top:0;margin-bottom:1rem}abbr[data-bs-original-title],abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address{margin-bottom:1rem;font-style:normal;line-height:inherit}ol,ul{padding-left:2rem}dl,ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}dt{font-weight:700}dd{margin-bottom:.5rem;margin-left:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}small{font-size:.875em}mark{padding:.2em;background-color:#fcf8e3}sub,sup{position:relative;font-size:.75em;line-height:0;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}a{color:#0d6efd;text-decoration:underline}a:hover{color:#0a58ca}a:not([href]):not([class]),a:not([href]):not([class]):hover{color:inherit;text-decoration:none}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em;direction:ltr;unicode-bidi:bidi-override}pre{display:block;margin-top:0;margin-bottom:1rem;overflow:auto;font-size:.875em}pre code{font-size:inherit;color:inherit;word-break:normal}code{font-size:.875em;color:#d63384;word-wrap:break-word}a>code{color:inherit}kbd{padding:.2rem .4rem;font-size:.875em;color:#fff;background-color:#212529;border-radius:.2rem}kbd kbd{padding:0;font-size:1em;font-weight:700}figure{margin:0 0 1rem}img,svg{vertical-align:middle}table{caption-side:bottom;border-collapse:collapse}caption{padding-top:.5rem;padding-bottom:.5rem;color:#6c757d;text-align:left}th{text-align:inherit;text-align:-webkit-match-parent}tbody,td,tfoot,th,thead,tr{border-color:inherit;border-style:solid;border-width:0}label{display:inline-block}button{border-radius:0}button:focus:not(:focus-visible){outline:0}button,input,optgroup,select,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,select{text-transform:none}[role=button]{cursor:pointer}select{word-wrap:normal}select:disabled{opacity:1}[list]::-webkit-calendar-picker-indicator{display:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled),button:not(:disabled){cursor:pointer}::-moz-focus-inner{padding:0;border-style:none}textarea{resize:vertical}fieldset{min-width:0;padding:0;margin:0;border:0}legend{float:left;width:100%;padding:0;margin-bottom:.5rem;font-size:calc(1.275rem + .3vw);line-height:inherit}@media (min-width:1200px){legend{font-size:1.5rem}}legend+*{clear:left}::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-fields-wrapper,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-text,::-webkit-datetime-edit-year-field{padding:0}::-webkit-inner-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:textfield}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-color-swatch-wrapper{padding:0}::file-selector-button{font:inherit}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}output{display:inline-block}iframe{border:0}summary{display:list-item;cursor:pointer}progress{vertical-align:baseline}[hidden]{display:none!important}</style>
    <style>/*! syntax-highlighting.css */pre{line-height:125%;}span.linenos{color:inherit; background-color:transparent; padding-left:5px; padding-right:20px;}.pdoc-code .hll{background-color:#ffffcc}.pdoc-code{background:#f8f8f8;}.pdoc-code .c{color:#3D7B7B; font-style:italic}.pdoc-code .err{border:1px solid #FF0000}.pdoc-code .k{color:#008000; font-weight:bold}.pdoc-code .o{color:#666666}.pdoc-code .ch{color:#3D7B7B; font-style:italic}.pdoc-code .cm{color:#3D7B7B; font-style:italic}.pdoc-code .cp{color:#9C6500}.pdoc-code .cpf{color:#3D7B7B; font-style:italic}.pdoc-code .c1{color:#3D7B7B; font-style:italic}.pdoc-code .cs{color:#3D7B7B; font-style:italic}.pdoc-code .gd{color:#A00000}.pdoc-code .ge{font-style:italic}.pdoc-code .gr{color:#E40000}.pdoc-code .gh{color:#000080; font-weight:bold}.pdoc-code .gi{color:#008400}.pdoc-code .go{color:#717171}.pdoc-code .gp{color:#000080; font-weight:bold}.pdoc-code .gs{font-weight:bold}.pdoc-code .gu{color:#800080; font-weight:bold}.pdoc-code .gt{color:#0044DD}.pdoc-code .kc{color:#008000; font-weight:bold}.pdoc-code .kd{color:#008000; font-weight:bold}.pdoc-code .kn{color:#008000; font-weight:bold}.pdoc-code .kp{color:#008000}.pdoc-code .kr{color:#008000; font-weight:bold}.pdoc-code .kt{color:#B00040}.pdoc-code .m{color:#666666}.pdoc-code .s{color:#BA2121}.pdoc-code .na{color:#687822}.pdoc-code .nb{color:#008000}.pdoc-code .nc{color:#0000FF; font-weight:bold}.pdoc-code .no{color:#880000}.pdoc-code .nd{color:#AA22FF}.pdoc-code .ni{color:#717171; font-weight:bold}.pdoc-code .ne{color:#CB3F38; font-weight:bold}.pdoc-code .nf{color:#0000FF}.pdoc-code .nl{color:#767600}.pdoc-code .nn{color:#0000FF; font-weight:bold}.pdoc-code .nt{color:#008000; font-weight:bold}.pdoc-code .nv{color:#19177C}.pdoc-code .ow{color:#AA22FF; font-weight:bold}.pdoc-code .w{color:#bbbbbb}.pdoc-code .mb{color:#666666}.pdoc-code .mf{color:#666666}.pdoc-code .mh{color:#666666}.pdoc-code .mi{color:#666666}.pdoc-code .mo{color:#666666}.pdoc-code .sa{color:#BA2121}.pdoc-code .sb{color:#BA2121}.pdoc-code .sc{color:#BA2121}.pdoc-code .dl{color:#BA2121}.pdoc-code .sd{color:#BA2121; font-style:italic}.pdoc-code .s2{color:#BA2121}.pdoc-code .se{color:#AA5D1F; font-weight:bold}.pdoc-code .sh{color:#BA2121}.pdoc-code .si{color:#A45A77; font-weight:bold}.pdoc-code .sx{color:#008000}.pdoc-code .sr{color:#A45A77}.pdoc-code .s1{color:#BA2121}.pdoc-code .ss{color:#19177C}.pdoc-code .bp{color:#008000}.pdoc-code .fm{color:#0000FF}.pdoc-code .vc{color:#19177C}.pdoc-code .vg{color:#19177C}.pdoc-code .vi{color:#19177C}.pdoc-code .vm{color:#19177C}.pdoc-code .il{color:#666666}</style>
    <style>/*! theme.css */:root{--pdoc-background:#fff;}.pdoc{--text:#212529;--muted:#6c757d;--link:#3660a5;--link-hover:#1659c5;--code:#f8f8f8;--active:#fff598;--accent:#eee;--accent2:#c1c1c1;--nav-hover:rgba(255, 255, 255, 0.5);--name:#0066BB;--def:#008800;--annotation:#007020;}</style>
    <style>/*! layout.css */html, body{width:100%;height:100%;}html, main{scroll-behavior:smooth;}body{background-color:var(--pdoc-background);}@media (max-width:769px){#navtoggle{cursor:pointer;position:absolute;width:50px;height:40px;top:1rem;right:1rem;border-color:var(--text);color:var(--text);display:flex;opacity:0.8;z-index:999;}#navtoggle:hover{opacity:1;}#togglestate + div{display:none;}#togglestate:checked + div{display:inherit;}main, header{padding:2rem 3vw;}header + main{margin-top:-3rem;}.git-button{display:none !important;}nav input[type="search"]{max-width:77%;}nav input[type="search"]:first-child{margin-top:-6px;}nav input[type="search"]:valid ~ *{display:none !important;}}@media (min-width:770px){:root{--sidebar-width:clamp(12.5rem, 28vw, 22rem);}nav{position:fixed;overflow:auto;height:100vh;width:var(--sidebar-width);}main, header{padding:3rem 2rem 3rem calc(var(--sidebar-width) + 3rem);width:calc(54rem + var(--sidebar-width));max-width:100%;}header + main{margin-top:-4rem;}#navtoggle{display:none;}}#togglestate{position:absolute;height:0;opacity:0;}nav.pdoc{--pad:clamp(0.5rem, 2vw, 1.75rem);--indent:1.5rem;background-color:var(--accent);border-right:1px solid var(--accent2);box-shadow:0 0 20px rgba(50, 50, 50, .2) inset;padding:0 0 0 var(--pad);overflow-wrap:anywhere;scrollbar-width:thin; scrollbar-color:var(--accent2) transparent; z-index:1}nav.pdoc::-webkit-scrollbar{width:.4rem; }nav.pdoc::-webkit-scrollbar-thumb{background-color:var(--accent2); }nav.pdoc > div{padding:var(--pad) 0;}nav.pdoc .module-list-button{display:inline-flex;align-items:center;color:var(--text);border-color:var(--muted);margin-bottom:1rem;}nav.pdoc .module-list-button:hover{border-color:var(--text);}nav.pdoc input[type=search]{display:block;outline-offset:0;width:calc(100% - var(--pad));}nav.pdoc .logo{max-width:calc(100% - var(--pad));max-height:35vh;display:block;margin:0 auto 1rem;transform:translate(calc(-.5 * var(--pad)), 0);}nav.pdoc ul{list-style:none;padding-left:0;}nav.pdoc > div > ul{margin-left:calc(0px - var(--pad));}nav.pdoc li a{padding:.2rem 0 .2rem calc(var(--pad) + var(--indent));}nav.pdoc > div > ul > li > a{padding-left:var(--pad);}nav.pdoc li{transition:all 100ms;}nav.pdoc li:hover{background-color:var(--nav-hover);}nav.pdoc a, nav.pdoc a:hover{color:var(--text);}nav.pdoc a{display:block;}nav.pdoc > h2:first-of-type{margin-top:1.5rem;}nav.pdoc .class:before{content:"class ";color:var(--muted);}nav.pdoc .function:after{content:"()";color:var(--muted);}nav.pdoc footer:before{content:"";display:block;width:calc(100% - var(--pad));border-top:solid var(--accent2) 1px;margin-top:1.5rem;padding-top:.5rem;}nav.pdoc footer{font-size:small;}</style>
    <style>/*! content.css */.pdoc{color:var(--text);box-sizing:border-box;line-height:1.5;background:none;}.pdoc .pdoc-button{cursor:pointer;display:inline-block;border:solid black 1px;border-radius:2px;font-size:.75rem;padding:calc(0.5em - 1px) 1em;transition:100ms all;}.pdoc .pdoc-alert{padding:1rem 1rem 1rem calc(1.5rem + 24px);border:1px solid transparent;border-radius:.25rem;background-repeat:no-repeat;background-position:1rem center;margin-bottom:1rem;}.pdoc .pdoc-alert > *:last-child{margin-bottom:0;}.pdoc .pdoc-alert-note {color:#084298;background-color:#cfe2ff;border-color:#b6d4fe;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23084298%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8%2016A8%208%200%201%200%208%200a8%208%200%200%200%200%2016zm.93-9.412-1%204.705c-.07.34.029.533.304.533.194%200%20.487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703%200-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381%202.29-.287zM8%205.5a1%201%200%201%201%200-2%201%201%200%200%201%200%202z%22/%3E%3C/svg%3E");}.pdoc .pdoc-alert-warning{color:#664d03;background-color:#fff3cd;border-color:#ffecb5;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23664d03%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8.982%201.566a1.13%201.13%200%200%200-1.96%200L.165%2013.233c-.457.778.091%201.767.98%201.767h13.713c.889%200%201.438-.99.98-1.767L8.982%201.566zM8%205c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%205.995A.905.905%200%200%201%208%205zm.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2z%22/%3E%3C/svg%3E");}.pdoc .pdoc-alert-danger{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M5.52.359A.5.5%200%200%201%206%200h4a.5.5%200%200%201%20.474.658L8.694%206H12.5a.5.5%200%200%201%20.395.807l-7%209a.5.5%200%200%201-.873-.454L6.823%209.5H3.5a.5.5%200%200%201-.48-.641l2.5-8.5z%22/%3E%3C/svg%3E");}.pdoc .visually-hidden{position:absolute !important;width:1px !important;height:1px !important;padding:0 !important;margin:-1px !important;overflow:hidden !important;clip:rect(0, 0, 0, 0) !important;white-space:nowrap !important;border:0 !important;}.pdoc h1, .pdoc h2, .pdoc h3{font-weight:300;margin:.3em 0;padding:.2em 0;}.pdoc > section:not(.module-info) h1{font-size:1.5rem;font-weight:500;}.pdoc > section:not(.module-info) h2{font-size:1.4rem;font-weight:500;}.pdoc > section:not(.module-info) h3{font-size:1.3rem;font-weight:500;}.pdoc > section:not(.module-info) h4{font-size:1.2rem;}.pdoc > section:not(.module-info) h5{font-size:1.1rem;}.pdoc a{text-decoration:none;color:var(--link);}.pdoc a:hover{color:var(--link-hover);}.pdoc blockquote{margin-left:2rem;}.pdoc pre{border-top:1px solid var(--accent2);border-bottom:1px solid var(--accent2);margin-top:0;margin-bottom:1em;padding:.5rem 0 .5rem .5rem;overflow-x:auto;background-color:var(--code);}.pdoc code{color:var(--text);padding:.2em .4em;margin:0;font-size:85%;background-color:var(--accent);border-radius:6px;}.pdoc a > code{color:inherit;}.pdoc pre > code{display:inline-block;font-size:inherit;background:none;border:none;padding:0;}.pdoc > section:not(.module-info){margin-bottom:1.5rem;}.pdoc .modulename{margin-top:0;font-weight:bold;}.pdoc .modulename a{color:var(--link);transition:100ms all;}.pdoc .git-button{float:right;border:solid var(--link) 1px;}.pdoc .git-button:hover{background-color:var(--link);color:var(--pdoc-background);}.view-source-toggle-state,.view-source-toggle-state ~ .pdoc-code{display:none;}.view-source-toggle-state:checked ~ .pdoc-code{display:block;}.view-source-button{display:inline-block;float:right;font-size:.75rem;line-height:1.5rem;color:var(--muted);padding:0 .4rem 0 1.3rem;cursor:pointer;text-indent:-2px;}.view-source-button > span{visibility:hidden;}.module-info .view-source-button{float:none;display:flex;justify-content:flex-end;margin:-1.2rem .4rem -.2rem 0;}.view-source-button::before{position:absolute;content:"View Source";display:list-item;list-style-type:disclosure-closed;}.view-source-toggle-state:checked ~ .attr .view-source-button::before,.view-source-toggle-state:checked ~ .view-source-button::before{list-style-type:disclosure-open;}.pdoc .docstring{margin-bottom:1.5rem;}.pdoc section:not(.module-info) .docstring{margin-left:clamp(0rem, 5vw - 2rem, 1rem);}.pdoc .docstring .pdoc-code{margin-left:1em;margin-right:1em;}.pdoc h1:target,.pdoc h2:target,.pdoc h3:target,.pdoc h4:target,.pdoc h5:target,.pdoc h6:target,.pdoc .pdoc-code > pre > span:target{background-color:var(--active);box-shadow:-1rem 0 0 0 var(--active);}.pdoc .pdoc-code > pre > span:target{display:block;}.pdoc div:target > .attr,.pdoc section:target > .attr,.pdoc dd:target > a{background-color:var(--active);}.pdoc *{scroll-margin:2rem;}.pdoc .pdoc-code .linenos{user-select:none;}.pdoc .attr:hover{filter:contrast(0.95);}.pdoc section, .pdoc .classattr{position:relative;}.pdoc .headerlink{--width:clamp(1rem, 3vw, 2rem);position:absolute;top:0;left:calc(0rem - var(--width));transition:all 100ms ease-in-out;opacity:0;}.pdoc .headerlink::before{content:"#";display:block;text-align:center;width:var(--width);height:2.3rem;line-height:2.3rem;font-size:1.5rem;}.pdoc .attr:hover ~ .headerlink,.pdoc *:target > .headerlink,.pdoc .headerlink:hover{opacity:1;}.pdoc .attr{display:block;margin:.5rem 0 .5rem;padding:.4rem .4rem .4rem 1rem;background-color:var(--accent);overflow-x:auto;}.pdoc .classattr{margin-left:2rem;}.pdoc .name{color:var(--name);font-weight:bold;}.pdoc .def{color:var(--def);font-weight:bold;}.pdoc .signature{background-color:transparent;}.pdoc .param, .pdoc .return-annotation{white-space:pre;}.pdoc .signature.multiline .param{display:block;}.pdoc .signature.condensed .param{display:inline-block;}.pdoc .annotation{color:var(--annotation);}.pdoc .view-value-toggle-state,.pdoc .view-value-toggle-state ~ .default_value{display:none;}.pdoc .view-value-toggle-state:checked ~ .default_value{display:inherit;}.pdoc .view-value-button{font-size:.5rem;vertical-align:middle;border-style:dashed;margin-top:-0.1rem;}.pdoc .view-value-button:hover{background:white;}.pdoc .view-value-button::before{content:"show";text-align:center;width:2.2em;display:inline-block;}.pdoc .view-value-toggle-state:checked ~ .view-value-button::before{content:"hide";}.pdoc .inherited{margin-left:2rem;}.pdoc .inherited dt{font-weight:700;}.pdoc .inherited dt, .pdoc .inherited dd{display:inline;margin-left:0;margin-bottom:.5rem;}.pdoc .inherited dd:not(:last-child):after{content:", ";}.pdoc .inherited .class:before{content:"class ";}.pdoc .inherited .function a:after{content:"()";}.pdoc .search-result .docstring{overflow:auto;max-height:25vh;}.pdoc .search-result.focused > .attr{background-color:var(--active);}.pdoc .attribution{margin-top:2rem;display:block;opacity:0.5;transition:all 200ms;filter:grayscale(100%);}.pdoc .attribution:hover{opacity:1;filter:grayscale(0%);}.pdoc .attribution img{margin-left:5px;height:35px;vertical-align:middle;width:70px;transition:all 200ms;}.pdoc table{display:block;width:max-content;max-width:100%;overflow:auto;margin-bottom:1rem;}.pdoc table th{font-weight:600;}.pdoc table th, .pdoc table td{padding:6px 13px;border:1px solid var(--accent2);}</style>
    <style>/*! custom.css */</style></head>
<body>
    <nav class="pdoc">
        <label id="navtoggle" for="togglestate" class="pdoc-button"><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'><path stroke-linecap='round' stroke="currentColor" stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/></svg></label>
        <input id="togglestate" type="checkbox" aria-hidden="true" tabindex="-1">
        <div>            <a class="pdoc-button module-list-button" href="../weavingspace.html">
<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-box-arrow-in-left" viewBox="0 0 16 16">
  <path fill-rule="evenodd" d="M10 3.5a.5.5 0 0 0-.5-.5h-8a.5.5 0 0 0-.5.5v9a.5.5 0 0 0 .5.5h8a.5.5 0 0 0 .5-.5v-2a.5.5 0 0 1 1 0v2A1.5 1.5 0 0 1 9.5 14h-8A1.5 1.5 0 0 1 0 12.5v-9A1.5 1.5 0 0 1 1.5 2h8A1.5 1.5 0 0 1 11 3.5v2a.5.5 0 0 1-1 0v-2z"/>
  <path fill-rule="evenodd" d="M4.146 8.354a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5H14.5a.5.5 0 0 1 0 1H5.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3z"/>
</svg>                &nbsp;weavingspace</a>


            <input type="search" placeholder="Search..." role="searchbox" aria-label="search"
                   pattern=".+" required>



            <h2>API Documentation</h2>
                <ul class="memberlist">
            <li>
                    <a class="class" href="#Symmetries">Symmetries</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#Symmetries.__init__">Symmetries</a>
                        </li>
                        <li>
                                <a class="variable" href="#Symmetries.polygon">polygon</a>
                        </li>
                        <li>
                                <a class="variable" href="#Symmetries.n">n</a>
                        </li>
                        <li>
                                <a class="variable" href="#Symmetries.p_code">p_code</a>
                        </li>
                        <li>
                                <a class="variable" href="#Symmetries.p_code_r">p_code_r</a>
                        </li>
                        <li>
                                <a class="variable" href="#Symmetries.rotation_shifts">rotation_shifts</a>
                        </li>
                        <li>
                                <a class="variable" href="#Symmetries.reflection_shifts">reflection_shifts</a>
                        </li>
                        <li>
                                <a class="function" href="#Symmetries.get_rotations">get_rotations</a>
                        </li>
                        <li>
                                <a class="function" href="#Symmetries.get_reflections">get_reflections</a>
                        </li>
                        <li>
                                <a class="function" href="#Symmetries.get_matching_transforms">get_matching_transforms</a>
                        </li>
                        <li>
                                <a class="function" href="#Symmetries.get_corner_labels">get_corner_labels</a>
                        </li>
                        <li>
                                <a class="function" href="#Symmetries.get_unique_labels">get_unique_labels</a>
                        </li>
                        <li>
                                <a class="function" href="#Symmetries.plot">plot</a>
                        </li>
                        <li>
                                <a class="function" href="#Symmetries.find_matches">find_matches</a>
                        </li>
                        <li>
                                <a class="function" href="#Symmetries.get_table">get_table</a>
                        </li>
                </ul>

            </li>
    </ul>



        <a class="attribution" title="pdoc: Python API documentation generator" href="https://pdoc.dev" target="_blank">
            built with <span class="visually-hidden">pdoc</span><img
                alt="pdoc logo"
                src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20role%3D%22img%22%20aria-label%3D%22pdoc%20logo%22%20width%3D%22300%22%20height%3D%22150%22%20viewBox%3D%22-1%200%2060%2030%22%3E%3Ctitle%3Epdoc%3C/title%3E%3Cpath%20d%3D%22M29.621%2021.293c-.011-.273-.214-.475-.511-.481a.5.5%200%200%200-.489.503l-.044%201.393c-.097.551-.695%201.215-1.566%201.704-.577.428-1.306.486-2.193.182-1.426-.617-2.467-1.654-3.304-2.487l-.173-.172a3.43%203.43%200%200%200-.365-.306.49.49%200%200%200-.286-.196c-1.718-1.06-4.931-1.47-7.353.191l-.219.15c-1.707%201.187-3.413%202.131-4.328%201.03-.02-.027-.49-.685-.141-1.763.233-.721.546-2.408.772-4.076.042-.09.067-.187.046-.288.166-1.347.277-2.625.241-3.351%201.378-1.008%202.271-2.586%202.271-4.362%200-.976-.272-1.935-.788-2.774-.057-.094-.122-.18-.184-.268.033-.167.052-.339.052-.516%200-1.477-1.202-2.679-2.679-2.679-.791%200-1.496.352-1.987.9a6.3%206.3%200%200%200-1.001.029c-.492-.564-1.207-.929-2.012-.929-1.477%200-2.679%201.202-2.679%202.679A2.65%202.65%200%200%200%20.97%206.554c-.383.747-.595%201.572-.595%202.41%200%202.311%201.507%204.29%203.635%205.107-.037.699-.147%202.27-.423%203.294l-.137.461c-.622%202.042-2.515%208.257%201.727%2010.643%201.614.908%203.06%201.248%204.317%201.248%202.665%200%204.492-1.524%205.322-2.401%201.476-1.559%202.886-1.854%206.491.82%201.877%201.393%203.514%201.753%204.861%201.068%202.223-1.713%202.811-3.867%203.399-6.374.077-.846.056-1.469.054-1.537zm-4.835%204.313c-.054.305-.156.586-.242.629-.034-.007-.131-.022-.307-.157-.145-.111-.314-.478-.456-.908.221.121.432.25.675.355.115.039.219.051.33.081zm-2.251-1.238c-.05.33-.158.648-.252.694-.022.001-.125-.018-.307-.157-.217-.166-.488-.906-.639-1.573.358.344.754.693%201.198%201.036zm-3.887-2.337c-.006-.116-.018-.231-.041-.342.635.145%201.189.368%201.599.625.097.231.166.481.174.642-.03.049-.055.101-.067.158-.046.013-.128.026-.298.004-.278-.037-.901-.57-1.367-1.087zm-1.127-.497c.116.306.176.625.12.71-.019.014-.117.045-.345.016-.206-.027-.604-.332-.986-.695.41-.051.816-.056%201.211-.031zm-4.535%201.535c.209.22.379.47.358.598-.006.041-.088.138-.351.234-.144.055-.539-.063-.979-.259a11.66%2011.66%200%200%200%20.972-.573zm.983-.664c.359-.237.738-.418%201.126-.554.25.237.479.548.457.694-.006.042-.087.138-.351.235-.174.064-.694-.105-1.232-.375zm-3.381%201.794c-.022.145-.061.29-.149.401-.133.166-.358.248-.69.251h-.002c-.133%200-.306-.26-.45-.621.417.091.854.07%201.291-.031zm-2.066-8.077a4.78%204.78%200%200%201-.775-.584c.172-.115.505-.254.88-.378l-.105.962zm-.331%202.302a10.32%2010.32%200%200%201-.828-.502c.202-.143.576-.328.984-.49l-.156.992zm-.45%202.157l-.701-.403c.214-.115.536-.249.891-.376a11.57%2011.57%200%200%201-.19.779zm-.181%201.716c.064.398.194.702.298.893-.194-.051-.435-.162-.736-.398.061-.119.224-.3.438-.495zM8.87%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zm-.735-.389a1.15%201.15%200%200%200-.314.783%201.16%201.16%200%200%200%201.162%201.162c.457%200%20.842-.27%201.032-.653.026.117.042.238.042.362a1.68%201.68%200%200%201-1.679%201.679%201.68%201.68%200%200%201-1.679-1.679c0-.843.626-1.535%201.436-1.654zM5.059%205.406A1.68%201.68%200%200%201%203.38%207.085a1.68%201.68%200%200%201-1.679-1.679c0-.037.009-.072.011-.109.21.3.541.508.935.508a1.16%201.16%200%200%200%201.162-1.162%201.14%201.14%200%200%200-.474-.912c.015%200%20.03-.005.045-.005.926.001%201.679.754%201.679%201.68zM3.198%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zM1.375%208.964c0-.52.103-1.035.288-1.52.466.394%201.06.64%201.717.64%201.144%200%202.116-.725%202.499-1.738.383%201.012%201.355%201.738%202.499%201.738.867%200%201.631-.421%202.121-1.062.307.605.478%201.267.478%201.942%200%202.486-2.153%204.51-4.801%204.51s-4.801-2.023-4.801-4.51zm24.342%2019.349c-.985.498-2.267.168-3.813-.979-3.073-2.281-5.453-3.199-7.813-.705-1.315%201.391-4.163%203.365-8.423.97-3.174-1.786-2.239-6.266-1.261-9.479l.146-.492c.276-1.02.395-2.457.444-3.268a6.11%206.11%200%200%200%201.18.115%206.01%206.01%200%200%200%202.536-.562l-.006.175c-.802.215-1.848.612-2.021%201.25-.079.295.021.601.274.837.219.203.415.364.598.501-.667.304-1.243.698-1.311%201.179-.02.144-.022.507.393.787.213.144.395.26.564.365-1.285.521-1.361.96-1.381%201.126-.018.142-.011.496.427.746l.854.489c-.473.389-.971.914-.999%201.429-.018.278.095.532.316.713.675.556%201.231.721%201.653.721.059%200%20.104-.014.158-.02.207.707.641%201.64%201.513%201.64h.013c.8-.008%201.236-.345%201.462-.626.173-.216.268-.457.325-.692.424.195.93.374%201.372.374.151%200%20.294-.021.423-.068.732-.27.944-.704.993-1.021.009-.061.003-.119.002-.179.266.086.538.147.789.147.15%200%20.294-.021.423-.069.542-.2.797-.489.914-.754.237.147.478.258.704.288.106.014.205.021.296.021.356%200%20.595-.101.767-.229.438.435%201.094.992%201.656%201.067.106.014.205.021.296.021a1.56%201.56%200%200%200%20.323-.035c.17.575.453%201.289.866%201.605.358.273.665.362.914.362a.99.99%200%200%200%20.421-.093%201.03%201.03%200%200%200%20.245-.164c.168.428.39.846.68%201.068.358.273.665.362.913.362a.99.99%200%200%200%20.421-.093c.317-.148.512-.448.639-.762.251.157.495.257.726.257.127%200%20.25-.024.37-.071.427-.17.706-.617.841-1.314.022-.015.047-.022.068-.038.067-.051.133-.104.196-.159-.443%201.486-1.107%202.761-2.086%203.257zM8.66%209.925a.5.5%200%201%200-1%200c0%20.653-.818%201.205-1.787%201.205s-1.787-.552-1.787-1.205a.5.5%200%201%200-1%200c0%201.216%201.25%202.205%202.787%202.205s2.787-.989%202.787-2.205zm4.4%2015.965l-.208.097c-2.661%201.258-4.708%201.436-6.086.527-1.542-1.017-1.88-3.19-1.844-4.198a.4.4%200%200%200-.385-.414c-.242-.029-.406.164-.414.385-.046%201.249.367%203.686%202.202%204.896.708.467%201.547.7%202.51.7%201.248%200%202.706-.392%204.362-1.174l.185-.086a.4.4%200%200%200%20.205-.527c-.089-.204-.326-.291-.527-.206zM9.547%202.292c.093.077.205.114.317.114a.5.5%200%200%200%20.318-.886L8.817.397a.5.5%200%200%200-.703.068.5.5%200%200%200%20.069.703l1.364%201.124zm-7.661-.065c.086%200%20.173-.022.253-.068l1.523-.893a.5.5%200%200%200-.506-.863l-1.523.892a.5.5%200%200%200-.179.685c.094.158.261.247.432.247z%22%20transform%3D%22matrix%28-1%200%200%201%2058%200%29%22%20fill%3D%22%233bb300%22/%3E%3Cpath%20d%3D%22M.3%2021.86V10.18q0-.46.02-.68.04-.22.18-.5.28-.54%201.34-.54%201.06%200%201.42.28.38.26.44.78.76-1.04%202.38-1.04%201.64%200%203.1%201.54%201.46%201.54%201.46%203.58%200%202.04-1.46%203.58-1.44%201.54-3.08%201.54-1.64%200-2.38-.92v4.04q0%20.46-.04.68-.02.22-.18.5-.14.3-.5.42-.36.12-.98.12-.62%200-1-.12-.36-.12-.52-.4-.14-.28-.18-.5-.02-.22-.02-.68zm3.96-9.42q-.46.54-.46%201.18%200%20.64.46%201.18.48.52%201.2.52.74%200%201.24-.52.52-.52.52-1.18%200-.66-.48-1.18-.48-.54-1.26-.54-.76%200-1.22.54zm14.741-8.36q.16-.3.54-.42.38-.12%201-.12.64%200%201.02.12.38.12.52.42.16.3.18.54.04.22.04.68v11.94q0%20.46-.04.7-.02.22-.18.5-.3.54-1.7.54-1.38%200-1.54-.98-.84.96-2.34.96-1.8%200-3.28-1.56-1.48-1.58-1.48-3.66%200-2.1%201.48-3.68%201.5-1.58%203.28-1.58%201.48%200%202.3%201v-4.2q0-.46.02-.68.04-.24.18-.52zm-3.24%2010.86q.52.54%201.26.54.74%200%201.22-.54.5-.54.5-1.18%200-.66-.48-1.22-.46-.56-1.26-.56-.8%200-1.28.56-.48.54-.48%201.2%200%20.66.52%201.2zm7.833-1.2q0-2.4%201.68-3.96%201.68-1.56%203.84-1.56%202.16%200%203.82%201.56%201.66%201.54%201.66%203.94%200%201.66-.86%202.96-.86%201.28-2.1%201.9-1.22.6-2.54.6-1.32%200-2.56-.64-1.24-.66-2.1-1.92-.84-1.28-.84-2.88zm4.18%201.44q.64.48%201.3.48.66%200%201.32-.5.66-.5.66-1.48%200-.98-.62-1.46-.62-.48-1.34-.48-.72%200-1.34.5-.62.5-.62%201.48%200%20.96.64%201.46zm11.412-1.44q0%20.84.56%201.32.56.46%201.18.46.64%200%201.18-.36.56-.38.9-.38.6%200%201.46%201.06.46.58.46%201.04%200%20.76-1.1%201.42-1.14.8-2.8.8-1.86%200-3.58-1.34-.82-.64-1.34-1.7-.52-1.08-.52-2.36%200-1.3.52-2.34.52-1.06%201.34-1.7%201.66-1.32%203.54-1.32.76%200%201.48.22.72.2%201.06.4l.32.2q.36.24.56.38.52.4.52.92%200%20.5-.42%201.14-.72%201.1-1.38%201.1-.38%200-1.08-.44-.36-.34-1.04-.34-.66%200-1.24.48-.58.48-.58%201.34z%22%20fill%3D%22green%22/%3E%3C/svg%3E"/>
        </a>
</div>
    </nav>
    <main class="pdoc">
            <section class="module-info">
                    <h1 class="modulename">
<a href="./../weavingspace.html">weavingspace</a><wbr>.symmetry    </h1>

                
                        <input id="mod-symmetry-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">

                        <label class="view-source-button" for="mod-symmetry-view-source"><span>View Source</span></label>

                        <div class="pdoc-code codehilite"><pre><span></span><span id="L-1"><a href="#L-1"><span class="linenos">  1</span></a><span class="ch">#!/usr/bin/env python</span>
</span><span id="L-2"><a href="#L-2"><span class="linenos">  2</span></a><span class="c1"># coding: utf-8</span>
</span><span id="L-3"><a href="#L-3"><span class="linenos">  3</span></a>
</span><span id="L-4"><a href="#L-4"><span class="linenos">  4</span></a><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Iterable</span>
</span><span id="L-5"><a href="#L-5"><span class="linenos">  5</span></a><span class="kn">from</span> <span class="nn">dataclasses</span> <span class="kn">import</span> <span class="n">dataclass</span>
</span><span id="L-6"><a href="#L-6"><span class="linenos">  6</span></a><span class="kn">import</span> <span class="nn">string</span>
</span><span id="L-7"><a href="#L-7"><span class="linenos">  7</span></a><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</span><span id="L-8"><a href="#L-8"><span class="linenos">  8</span></a><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">pyplot</span>
</span><span id="L-9"><a href="#L-9"><span class="linenos">  9</span></a>
</span><span id="L-10"><a href="#L-10"><span class="linenos"> 10</span></a><span class="kn">import</span> <span class="nn">shapely.geometry</span> <span class="k">as</span> <span class="nn">geom</span>
</span><span id="L-11"><a href="#L-11"><span class="linenos"> 11</span></a><span class="kn">import</span> <span class="nn">shapely.affinity</span> <span class="k">as</span> <span class="nn">affine</span>
</span><span id="L-12"><a href="#L-12"><span class="linenos"> 12</span></a><span class="kn">import</span> <span class="nn">shapely.ops</span>
</span><span id="L-13"><a href="#L-13"><span class="linenos"> 13</span></a><span class="kn">import</span> <span class="nn">geopandas</span> <span class="k">as</span> <span class="nn">gpd</span>
</span><span id="L-14"><a href="#L-14"><span class="linenos"> 14</span></a>
</span><span id="L-15"><a href="#L-15"><span class="linenos"> 15</span></a><span class="kn">import</span> <span class="nn">weavingspace.tiling_utils</span> <span class="k">as</span> <span class="nn">tiling_utils</span>
</span><span id="L-16"><a href="#L-16"><span class="linenos"> 16</span></a>
</span><span id="L-17"><a href="#L-17"><span class="linenos"> 17</span></a>
</span><span id="L-18"><a href="#L-18"><span class="linenos"> 18</span></a><span class="k">def</span> <span class="nf">_equal_tuples</span><span class="p">(</span><span class="n">t1</span><span class="p">:</span><span class="n">Iterable</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="n">t2</span><span class="p">:</span><span class="n">Iterable</span><span class="p">[</span><span class="nb">float</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="L-19"><a href="#L-19"><span class="linenos"> 19</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;Tests for near equality of two iterables of floats using numpy</span>
</span><span id="L-20"><a href="#L-20"><span class="linenos"> 20</span></a><span class="sd">  allclose. Wrapped so as to allow find_matches function to take </span>
</span><span id="L-21"><a href="#L-21"><span class="linenos"> 21</span></a><span class="sd">  alternative equality tests as input.</span>
</span><span id="L-22"><a href="#L-22"><span class="linenos"> 22</span></a><span class="sd">  &quot;&quot;&quot;</span>
</span><span id="L-23"><a href="#L-23"><span class="linenos"> 23</span></a>  <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">t1</span><span class="p">,</span> <span class="n">t2</span><span class="p">,</span> <span class="n">atol</span> <span class="o">=</span> <span class="n">tiling_utils</span><span class="o">.</span><span class="n">RESOLUTION</span> <span class="o">*</span> <span class="mi">10</span><span class="p">)</span>
</span><span id="L-24"><a href="#L-24"><span class="linenos"> 24</span></a>
</span><span id="L-25"><a href="#L-25"><span class="linenos"> 25</span></a><span class="k">def</span> <span class="nf">_round_tuple</span><span class="p">(</span><span class="n">t</span><span class="p">:</span><span class="n">Iterable</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="n">digits</span><span class="p">:</span><span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">float</span><span class="p">]:</span>
</span><span id="L-26"><a href="#L-26"><span class="linenos"> 26</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;Convenience function to round all members of an interable. Used for </span>
</span><span id="L-27"><a href="#L-27"><span class="linenos"> 27</span></a><span class="sd">  display purposes.&quot;&quot;&quot;</span>
</span><span id="L-28"><a href="#L-28"><span class="linenos"> 28</span></a>  <span class="k">return</span> <span class="nb">tuple</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">digits</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">t</span><span class="p">])</span>
</span><span id="L-29"><a href="#L-29"><span class="linenos"> 29</span></a>
</span><span id="L-30"><a href="#L-30"><span class="linenos"> 30</span></a>
</span><span id="L-31"><a href="#L-31"><span class="linenos"> 31</span></a><span class="nd">@dataclass</span>
</span><span id="L-32"><a href="#L-32"><span class="linenos"> 32</span></a><span class="k">class</span> <span class="nc">Symmetries</span><span class="p">():</span>
</span><span id="L-33"><a href="#L-33"><span class="linenos"> 33</span></a>
</span><span id="L-34"><a href="#L-34"><span class="linenos"> 34</span></a>  <span class="n">polygon</span><span class="p">:</span><span class="n">geom</span><span class="o">.</span><span class="n">Polygon</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-35"><a href="#L-35"><span class="linenos"> 35</span></a>  <span class="n">n</span><span class="p">:</span><span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-36"><a href="#L-36"><span class="linenos"> 36</span></a>  <span class="n">p_code</span><span class="p">:</span><span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-37"><a href="#L-37"><span class="linenos"> 37</span></a>  <span class="n">p_code_r</span><span class="p">:</span><span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-38"><a href="#L-38"><span class="linenos"> 38</span></a>  <span class="n">rotation_shifts</span><span class="p">:</span><span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-39"><a href="#L-39"><span class="linenos"> 39</span></a>  <span class="n">reflection_shifts</span><span class="p">:</span><span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-40"><a href="#L-40"><span class="linenos"> 40</span></a>  
</span><span id="L-41"><a href="#L-41"><span class="linenos"> 41</span></a>
</span><span id="L-42"><a href="#L-42"><span class="linenos"> 42</span></a>  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">polygon</span><span class="p">:</span><span class="n">geom</span><span class="o">.</span><span class="n">Polygon</span><span class="p">):</span>
</span><span id="L-43"><a href="#L-43"><span class="linenos"> 43</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">polygon</span> <span class="o">=</span> <span class="n">polygon</span>
</span><span id="L-44"><a href="#L-44"><span class="linenos"> 44</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">=</span> <span class="n">shapely</span><span class="o">.</span><span class="n">count_coordinates</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">polygon</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
</span><span id="L-45"><a href="#L-45"><span class="linenos"> 45</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">p_code</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_polygon_code</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">polygon</span><span class="p">)</span>
</span><span id="L-46"><a href="#L-46"><span class="linenos"> 46</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">p_code_r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_polygon_code</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">polygon</span><span class="p">,</span> <span class="n">mirrored</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</span><span id="L-47"><a href="#L-47"><span class="linenos"> 47</span></a>    <span class="n">symmetries</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_find_symmetries</span><span class="p">()</span>
</span><span id="L-48"><a href="#L-48"><span class="linenos"> 48</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">rotation_shifts</span> <span class="o">=</span> <span class="n">symmetries</span><span class="p">[</span><span class="s2">&quot;rotation-shifts&quot;</span><span class="p">]</span>
</span><span id="L-49"><a href="#L-49"><span class="linenos"> 49</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">reflection_shifts</span> <span class="o">=</span> <span class="n">symmetries</span><span class="p">[</span><span class="s2">&quot;reflection-shifts&quot;</span><span class="p">]</span>
</span><span id="L-50"><a href="#L-50"><span class="linenos"> 50</span></a>    
</span><span id="L-51"><a href="#L-51"><span class="linenos"> 51</span></a>
</span><span id="L-52"><a href="#L-52"><span class="linenos"> 52</span></a>  <span class="k">def</span> <span class="nf">_get_polygon_code</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">p</span><span class="p">:</span><span class="n">geom</span><span class="o">.</span><span class="n">Polygon</span><span class="p">,</span> 
</span><span id="L-53"><a href="#L-53"><span class="linenos"> 53</span></a>                        <span class="n">mirrored</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">]]:</span>
</span><span id="L-54"><a href="#L-54"><span class="linenos"> 54</span></a><span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Returns a list of length-angle pairs to uniquely encode a polygon</span>
</span><span id="L-55"><a href="#L-55"><span class="linenos"> 55</span></a><span class="sd">    shape (up to scale). The alignment of lengths and angles is important</span>
</span><span id="L-56"><a href="#L-56"><span class="linenos"> 56</span></a><span class="sd">    and symmetry detection is sensitively dependent on it...</span>
</span><span id="L-57"><a href="#L-57"><span class="linenos"> 57</span></a>
</span><span id="L-58"><a href="#L-58"><span class="linenos"> 58</span></a><span class="sd">    The forward (i.e. unmirrored) polygon pairs are of edge lengths and the </span>
</span><span id="L-59"><a href="#L-59"><span class="linenos"> 59</span></a><span class="sd">    angle between each edge and its successor going CW around the polygon. </span>
</span><span id="L-60"><a href="#L-60"><span class="linenos"> 60</span></a><span class="sd">    </span>
</span><span id="L-61"><a href="#L-61"><span class="linenos"> 61</span></a><span class="sd">           A[i] ----L[i]---- A (i+1)</span>
</span><span id="L-62"><a href="#L-62"><span class="linenos"> 62</span></a><span class="sd">          /                   \</span>
</span><span id="L-63"><a href="#L-63"><span class="linenos"> 63</span></a><span class="sd">         /                     \</span>
</span><span id="L-64"><a href="#L-64"><span class="linenos"> 64</span></a><span class="sd">                             </span>
</span><span id="L-65"><a href="#L-65"><span class="linenos"> 65</span></a><span class="sd">    i.e. edge i is between angles i and i + 1, and angle i is between edge</span>
</span><span id="L-66"><a href="#L-66"><span class="linenos"> 66</span></a><span class="sd">    i-1 and i. The unmirrored encoding pairs length[i] with angle[i+1].</span>
</span><span id="L-67"><a href="#L-67"><span class="linenos"> 67</span></a><span class="sd">    </span>
</span><span id="L-68"><a href="#L-68"><span class="linenos"> 68</span></a><span class="sd">    The mirrored encoding pairs matched indexes of lengths and angles in the</span>
</span><span id="L-69"><a href="#L-69"><span class="linenos"> 69</span></a><span class="sd">    original polygon. This means the angle is still the one between and edge </span>
</span><span id="L-70"><a href="#L-70"><span class="linenos"> 70</span></a><span class="sd">    and its successor but proceeding CCW around the polygon.</span>
</span><span id="L-71"><a href="#L-71"><span class="linenos"> 71</span></a><span class="sd">    </span>
</span><span id="L-72"><a href="#L-72"><span class="linenos"> 72</span></a><span class="sd">    See in particular for clarification.</span>
</span><span id="L-73"><a href="#L-73"><span class="linenos"> 73</span></a><span class="sd">    </span>
</span><span id="L-74"><a href="#L-74"><span class="linenos"> 74</span></a><span class="sd">    Eades P. 1988. Symmetry Finding Algorithms. In Machine Intelligence and </span>
</span><span id="L-75"><a href="#L-75"><span class="linenos"> 75</span></a><span class="sd">    Pattern Recognition, ed. GT Toussaint, 6:41-51. Computational Morphology. </span>
</span><span id="L-76"><a href="#L-76"><span class="linenos"> 76</span></a><span class="sd">    North-Holland. doi: 10.1016/B978-0-444-70467-2.50009-6.</span>
</span><span id="L-77"><a href="#L-77"><span class="linenos"> 77</span></a><span class="sd">    </span>
</span><span id="L-78"><a href="#L-78"><span class="linenos"> 78</span></a><span class="sd">    Args:</span>
</span><span id="L-79"><a href="#L-79"><span class="linenos"> 79</span></a><span class="sd">      p (geom.Polygon): the polygon to encode</span>
</span><span id="L-80"><a href="#L-80"><span class="linenos"> 80</span></a><span class="sd">        mirrored (bool, optional): if true encoding will be in CCC order. </span>
</span><span id="L-81"><a href="#L-81"><span class="linenos"> 81</span></a><span class="sd">        Defaults to False.</span>
</span><span id="L-82"><a href="#L-82"><span class="linenos"> 82</span></a>
</span><span id="L-83"><a href="#L-83"><span class="linenos"> 83</span></a><span class="sd">    Returns:</span>
</span><span id="L-84"><a href="#L-84"><span class="linenos"> 84</span></a><span class="sd">      list[tuple[float]]: _description_</span>
</span><span id="L-85"><a href="#L-85"><span class="linenos"> 85</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-86"><a href="#L-86"><span class="linenos"> 86</span></a>    <span class="c1"># get edge lengths and angles</span>
</span><span id="L-87"><a href="#L-87"><span class="linenos"> 87</span></a>    <span class="n">lengths</span> <span class="o">=</span> <span class="n">tiling_utils</span><span class="o">.</span><span class="n">get_side_lengths</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</span><span id="L-88"><a href="#L-88"><span class="linenos"> 88</span></a>    <span class="n">raw_angles</span> <span class="o">=</span> <span class="n">tiling_utils</span><span class="o">.</span><span class="n">get_interior_angles</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</span><span id="L-89"><a href="#L-89"><span class="linenos"> 89</span></a>    <span class="k">if</span> <span class="n">mirrored</span><span class="p">:</span>
</span><span id="L-90"><a href="#L-90"><span class="linenos"> 90</span></a>      <span class="n">lengths_r</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">reversed</span><span class="p">(</span><span class="n">lengths</span><span class="p">))</span>
</span><span id="L-91"><a href="#L-91"><span class="linenos"> 91</span></a>      <span class="n">angles_r</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">reversed</span><span class="p">(</span><span class="n">raw_angles</span><span class="p">))</span>
</span><span id="L-92"><a href="#L-92"><span class="linenos"> 92</span></a>      <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">lengths_r</span><span class="p">,</span> <span class="n">angles_r</span><span class="p">))</span>
</span><span id="L-93"><a href="#L-93"><span class="linenos"> 93</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="L-94"><a href="#L-94"><span class="linenos"> 94</span></a>      <span class="n">angles</span> <span class="o">=</span> <span class="n">raw_angles</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">+</span> <span class="n">raw_angles</span><span class="p">[:</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-95"><a href="#L-95"><span class="linenos"> 95</span></a>      <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">lengths</span><span class="p">,</span> <span class="n">angles</span><span class="p">))</span>
</span><span id="L-96"><a href="#L-96"><span class="linenos"> 96</span></a>
</span><span id="L-97"><a href="#L-97"><span class="linenos"> 97</span></a>
</span><span id="L-98"><a href="#L-98"><span class="linenos"> 98</span></a>  <span class="k">def</span> <span class="nf">_find_symmetries</span><span class="p">(</span>
</span><span id="L-99"><a href="#L-99"><span class="linenos"> 99</span></a>      <span class="bp">self</span><span class="p">,</span> <span class="n">other_polygon</span><span class="p">:</span><span class="n">geom</span><span class="o">.</span><span class="n">Polygon</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]]:</span>
</span><span id="L-100"><a href="#L-100"><span class="linenos">100</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Finds rotation and reflection symmetries of the supplied polygon.</span>
</span><span id="L-101"><a href="#L-101"><span class="linenos">101</span></a><span class="sd">    Based on</span>
</span><span id="L-102"><a href="#L-102"><span class="linenos">102</span></a><span class="sd">    </span>
</span><span id="L-103"><a href="#L-103"><span class="linenos">103</span></a><span class="sd">      Eades P. 1988. Symmetry Finding Algorithms. In Machine Intelligence and </span>
</span><span id="L-104"><a href="#L-104"><span class="linenos">104</span></a><span class="sd">      Pattern Recognition, ed. GT Toussaint, 6:41-51. Computational Morphology. </span>
</span><span id="L-105"><a href="#L-105"><span class="linenos">105</span></a><span class="sd">      North-Holland. doi: 10.1016/B978-0-444-70467-2.50009-6.</span>
</span><span id="L-106"><a href="#L-106"><span class="linenos">106</span></a><span class="sd">    </span>
</span><span id="L-107"><a href="#L-107"><span class="linenos">107</span></a><span class="sd">    and also</span>
</span><span id="L-108"><a href="#L-108"><span class="linenos">108</span></a><span class="sd">    </span>
</span><span id="L-109"><a href="#L-109"><span class="linenos">109</span></a><span class="sd">      Wolter JD, TC Woo, and RA Volz. 1985. Optimal algorithms for symmetry </span>
</span><span id="L-110"><a href="#L-110"><span class="linenos">110</span></a><span class="sd">      detection in two and three dimensions. The Visual Computer 1(1): 37-48. </span>
</span><span id="L-111"><a href="#L-111"><span class="linenos">111</span></a><span class="sd">      doi: 10.1007/BF01901268.</span>
</span><span id="L-112"><a href="#L-112"><span class="linenos">112</span></a><span class="sd">    </span>
</span><span id="L-113"><a href="#L-113"><span class="linenos">113</span></a><span class="sd">    Details in these papers are not unambiguous. This implementation was</span>
</span><span id="L-114"><a href="#L-114"><span class="linenos">114</span></a><span class="sd">    developed based on them, but with a lot of trial and error to get the index</span>
</span><span id="L-115"><a href="#L-115"><span class="linenos">115</span></a><span class="sd">    offsets and (especially) retrieval of the reflection axes angles to work.</span>
</span><span id="L-116"><a href="#L-116"><span class="linenos">116</span></a>
</span><span id="L-117"><a href="#L-117"><span class="linenos">117</span></a><span class="sd">    Args:</span>
</span><span id="L-118"><a href="#L-118"><span class="linenos">118</span></a><span class="sd">      other (geom.Polygon, optional): finds transforms between this polygon and </span>
</span><span id="L-119"><a href="#L-119"><span class="linenos">119</span></a><span class="sd">      another that may be supplied. Defaults to None, when the comparison </span>
</span><span id="L-120"><a href="#L-120"><span class="linenos">120</span></a><span class="sd">      polygon will that for which this Symmetries object has been initialised.</span>
</span><span id="L-121"><a href="#L-121"><span class="linenos">121</span></a>
</span><span id="L-122"><a href="#L-122"><span class="linenos">122</span></a><span class="sd">    Returns:</span>
</span><span id="L-123"><a href="#L-123"><span class="linenos">123</span></a><span class="sd">      dict[str, list[float]]: _description_</span>
</span><span id="L-124"><a href="#L-124"><span class="linenos">124</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-125"><a href="#L-125"><span class="linenos">125</span></a>    <span class="c1"># compose extended sequence of length-angle pairs for cyclic matching</span>
</span><span id="L-126"><a href="#L-126"><span class="linenos">126</span></a>    <span class="n">S</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">p_code</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">p_code</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-127"><a href="#L-127"><span class="linenos">127</span></a>    <span class="c1"># get code for the &#39;other&#39; polygon, if it exists...</span>
</span><span id="L-128"><a href="#L-128"><span class="linenos">128</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">other_polygon</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-129"><a href="#L-129"><span class="linenos">129</span></a>      <span class="n">p_code</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_polygon_code</span><span class="p">(</span><span class="n">other_polygon</span><span class="p">)</span>
</span><span id="L-130"><a href="#L-130"><span class="linenos">130</span></a>      <span class="n">p_code_r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_polygon_code</span><span class="p">(</span><span class="n">other_polygon</span><span class="p">,</span> <span class="n">mirrored</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</span><span id="L-131"><a href="#L-131"><span class="linenos">131</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="L-132"><a href="#L-132"><span class="linenos">132</span></a>      <span class="n">p_code</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">p_code</span>
</span><span id="L-133"><a href="#L-133"><span class="linenos">133</span></a>      <span class="n">p_code_r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">p_code_r</span>
</span><span id="L-134"><a href="#L-134"><span class="linenos">134</span></a>    <span class="c1"># ==== Rotations ====</span>
</span><span id="L-135"><a href="#L-135"><span class="linenos">135</span></a>    <span class="n">rotation_shifts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_matches</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="n">p_code</span><span class="p">)</span>
</span><span id="L-136"><a href="#L-136"><span class="linenos">136</span></a>    <span class="c1"># ==== Reflections ====</span>
</span><span id="L-137"><a href="#L-137"><span class="linenos">137</span></a>    <span class="n">reflection_shifts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_matches</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="n">p_code_r</span><span class="p">)</span>
</span><span id="L-138"><a href="#L-138"><span class="linenos">138</span></a>    <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;rotation-shifts&quot;</span><span class="p">:</span> <span class="n">rotation_shifts</span><span class="p">,</span>
</span><span id="L-139"><a href="#L-139"><span class="linenos">139</span></a>            <span class="s2">&quot;reflection-shifts&quot;</span><span class="p">:</span> <span class="n">reflection_shifts</span><span class="p">}</span>
</span><span id="L-140"><a href="#L-140"><span class="linenos">140</span></a>
</span><span id="L-141"><a href="#L-141"><span class="linenos">141</span></a>
</span><span id="L-142"><a href="#L-142"><span class="linenos">142</span></a>  <span class="k">def</span> <span class="nf">get_rotations</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">offsets</span><span class="p">:</span><span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]]:</span>
</span><span id="L-143"><a href="#L-143"><span class="linenos">143</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Gets the rotations associated with this collection of symmetries.</span>
</span><span id="L-144"><a href="#L-144"><span class="linenos">144</span></a>
</span><span id="L-145"><a href="#L-145"><span class="linenos">145</span></a><span class="sd">    Returns:</span>
</span><span id="L-146"><a href="#L-146"><span class="linenos">146</span></a><span class="sd">      dict[str, list[float], list[float]]: Two item dictionary with &#39;angles&#39; and</span>
</span><span id="L-147"><a href="#L-147"><span class="linenos">147</span></a><span class="sd">        &#39;transforms&#39; entries, each a list of floats.</span>
</span><span id="L-148"><a href="#L-148"><span class="linenos">148</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-149"><a href="#L-149"><span class="linenos">149</span></a>    <span class="k">if</span> <span class="n">offsets</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-150"><a href="#L-150"><span class="linenos">150</span></a>      <span class="n">offsets</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rotation_shifts</span>
</span><span id="L-151"><a href="#L-151"><span class="linenos">151</span></a>    <span class="n">c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">polygon</span><span class="o">.</span><span class="n">centroid</span>
</span><span id="L-152"><a href="#L-152"><span class="linenos">152</span></a>    <span class="n">rot_angles</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">i</span> <span class="o">*</span> <span class="mi">360</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">offsets</span><span class="p">]</span> 
</span><span id="L-153"><a href="#L-153"><span class="linenos">153</span></a>    <span class="n">rotations</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_rotation_transform</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">y</span><span class="p">)),</span> <span class="mi">6</span><span class="p">)</span> 
</span><span id="L-154"><a href="#L-154"><span class="linenos">154</span></a>                 <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">rot_angles</span><span class="p">]</span>
</span><span id="L-155"><a href="#L-155"><span class="linenos">155</span></a>    <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;angles&quot;</span><span class="p">:</span> <span class="n">rot_angles</span><span class="p">,</span> <span class="s2">&quot;transforms&quot;</span><span class="p">:</span> <span class="n">rotations</span><span class="p">}</span>
</span><span id="L-156"><a href="#L-156"><span class="linenos">156</span></a>    
</span><span id="L-157"><a href="#L-157"><span class="linenos">157</span></a>
</span><span id="L-158"><a href="#L-158"><span class="linenos">158</span></a>  <span class="k">def</span> <span class="nf">get_reflections</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">offsets</span><span class="p">:</span><span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]]:</span>
</span><span id="L-159"><a href="#L-159"><span class="linenos">159</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Gets the reflections associated with this collection of symmetries.</span>
</span><span id="L-160"><a href="#L-160"><span class="linenos">160</span></a>
</span><span id="L-161"><a href="#L-161"><span class="linenos">161</span></a><span class="sd">    Returns:</span>
</span><span id="L-162"><a href="#L-162"><span class="linenos">162</span></a><span class="sd">      dict[str, list[float], list[float]]: Two item dictionary with &#39;angles&#39; and</span>
</span><span id="L-163"><a href="#L-163"><span class="linenos">163</span></a><span class="sd">        &#39;transforms&#39; entries, each a list of floats.</span>
</span><span id="L-164"><a href="#L-164"><span class="linenos">164</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-165"><a href="#L-165"><span class="linenos">165</span></a>    <span class="k">if</span> <span class="n">offsets</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-166"><a href="#L-166"><span class="linenos">166</span></a>      <span class="n">offsets</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reflection_shifts</span>
</span><span id="L-167"><a href="#L-167"><span class="linenos">167</span></a>    <span class="c1"># calculate all possible reflection axes - ordering of these is important</span>
</span><span id="L-168"><a href="#L-168"><span class="linenos">168</span></a>    <span class="c1"># for correct picking - don&#39;t mess with this code!</span>
</span><span id="L-169"><a href="#L-169"><span class="linenos">169</span></a>    <span class="n">c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">polygon</span><span class="o">.</span><span class="n">centroid</span>
</span><span id="L-170"><a href="#L-170"><span class="linenos">170</span></a>    <span class="n">bearings</span> <span class="o">=</span> <span class="n">tiling_utils</span><span class="o">.</span><span class="n">get_side_bearings</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">polygon</span><span class="p">)</span>
</span><span id="L-171"><a href="#L-171"><span class="linenos">171</span></a>    <span class="n">reflection_axes</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-172"><a href="#L-172"><span class="linenos">172</span></a>    <span class="n">interior_angles</span> <span class="o">=</span> <span class="n">tiling_utils</span><span class="o">.</span><span class="n">get_interior_angles</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">polygon</span><span class="p">)</span>
</span><span id="L-173"><a href="#L-173"><span class="linenos">173</span></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">):</span>
</span><span id="L-174"><a href="#L-174"><span class="linenos">174</span></a>      <span class="c1"># angle bisectors</span>
</span><span id="L-175"><a href="#L-175"><span class="linenos">175</span></a>      <span class="n">reflection_axes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">bearings</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">interior_angles</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="L-176"><a href="#L-176"><span class="linenos">176</span></a>      <span class="c1"># edge_perpendicular bisectors</span>
</span><span id="L-177"><a href="#L-177"><span class="linenos">177</span></a>      <span class="n">reflection_axes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">bearings</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="mi">90</span><span class="p">)</span>  <span class="c1"># normal to the edge</span>
</span><span id="L-178"><a href="#L-178"><span class="linenos">178</span></a>    <span class="c1"># pick out those where matches occurred</span>
</span><span id="L-179"><a href="#L-179"><span class="linenos">179</span></a>    <span class="n">ref_angles</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">reflection_axes</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="mi">6</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">offsets</span><span class="p">]</span>
</span><span id="L-180"><a href="#L-180"><span class="linenos">180</span></a>    <span class="n">reflections</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_reflection_transform</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">y</span><span class="p">)),</span> <span class="mi">6</span><span class="p">)</span>
</span><span id="L-181"><a href="#L-181"><span class="linenos">181</span></a>                   <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">ref_angles</span><span class="p">]</span>
</span><span id="L-182"><a href="#L-182"><span class="linenos">182</span></a>    <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;angles&quot;</span><span class="p">:</span> <span class="n">ref_angles</span><span class="p">,</span> <span class="s2">&quot;transforms&quot;</span><span class="p">:</span> <span class="n">reflections</span><span class="p">}</span>
</span><span id="L-183"><a href="#L-183"><span class="linenos">183</span></a>
</span><span id="L-184"><a href="#L-184"><span class="linenos">184</span></a>
</span><span id="L-185"><a href="#L-185"><span class="linenos">185</span></a>  <span class="k">def</span> <span class="nf">get_matching_transforms</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> 
</span><span id="L-186"><a href="#L-186"><span class="linenos">186</span></a>                              <span class="n">other</span><span class="p">:</span><span class="n">geom</span><span class="o">.</span><span class="n">Polygon</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]]:</span>
</span><span id="L-187"><a href="#L-187"><span class="linenos">187</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Finds the transforms that will map another polygon onto this one.</span>
</span><span id="L-188"><a href="#L-188"><span class="linenos">188</span></a><span class="sd">    Reuses the _find_symmetries() method, but supplying the other polygon</span>
</span><span id="L-189"><a href="#L-189"><span class="linenos">189</span></a><span class="sd">    as that method&#39;s optional argument. Before determining the match the</span>
</span><span id="L-190"><a href="#L-190"><span class="linenos">190</span></a><span class="sd">    points on the perimeter of the other polygon are reordered so that the</span>
</span><span id="L-191"><a href="#L-191"><span class="linenos">191</span></a><span class="sd">    index positions match those of the reference polygon.</span>
</span><span id="L-192"><a href="#L-192"><span class="linenos">192</span></a>
</span><span id="L-193"><a href="#L-193"><span class="linenos">193</span></a><span class="sd">    Args:</span>
</span><span id="L-194"><a href="#L-194"><span class="linenos">194</span></a><span class="sd">        other (geom.Polygon): the polygon to match.</span>
</span><span id="L-195"><a href="#L-195"><span class="linenos">195</span></a>
</span><span id="L-196"><a href="#L-196"><span class="linenos">196</span></a><span class="sd">    Returns:</span>
</span><span id="L-197"><a href="#L-197"><span class="linenos">197</span></a><span class="sd">      dict[str,Union[str,list[float]]]: A dictionary with the following entries:</span>
</span><span id="L-198"><a href="#L-198"><span class="linenos">198</span></a><span class="sd">      &#39;rotation-shifts&#39;: vertex offsets to form matches by rotation</span>
</span><span id="L-199"><a href="#L-199"><span class="linenos">199</span></a><span class="sd">      &#39;reflection-shifts&#39;: vertex offsets to form matches by reflection</span>
</span><span id="L-200"><a href="#L-200"><span class="linenos">200</span></a><span class="sd">      &#39;rotation-angles&#39;: list of rotation angles of matches (in degrees)</span>
</span><span id="L-201"><a href="#L-201"><span class="linenos">201</span></a><span class="sd">      &#39;reflection-angles&#39;: list of angles of reflection axes (in degrees)</span>
</span><span id="L-202"><a href="#L-202"><span class="linenos">202</span></a><span class="sd">      &#39;rotation-transforms&#39;: list of shapely affine transform tuples of    </span>
</span><span id="L-203"><a href="#L-203"><span class="linenos">203</span></a><span class="sd">        rotation matches</span>
</span><span id="L-204"><a href="#L-204"><span class="linenos">204</span></a><span class="sd">      &#39;reflection-transforms&#39;: list of shapely affine transform tuples of</span>
</span><span id="L-205"><a href="#L-205"><span class="linenos">205</span></a><span class="sd">        reflection matches</span>
</span><span id="L-206"><a href="#L-206"><span class="linenos">206</span></a><span class="sd">      &#39;pre-translation&#39;: translation to align other with this polygon as tuple</span>
</span><span id="L-207"><a href="#L-207"><span class="linenos">207</span></a><span class="sd">        of floats</span>
</span><span id="L-208"><a href="#L-208"><span class="linenos">208</span></a><span class="sd">      &#39;pre-rotation&#39;: rotation to align other with this polygon (in degrees)</span>
</span><span id="L-209"><a href="#L-209"><span class="linenos">209</span></a><span class="sd">      &#39;pre-transform&#39;: shapely affine transform tuple that brings other into</span>
</span><span id="L-210"><a href="#L-210"><span class="linenos">210</span></a><span class="sd">        alignment with this polygon such that the matching transforms work </span>
</span><span id="L-211"><a href="#L-211"><span class="linenos">211</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-212"><a href="#L-212"><span class="linenos">212</span></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">==</span> <span class="n">shapely</span><span class="o">.</span><span class="n">count_coordinates</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="L-213"><a href="#L-213"><span class="linenos">213</span></a>      <span class="c1"># shift them to the same centroid</span>
</span><span id="L-214"><a href="#L-214"><span class="linenos">214</span></a>      <span class="n">c0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">polygon</span><span class="o">.</span><span class="n">centroid</span>
</span><span id="L-215"><a href="#L-215"><span class="linenos">215</span></a>      <span class="n">trans</span> <span class="o">=</span> <span class="p">(</span><span class="n">c0</span><span class="o">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">other</span><span class="o">.</span><span class="n">centroid</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">c0</span><span class="o">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">other</span><span class="o">.</span><span class="n">centroid</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
</span><span id="L-216"><a href="#L-216"><span class="linenos">216</span></a>      <span class="n">other</span> <span class="o">=</span> <span class="n">affine</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">trans</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">trans</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="L-217"><a href="#L-217"><span class="linenos">217</span></a>      <span class="c1"># now see if they align at all</span>
</span><span id="L-218"><a href="#L-218"><span class="linenos">218</span></a>      <span class="n">symms</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_find_symmetries</span><span class="p">(</span><span class="n">other_polygon</span> <span class="o">=</span> <span class="n">other</span><span class="p">)</span>
</span><span id="L-219"><a href="#L-219"><span class="linenos">219</span></a>      <span class="n">rot_shifts</span> <span class="o">=</span> <span class="n">symms</span><span class="p">[</span><span class="s2">&quot;rotation-shifts&quot;</span><span class="p">]</span>
</span><span id="L-220"><a href="#L-220"><span class="linenos">220</span></a>      <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">rot_shifts</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-221"><a href="#L-221"><span class="linenos">221</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Polygons do not match at all!&quot;</span><span class="p">)</span>
</span><span id="L-222"><a href="#L-222"><span class="linenos">222</span></a>        <span class="k">return</span> <span class="kc">None</span>
</span><span id="L-223"><a href="#L-223"><span class="linenos">223</span></a>      <span class="c1"># now align the corners so indexes of their corners match</span>
</span><span id="L-224"><a href="#L-224"><span class="linenos">224</span></a>      <span class="k">if</span> <span class="n">rot_shifts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-225"><a href="#L-225"><span class="linenos">225</span></a>        <span class="n">other</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_shift_polygon_corners</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="o">-</span><span class="n">rot_shifts</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="L-226"><a href="#L-226"><span class="linenos">226</span></a>        <span class="n">rotation</span> <span class="o">=</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">get_rotations</span><span class="p">(</span><span class="n">rot_shifts</span><span class="p">)[</span><span class="s2">&quot;angles&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-227"><a href="#L-227"><span class="linenos">227</span></a>        <span class="n">other</span> <span class="o">=</span> <span class="n">tiling_utils</span><span class="o">.</span><span class="n">rotate_preserving_order</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">rotation</span><span class="p">,</span> <span class="n">c0</span><span class="p">)</span>
</span><span id="L-228"><a href="#L-228"><span class="linenos">228</span></a>      <span class="c1"># now determine the additional rotation needed to line them up</span>
</span><span id="L-229"><a href="#L-229"><span class="linenos">229</span></a>      <span class="n">p0_0</span> <span class="o">=</span> <span class="n">tiling_utils</span><span class="o">.</span><span class="n">get_corners</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">polygon</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-230"><a href="#L-230"><span class="linenos">230</span></a>      <span class="n">other_corners</span> <span class="o">=</span> <span class="n">tiling_utils</span><span class="o">.</span><span class="n">get_corners</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">repeat_first</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
</span><span id="L-231"><a href="#L-231"><span class="linenos">231</span></a>      <span class="n">rotation</span> <span class="o">=</span> <span class="n">rotation</span> <span class="o">+</span> \
</span><span id="L-232"><a href="#L-232"><span class="linenos">232</span></a>        <span class="n">tiling_utils</span><span class="o">.</span><span class="n">get_inner_angle</span><span class="p">(</span><span class="n">other_corners</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">c0</span><span class="p">,</span> <span class="n">p0_0</span><span class="p">)</span>
</span><span id="L-233"><a href="#L-233"><span class="linenos">233</span></a>      <span class="c1"># now find store and report the matching symmetries</span>
</span><span id="L-234"><a href="#L-234"><span class="linenos">234</span></a>      <span class="n">symms</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_find_symmetries</span><span class="p">(</span><span class="n">other_polygon</span> <span class="o">=</span> <span class="n">other</span><span class="p">)</span>
</span><span id="L-235"><a href="#L-235"><span class="linenos">235</span></a>      <span class="n">rot_shifts</span> <span class="o">=</span> <span class="n">symms</span><span class="p">[</span><span class="s2">&quot;rotation-shifts&quot;</span><span class="p">]</span>
</span><span id="L-236"><a href="#L-236"><span class="linenos">236</span></a>      <span class="n">rot_details</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_rotations</span><span class="p">(</span><span class="n">rot_shifts</span><span class="p">)</span>
</span><span id="L-237"><a href="#L-237"><span class="linenos">237</span></a>      <span class="n">symms</span><span class="p">[</span><span class="s2">&quot;rotation-angles&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">rot_details</span><span class="p">[</span><span class="s2">&quot;angles&quot;</span><span class="p">]</span>
</span><span id="L-238"><a href="#L-238"><span class="linenos">238</span></a>      <span class="n">symms</span><span class="p">[</span><span class="s2">&quot;rotation-transforms&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">rot_details</span><span class="p">[</span><span class="s2">&quot;transforms&quot;</span><span class="p">]</span>
</span><span id="L-239"><a href="#L-239"><span class="linenos">239</span></a>      <span class="n">ref_shifts</span> <span class="o">=</span> <span class="n">symms</span><span class="p">[</span><span class="s2">&quot;reflection-shifts&quot;</span><span class="p">]</span>
</span><span id="L-240"><a href="#L-240"><span class="linenos">240</span></a>      <span class="n">ref_details</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_reflections</span><span class="p">(</span><span class="n">ref_shifts</span><span class="p">)</span>
</span><span id="L-241"><a href="#L-241"><span class="linenos">241</span></a>      <span class="n">symms</span><span class="p">[</span><span class="s2">&quot;reflection-angles&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ref_details</span><span class="p">[</span><span class="s2">&quot;angles&quot;</span><span class="p">]</span>
</span><span id="L-242"><a href="#L-242"><span class="linenos">242</span></a>      <span class="n">symms</span><span class="p">[</span><span class="s2">&quot;reflection-transforms&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ref_details</span><span class="p">[</span><span class="s2">&quot;transforms&quot;</span><span class="p">]</span>
</span><span id="L-243"><a href="#L-243"><span class="linenos">243</span></a>      <span class="n">symms</span><span class="p">[</span><span class="s2">&quot;pre-translation&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">trans</span>
</span><span id="L-244"><a href="#L-244"><span class="linenos">244</span></a>      <span class="n">symms</span><span class="p">[</span><span class="s2">&quot;pre-rotation&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">rotation</span>
</span><span id="L-245"><a href="#L-245"><span class="linenos">245</span></a>      <span class="n">symms</span><span class="p">[</span><span class="s2">&quot;pre-transform&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_combine_transforms</span><span class="p">(</span>
</span><span id="L-246"><a href="#L-246"><span class="linenos">246</span></a>        <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_translation_transform</span><span class="p">(</span><span class="n">trans</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">trans</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span>
</span><span id="L-247"><a href="#L-247"><span class="linenos">247</span></a>         <span class="bp">self</span><span class="o">.</span><span class="n">_get_rotation_transform</span><span class="p">(</span><span class="n">rotation</span><span class="p">,</span> <span class="p">(</span><span class="n">c0</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">c0</span><span class="o">.</span><span class="n">y</span><span class="p">))])</span>
</span><span id="L-248"><a href="#L-248"><span class="linenos">248</span></a>      <span class="k">return</span> <span class="n">symms</span>
</span><span id="L-249"><a href="#L-249"><span class="linenos">249</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="L-250"><a href="#L-250"><span class="linenos">250</span></a>      <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Polygons have different numbers of sides!&quot;</span><span class="p">)</span>
</span><span id="L-251"><a href="#L-251"><span class="linenos">251</span></a>      <span class="k">return</span> <span class="kc">None</span>
</span><span id="L-252"><a href="#L-252"><span class="linenos">252</span></a>
</span><span id="L-253"><a href="#L-253"><span class="linenos">253</span></a>
</span><span id="L-254"><a href="#L-254"><span class="linenos">254</span></a>  <span class="k">def</span> <span class="nf">_shift_polygon_corners</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">polygon</span><span class="p">:</span><span class="n">geom</span><span class="o">.</span><span class="n">Polygon</span><span class="p">,</span> 
</span><span id="L-255"><a href="#L-255"><span class="linenos">255</span></a>                             <span class="n">offset</span><span class="p">:</span><span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">geom</span><span class="o">.</span><span class="n">Polygon</span><span class="p">:</span>
</span><span id="L-256"><a href="#L-256"><span class="linenos">256</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns this polygon but with its first corner offset from its</span>
</span><span id="L-257"><a href="#L-257"><span class="linenos">257</span></a><span class="sd">    original position in the coordinate sequence. The returned polygon will</span>
</span><span id="L-258"><a href="#L-258"><span class="linenos">258</span></a><span class="sd">    be identical but stored differently internally.</span>
</span><span id="L-259"><a href="#L-259"><span class="linenos">259</span></a>
</span><span id="L-260"><a href="#L-260"><span class="linenos">260</span></a><span class="sd">    Args:</span>
</span><span id="L-261"><a href="#L-261"><span class="linenos">261</span></a><span class="sd">      polygon (geom.Polygon): the polygon to reorder.</span>
</span><span id="L-262"><a href="#L-262"><span class="linenos">262</span></a><span class="sd">      offset (int): the number of corner positions by which to shift the</span>
</span><span id="L-263"><a href="#L-263"><span class="linenos">263</span></a><span class="sd">        sequence.</span>
</span><span id="L-264"><a href="#L-264"><span class="linenos">264</span></a>
</span><span id="L-265"><a href="#L-265"><span class="linenos">265</span></a><span class="sd">    Returns:</span>
</span><span id="L-266"><a href="#L-266"><span class="linenos">266</span></a><span class="sd">        geom.Polygon: the reordered polygon.</span>
</span><span id="L-267"><a href="#L-267"><span class="linenos">267</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-268"><a href="#L-268"><span class="linenos">268</span></a>    <span class="n">corners</span> <span class="o">=</span> <span class="n">tiling_utils</span><span class="o">.</span><span class="n">get_corners</span><span class="p">(</span><span class="n">polygon</span><span class="p">,</span> <span class="n">repeat_first</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
</span><span id="L-269"><a href="#L-269"><span class="linenos">269</span></a>    <span class="k">return</span> <span class="n">geom</span><span class="o">.</span><span class="n">Polygon</span><span class="p">([</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">corners</span><span class="p">[</span><span class="n">offset</span><span class="p">:]</span> <span class="o">+</span> <span class="n">corners</span><span class="p">[:</span><span class="n">offset</span><span class="p">]])</span> 
</span><span id="L-270"><a href="#L-270"><span class="linenos">270</span></a>
</span><span id="L-271"><a href="#L-271"><span class="linenos">271</span></a>
</span><span id="L-272"><a href="#L-272"><span class="linenos">272</span></a>  <span class="k">def</span> <span class="nf">_get_translation_transform</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dx</span><span class="p">:</span><span class="nb">float</span><span class="p">,</span> <span class="n">dy</span><span class="p">:</span><span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]:</span>
</span><span id="L-273"><a href="#L-273"><span class="linenos">273</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns the shapely affine transform tuple for a translation.</span>
</span><span id="L-274"><a href="#L-274"><span class="linenos">274</span></a>
</span><span id="L-275"><a href="#L-275"><span class="linenos">275</span></a><span class="sd">    Args:</span>
</span><span id="L-276"><a href="#L-276"><span class="linenos">276</span></a><span class="sd">        dx (float): translation distance in x direction.</span>
</span><span id="L-277"><a href="#L-277"><span class="linenos">277</span></a><span class="sd">        dy (float): translation distance in y direction.</span>
</span><span id="L-278"><a href="#L-278"><span class="linenos">278</span></a>
</span><span id="L-279"><a href="#L-279"><span class="linenos">279</span></a><span class="sd">    Returns:</span>
</span><span id="L-280"><a href="#L-280"><span class="linenos">280</span></a><span class="sd">      list[float]: a six item list of floats, per the shapely.affinity.</span>
</span><span id="L-281"><a href="#L-281"><span class="linenos">281</span></a><span class="sd">      affine_transform method, see </span>
</span><span id="L-282"><a href="#L-282"><span class="linenos">282</span></a><span class="sd">        https://shapely.readthedocs.io/en/stable/manual.html#affine-transformations</span>
</span><span id="L-283"><a href="#L-283"><span class="linenos">283</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-284"><a href="#L-284"><span class="linenos">284</span></a>    <span class="k">return</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="p">]</span>
</span><span id="L-285"><a href="#L-285"><span class="linenos">285</span></a>  
</span><span id="L-286"><a href="#L-286"><span class="linenos">286</span></a>
</span><span id="L-287"><a href="#L-287"><span class="linenos">287</span></a>  <span class="k">def</span> <span class="nf">_get_rotation_transform</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">angle</span><span class="p">:</span><span class="nb">float</span><span class="p">,</span> 
</span><span id="L-288"><a href="#L-288"><span class="linenos">288</span></a>                              <span class="n">centre</span><span class="p">:</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]:</span>
</span><span id="L-289"><a href="#L-289"><span class="linenos">289</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns the shapely affine transform tuple for a rotation, optionally</span>
</span><span id="L-290"><a href="#L-290"><span class="linenos">290</span></a><span class="sd">    about a supplied centre point.</span>
</span><span id="L-291"><a href="#L-291"><span class="linenos">291</span></a>
</span><span id="L-292"><a href="#L-292"><span class="linenos">292</span></a><span class="sd">    Args:</span>
</span><span id="L-293"><a href="#L-293"><span class="linenos">293</span></a><span class="sd">        angle (float): the angle of rotation (in degrees).</span>
</span><span id="L-294"><a href="#L-294"><span class="linenos">294</span></a><span class="sd">        centre (tuple[float], optional): An option centre location. Defaults to </span>
</span><span id="L-295"><a href="#L-295"><span class="linenos">295</span></a><span class="sd">        None, which will in turn be converted to (0, 0).</span>
</span><span id="L-296"><a href="#L-296"><span class="linenos">296</span></a>
</span><span id="L-297"><a href="#L-297"><span class="linenos">297</span></a><span class="sd">    Returns:</span>
</span><span id="L-298"><a href="#L-298"><span class="linenos">298</span></a><span class="sd">      list[float]: a six item list of floats, per the shapely.affinity.</span>
</span><span id="L-299"><a href="#L-299"><span class="linenos">299</span></a><span class="sd">        affine_transform method, see </span>
</span><span id="L-300"><a href="#L-300"><span class="linenos">300</span></a><span class="sd">          https://shapely.readthedocs.io/en/stable/manual.html#affine-transformations</span>
</span><span id="L-301"><a href="#L-301"><span class="linenos">301</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-302"><a href="#L-302"><span class="linenos">302</span></a>    <span class="k">if</span> <span class="n">centre</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">centre</span><span class="p">,</span> 
</span><span id="L-303"><a href="#L-303"><span class="linenos">303</span></a>                                     <span class="n">atol</span> <span class="o">=</span> <span class="n">tiling_utils</span><span class="o">.</span><span class="n">RESOLUTION</span><span class="p">):</span>
</span><span id="L-304"><a href="#L-304"><span class="linenos">304</span></a>      <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span>
</span><span id="L-305"><a href="#L-305"><span class="linenos">305</span></a>      <span class="k">return</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
</span><span id="L-306"><a href="#L-306"><span class="linenos">306</span></a>    
</span><span id="L-307"><a href="#L-307"><span class="linenos">307</span></a>    <span class="n">dx</span><span class="p">,</span> <span class="n">dy</span> <span class="o">=</span> <span class="n">centre</span>
</span><span id="L-308"><a href="#L-308"><span class="linenos">308</span></a>    <span class="n">t1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_translation_transform</span><span class="p">(</span><span class="o">-</span><span class="n">dx</span><span class="p">,</span> <span class="o">-</span><span class="n">dy</span><span class="p">)</span>
</span><span id="L-309"><a href="#L-309"><span class="linenos">309</span></a>    <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_rotation_transform</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span>
</span><span id="L-310"><a href="#L-310"><span class="linenos">310</span></a>    <span class="n">t2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_translation_transform</span><span class="p">(</span><span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="p">)</span>
</span><span id="L-311"><a href="#L-311"><span class="linenos">311</span></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_combine_transforms</span><span class="p">([</span><span class="n">t1</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">t2</span><span class="p">])</span>
</span><span id="L-312"><a href="#L-312"><span class="linenos">312</span></a>  
</span><span id="L-313"><a href="#L-313"><span class="linenos">313</span></a>  
</span><span id="L-314"><a href="#L-314"><span class="linenos">314</span></a>  <span class="k">def</span> <span class="nf">_get_reflection_transform</span><span class="p">(</span>
</span><span id="L-315"><a href="#L-315"><span class="linenos">315</span></a>      <span class="bp">self</span><span class="p">,</span> <span class="n">angle</span><span class="p">:</span><span class="nb">float</span><span class="p">,</span> <span class="n">centre</span><span class="p">:</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]:</span>
</span><span id="L-316"><a href="#L-316"><span class="linenos">316</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns a shapely affine transform tuple that will reflect a shape</span>
</span><span id="L-317"><a href="#L-317"><span class="linenos">317</span></a><span class="sd">    in a line at the specified angle, optionally through a specified centre</span>
</span><span id="L-318"><a href="#L-318"><span class="linenos">318</span></a><span class="sd">    point.</span>
</span><span id="L-319"><a href="#L-319"><span class="linenos">319</span></a>
</span><span id="L-320"><a href="#L-320"><span class="linenos">320</span></a><span class="sd">    Args:</span>
</span><span id="L-321"><a href="#L-321"><span class="linenos">321</span></a><span class="sd">      angle (float): angle to the x-axis of the line of reflection.</span>
</span><span id="L-322"><a href="#L-322"><span class="linenos">322</span></a><span class="sd">      centre (tuple[float], optional): point through which the line of </span>
</span><span id="L-323"><a href="#L-323"><span class="linenos">323</span></a><span class="sd">        reflection passes. Defaults to None, which</span>
</span><span id="L-324"><a href="#L-324"><span class="linenos">324</span></a><span class="sd">        will in turn be converted to (0, 0).</span>
</span><span id="L-325"><a href="#L-325"><span class="linenos">325</span></a>
</span><span id="L-326"><a href="#L-326"><span class="linenos">326</span></a><span class="sd">    Returns:</span>
</span><span id="L-327"><a href="#L-327"><span class="linenos">327</span></a><span class="sd">      list[float]: a six item list of floats, per the shapely.affinity.</span>
</span><span id="L-328"><a href="#L-328"><span class="linenos">328</span></a><span class="sd">        affine_transform method, see </span>
</span><span id="L-329"><a href="#L-329"><span class="linenos">329</span></a><span class="sd">          https://shapely.readthedocs.io/en/stable/manual.html#affine-transformations</span>
</span><span id="L-330"><a href="#L-330"><span class="linenos">330</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-331"><a href="#L-331"><span class="linenos">331</span></a>    <span class="k">if</span> <span class="n">centre</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">centre</span><span class="p">,</span> 
</span><span id="L-332"><a href="#L-332"><span class="linenos">332</span></a>                                     <span class="n">atol</span> <span class="o">=</span> <span class="n">tiling_utils</span><span class="o">.</span><span class="n">RESOLUTION</span><span class="p">):</span>
</span><span id="L-333"><a href="#L-333"><span class="linenos">333</span></a>      <span class="n">A</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span>
</span><span id="L-334"><a href="#L-334"><span class="linenos">334</span></a>      <span class="k">return</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">A</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">A</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">A</span><span class="p">),</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">A</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="L-335"><a href="#L-335"><span class="linenos">335</span></a>    <span class="n">dx</span><span class="p">,</span> <span class="n">dy</span> <span class="o">=</span> <span class="n">centre</span>
</span><span id="L-336"><a href="#L-336"><span class="linenos">336</span></a>    <span class="n">t1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_translation_transform</span><span class="p">(</span><span class="o">-</span><span class="n">dx</span><span class="p">,</span> <span class="o">-</span><span class="n">dy</span><span class="p">)</span>
</span><span id="L-337"><a href="#L-337"><span class="linenos">337</span></a>    <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_reflection_transform</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span>
</span><span id="L-338"><a href="#L-338"><span class="linenos">338</span></a>    <span class="n">t2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_translation_transform</span><span class="p">(</span><span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="p">)</span>
</span><span id="L-339"><a href="#L-339"><span class="linenos">339</span></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_combine_transforms</span><span class="p">([</span><span class="n">t1</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">t2</span><span class="p">])</span>
</span><span id="L-340"><a href="#L-340"><span class="linenos">340</span></a>
</span><span id="L-341"><a href="#L-341"><span class="linenos">341</span></a>
</span><span id="L-342"><a href="#L-342"><span class="linenos">342</span></a>  <span class="k">def</span> <span class="nf">_combine_transforms</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">transforms</span><span class="p">:</span><span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]:</span>
</span><span id="L-343"><a href="#L-343"><span class="linenos">343</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns a shapely affine transform list that combines the listed</span>
</span><span id="L-344"><a href="#L-344"><span class="linenos">344</span></a><span class="sd">    sequence of transforms applied in order.</span>
</span><span id="L-345"><a href="#L-345"><span class="linenos">345</span></a>
</span><span id="L-346"><a href="#L-346"><span class="linenos">346</span></a><span class="sd">    Args:</span>
</span><span id="L-347"><a href="#L-347"><span class="linenos">347</span></a><span class="sd">      transforms (list[list[float]]): sequence of transforms to combine.</span>
</span><span id="L-348"><a href="#L-348"><span class="linenos">348</span></a>
</span><span id="L-349"><a href="#L-349"><span class="linenos">349</span></a><span class="sd">    Returns:</span>
</span><span id="L-350"><a href="#L-350"><span class="linenos">350</span></a><span class="sd">      list[float]: a transform tuple combining the supplied transforms applied</span>
</span><span id="L-351"><a href="#L-351"><span class="linenos">351</span></a><span class="sd">        in order, see </span>
</span><span id="L-352"><a href="#L-352"><span class="linenos">352</span></a><span class="sd">          https://shapely.readthedocs.io/en/stable/manual.html#affine-transformations</span>
</span><span id="L-353"><a href="#L-353"><span class="linenos">353</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-354"><a href="#L-354"><span class="linenos">354</span></a>    <span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</span><span id="L-355"><a href="#L-355"><span class="linenos">355</span></a>    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">transforms</span><span class="p">:</span>
</span><span id="L-356"><a href="#L-356"><span class="linenos">356</span></a>      <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_as_numpy_matrix</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">@</span> <span class="n">result</span>
</span><span id="L-357"><a href="#L-357"><span class="linenos">357</span></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_as_shapely_transform</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</span><span id="L-358"><a href="#L-358"><span class="linenos">358</span></a>
</span><span id="L-359"><a href="#L-359"><span class="linenos">359</span></a>
</span><span id="L-360"><a href="#L-360"><span class="linenos">360</span></a>  <span class="k">def</span> <span class="nf">_reverse_transform</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">transform</span><span class="p">:</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]:</span>
</span><span id="L-361"><a href="#L-361"><span class="linenos">361</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns the inverse shapely affine transform of the supplied transform.</span>
</span><span id="L-362"><a href="#L-362"><span class="linenos">362</span></a>
</span><span id="L-363"><a href="#L-363"><span class="linenos">363</span></a><span class="sd">    Args:</span>
</span><span id="L-364"><a href="#L-364"><span class="linenos">364</span></a><span class="sd">      transform (list[float]): the transform for which the inverse is desired.</span>
</span><span id="L-365"><a href="#L-365"><span class="linenos">365</span></a>
</span><span id="L-366"><a href="#L-366"><span class="linenos">366</span></a><span class="sd">    Returns:</span>
</span><span id="L-367"><a href="#L-367"><span class="linenos">367</span></a><span class="sd">      list[float]: shapely affine transform tuple that will invert the supplied</span>
</span><span id="L-368"><a href="#L-368"><span class="linenos">368</span></a><span class="sd">        transform.</span>
</span><span id="L-369"><a href="#L-369"><span class="linenos">369</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-370"><a href="#L-370"><span class="linenos">370</span></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_as_shapely_transform</span><span class="p">(</span>
</span><span id="L-371"><a href="#L-371"><span class="linenos">371</span></a>      <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_as_numpy_matrix</span><span class="p">(</span><span class="n">transform</span><span class="p">)))</span>
</span><span id="L-372"><a href="#L-372"><span class="linenos">372</span></a>
</span><span id="L-373"><a href="#L-373"><span class="linenos">373</span></a>
</span><span id="L-374"><a href="#L-374"><span class="linenos">374</span></a>  <span class="k">def</span> <span class="nf">_as_shapely_transform</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arr</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]:</span>
</span><span id="L-375"><a href="#L-375"><span class="linenos">375</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns the shapely affine transform list equivalent to the supplied</span>
</span><span id="L-376"><a href="#L-376"><span class="linenos">376</span></a><span class="sd">    numpy matrix of a conventional augmented affine transform matrix.</span>
</span><span id="L-377"><a href="#L-377"><span class="linenos">377</span></a>
</span><span id="L-378"><a href="#L-378"><span class="linenos">378</span></a><span class="sd">    Args:</span>
</span><span id="L-379"><a href="#L-379"><span class="linenos">379</span></a><span class="sd">      arr (np.array): augmented affine transform matrix of the desired </span>
</span><span id="L-380"><a href="#L-380"><span class="linenos">380</span></a><span class="sd">        transform.</span>
</span><span id="L-381"><a href="#L-381"><span class="linenos">381</span></a>
</span><span id="L-382"><a href="#L-382"><span class="linenos">382</span></a><span class="sd">    Returns:</span>
</span><span id="L-383"><a href="#L-383"><span class="linenos">383</span></a><span class="sd">      list[float]: desired shapely affine transform list of floats.</span>
</span><span id="L-384"><a href="#L-384"><span class="linenos">384</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-385"><a href="#L-385"><span class="linenos">385</span></a>    <span class="k">return</span> <span class="p">[</span><span class="n">arr</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">arr</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">arr</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">arr</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">arr</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span> <span class="n">arr</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">]]</span>
</span><span id="L-386"><a href="#L-386"><span class="linenos">386</span></a>  
</span><span id="L-387"><a href="#L-387"><span class="linenos">387</span></a>  
</span><span id="L-388"><a href="#L-388"><span class="linenos">388</span></a>  <span class="k">def</span> <span class="nf">_as_numpy_matrix</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">transform</span><span class="p">:</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">:</span>
</span><span id="L-389"><a href="#L-389"><span class="linenos">389</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Converts the supplied shapely affine transform list to an augmented</span>
</span><span id="L-390"><a href="#L-390"><span class="linenos">390</span></a><span class="sd">    affine transform matrix in numpy array form. This makes combining transforms</span>
</span><span id="L-391"><a href="#L-391"><span class="linenos">391</span></a><span class="sd">    much easier.</span>
</span><span id="L-392"><a href="#L-392"><span class="linenos">392</span></a>
</span><span id="L-393"><a href="#L-393"><span class="linenos">393</span></a><span class="sd">    Args:</span>
</span><span id="L-394"><a href="#L-394"><span class="linenos">394</span></a><span class="sd">      transform (list[float]): the transform in shapely format.</span>
</span><span id="L-395"><a href="#L-395"><span class="linenos">395</span></a>
</span><span id="L-396"><a href="#L-396"><span class="linenos">396</span></a><span class="sd">    Returns:</span>
</span><span id="L-397"><a href="#L-397"><span class="linenos">397</span></a><span class="sd">        np.array: the transform in numpy matrix format.</span>
</span><span id="L-398"><a href="#L-398"><span class="linenos">398</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-399"><a href="#L-399"><span class="linenos">399</span></a>    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">transform</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">transform</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">transform</span><span class="p">[</span><span class="mi">4</span><span class="p">]],</span>
</span><span id="L-400"><a href="#L-400"><span class="linenos">400</span></a>                     <span class="p">[</span><span class="n">transform</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">transform</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">transform</span><span class="p">[</span><span class="mi">5</span><span class="p">]],</span>
</span><span id="L-401"><a href="#L-401"><span class="linenos">401</span></a>                     <span class="p">[</span>           <span class="mi">0</span><span class="p">,</span>            <span class="mi">0</span><span class="p">,</span>            <span class="mi">1</span><span class="p">]])</span>
</span><span id="L-402"><a href="#L-402"><span class="linenos">402</span></a>
</span><span id="L-403"><a href="#L-403"><span class="linenos">403</span></a>
</span><span id="L-404"><a href="#L-404"><span class="linenos">404</span></a>  <span class="k">def</span> <span class="nf">get_corner_labels</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="L-405"><a href="#L-405"><span class="linenos">405</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns all the reorderings of vertex labels corresponding to each</span>
</span><span id="L-406"><a href="#L-406"><span class="linenos">406</span></a><span class="sd">    symmetry.</span>
</span><span id="L-407"><a href="#L-407"><span class="linenos">407</span></a>
</span><span id="L-408"><a href="#L-408"><span class="linenos">408</span></a><span class="sd">    Returns:</span>
</span><span id="L-409"><a href="#L-409"><span class="linenos">409</span></a><span class="sd">      dict[str, list[str]]: A dictionary with two entries. &quot;rotations&quot; is</span>
</span><span id="L-410"><a href="#L-410"><span class="linenos">410</span></a><span class="sd">        a list of labels under the rotation symmetries, &quot;reflections&quot; those</span>
</span><span id="L-411"><a href="#L-411"><span class="linenos">411</span></a><span class="sd">        under the reflection symmetries.</span>
</span><span id="L-412"><a href="#L-412"><span class="linenos">412</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-413"><a href="#L-413"><span class="linenos">413</span></a>    <span class="n">labels</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">string</span><span class="o">.</span><span class="n">ascii_letters</span><span class="o">.</span><span class="n">upper</span><span class="p">())[:</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">]</span>
</span><span id="L-414"><a href="#L-414"><span class="linenos">414</span></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_labels_under_symmetries</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span>
</span><span id="L-415"><a href="#L-415"><span class="linenos">415</span></a>
</span><span id="L-416"><a href="#L-416"><span class="linenos">416</span></a>
</span><span id="L-417"><a href="#L-417"><span class="linenos">417</span></a>  <span class="k">def</span> <span class="nf">get_unique_labels</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">offset</span><span class="p">:</span><span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="L-418"><a href="#L-418"><span class="linenos">418</span></a>    <span class="n">labellings</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_corner_labels</span><span class="p">()</span>
</span><span id="L-419"><a href="#L-419"><span class="linenos">419</span></a>    <span class="n">labellings</span> <span class="o">=</span> <span class="n">labellings</span><span class="p">[</span><span class="s2">&quot;rotations&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">labellings</span><span class="p">[</span><span class="s2">&quot;reflections&quot;</span><span class="p">]</span>
</span><span id="L-420"><a href="#L-420"><span class="linenos">420</span></a>    <span class="n">labellings</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">labellings</span><span class="p">)]</span>
</span><span id="L-421"><a href="#L-421"><span class="linenos">421</span></a>    <span class="n">n_new_labels</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">labellings</span><span class="p">))</span>
</span><span id="L-422"><a href="#L-422"><span class="linenos">422</span></a>    <span class="n">letters</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">string</span><span class="o">.</span><span class="n">ascii_letters</span><span class="o">.</span><span class="n">upper</span><span class="p">())[</span><span class="n">offset</span><span class="p">:</span><span class="n">offset</span> <span class="o">+</span> <span class="n">n_new_labels</span><span class="p">]</span>
</span><span id="L-423"><a href="#L-423"><span class="linenos">423</span></a>    <span class="n">mapping</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
</span><span id="L-424"><a href="#L-424"><span class="linenos">424</span></a>    <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-425"><a href="#L-425"><span class="linenos">425</span></a>    <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">labellings</span><span class="p">:</span>
</span><span id="L-426"><a href="#L-426"><span class="linenos">426</span></a>      <span class="k">if</span> <span class="ow">not</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">mapping</span><span class="p">:</span>
</span><span id="L-427"><a href="#L-427"><span class="linenos">427</span></a>        <span class="n">mapping</span><span class="p">[</span><span class="n">label</span><span class="p">]</span> <span class="o">=</span> <span class="n">letters</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span><span id="L-428"><a href="#L-428"><span class="linenos">428</span></a>        <span class="n">i</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span>
</span><span id="L-429"><a href="#L-429"><span class="linenos">429</span></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_labels_under_symmetries</span><span class="p">([</span><span class="n">mapping</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">labellings</span><span class="p">])</span>
</span><span id="L-430"><a href="#L-430"><span class="linenos">430</span></a>  
</span><span id="L-431"><a href="#L-431"><span class="linenos">431</span></a>  
</span><span id="L-432"><a href="#L-432"><span class="linenos">432</span></a>  <span class="k">def</span> <span class="nf">_get_labels_under_symmetries</span><span class="p">(</span>
</span><span id="L-433"><a href="#L-433"><span class="linenos">433</span></a>      <span class="bp">self</span><span class="p">,</span> <span class="n">labels</span><span class="p">:</span><span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="L-434"><a href="#L-434"><span class="linenos">434</span></a>    <span class="n">cycle</span> <span class="o">=</span> <span class="n">labels</span> <span class="o">*</span> <span class="mi">2</span>
</span><span id="L-435"><a href="#L-435"><span class="linenos">435</span></a>    <span class="n">under_rotation</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">cycle</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">+</span> <span class="n">i</span><span class="p">])</span> 
</span><span id="L-436"><a href="#L-436"><span class="linenos">436</span></a>                      <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">rotation_shifts</span><span class="p">]</span>
</span><span id="L-437"><a href="#L-437"><span class="linenos">437</span></a>    <span class="n">under_reflection</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">cycle</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">+</span> <span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> 
</span><span id="L-438"><a href="#L-438"><span class="linenos">438</span></a>                        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">reflection_shifts</span><span class="p">]</span>
</span><span id="L-439"><a href="#L-439"><span class="linenos">439</span></a>    <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;rotations&quot;</span><span class="p">:</span> <span class="n">under_rotation</span><span class="p">,</span>
</span><span id="L-440"><a href="#L-440"><span class="linenos">440</span></a>            <span class="s2">&quot;reflections&quot;</span><span class="p">:</span> <span class="n">under_reflection</span><span class="p">}</span>
</span><span id="L-441"><a href="#L-441"><span class="linenos">441</span></a>
</span><span id="L-442"><a href="#L-442"><span class="linenos">442</span></a>
</span><span id="L-443"><a href="#L-443"><span class="linenos">443</span></a>  <span class="k">def</span> <span class="nf">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">which</span><span class="p">:</span><span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;both&quot;</span><span class="p">,</span> <span class="n">all_in_one</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
</span><span id="L-444"><a href="#L-444"><span class="linenos">444</span></a>    
</span><span id="L-445"><a href="#L-445"><span class="linenos">445</span></a>    <span class="k">if</span> <span class="n">all_in_one</span><span class="p">:</span>
</span><span id="L-446"><a href="#L-446"><span class="linenos">446</span></a>      <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;all_in_one option not yet implemented!&quot;</span><span class="p">)</span>
</span><span id="L-447"><a href="#L-447"><span class="linenos">447</span></a>    
</span><span id="L-448"><a href="#L-448"><span class="linenos">448</span></a>    <span class="k">if</span> <span class="n">which</span> <span class="o">==</span> <span class="s2">&quot;both&quot;</span><span class="p">:</span>
</span><span id="L-449"><a href="#L-449"><span class="linenos">449</span></a>      <span class="n">n_subplots</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rotation_shifts</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">reflection_shifts</span><span class="p">)</span>
</span><span id="L-450"><a href="#L-450"><span class="linenos">450</span></a>    <span class="k">elif</span> <span class="n">which</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;rot&quot;</span><span class="p">:</span>
</span><span id="L-451"><a href="#L-451"><span class="linenos">451</span></a>      <span class="n">n_subplots</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rotation_shifts</span><span class="p">)</span>
</span><span id="L-452"><a href="#L-452"><span class="linenos">452</span></a>    <span class="k">elif</span> <span class="n">which</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;ref&quot;</span><span class="p">:</span>
</span><span id="L-453"><a href="#L-453"><span class="linenos">453</span></a>      <span class="n">n_subplots</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">reflection_shifts</span><span class="p">)</span>
</span><span id="L-454"><a href="#L-454"><span class="linenos">454</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="L-455"><a href="#L-455"><span class="linenos">455</span></a>      <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Please specify symmetries to plot using the which parameter!&quot;</span><span class="p">)</span>
</span><span id="L-456"><a href="#L-456"><span class="linenos">456</span></a>      <span class="k">return</span>
</span><span id="L-457"><a href="#L-457"><span class="linenos">457</span></a>    
</span><span id="L-458"><a href="#L-458"><span class="linenos">458</span></a>    <span class="n">nr</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">n_subplots</span><span class="p">)))</span>
</span><span id="L-459"><a href="#L-459"><span class="linenos">459</span></a>    <span class="n">nc</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">n_subplots</span> <span class="o">/</span> <span class="n">nr</span><span class="p">))</span>
</span><span id="L-460"><a href="#L-460"><span class="linenos">460</span></a>    <span class="n">nplots</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-461"><a href="#L-461"><span class="linenos">461</span></a>    <span class="n">mrr</span> <span class="o">=</span> <span class="n">shapely</span><span class="o">.</span><span class="n">oriented_envelope</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">polygon</span><span class="p">)</span>
</span><span id="L-462"><a href="#L-462"><span class="linenos">462</span></a>    <span class="n">w</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">tiling_utils</span><span class="o">.</span><span class="n">get_side_lengths</span><span class="p">(</span><span class="n">mrr</span><span class="p">)[:</span><span class="mi">2</span><span class="p">])</span>
</span><span id="L-463"><a href="#L-463"><span class="linenos">463</span></a>
</span><span id="L-464"><a href="#L-464"><span class="linenos">464</span></a>    <span class="n">fig</span> <span class="o">=</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
</span><span id="L-465"><a href="#L-465"><span class="linenos">465</span></a>    <span class="n">labels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_unique_labels</span><span class="p">()</span>
</span><span id="L-466"><a href="#L-466"><span class="linenos">466</span></a>    <span class="n">c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">polygon</span><span class="o">.</span><span class="n">centroid</span>
</span><span id="L-467"><a href="#L-467"><span class="linenos">467</span></a>
</span><span id="L-468"><a href="#L-468"><span class="linenos">468</span></a>    <span class="k">if</span> <span class="n">which</span> <span class="o">==</span> <span class="s2">&quot;both&quot;</span> <span class="ow">or</span> <span class="n">which</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;rot&quot;</span><span class="p">:</span>
</span><span id="L-469"><a href="#L-469"><span class="linenos">469</span></a>      <span class="n">rotations</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_rotations</span><span class="p">()[</span><span class="s2">&quot;angles&quot;</span><span class="p">]</span>
</span><span id="L-470"><a href="#L-470"><span class="linenos">470</span></a>      <span class="k">for</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">rotn</span><span class="p">),</span> <span class="n">label</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="nb">enumerate</span><span class="p">(</span><span class="n">rotations</span><span class="p">),</span> <span class="n">labels</span><span class="p">[</span><span class="s2">&quot;rotations&quot;</span><span class="p">]):</span>
</span><span id="L-471"><a href="#L-471"><span class="linenos">471</span></a>        <span class="n">nplots</span> <span class="o">=</span> <span class="n">nplots</span> <span class="o">+</span> <span class="mi">1</span>
</span><span id="L-472"><a href="#L-472"><span class="linenos">472</span></a>        <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">nr</span><span class="p">,</span> <span class="n">nc</span><span class="p">,</span> <span class="n">nplots</span><span class="p">)</span>
</span><span id="L-473"><a href="#L-473"><span class="linenos">473</span></a>        <span class="n">gpd</span><span class="o">.</span><span class="n">GeoSeries</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">polygon</span><span class="p">])</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span> <span class="o">=</span> <span class="n">ax</span><span class="p">,</span> <span class="n">fc</span> <span class="o">=</span> <span class="s2">&quot;lightgrey&quot;</span><span class="p">,</span> <span class="n">lw</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="L-474"><a href="#L-474"><span class="linenos">474</span></a>        <span class="k">for</span> <span class="n">lbl</span><span class="p">,</span> <span class="n">pt</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">label</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">polygon</span><span class="o">.</span><span class="n">exterior</span><span class="o">.</span><span class="n">coords</span><span class="p">):</span>
</span><span id="L-475"><a href="#L-475"><span class="linenos">475</span></a>          <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">lbl</span><span class="p">,</span> <span class="n">xy</span> <span class="o">=</span> <span class="n">pt</span><span class="p">,</span> <span class="n">ha</span> <span class="o">=</span> <span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">va</span> <span class="o">=</span> <span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">14</span><span class="p">)</span>
</span><span id="L-476"><a href="#L-476"><span class="linenos">476</span></a>        <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-477"><a href="#L-477"><span class="linenos">477</span></a>          <span class="n">rotn</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">rotn</span><span class="p">)</span> 
</span><span id="L-478"><a href="#L-478"><span class="linenos">478</span></a>          <span class="n">arc</span> <span class="o">=</span> <span class="n">geom</span><span class="o">.</span><span class="n">LineString</span><span class="p">(</span>
</span><span id="L-479"><a href="#L-479"><span class="linenos">479</span></a>            <span class="p">[[</span><span class="n">w</span><span class="o">/</span><span class="mi">6</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="n">w</span><span class="o">/</span><span class="mi">6</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">a</span><span class="p">)]</span>
</span><span id="L-480"><a href="#L-480"><span class="linenos">480</span></a>             <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">rotn</span><span class="p">,</span> <span class="mi">50</span><span class="p">)])</span>
</span><span id="L-481"><a href="#L-481"><span class="linenos">481</span></a>          <span class="n">angle</span> <span class="o">=</span> <span class="n">geom</span><span class="o">.</span><span class="n">LineString</span><span class="p">(</span>
</span><span id="L-482"><a href="#L-482"><span class="linenos">482</span></a>            <span class="p">[(</span><span class="n">w</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> 
</span><span id="L-483"><a href="#L-483"><span class="linenos">483</span></a>             <span class="p">(</span><span class="n">w</span><span class="o">/</span><span class="mi">4</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">rotn</span><span class="p">),</span> <span class="n">w</span><span class="o">/</span><span class="mi">4</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">rotn</span><span class="p">))])</span>
</span><span id="L-484"><a href="#L-484"><span class="linenos">484</span></a>          <span class="n">ls</span> <span class="o">=</span> <span class="p">[</span><span class="n">affine</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">y</span><span class="p">)</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="p">[</span><span class="n">arc</span><span class="p">,</span> <span class="n">angle</span><span class="p">]]</span>
</span><span id="L-485"><a href="#L-485"><span class="linenos">485</span></a>          <span class="n">gpd</span><span class="o">.</span><span class="n">GeoSeries</span><span class="p">(</span><span class="n">ls</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span> <span class="o">=</span> <span class="n">ax</span><span class="p">,</span> <span class="n">ec</span> <span class="o">=</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="n">lw</span> <span class="o">=</span> <span class="mf">0.35</span><span class="p">)</span>
</span><span id="L-486"><a href="#L-486"><span class="linenos">486</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">get_corner_labels</span><span class="p">()</span>
</span><span id="L-487"><a href="#L-487"><span class="linenos">487</span></a>        <span class="n">pyplot</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>
</span><span id="L-488"><a href="#L-488"><span class="linenos">488</span></a>        
</span><span id="L-489"><a href="#L-489"><span class="linenos">489</span></a>    <span class="k">if</span> <span class="n">which</span> <span class="o">==</span> <span class="s2">&quot;both&quot;</span> <span class="ow">or</span> <span class="n">which</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;ref&quot;</span><span class="p">:</span>
</span><span id="L-490"><a href="#L-490"><span class="linenos">490</span></a>      <span class="n">reflections</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_reflections</span><span class="p">()[</span><span class="s2">&quot;angles&quot;</span><span class="p">]</span>
</span><span id="L-491"><a href="#L-491"><span class="linenos">491</span></a>      <span class="k">for</span> <span class="n">refn</span><span class="p">,</span> <span class="n">label</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">reflections</span><span class="p">,</span> <span class="n">labels</span><span class="p">[</span><span class="s2">&quot;reflections&quot;</span><span class="p">]):</span>
</span><span id="L-492"><a href="#L-492"><span class="linenos">492</span></a>        <span class="n">nplots</span> <span class="o">=</span> <span class="n">nplots</span> <span class="o">+</span> <span class="mi">1</span>
</span><span id="L-493"><a href="#L-493"><span class="linenos">493</span></a>        <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">nr</span><span class="p">,</span> <span class="n">nc</span><span class="p">,</span> <span class="n">nplots</span><span class="p">)</span>
</span><span id="L-494"><a href="#L-494"><span class="linenos">494</span></a>        <span class="n">gpd</span><span class="o">.</span><span class="n">GeoSeries</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">polygon</span><span class="p">])</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span> <span class="o">=</span> <span class="n">ax</span><span class="p">,</span> <span class="n">fc</span> <span class="o">=</span> <span class="s2">&quot;lightgrey&quot;</span><span class="p">,</span> <span class="n">lw</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="L-495"><a href="#L-495"><span class="linenos">495</span></a>        <span class="k">for</span> <span class="n">lbl</span><span class="p">,</span> <span class="n">pt</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">label</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">polygon</span><span class="o">.</span><span class="n">exterior</span><span class="o">.</span><span class="n">coords</span><span class="p">):</span>
</span><span id="L-496"><a href="#L-496"><span class="linenos">496</span></a>          <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">lbl</span><span class="p">,</span> <span class="n">xy</span> <span class="o">=</span> <span class="n">pt</span><span class="p">,</span> <span class="n">ha</span> <span class="o">=</span> <span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">va</span> <span class="o">=</span> <span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">14</span><span class="p">)</span>
</span><span id="L-497"><a href="#L-497"><span class="linenos">497</span></a>        <span class="n">ls</span> <span class="o">=</span> <span class="n">geom</span><span class="o">.</span><span class="n">LineString</span><span class="p">([(</span><span class="o">-</span><span class="n">h</span><span class="o">/</span><span class="mi">2</span> <span class="o">*</span> <span class="mf">1.1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="n">h</span><span class="o">/</span><span class="mi">2</span> <span class="o">*</span> <span class="mf">1.1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)])</span>
</span><span id="L-498"><a href="#L-498"><span class="linenos">498</span></a>        <span class="n">ls</span> <span class="o">=</span> <span class="n">affine</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span><span class="n">ls</span><span class="p">,</span> <span class="n">refn</span><span class="p">)</span>
</span><span id="L-499"><a href="#L-499"><span class="linenos">499</span></a>        <span class="n">ls</span> <span class="o">=</span> <span class="n">affine</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="n">ls</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
</span><span id="L-500"><a href="#L-500"><span class="linenos">500</span></a>        <span class="n">gpd</span><span class="o">.</span><span class="n">GeoSeries</span><span class="p">([</span><span class="n">ls</span><span class="p">])</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span> <span class="o">=</span> <span class="n">ax</span><span class="p">,</span> <span class="n">ec</span> <span class="o">=</span> <span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">ls</span> <span class="o">=</span> <span class="s2">&quot;dashed&quot;</span><span class="p">,</span> <span class="n">lw</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">)</span>
</span><span id="L-501"><a href="#L-501"><span class="linenos">501</span></a>        <span class="n">pyplot</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>
</span><span id="L-502"><a href="#L-502"><span class="linenos">502</span></a>
</span><span id="L-503"><a href="#L-503"><span class="linenos">503</span></a>    <span class="k">return</span> <span class="n">ax</span>
</span><span id="L-504"><a href="#L-504"><span class="linenos">504</span></a>
</span><span id="L-505"><a href="#L-505"><span class="linenos">505</span></a>
</span><span id="L-506"><a href="#L-506"><span class="linenos">506</span></a>  <span class="k">def</span> <span class="nf">find_matches</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">seq</span><span class="p">:</span><span class="n">Iterable</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">]],</span> 
</span><span id="L-507"><a href="#L-507"><span class="linenos">507</span></a>                   <span class="n">pat</span><span class="p">:</span><span class="n">Iterable</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">]],</span>
</span><span id="L-508"><a href="#L-508"><span class="linenos">508</span></a>                   <span class="n">equals</span> <span class="o">=</span> <span class="n">_equal_tuples</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
</span><span id="L-509"><a href="#L-509"><span class="linenos">509</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot; Implements Knuth-Morris-Pratt string pattern matching algorithm. See:</span>
</span><span id="L-510"><a href="#L-510"><span class="linenos">510</span></a><span class="sd">    https://en.wikipedia.org/wiki/KnuthMorrisPratt_algorithm which provides</span>
</span><span id="L-511"><a href="#L-511"><span class="linenos">511</span></a><span class="sd">    detailed pseudo-code on which this code is directly based. This</span>
</span><span id="L-512"><a href="#L-512"><span class="linenos">512</span></a><span class="sd">    implementation expects sequences of tuples of floats, although in principle</span>
</span><span id="L-513"><a href="#L-513"><span class="linenos">513</span></a><span class="sd">    any objects could be contained in the Iterables. The default equality</span>
</span><span id="L-514"><a href="#L-514"><span class="linenos">514</span></a><span class="sd">    function tests for close matches, not exact equality.</span>
</span><span id="L-515"><a href="#L-515"><span class="linenos">515</span></a>
</span><span id="L-516"><a href="#L-516"><span class="linenos">516</span></a><span class="sd">    Args:</span>
</span><span id="L-517"><a href="#L-517"><span class="linenos">517</span></a><span class="sd">      seq (Iterable[tuple[float]]): The sequence of float tuples to find   </span>
</span><span id="L-518"><a href="#L-518"><span class="linenos">518</span></a><span class="sd">        matches in.</span>
</span><span id="L-519"><a href="#L-519"><span class="linenos">519</span></a><span class="sd">      pat (Iterable[tuple[float]]): The sequence to match.</span>
</span><span id="L-520"><a href="#L-520"><span class="linenos">520</span></a><span class="sd">      equals (function, optional): A function to use to test for equality of</span>
</span><span id="L-521"><a href="#L-521"><span class="linenos">521</span></a><span class="sd">        elements in patterns. Defaults to _equal_tuples().</span>
</span><span id="L-522"><a href="#L-522"><span class="linenos">522</span></a>
</span><span id="L-523"><a href="#L-523"><span class="linenos">523</span></a><span class="sd">    Returns:</span>
</span><span id="L-524"><a href="#L-524"><span class="linenos">524</span></a><span class="sd">        Iterable[int]: _description_</span>
</span><span id="L-525"><a href="#L-525"><span class="linenos">525</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-526"><a href="#L-526"><span class="linenos">526</span></a>    <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
</span><span id="L-527"><a href="#L-527"><span class="linenos">527</span></a>    <span class="n">finds</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-528"><a href="#L-528"><span class="linenos">528</span></a>    <span class="n">table</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_table</span><span class="p">(</span><span class="n">pat</span><span class="p">,</span> <span class="n">equals</span><span class="p">)</span>
</span><span id="L-529"><a href="#L-529"><span class="linenos">529</span></a>    <span class="k">while</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">seq</span><span class="p">):</span>
</span><span id="L-530"><a href="#L-530"><span class="linenos">530</span></a>      <span class="k">if</span> <span class="n">equals</span><span class="p">(</span><span class="n">pat</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">seq</span><span class="p">[</span><span class="n">j</span><span class="p">]):</span>
</span><span id="L-531"><a href="#L-531"><span class="linenos">531</span></a>        <span class="n">j</span> <span class="o">=</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span>
</span><span id="L-532"><a href="#L-532"><span class="linenos">532</span></a>        <span class="n">k</span> <span class="o">=</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span>
</span><span id="L-533"><a href="#L-533"><span class="linenos">533</span></a>        <span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">pat</span><span class="p">):</span>
</span><span id="L-534"><a href="#L-534"><span class="linenos">534</span></a>          <span class="n">finds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">j</span> <span class="o">-</span> <span class="n">k</span><span class="p">)</span>
</span><span id="L-535"><a href="#L-535"><span class="linenos">535</span></a>          <span class="n">k</span> <span class="o">=</span> <span class="n">table</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
</span><span id="L-536"><a href="#L-536"><span class="linenos">536</span></a>      <span class="k">else</span><span class="p">:</span>
</span><span id="L-537"><a href="#L-537"><span class="linenos">537</span></a>        <span class="n">k</span> <span class="o">=</span> <span class="n">table</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
</span><span id="L-538"><a href="#L-538"><span class="linenos">538</span></a>        <span class="k">if</span> <span class="n">k</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-539"><a href="#L-539"><span class="linenos">539</span></a>          <span class="n">j</span> <span class="o">=</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span>
</span><span id="L-540"><a href="#L-540"><span class="linenos">540</span></a>          <span class="n">k</span> <span class="o">=</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span>
</span><span id="L-541"><a href="#L-541"><span class="linenos">541</span></a>    <span class="k">return</span> <span class="n">finds</span>
</span><span id="L-542"><a href="#L-542"><span class="linenos">542</span></a>
</span><span id="L-543"><a href="#L-543"><span class="linenos">543</span></a>
</span><span id="L-544"><a href="#L-544"><span class="linenos">544</span></a>  <span class="k">def</span> <span class="nf">get_table</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pattern</span><span class="p">:</span><span class="n">Iterable</span><span class="p">,</span>
</span><span id="L-545"><a href="#L-545"><span class="linenos">545</span></a>                <span class="n">equals</span> <span class="o">=</span> <span class="n">_equal_tuples</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
</span><span id="L-546"><a href="#L-546"><span class="linenos">546</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns the &#39;offsets&#39; table used by KMP pattern matching algorithm as</span>
</span><span id="L-547"><a href="#L-547"><span class="linenos">547</span></a><span class="sd">    required by self.find_matches, based on the supplied pattern.</span>
</span><span id="L-548"><a href="#L-548"><span class="linenos">548</span></a>
</span><span id="L-549"><a href="#L-549"><span class="linenos">549</span></a><span class="sd">    Args:</span>
</span><span id="L-550"><a href="#L-550"><span class="linenos">550</span></a><span class="sd">      pattern (Iterable): The pattern to set up the table for.</span>
</span><span id="L-551"><a href="#L-551"><span class="linenos">551</span></a><span class="sd">      equals (function, optional): A function to use to test for equality of</span>
</span><span id="L-552"><a href="#L-552"><span class="linenos">552</span></a><span class="sd">        elements in patterns. Defaults to _equal_tuples().</span>
</span><span id="L-553"><a href="#L-553"><span class="linenos">553</span></a>
</span><span id="L-554"><a href="#L-554"><span class="linenos">554</span></a><span class="sd">    Returns:</span>
</span><span id="L-555"><a href="#L-555"><span class="linenos">555</span></a><span class="sd">        Iterable[int]: _description_</span>
</span><span id="L-556"><a href="#L-556"><span class="linenos">556</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-557"><a href="#L-557"><span class="linenos">557</span></a>    <span class="n">pos</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="L-558"><a href="#L-558"><span class="linenos">558</span></a>    <span class="n">cnd</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-559"><a href="#L-559"><span class="linenos">559</span></a>    <span class="n">T</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">}</span>
</span><span id="L-560"><a href="#L-560"><span class="linenos">560</span></a>    <span class="k">while</span> <span class="n">pos</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">pattern</span><span class="p">):</span>
</span><span id="L-561"><a href="#L-561"><span class="linenos">561</span></a>      <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">pattern</span><span class="p">[</span><span class="n">pos</span><span class="p">],</span> <span class="n">pattern</span><span class="p">[</span><span class="n">cnd</span><span class="p">]):</span>
</span><span id="L-562"><a href="#L-562"><span class="linenos">562</span></a>        <span class="n">T</span><span class="p">[</span><span class="n">pos</span><span class="p">]</span> <span class="o">=</span> <span class="n">T</span><span class="p">[</span><span class="n">cnd</span><span class="p">]</span>
</span><span id="L-563"><a href="#L-563"><span class="linenos">563</span></a>      <span class="k">else</span><span class="p">:</span>
</span><span id="L-564"><a href="#L-564"><span class="linenos">564</span></a>        <span class="n">T</span><span class="p">[</span><span class="n">pos</span><span class="p">]</span> <span class="o">=</span> <span class="n">cnd</span>
</span><span id="L-565"><a href="#L-565"><span class="linenos">565</span></a>        <span class="k">while</span> <span class="n">cnd</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">equals</span><span class="p">(</span><span class="n">pattern</span><span class="p">[</span><span class="n">pos</span><span class="p">],</span> <span class="n">pattern</span><span class="p">[</span><span class="n">cnd</span><span class="p">]):</span>
</span><span id="L-566"><a href="#L-566"><span class="linenos">566</span></a>          <span class="n">cnd</span> <span class="o">=</span> <span class="n">T</span><span class="p">[</span><span class="n">cnd</span><span class="p">]</span>
</span><span id="L-567"><a href="#L-567"><span class="linenos">567</span></a>      <span class="n">pos</span> <span class="o">=</span> <span class="n">pos</span> <span class="o">+</span> <span class="mi">1</span>
</span><span id="L-568"><a href="#L-568"><span class="linenos">568</span></a>      <span class="n">cnd</span> <span class="o">=</span> <span class="n">cnd</span> <span class="o">+</span> <span class="mi">1</span>
</span><span id="L-569"><a href="#L-569"><span class="linenos">569</span></a>    <span class="n">T</span><span class="p">[</span><span class="n">pos</span><span class="p">]</span> <span class="o">=</span> <span class="n">cnd</span>
</span><span id="L-570"><a href="#L-570"><span class="linenos">570</span></a>    <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">T</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
</span></pre></div>


            </section>
                <section id="Symmetries">
                            <input id="Symmetries-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
                    <div class="decorator">@dataclass</div>

    <span class="def">class</span>
    <span class="name">Symmetries</span>:

                <label class="view-source-button" for="Symmetries-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Symmetries"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Symmetries-32"><a href="#Symmetries-32"><span class="linenos"> 32</span></a><span class="nd">@dataclass</span>
</span><span id="Symmetries-33"><a href="#Symmetries-33"><span class="linenos"> 33</span></a><span class="k">class</span> <span class="nc">Symmetries</span><span class="p">():</span>
</span><span id="Symmetries-34"><a href="#Symmetries-34"><span class="linenos"> 34</span></a>
</span><span id="Symmetries-35"><a href="#Symmetries-35"><span class="linenos"> 35</span></a>  <span class="n">polygon</span><span class="p">:</span><span class="n">geom</span><span class="o">.</span><span class="n">Polygon</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Symmetries-36"><a href="#Symmetries-36"><span class="linenos"> 36</span></a>  <span class="n">n</span><span class="p">:</span><span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Symmetries-37"><a href="#Symmetries-37"><span class="linenos"> 37</span></a>  <span class="n">p_code</span><span class="p">:</span><span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Symmetries-38"><a href="#Symmetries-38"><span class="linenos"> 38</span></a>  <span class="n">p_code_r</span><span class="p">:</span><span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Symmetries-39"><a href="#Symmetries-39"><span class="linenos"> 39</span></a>  <span class="n">rotation_shifts</span><span class="p">:</span><span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Symmetries-40"><a href="#Symmetries-40"><span class="linenos"> 40</span></a>  <span class="n">reflection_shifts</span><span class="p">:</span><span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Symmetries-41"><a href="#Symmetries-41"><span class="linenos"> 41</span></a>  
</span><span id="Symmetries-42"><a href="#Symmetries-42"><span class="linenos"> 42</span></a>
</span><span id="Symmetries-43"><a href="#Symmetries-43"><span class="linenos"> 43</span></a>  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">polygon</span><span class="p">:</span><span class="n">geom</span><span class="o">.</span><span class="n">Polygon</span><span class="p">):</span>
</span><span id="Symmetries-44"><a href="#Symmetries-44"><span class="linenos"> 44</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">polygon</span> <span class="o">=</span> <span class="n">polygon</span>
</span><span id="Symmetries-45"><a href="#Symmetries-45"><span class="linenos"> 45</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">=</span> <span class="n">shapely</span><span class="o">.</span><span class="n">count_coordinates</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">polygon</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
</span><span id="Symmetries-46"><a href="#Symmetries-46"><span class="linenos"> 46</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">p_code</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_polygon_code</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">polygon</span><span class="p">)</span>
</span><span id="Symmetries-47"><a href="#Symmetries-47"><span class="linenos"> 47</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">p_code_r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_polygon_code</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">polygon</span><span class="p">,</span> <span class="n">mirrored</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</span><span id="Symmetries-48"><a href="#Symmetries-48"><span class="linenos"> 48</span></a>    <span class="n">symmetries</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_find_symmetries</span><span class="p">()</span>
</span><span id="Symmetries-49"><a href="#Symmetries-49"><span class="linenos"> 49</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">rotation_shifts</span> <span class="o">=</span> <span class="n">symmetries</span><span class="p">[</span><span class="s2">&quot;rotation-shifts&quot;</span><span class="p">]</span>
</span><span id="Symmetries-50"><a href="#Symmetries-50"><span class="linenos"> 50</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">reflection_shifts</span> <span class="o">=</span> <span class="n">symmetries</span><span class="p">[</span><span class="s2">&quot;reflection-shifts&quot;</span><span class="p">]</span>
</span><span id="Symmetries-51"><a href="#Symmetries-51"><span class="linenos"> 51</span></a>    
</span><span id="Symmetries-52"><a href="#Symmetries-52"><span class="linenos"> 52</span></a>
</span><span id="Symmetries-53"><a href="#Symmetries-53"><span class="linenos"> 53</span></a>  <span class="k">def</span> <span class="nf">_get_polygon_code</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">p</span><span class="p">:</span><span class="n">geom</span><span class="o">.</span><span class="n">Polygon</span><span class="p">,</span> 
</span><span id="Symmetries-54"><a href="#Symmetries-54"><span class="linenos"> 54</span></a>                        <span class="n">mirrored</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">]]:</span>
</span><span id="Symmetries-55"><a href="#Symmetries-55"><span class="linenos"> 55</span></a><span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Returns a list of length-angle pairs to uniquely encode a polygon</span>
</span><span id="Symmetries-56"><a href="#Symmetries-56"><span class="linenos"> 56</span></a><span class="sd">    shape (up to scale). The alignment of lengths and angles is important</span>
</span><span id="Symmetries-57"><a href="#Symmetries-57"><span class="linenos"> 57</span></a><span class="sd">    and symmetry detection is sensitively dependent on it...</span>
</span><span id="Symmetries-58"><a href="#Symmetries-58"><span class="linenos"> 58</span></a>
</span><span id="Symmetries-59"><a href="#Symmetries-59"><span class="linenos"> 59</span></a><span class="sd">    The forward (i.e. unmirrored) polygon pairs are of edge lengths and the </span>
</span><span id="Symmetries-60"><a href="#Symmetries-60"><span class="linenos"> 60</span></a><span class="sd">    angle between each edge and its successor going CW around the polygon. </span>
</span><span id="Symmetries-61"><a href="#Symmetries-61"><span class="linenos"> 61</span></a><span class="sd">    </span>
</span><span id="Symmetries-62"><a href="#Symmetries-62"><span class="linenos"> 62</span></a><span class="sd">           A[i] ----L[i]---- A (i+1)</span>
</span><span id="Symmetries-63"><a href="#Symmetries-63"><span class="linenos"> 63</span></a><span class="sd">          /                   \</span>
</span><span id="Symmetries-64"><a href="#Symmetries-64"><span class="linenos"> 64</span></a><span class="sd">         /                     \</span>
</span><span id="Symmetries-65"><a href="#Symmetries-65"><span class="linenos"> 65</span></a><span class="sd">                             </span>
</span><span id="Symmetries-66"><a href="#Symmetries-66"><span class="linenos"> 66</span></a><span class="sd">    i.e. edge i is between angles i and i + 1, and angle i is between edge</span>
</span><span id="Symmetries-67"><a href="#Symmetries-67"><span class="linenos"> 67</span></a><span class="sd">    i-1 and i. The unmirrored encoding pairs length[i] with angle[i+1].</span>
</span><span id="Symmetries-68"><a href="#Symmetries-68"><span class="linenos"> 68</span></a><span class="sd">    </span>
</span><span id="Symmetries-69"><a href="#Symmetries-69"><span class="linenos"> 69</span></a><span class="sd">    The mirrored encoding pairs matched indexes of lengths and angles in the</span>
</span><span id="Symmetries-70"><a href="#Symmetries-70"><span class="linenos"> 70</span></a><span class="sd">    original polygon. This means the angle is still the one between and edge </span>
</span><span id="Symmetries-71"><a href="#Symmetries-71"><span class="linenos"> 71</span></a><span class="sd">    and its successor but proceeding CCW around the polygon.</span>
</span><span id="Symmetries-72"><a href="#Symmetries-72"><span class="linenos"> 72</span></a><span class="sd">    </span>
</span><span id="Symmetries-73"><a href="#Symmetries-73"><span class="linenos"> 73</span></a><span class="sd">    See in particular for clarification.</span>
</span><span id="Symmetries-74"><a href="#Symmetries-74"><span class="linenos"> 74</span></a><span class="sd">    </span>
</span><span id="Symmetries-75"><a href="#Symmetries-75"><span class="linenos"> 75</span></a><span class="sd">    Eades P. 1988. Symmetry Finding Algorithms. In Machine Intelligence and </span>
</span><span id="Symmetries-76"><a href="#Symmetries-76"><span class="linenos"> 76</span></a><span class="sd">    Pattern Recognition, ed. GT Toussaint, 6:41-51. Computational Morphology. </span>
</span><span id="Symmetries-77"><a href="#Symmetries-77"><span class="linenos"> 77</span></a><span class="sd">    North-Holland. doi: 10.1016/B978-0-444-70467-2.50009-6.</span>
</span><span id="Symmetries-78"><a href="#Symmetries-78"><span class="linenos"> 78</span></a><span class="sd">    </span>
</span><span id="Symmetries-79"><a href="#Symmetries-79"><span class="linenos"> 79</span></a><span class="sd">    Args:</span>
</span><span id="Symmetries-80"><a href="#Symmetries-80"><span class="linenos"> 80</span></a><span class="sd">      p (geom.Polygon): the polygon to encode</span>
</span><span id="Symmetries-81"><a href="#Symmetries-81"><span class="linenos"> 81</span></a><span class="sd">        mirrored (bool, optional): if true encoding will be in CCC order. </span>
</span><span id="Symmetries-82"><a href="#Symmetries-82"><span class="linenos"> 82</span></a><span class="sd">        Defaults to False.</span>
</span><span id="Symmetries-83"><a href="#Symmetries-83"><span class="linenos"> 83</span></a>
</span><span id="Symmetries-84"><a href="#Symmetries-84"><span class="linenos"> 84</span></a><span class="sd">    Returns:</span>
</span><span id="Symmetries-85"><a href="#Symmetries-85"><span class="linenos"> 85</span></a><span class="sd">      list[tuple[float]]: _description_</span>
</span><span id="Symmetries-86"><a href="#Symmetries-86"><span class="linenos"> 86</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Symmetries-87"><a href="#Symmetries-87"><span class="linenos"> 87</span></a>    <span class="c1"># get edge lengths and angles</span>
</span><span id="Symmetries-88"><a href="#Symmetries-88"><span class="linenos"> 88</span></a>    <span class="n">lengths</span> <span class="o">=</span> <span class="n">tiling_utils</span><span class="o">.</span><span class="n">get_side_lengths</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</span><span id="Symmetries-89"><a href="#Symmetries-89"><span class="linenos"> 89</span></a>    <span class="n">raw_angles</span> <span class="o">=</span> <span class="n">tiling_utils</span><span class="o">.</span><span class="n">get_interior_angles</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</span><span id="Symmetries-90"><a href="#Symmetries-90"><span class="linenos"> 90</span></a>    <span class="k">if</span> <span class="n">mirrored</span><span class="p">:</span>
</span><span id="Symmetries-91"><a href="#Symmetries-91"><span class="linenos"> 91</span></a>      <span class="n">lengths_r</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">reversed</span><span class="p">(</span><span class="n">lengths</span><span class="p">))</span>
</span><span id="Symmetries-92"><a href="#Symmetries-92"><span class="linenos"> 92</span></a>      <span class="n">angles_r</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">reversed</span><span class="p">(</span><span class="n">raw_angles</span><span class="p">))</span>
</span><span id="Symmetries-93"><a href="#Symmetries-93"><span class="linenos"> 93</span></a>      <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">lengths_r</span><span class="p">,</span> <span class="n">angles_r</span><span class="p">))</span>
</span><span id="Symmetries-94"><a href="#Symmetries-94"><span class="linenos"> 94</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="Symmetries-95"><a href="#Symmetries-95"><span class="linenos"> 95</span></a>      <span class="n">angles</span> <span class="o">=</span> <span class="n">raw_angles</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">+</span> <span class="n">raw_angles</span><span class="p">[:</span><span class="mi">1</span><span class="p">]</span>
</span><span id="Symmetries-96"><a href="#Symmetries-96"><span class="linenos"> 96</span></a>      <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">lengths</span><span class="p">,</span> <span class="n">angles</span><span class="p">))</span>
</span><span id="Symmetries-97"><a href="#Symmetries-97"><span class="linenos"> 97</span></a>
</span><span id="Symmetries-98"><a href="#Symmetries-98"><span class="linenos"> 98</span></a>
</span><span id="Symmetries-99"><a href="#Symmetries-99"><span class="linenos"> 99</span></a>  <span class="k">def</span> <span class="nf">_find_symmetries</span><span class="p">(</span>
</span><span id="Symmetries-100"><a href="#Symmetries-100"><span class="linenos">100</span></a>      <span class="bp">self</span><span class="p">,</span> <span class="n">other_polygon</span><span class="p">:</span><span class="n">geom</span><span class="o">.</span><span class="n">Polygon</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]]:</span>
</span><span id="Symmetries-101"><a href="#Symmetries-101"><span class="linenos">101</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Finds rotation and reflection symmetries of the supplied polygon.</span>
</span><span id="Symmetries-102"><a href="#Symmetries-102"><span class="linenos">102</span></a><span class="sd">    Based on</span>
</span><span id="Symmetries-103"><a href="#Symmetries-103"><span class="linenos">103</span></a><span class="sd">    </span>
</span><span id="Symmetries-104"><a href="#Symmetries-104"><span class="linenos">104</span></a><span class="sd">      Eades P. 1988. Symmetry Finding Algorithms. In Machine Intelligence and </span>
</span><span id="Symmetries-105"><a href="#Symmetries-105"><span class="linenos">105</span></a><span class="sd">      Pattern Recognition, ed. GT Toussaint, 6:41-51. Computational Morphology. </span>
</span><span id="Symmetries-106"><a href="#Symmetries-106"><span class="linenos">106</span></a><span class="sd">      North-Holland. doi: 10.1016/B978-0-444-70467-2.50009-6.</span>
</span><span id="Symmetries-107"><a href="#Symmetries-107"><span class="linenos">107</span></a><span class="sd">    </span>
</span><span id="Symmetries-108"><a href="#Symmetries-108"><span class="linenos">108</span></a><span class="sd">    and also</span>
</span><span id="Symmetries-109"><a href="#Symmetries-109"><span class="linenos">109</span></a><span class="sd">    </span>
</span><span id="Symmetries-110"><a href="#Symmetries-110"><span class="linenos">110</span></a><span class="sd">      Wolter JD, TC Woo, and RA Volz. 1985. Optimal algorithms for symmetry </span>
</span><span id="Symmetries-111"><a href="#Symmetries-111"><span class="linenos">111</span></a><span class="sd">      detection in two and three dimensions. The Visual Computer 1(1): 37-48. </span>
</span><span id="Symmetries-112"><a href="#Symmetries-112"><span class="linenos">112</span></a><span class="sd">      doi: 10.1007/BF01901268.</span>
</span><span id="Symmetries-113"><a href="#Symmetries-113"><span class="linenos">113</span></a><span class="sd">    </span>
</span><span id="Symmetries-114"><a href="#Symmetries-114"><span class="linenos">114</span></a><span class="sd">    Details in these papers are not unambiguous. This implementation was</span>
</span><span id="Symmetries-115"><a href="#Symmetries-115"><span class="linenos">115</span></a><span class="sd">    developed based on them, but with a lot of trial and error to get the index</span>
</span><span id="Symmetries-116"><a href="#Symmetries-116"><span class="linenos">116</span></a><span class="sd">    offsets and (especially) retrieval of the reflection axes angles to work.</span>
</span><span id="Symmetries-117"><a href="#Symmetries-117"><span class="linenos">117</span></a>
</span><span id="Symmetries-118"><a href="#Symmetries-118"><span class="linenos">118</span></a><span class="sd">    Args:</span>
</span><span id="Symmetries-119"><a href="#Symmetries-119"><span class="linenos">119</span></a><span class="sd">      other (geom.Polygon, optional): finds transforms between this polygon and </span>
</span><span id="Symmetries-120"><a href="#Symmetries-120"><span class="linenos">120</span></a><span class="sd">      another that may be supplied. Defaults to None, when the comparison </span>
</span><span id="Symmetries-121"><a href="#Symmetries-121"><span class="linenos">121</span></a><span class="sd">      polygon will that for which this Symmetries object has been initialised.</span>
</span><span id="Symmetries-122"><a href="#Symmetries-122"><span class="linenos">122</span></a>
</span><span id="Symmetries-123"><a href="#Symmetries-123"><span class="linenos">123</span></a><span class="sd">    Returns:</span>
</span><span id="Symmetries-124"><a href="#Symmetries-124"><span class="linenos">124</span></a><span class="sd">      dict[str, list[float]]: _description_</span>
</span><span id="Symmetries-125"><a href="#Symmetries-125"><span class="linenos">125</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Symmetries-126"><a href="#Symmetries-126"><span class="linenos">126</span></a>    <span class="c1"># compose extended sequence of length-angle pairs for cyclic matching</span>
</span><span id="Symmetries-127"><a href="#Symmetries-127"><span class="linenos">127</span></a>    <span class="n">S</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">p_code</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">p_code</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="Symmetries-128"><a href="#Symmetries-128"><span class="linenos">128</span></a>    <span class="c1"># get code for the &#39;other&#39; polygon, if it exists...</span>
</span><span id="Symmetries-129"><a href="#Symmetries-129"><span class="linenos">129</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">other_polygon</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Symmetries-130"><a href="#Symmetries-130"><span class="linenos">130</span></a>      <span class="n">p_code</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_polygon_code</span><span class="p">(</span><span class="n">other_polygon</span><span class="p">)</span>
</span><span id="Symmetries-131"><a href="#Symmetries-131"><span class="linenos">131</span></a>      <span class="n">p_code_r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_polygon_code</span><span class="p">(</span><span class="n">other_polygon</span><span class="p">,</span> <span class="n">mirrored</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</span><span id="Symmetries-132"><a href="#Symmetries-132"><span class="linenos">132</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="Symmetries-133"><a href="#Symmetries-133"><span class="linenos">133</span></a>      <span class="n">p_code</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">p_code</span>
</span><span id="Symmetries-134"><a href="#Symmetries-134"><span class="linenos">134</span></a>      <span class="n">p_code_r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">p_code_r</span>
</span><span id="Symmetries-135"><a href="#Symmetries-135"><span class="linenos">135</span></a>    <span class="c1"># ==== Rotations ====</span>
</span><span id="Symmetries-136"><a href="#Symmetries-136"><span class="linenos">136</span></a>    <span class="n">rotation_shifts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_matches</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="n">p_code</span><span class="p">)</span>
</span><span id="Symmetries-137"><a href="#Symmetries-137"><span class="linenos">137</span></a>    <span class="c1"># ==== Reflections ====</span>
</span><span id="Symmetries-138"><a href="#Symmetries-138"><span class="linenos">138</span></a>    <span class="n">reflection_shifts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_matches</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="n">p_code_r</span><span class="p">)</span>
</span><span id="Symmetries-139"><a href="#Symmetries-139"><span class="linenos">139</span></a>    <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;rotation-shifts&quot;</span><span class="p">:</span> <span class="n">rotation_shifts</span><span class="p">,</span>
</span><span id="Symmetries-140"><a href="#Symmetries-140"><span class="linenos">140</span></a>            <span class="s2">&quot;reflection-shifts&quot;</span><span class="p">:</span> <span class="n">reflection_shifts</span><span class="p">}</span>
</span><span id="Symmetries-141"><a href="#Symmetries-141"><span class="linenos">141</span></a>
</span><span id="Symmetries-142"><a href="#Symmetries-142"><span class="linenos">142</span></a>
</span><span id="Symmetries-143"><a href="#Symmetries-143"><span class="linenos">143</span></a>  <span class="k">def</span> <span class="nf">get_rotations</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">offsets</span><span class="p">:</span><span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]]:</span>
</span><span id="Symmetries-144"><a href="#Symmetries-144"><span class="linenos">144</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Gets the rotations associated with this collection of symmetries.</span>
</span><span id="Symmetries-145"><a href="#Symmetries-145"><span class="linenos">145</span></a>
</span><span id="Symmetries-146"><a href="#Symmetries-146"><span class="linenos">146</span></a><span class="sd">    Returns:</span>
</span><span id="Symmetries-147"><a href="#Symmetries-147"><span class="linenos">147</span></a><span class="sd">      dict[str, list[float], list[float]]: Two item dictionary with &#39;angles&#39; and</span>
</span><span id="Symmetries-148"><a href="#Symmetries-148"><span class="linenos">148</span></a><span class="sd">        &#39;transforms&#39; entries, each a list of floats.</span>
</span><span id="Symmetries-149"><a href="#Symmetries-149"><span class="linenos">149</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Symmetries-150"><a href="#Symmetries-150"><span class="linenos">150</span></a>    <span class="k">if</span> <span class="n">offsets</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Symmetries-151"><a href="#Symmetries-151"><span class="linenos">151</span></a>      <span class="n">offsets</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rotation_shifts</span>
</span><span id="Symmetries-152"><a href="#Symmetries-152"><span class="linenos">152</span></a>    <span class="n">c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">polygon</span><span class="o">.</span><span class="n">centroid</span>
</span><span id="Symmetries-153"><a href="#Symmetries-153"><span class="linenos">153</span></a>    <span class="n">rot_angles</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">i</span> <span class="o">*</span> <span class="mi">360</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">offsets</span><span class="p">]</span> 
</span><span id="Symmetries-154"><a href="#Symmetries-154"><span class="linenos">154</span></a>    <span class="n">rotations</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_rotation_transform</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">y</span><span class="p">)),</span> <span class="mi">6</span><span class="p">)</span> 
</span><span id="Symmetries-155"><a href="#Symmetries-155"><span class="linenos">155</span></a>                 <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">rot_angles</span><span class="p">]</span>
</span><span id="Symmetries-156"><a href="#Symmetries-156"><span class="linenos">156</span></a>    <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;angles&quot;</span><span class="p">:</span> <span class="n">rot_angles</span><span class="p">,</span> <span class="s2">&quot;transforms&quot;</span><span class="p">:</span> <span class="n">rotations</span><span class="p">}</span>
</span><span id="Symmetries-157"><a href="#Symmetries-157"><span class="linenos">157</span></a>    
</span><span id="Symmetries-158"><a href="#Symmetries-158"><span class="linenos">158</span></a>
</span><span id="Symmetries-159"><a href="#Symmetries-159"><span class="linenos">159</span></a>  <span class="k">def</span> <span class="nf">get_reflections</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">offsets</span><span class="p">:</span><span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]]:</span>
</span><span id="Symmetries-160"><a href="#Symmetries-160"><span class="linenos">160</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Gets the reflections associated with this collection of symmetries.</span>
</span><span id="Symmetries-161"><a href="#Symmetries-161"><span class="linenos">161</span></a>
</span><span id="Symmetries-162"><a href="#Symmetries-162"><span class="linenos">162</span></a><span class="sd">    Returns:</span>
</span><span id="Symmetries-163"><a href="#Symmetries-163"><span class="linenos">163</span></a><span class="sd">      dict[str, list[float], list[float]]: Two item dictionary with &#39;angles&#39; and</span>
</span><span id="Symmetries-164"><a href="#Symmetries-164"><span class="linenos">164</span></a><span class="sd">        &#39;transforms&#39; entries, each a list of floats.</span>
</span><span id="Symmetries-165"><a href="#Symmetries-165"><span class="linenos">165</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Symmetries-166"><a href="#Symmetries-166"><span class="linenos">166</span></a>    <span class="k">if</span> <span class="n">offsets</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Symmetries-167"><a href="#Symmetries-167"><span class="linenos">167</span></a>      <span class="n">offsets</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reflection_shifts</span>
</span><span id="Symmetries-168"><a href="#Symmetries-168"><span class="linenos">168</span></a>    <span class="c1"># calculate all possible reflection axes - ordering of these is important</span>
</span><span id="Symmetries-169"><a href="#Symmetries-169"><span class="linenos">169</span></a>    <span class="c1"># for correct picking - don&#39;t mess with this code!</span>
</span><span id="Symmetries-170"><a href="#Symmetries-170"><span class="linenos">170</span></a>    <span class="n">c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">polygon</span><span class="o">.</span><span class="n">centroid</span>
</span><span id="Symmetries-171"><a href="#Symmetries-171"><span class="linenos">171</span></a>    <span class="n">bearings</span> <span class="o">=</span> <span class="n">tiling_utils</span><span class="o">.</span><span class="n">get_side_bearings</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">polygon</span><span class="p">)</span>
</span><span id="Symmetries-172"><a href="#Symmetries-172"><span class="linenos">172</span></a>    <span class="n">reflection_axes</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Symmetries-173"><a href="#Symmetries-173"><span class="linenos">173</span></a>    <span class="n">interior_angles</span> <span class="o">=</span> <span class="n">tiling_utils</span><span class="o">.</span><span class="n">get_interior_angles</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">polygon</span><span class="p">)</span>
</span><span id="Symmetries-174"><a href="#Symmetries-174"><span class="linenos">174</span></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">):</span>
</span><span id="Symmetries-175"><a href="#Symmetries-175"><span class="linenos">175</span></a>      <span class="c1"># angle bisectors</span>
</span><span id="Symmetries-176"><a href="#Symmetries-176"><span class="linenos">176</span></a>      <span class="n">reflection_axes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">bearings</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">interior_angles</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="Symmetries-177"><a href="#Symmetries-177"><span class="linenos">177</span></a>      <span class="c1"># edge_perpendicular bisectors</span>
</span><span id="Symmetries-178"><a href="#Symmetries-178"><span class="linenos">178</span></a>      <span class="n">reflection_axes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">bearings</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="mi">90</span><span class="p">)</span>  <span class="c1"># normal to the edge</span>
</span><span id="Symmetries-179"><a href="#Symmetries-179"><span class="linenos">179</span></a>    <span class="c1"># pick out those where matches occurred</span>
</span><span id="Symmetries-180"><a href="#Symmetries-180"><span class="linenos">180</span></a>    <span class="n">ref_angles</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">reflection_axes</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="mi">6</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">offsets</span><span class="p">]</span>
</span><span id="Symmetries-181"><a href="#Symmetries-181"><span class="linenos">181</span></a>    <span class="n">reflections</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_reflection_transform</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">y</span><span class="p">)),</span> <span class="mi">6</span><span class="p">)</span>
</span><span id="Symmetries-182"><a href="#Symmetries-182"><span class="linenos">182</span></a>                   <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">ref_angles</span><span class="p">]</span>
</span><span id="Symmetries-183"><a href="#Symmetries-183"><span class="linenos">183</span></a>    <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;angles&quot;</span><span class="p">:</span> <span class="n">ref_angles</span><span class="p">,</span> <span class="s2">&quot;transforms&quot;</span><span class="p">:</span> <span class="n">reflections</span><span class="p">}</span>
</span><span id="Symmetries-184"><a href="#Symmetries-184"><span class="linenos">184</span></a>
</span><span id="Symmetries-185"><a href="#Symmetries-185"><span class="linenos">185</span></a>
</span><span id="Symmetries-186"><a href="#Symmetries-186"><span class="linenos">186</span></a>  <span class="k">def</span> <span class="nf">get_matching_transforms</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> 
</span><span id="Symmetries-187"><a href="#Symmetries-187"><span class="linenos">187</span></a>                              <span class="n">other</span><span class="p">:</span><span class="n">geom</span><span class="o">.</span><span class="n">Polygon</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]]:</span>
</span><span id="Symmetries-188"><a href="#Symmetries-188"><span class="linenos">188</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Finds the transforms that will map another polygon onto this one.</span>
</span><span id="Symmetries-189"><a href="#Symmetries-189"><span class="linenos">189</span></a><span class="sd">    Reuses the _find_symmetries() method, but supplying the other polygon</span>
</span><span id="Symmetries-190"><a href="#Symmetries-190"><span class="linenos">190</span></a><span class="sd">    as that method&#39;s optional argument. Before determining the match the</span>
</span><span id="Symmetries-191"><a href="#Symmetries-191"><span class="linenos">191</span></a><span class="sd">    points on the perimeter of the other polygon are reordered so that the</span>
</span><span id="Symmetries-192"><a href="#Symmetries-192"><span class="linenos">192</span></a><span class="sd">    index positions match those of the reference polygon.</span>
</span><span id="Symmetries-193"><a href="#Symmetries-193"><span class="linenos">193</span></a>
</span><span id="Symmetries-194"><a href="#Symmetries-194"><span class="linenos">194</span></a><span class="sd">    Args:</span>
</span><span id="Symmetries-195"><a href="#Symmetries-195"><span class="linenos">195</span></a><span class="sd">        other (geom.Polygon): the polygon to match.</span>
</span><span id="Symmetries-196"><a href="#Symmetries-196"><span class="linenos">196</span></a>
</span><span id="Symmetries-197"><a href="#Symmetries-197"><span class="linenos">197</span></a><span class="sd">    Returns:</span>
</span><span id="Symmetries-198"><a href="#Symmetries-198"><span class="linenos">198</span></a><span class="sd">      dict[str,Union[str,list[float]]]: A dictionary with the following entries:</span>
</span><span id="Symmetries-199"><a href="#Symmetries-199"><span class="linenos">199</span></a><span class="sd">      &#39;rotation-shifts&#39;: vertex offsets to form matches by rotation</span>
</span><span id="Symmetries-200"><a href="#Symmetries-200"><span class="linenos">200</span></a><span class="sd">      &#39;reflection-shifts&#39;: vertex offsets to form matches by reflection</span>
</span><span id="Symmetries-201"><a href="#Symmetries-201"><span class="linenos">201</span></a><span class="sd">      &#39;rotation-angles&#39;: list of rotation angles of matches (in degrees)</span>
</span><span id="Symmetries-202"><a href="#Symmetries-202"><span class="linenos">202</span></a><span class="sd">      &#39;reflection-angles&#39;: list of angles of reflection axes (in degrees)</span>
</span><span id="Symmetries-203"><a href="#Symmetries-203"><span class="linenos">203</span></a><span class="sd">      &#39;rotation-transforms&#39;: list of shapely affine transform tuples of    </span>
</span><span id="Symmetries-204"><a href="#Symmetries-204"><span class="linenos">204</span></a><span class="sd">        rotation matches</span>
</span><span id="Symmetries-205"><a href="#Symmetries-205"><span class="linenos">205</span></a><span class="sd">      &#39;reflection-transforms&#39;: list of shapely affine transform tuples of</span>
</span><span id="Symmetries-206"><a href="#Symmetries-206"><span class="linenos">206</span></a><span class="sd">        reflection matches</span>
</span><span id="Symmetries-207"><a href="#Symmetries-207"><span class="linenos">207</span></a><span class="sd">      &#39;pre-translation&#39;: translation to align other with this polygon as tuple</span>
</span><span id="Symmetries-208"><a href="#Symmetries-208"><span class="linenos">208</span></a><span class="sd">        of floats</span>
</span><span id="Symmetries-209"><a href="#Symmetries-209"><span class="linenos">209</span></a><span class="sd">      &#39;pre-rotation&#39;: rotation to align other with this polygon (in degrees)</span>
</span><span id="Symmetries-210"><a href="#Symmetries-210"><span class="linenos">210</span></a><span class="sd">      &#39;pre-transform&#39;: shapely affine transform tuple that brings other into</span>
</span><span id="Symmetries-211"><a href="#Symmetries-211"><span class="linenos">211</span></a><span class="sd">        alignment with this polygon such that the matching transforms work </span>
</span><span id="Symmetries-212"><a href="#Symmetries-212"><span class="linenos">212</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Symmetries-213"><a href="#Symmetries-213"><span class="linenos">213</span></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">==</span> <span class="n">shapely</span><span class="o">.</span><span class="n">count_coordinates</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="Symmetries-214"><a href="#Symmetries-214"><span class="linenos">214</span></a>      <span class="c1"># shift them to the same centroid</span>
</span><span id="Symmetries-215"><a href="#Symmetries-215"><span class="linenos">215</span></a>      <span class="n">c0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">polygon</span><span class="o">.</span><span class="n">centroid</span>
</span><span id="Symmetries-216"><a href="#Symmetries-216"><span class="linenos">216</span></a>      <span class="n">trans</span> <span class="o">=</span> <span class="p">(</span><span class="n">c0</span><span class="o">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">other</span><span class="o">.</span><span class="n">centroid</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">c0</span><span class="o">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">other</span><span class="o">.</span><span class="n">centroid</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
</span><span id="Symmetries-217"><a href="#Symmetries-217"><span class="linenos">217</span></a>      <span class="n">other</span> <span class="o">=</span> <span class="n">affine</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">trans</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">trans</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="Symmetries-218"><a href="#Symmetries-218"><span class="linenos">218</span></a>      <span class="c1"># now see if they align at all</span>
</span><span id="Symmetries-219"><a href="#Symmetries-219"><span class="linenos">219</span></a>      <span class="n">symms</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_find_symmetries</span><span class="p">(</span><span class="n">other_polygon</span> <span class="o">=</span> <span class="n">other</span><span class="p">)</span>
</span><span id="Symmetries-220"><a href="#Symmetries-220"><span class="linenos">220</span></a>      <span class="n">rot_shifts</span> <span class="o">=</span> <span class="n">symms</span><span class="p">[</span><span class="s2">&quot;rotation-shifts&quot;</span><span class="p">]</span>
</span><span id="Symmetries-221"><a href="#Symmetries-221"><span class="linenos">221</span></a>      <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">rot_shifts</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Symmetries-222"><a href="#Symmetries-222"><span class="linenos">222</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Polygons do not match at all!&quot;</span><span class="p">)</span>
</span><span id="Symmetries-223"><a href="#Symmetries-223"><span class="linenos">223</span></a>        <span class="k">return</span> <span class="kc">None</span>
</span><span id="Symmetries-224"><a href="#Symmetries-224"><span class="linenos">224</span></a>      <span class="c1"># now align the corners so indexes of their corners match</span>
</span><span id="Symmetries-225"><a href="#Symmetries-225"><span class="linenos">225</span></a>      <span class="k">if</span> <span class="n">rot_shifts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Symmetries-226"><a href="#Symmetries-226"><span class="linenos">226</span></a>        <span class="n">other</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_shift_polygon_corners</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="o">-</span><span class="n">rot_shifts</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="Symmetries-227"><a href="#Symmetries-227"><span class="linenos">227</span></a>        <span class="n">rotation</span> <span class="o">=</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">get_rotations</span><span class="p">(</span><span class="n">rot_shifts</span><span class="p">)[</span><span class="s2">&quot;angles&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span><span id="Symmetries-228"><a href="#Symmetries-228"><span class="linenos">228</span></a>        <span class="n">other</span> <span class="o">=</span> <span class="n">tiling_utils</span><span class="o">.</span><span class="n">rotate_preserving_order</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">rotation</span><span class="p">,</span> <span class="n">c0</span><span class="p">)</span>
</span><span id="Symmetries-229"><a href="#Symmetries-229"><span class="linenos">229</span></a>      <span class="c1"># now determine the additional rotation needed to line them up</span>
</span><span id="Symmetries-230"><a href="#Symmetries-230"><span class="linenos">230</span></a>      <span class="n">p0_0</span> <span class="o">=</span> <span class="n">tiling_utils</span><span class="o">.</span><span class="n">get_corners</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">polygon</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="Symmetries-231"><a href="#Symmetries-231"><span class="linenos">231</span></a>      <span class="n">other_corners</span> <span class="o">=</span> <span class="n">tiling_utils</span><span class="o">.</span><span class="n">get_corners</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">repeat_first</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
</span><span id="Symmetries-232"><a href="#Symmetries-232"><span class="linenos">232</span></a>      <span class="n">rotation</span> <span class="o">=</span> <span class="n">rotation</span> <span class="o">+</span> \
</span><span id="Symmetries-233"><a href="#Symmetries-233"><span class="linenos">233</span></a>        <span class="n">tiling_utils</span><span class="o">.</span><span class="n">get_inner_angle</span><span class="p">(</span><span class="n">other_corners</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">c0</span><span class="p">,</span> <span class="n">p0_0</span><span class="p">)</span>
</span><span id="Symmetries-234"><a href="#Symmetries-234"><span class="linenos">234</span></a>      <span class="c1"># now find store and report the matching symmetries</span>
</span><span id="Symmetries-235"><a href="#Symmetries-235"><span class="linenos">235</span></a>      <span class="n">symms</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_find_symmetries</span><span class="p">(</span><span class="n">other_polygon</span> <span class="o">=</span> <span class="n">other</span><span class="p">)</span>
</span><span id="Symmetries-236"><a href="#Symmetries-236"><span class="linenos">236</span></a>      <span class="n">rot_shifts</span> <span class="o">=</span> <span class="n">symms</span><span class="p">[</span><span class="s2">&quot;rotation-shifts&quot;</span><span class="p">]</span>
</span><span id="Symmetries-237"><a href="#Symmetries-237"><span class="linenos">237</span></a>      <span class="n">rot_details</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_rotations</span><span class="p">(</span><span class="n">rot_shifts</span><span class="p">)</span>
</span><span id="Symmetries-238"><a href="#Symmetries-238"><span class="linenos">238</span></a>      <span class="n">symms</span><span class="p">[</span><span class="s2">&quot;rotation-angles&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">rot_details</span><span class="p">[</span><span class="s2">&quot;angles&quot;</span><span class="p">]</span>
</span><span id="Symmetries-239"><a href="#Symmetries-239"><span class="linenos">239</span></a>      <span class="n">symms</span><span class="p">[</span><span class="s2">&quot;rotation-transforms&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">rot_details</span><span class="p">[</span><span class="s2">&quot;transforms&quot;</span><span class="p">]</span>
</span><span id="Symmetries-240"><a href="#Symmetries-240"><span class="linenos">240</span></a>      <span class="n">ref_shifts</span> <span class="o">=</span> <span class="n">symms</span><span class="p">[</span><span class="s2">&quot;reflection-shifts&quot;</span><span class="p">]</span>
</span><span id="Symmetries-241"><a href="#Symmetries-241"><span class="linenos">241</span></a>      <span class="n">ref_details</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_reflections</span><span class="p">(</span><span class="n">ref_shifts</span><span class="p">)</span>
</span><span id="Symmetries-242"><a href="#Symmetries-242"><span class="linenos">242</span></a>      <span class="n">symms</span><span class="p">[</span><span class="s2">&quot;reflection-angles&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ref_details</span><span class="p">[</span><span class="s2">&quot;angles&quot;</span><span class="p">]</span>
</span><span id="Symmetries-243"><a href="#Symmetries-243"><span class="linenos">243</span></a>      <span class="n">symms</span><span class="p">[</span><span class="s2">&quot;reflection-transforms&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ref_details</span><span class="p">[</span><span class="s2">&quot;transforms&quot;</span><span class="p">]</span>
</span><span id="Symmetries-244"><a href="#Symmetries-244"><span class="linenos">244</span></a>      <span class="n">symms</span><span class="p">[</span><span class="s2">&quot;pre-translation&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">trans</span>
</span><span id="Symmetries-245"><a href="#Symmetries-245"><span class="linenos">245</span></a>      <span class="n">symms</span><span class="p">[</span><span class="s2">&quot;pre-rotation&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">rotation</span>
</span><span id="Symmetries-246"><a href="#Symmetries-246"><span class="linenos">246</span></a>      <span class="n">symms</span><span class="p">[</span><span class="s2">&quot;pre-transform&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_combine_transforms</span><span class="p">(</span>
</span><span id="Symmetries-247"><a href="#Symmetries-247"><span class="linenos">247</span></a>        <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_translation_transform</span><span class="p">(</span><span class="n">trans</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">trans</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span>
</span><span id="Symmetries-248"><a href="#Symmetries-248"><span class="linenos">248</span></a>         <span class="bp">self</span><span class="o">.</span><span class="n">_get_rotation_transform</span><span class="p">(</span><span class="n">rotation</span><span class="p">,</span> <span class="p">(</span><span class="n">c0</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">c0</span><span class="o">.</span><span class="n">y</span><span class="p">))])</span>
</span><span id="Symmetries-249"><a href="#Symmetries-249"><span class="linenos">249</span></a>      <span class="k">return</span> <span class="n">symms</span>
</span><span id="Symmetries-250"><a href="#Symmetries-250"><span class="linenos">250</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="Symmetries-251"><a href="#Symmetries-251"><span class="linenos">251</span></a>      <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Polygons have different numbers of sides!&quot;</span><span class="p">)</span>
</span><span id="Symmetries-252"><a href="#Symmetries-252"><span class="linenos">252</span></a>      <span class="k">return</span> <span class="kc">None</span>
</span><span id="Symmetries-253"><a href="#Symmetries-253"><span class="linenos">253</span></a>
</span><span id="Symmetries-254"><a href="#Symmetries-254"><span class="linenos">254</span></a>
</span><span id="Symmetries-255"><a href="#Symmetries-255"><span class="linenos">255</span></a>  <span class="k">def</span> <span class="nf">_shift_polygon_corners</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">polygon</span><span class="p">:</span><span class="n">geom</span><span class="o">.</span><span class="n">Polygon</span><span class="p">,</span> 
</span><span id="Symmetries-256"><a href="#Symmetries-256"><span class="linenos">256</span></a>                             <span class="n">offset</span><span class="p">:</span><span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">geom</span><span class="o">.</span><span class="n">Polygon</span><span class="p">:</span>
</span><span id="Symmetries-257"><a href="#Symmetries-257"><span class="linenos">257</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns this polygon but with its first corner offset from its</span>
</span><span id="Symmetries-258"><a href="#Symmetries-258"><span class="linenos">258</span></a><span class="sd">    original position in the coordinate sequence. The returned polygon will</span>
</span><span id="Symmetries-259"><a href="#Symmetries-259"><span class="linenos">259</span></a><span class="sd">    be identical but stored differently internally.</span>
</span><span id="Symmetries-260"><a href="#Symmetries-260"><span class="linenos">260</span></a>
</span><span id="Symmetries-261"><a href="#Symmetries-261"><span class="linenos">261</span></a><span class="sd">    Args:</span>
</span><span id="Symmetries-262"><a href="#Symmetries-262"><span class="linenos">262</span></a><span class="sd">      polygon (geom.Polygon): the polygon to reorder.</span>
</span><span id="Symmetries-263"><a href="#Symmetries-263"><span class="linenos">263</span></a><span class="sd">      offset (int): the number of corner positions by which to shift the</span>
</span><span id="Symmetries-264"><a href="#Symmetries-264"><span class="linenos">264</span></a><span class="sd">        sequence.</span>
</span><span id="Symmetries-265"><a href="#Symmetries-265"><span class="linenos">265</span></a>
</span><span id="Symmetries-266"><a href="#Symmetries-266"><span class="linenos">266</span></a><span class="sd">    Returns:</span>
</span><span id="Symmetries-267"><a href="#Symmetries-267"><span class="linenos">267</span></a><span class="sd">        geom.Polygon: the reordered polygon.</span>
</span><span id="Symmetries-268"><a href="#Symmetries-268"><span class="linenos">268</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Symmetries-269"><a href="#Symmetries-269"><span class="linenos">269</span></a>    <span class="n">corners</span> <span class="o">=</span> <span class="n">tiling_utils</span><span class="o">.</span><span class="n">get_corners</span><span class="p">(</span><span class="n">polygon</span><span class="p">,</span> <span class="n">repeat_first</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
</span><span id="Symmetries-270"><a href="#Symmetries-270"><span class="linenos">270</span></a>    <span class="k">return</span> <span class="n">geom</span><span class="o">.</span><span class="n">Polygon</span><span class="p">([</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">corners</span><span class="p">[</span><span class="n">offset</span><span class="p">:]</span> <span class="o">+</span> <span class="n">corners</span><span class="p">[:</span><span class="n">offset</span><span class="p">]])</span> 
</span><span id="Symmetries-271"><a href="#Symmetries-271"><span class="linenos">271</span></a>
</span><span id="Symmetries-272"><a href="#Symmetries-272"><span class="linenos">272</span></a>
</span><span id="Symmetries-273"><a href="#Symmetries-273"><span class="linenos">273</span></a>  <span class="k">def</span> <span class="nf">_get_translation_transform</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dx</span><span class="p">:</span><span class="nb">float</span><span class="p">,</span> <span class="n">dy</span><span class="p">:</span><span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]:</span>
</span><span id="Symmetries-274"><a href="#Symmetries-274"><span class="linenos">274</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns the shapely affine transform tuple for a translation.</span>
</span><span id="Symmetries-275"><a href="#Symmetries-275"><span class="linenos">275</span></a>
</span><span id="Symmetries-276"><a href="#Symmetries-276"><span class="linenos">276</span></a><span class="sd">    Args:</span>
</span><span id="Symmetries-277"><a href="#Symmetries-277"><span class="linenos">277</span></a><span class="sd">        dx (float): translation distance in x direction.</span>
</span><span id="Symmetries-278"><a href="#Symmetries-278"><span class="linenos">278</span></a><span class="sd">        dy (float): translation distance in y direction.</span>
</span><span id="Symmetries-279"><a href="#Symmetries-279"><span class="linenos">279</span></a>
</span><span id="Symmetries-280"><a href="#Symmetries-280"><span class="linenos">280</span></a><span class="sd">    Returns:</span>
</span><span id="Symmetries-281"><a href="#Symmetries-281"><span class="linenos">281</span></a><span class="sd">      list[float]: a six item list of floats, per the shapely.affinity.</span>
</span><span id="Symmetries-282"><a href="#Symmetries-282"><span class="linenos">282</span></a><span class="sd">      affine_transform method, see </span>
</span><span id="Symmetries-283"><a href="#Symmetries-283"><span class="linenos">283</span></a><span class="sd">        https://shapely.readthedocs.io/en/stable/manual.html#affine-transformations</span>
</span><span id="Symmetries-284"><a href="#Symmetries-284"><span class="linenos">284</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Symmetries-285"><a href="#Symmetries-285"><span class="linenos">285</span></a>    <span class="k">return</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="p">]</span>
</span><span id="Symmetries-286"><a href="#Symmetries-286"><span class="linenos">286</span></a>  
</span><span id="Symmetries-287"><a href="#Symmetries-287"><span class="linenos">287</span></a>
</span><span id="Symmetries-288"><a href="#Symmetries-288"><span class="linenos">288</span></a>  <span class="k">def</span> <span class="nf">_get_rotation_transform</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">angle</span><span class="p">:</span><span class="nb">float</span><span class="p">,</span> 
</span><span id="Symmetries-289"><a href="#Symmetries-289"><span class="linenos">289</span></a>                              <span class="n">centre</span><span class="p">:</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]:</span>
</span><span id="Symmetries-290"><a href="#Symmetries-290"><span class="linenos">290</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns the shapely affine transform tuple for a rotation, optionally</span>
</span><span id="Symmetries-291"><a href="#Symmetries-291"><span class="linenos">291</span></a><span class="sd">    about a supplied centre point.</span>
</span><span id="Symmetries-292"><a href="#Symmetries-292"><span class="linenos">292</span></a>
</span><span id="Symmetries-293"><a href="#Symmetries-293"><span class="linenos">293</span></a><span class="sd">    Args:</span>
</span><span id="Symmetries-294"><a href="#Symmetries-294"><span class="linenos">294</span></a><span class="sd">        angle (float): the angle of rotation (in degrees).</span>
</span><span id="Symmetries-295"><a href="#Symmetries-295"><span class="linenos">295</span></a><span class="sd">        centre (tuple[float], optional): An option centre location. Defaults to </span>
</span><span id="Symmetries-296"><a href="#Symmetries-296"><span class="linenos">296</span></a><span class="sd">        None, which will in turn be converted to (0, 0).</span>
</span><span id="Symmetries-297"><a href="#Symmetries-297"><span class="linenos">297</span></a>
</span><span id="Symmetries-298"><a href="#Symmetries-298"><span class="linenos">298</span></a><span class="sd">    Returns:</span>
</span><span id="Symmetries-299"><a href="#Symmetries-299"><span class="linenos">299</span></a><span class="sd">      list[float]: a six item list of floats, per the shapely.affinity.</span>
</span><span id="Symmetries-300"><a href="#Symmetries-300"><span class="linenos">300</span></a><span class="sd">        affine_transform method, see </span>
</span><span id="Symmetries-301"><a href="#Symmetries-301"><span class="linenos">301</span></a><span class="sd">          https://shapely.readthedocs.io/en/stable/manual.html#affine-transformations</span>
</span><span id="Symmetries-302"><a href="#Symmetries-302"><span class="linenos">302</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Symmetries-303"><a href="#Symmetries-303"><span class="linenos">303</span></a>    <span class="k">if</span> <span class="n">centre</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">centre</span><span class="p">,</span> 
</span><span id="Symmetries-304"><a href="#Symmetries-304"><span class="linenos">304</span></a>                                     <span class="n">atol</span> <span class="o">=</span> <span class="n">tiling_utils</span><span class="o">.</span><span class="n">RESOLUTION</span><span class="p">):</span>
</span><span id="Symmetries-305"><a href="#Symmetries-305"><span class="linenos">305</span></a>      <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span>
</span><span id="Symmetries-306"><a href="#Symmetries-306"><span class="linenos">306</span></a>      <span class="k">return</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
</span><span id="Symmetries-307"><a href="#Symmetries-307"><span class="linenos">307</span></a>    
</span><span id="Symmetries-308"><a href="#Symmetries-308"><span class="linenos">308</span></a>    <span class="n">dx</span><span class="p">,</span> <span class="n">dy</span> <span class="o">=</span> <span class="n">centre</span>
</span><span id="Symmetries-309"><a href="#Symmetries-309"><span class="linenos">309</span></a>    <span class="n">t1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_translation_transform</span><span class="p">(</span><span class="o">-</span><span class="n">dx</span><span class="p">,</span> <span class="o">-</span><span class="n">dy</span><span class="p">)</span>
</span><span id="Symmetries-310"><a href="#Symmetries-310"><span class="linenos">310</span></a>    <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_rotation_transform</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span>
</span><span id="Symmetries-311"><a href="#Symmetries-311"><span class="linenos">311</span></a>    <span class="n">t2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_translation_transform</span><span class="p">(</span><span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="p">)</span>
</span><span id="Symmetries-312"><a href="#Symmetries-312"><span class="linenos">312</span></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_combine_transforms</span><span class="p">([</span><span class="n">t1</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">t2</span><span class="p">])</span>
</span><span id="Symmetries-313"><a href="#Symmetries-313"><span class="linenos">313</span></a>  
</span><span id="Symmetries-314"><a href="#Symmetries-314"><span class="linenos">314</span></a>  
</span><span id="Symmetries-315"><a href="#Symmetries-315"><span class="linenos">315</span></a>  <span class="k">def</span> <span class="nf">_get_reflection_transform</span><span class="p">(</span>
</span><span id="Symmetries-316"><a href="#Symmetries-316"><span class="linenos">316</span></a>      <span class="bp">self</span><span class="p">,</span> <span class="n">angle</span><span class="p">:</span><span class="nb">float</span><span class="p">,</span> <span class="n">centre</span><span class="p">:</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]:</span>
</span><span id="Symmetries-317"><a href="#Symmetries-317"><span class="linenos">317</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns a shapely affine transform tuple that will reflect a shape</span>
</span><span id="Symmetries-318"><a href="#Symmetries-318"><span class="linenos">318</span></a><span class="sd">    in a line at the specified angle, optionally through a specified centre</span>
</span><span id="Symmetries-319"><a href="#Symmetries-319"><span class="linenos">319</span></a><span class="sd">    point.</span>
</span><span id="Symmetries-320"><a href="#Symmetries-320"><span class="linenos">320</span></a>
</span><span id="Symmetries-321"><a href="#Symmetries-321"><span class="linenos">321</span></a><span class="sd">    Args:</span>
</span><span id="Symmetries-322"><a href="#Symmetries-322"><span class="linenos">322</span></a><span class="sd">      angle (float): angle to the x-axis of the line of reflection.</span>
</span><span id="Symmetries-323"><a href="#Symmetries-323"><span class="linenos">323</span></a><span class="sd">      centre (tuple[float], optional): point through which the line of </span>
</span><span id="Symmetries-324"><a href="#Symmetries-324"><span class="linenos">324</span></a><span class="sd">        reflection passes. Defaults to None, which</span>
</span><span id="Symmetries-325"><a href="#Symmetries-325"><span class="linenos">325</span></a><span class="sd">        will in turn be converted to (0, 0).</span>
</span><span id="Symmetries-326"><a href="#Symmetries-326"><span class="linenos">326</span></a>
</span><span id="Symmetries-327"><a href="#Symmetries-327"><span class="linenos">327</span></a><span class="sd">    Returns:</span>
</span><span id="Symmetries-328"><a href="#Symmetries-328"><span class="linenos">328</span></a><span class="sd">      list[float]: a six item list of floats, per the shapely.affinity.</span>
</span><span id="Symmetries-329"><a href="#Symmetries-329"><span class="linenos">329</span></a><span class="sd">        affine_transform method, see </span>
</span><span id="Symmetries-330"><a href="#Symmetries-330"><span class="linenos">330</span></a><span class="sd">          https://shapely.readthedocs.io/en/stable/manual.html#affine-transformations</span>
</span><span id="Symmetries-331"><a href="#Symmetries-331"><span class="linenos">331</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Symmetries-332"><a href="#Symmetries-332"><span class="linenos">332</span></a>    <span class="k">if</span> <span class="n">centre</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">centre</span><span class="p">,</span> 
</span><span id="Symmetries-333"><a href="#Symmetries-333"><span class="linenos">333</span></a>                                     <span class="n">atol</span> <span class="o">=</span> <span class="n">tiling_utils</span><span class="o">.</span><span class="n">RESOLUTION</span><span class="p">):</span>
</span><span id="Symmetries-334"><a href="#Symmetries-334"><span class="linenos">334</span></a>      <span class="n">A</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span>
</span><span id="Symmetries-335"><a href="#Symmetries-335"><span class="linenos">335</span></a>      <span class="k">return</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">A</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">A</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">A</span><span class="p">),</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">A</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="Symmetries-336"><a href="#Symmetries-336"><span class="linenos">336</span></a>    <span class="n">dx</span><span class="p">,</span> <span class="n">dy</span> <span class="o">=</span> <span class="n">centre</span>
</span><span id="Symmetries-337"><a href="#Symmetries-337"><span class="linenos">337</span></a>    <span class="n">t1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_translation_transform</span><span class="p">(</span><span class="o">-</span><span class="n">dx</span><span class="p">,</span> <span class="o">-</span><span class="n">dy</span><span class="p">)</span>
</span><span id="Symmetries-338"><a href="#Symmetries-338"><span class="linenos">338</span></a>    <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_reflection_transform</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span>
</span><span id="Symmetries-339"><a href="#Symmetries-339"><span class="linenos">339</span></a>    <span class="n">t2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_translation_transform</span><span class="p">(</span><span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="p">)</span>
</span><span id="Symmetries-340"><a href="#Symmetries-340"><span class="linenos">340</span></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_combine_transforms</span><span class="p">([</span><span class="n">t1</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">t2</span><span class="p">])</span>
</span><span id="Symmetries-341"><a href="#Symmetries-341"><span class="linenos">341</span></a>
</span><span id="Symmetries-342"><a href="#Symmetries-342"><span class="linenos">342</span></a>
</span><span id="Symmetries-343"><a href="#Symmetries-343"><span class="linenos">343</span></a>  <span class="k">def</span> <span class="nf">_combine_transforms</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">transforms</span><span class="p">:</span><span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]:</span>
</span><span id="Symmetries-344"><a href="#Symmetries-344"><span class="linenos">344</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns a shapely affine transform list that combines the listed</span>
</span><span id="Symmetries-345"><a href="#Symmetries-345"><span class="linenos">345</span></a><span class="sd">    sequence of transforms applied in order.</span>
</span><span id="Symmetries-346"><a href="#Symmetries-346"><span class="linenos">346</span></a>
</span><span id="Symmetries-347"><a href="#Symmetries-347"><span class="linenos">347</span></a><span class="sd">    Args:</span>
</span><span id="Symmetries-348"><a href="#Symmetries-348"><span class="linenos">348</span></a><span class="sd">      transforms (list[list[float]]): sequence of transforms to combine.</span>
</span><span id="Symmetries-349"><a href="#Symmetries-349"><span class="linenos">349</span></a>
</span><span id="Symmetries-350"><a href="#Symmetries-350"><span class="linenos">350</span></a><span class="sd">    Returns:</span>
</span><span id="Symmetries-351"><a href="#Symmetries-351"><span class="linenos">351</span></a><span class="sd">      list[float]: a transform tuple combining the supplied transforms applied</span>
</span><span id="Symmetries-352"><a href="#Symmetries-352"><span class="linenos">352</span></a><span class="sd">        in order, see </span>
</span><span id="Symmetries-353"><a href="#Symmetries-353"><span class="linenos">353</span></a><span class="sd">          https://shapely.readthedocs.io/en/stable/manual.html#affine-transformations</span>
</span><span id="Symmetries-354"><a href="#Symmetries-354"><span class="linenos">354</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Symmetries-355"><a href="#Symmetries-355"><span class="linenos">355</span></a>    <span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</span><span id="Symmetries-356"><a href="#Symmetries-356"><span class="linenos">356</span></a>    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">transforms</span><span class="p">:</span>
</span><span id="Symmetries-357"><a href="#Symmetries-357"><span class="linenos">357</span></a>      <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_as_numpy_matrix</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">@</span> <span class="n">result</span>
</span><span id="Symmetries-358"><a href="#Symmetries-358"><span class="linenos">358</span></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_as_shapely_transform</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</span><span id="Symmetries-359"><a href="#Symmetries-359"><span class="linenos">359</span></a>
</span><span id="Symmetries-360"><a href="#Symmetries-360"><span class="linenos">360</span></a>
</span><span id="Symmetries-361"><a href="#Symmetries-361"><span class="linenos">361</span></a>  <span class="k">def</span> <span class="nf">_reverse_transform</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">transform</span><span class="p">:</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]:</span>
</span><span id="Symmetries-362"><a href="#Symmetries-362"><span class="linenos">362</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns the inverse shapely affine transform of the supplied transform.</span>
</span><span id="Symmetries-363"><a href="#Symmetries-363"><span class="linenos">363</span></a>
</span><span id="Symmetries-364"><a href="#Symmetries-364"><span class="linenos">364</span></a><span class="sd">    Args:</span>
</span><span id="Symmetries-365"><a href="#Symmetries-365"><span class="linenos">365</span></a><span class="sd">      transform (list[float]): the transform for which the inverse is desired.</span>
</span><span id="Symmetries-366"><a href="#Symmetries-366"><span class="linenos">366</span></a>
</span><span id="Symmetries-367"><a href="#Symmetries-367"><span class="linenos">367</span></a><span class="sd">    Returns:</span>
</span><span id="Symmetries-368"><a href="#Symmetries-368"><span class="linenos">368</span></a><span class="sd">      list[float]: shapely affine transform tuple that will invert the supplied</span>
</span><span id="Symmetries-369"><a href="#Symmetries-369"><span class="linenos">369</span></a><span class="sd">        transform.</span>
</span><span id="Symmetries-370"><a href="#Symmetries-370"><span class="linenos">370</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Symmetries-371"><a href="#Symmetries-371"><span class="linenos">371</span></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_as_shapely_transform</span><span class="p">(</span>
</span><span id="Symmetries-372"><a href="#Symmetries-372"><span class="linenos">372</span></a>      <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_as_numpy_matrix</span><span class="p">(</span><span class="n">transform</span><span class="p">)))</span>
</span><span id="Symmetries-373"><a href="#Symmetries-373"><span class="linenos">373</span></a>
</span><span id="Symmetries-374"><a href="#Symmetries-374"><span class="linenos">374</span></a>
</span><span id="Symmetries-375"><a href="#Symmetries-375"><span class="linenos">375</span></a>  <span class="k">def</span> <span class="nf">_as_shapely_transform</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arr</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]:</span>
</span><span id="Symmetries-376"><a href="#Symmetries-376"><span class="linenos">376</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns the shapely affine transform list equivalent to the supplied</span>
</span><span id="Symmetries-377"><a href="#Symmetries-377"><span class="linenos">377</span></a><span class="sd">    numpy matrix of a conventional augmented affine transform matrix.</span>
</span><span id="Symmetries-378"><a href="#Symmetries-378"><span class="linenos">378</span></a>
</span><span id="Symmetries-379"><a href="#Symmetries-379"><span class="linenos">379</span></a><span class="sd">    Args:</span>
</span><span id="Symmetries-380"><a href="#Symmetries-380"><span class="linenos">380</span></a><span class="sd">      arr (np.array): augmented affine transform matrix of the desired </span>
</span><span id="Symmetries-381"><a href="#Symmetries-381"><span class="linenos">381</span></a><span class="sd">        transform.</span>
</span><span id="Symmetries-382"><a href="#Symmetries-382"><span class="linenos">382</span></a>
</span><span id="Symmetries-383"><a href="#Symmetries-383"><span class="linenos">383</span></a><span class="sd">    Returns:</span>
</span><span id="Symmetries-384"><a href="#Symmetries-384"><span class="linenos">384</span></a><span class="sd">      list[float]: desired shapely affine transform list of floats.</span>
</span><span id="Symmetries-385"><a href="#Symmetries-385"><span class="linenos">385</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Symmetries-386"><a href="#Symmetries-386"><span class="linenos">386</span></a>    <span class="k">return</span> <span class="p">[</span><span class="n">arr</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">arr</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">arr</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">arr</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">arr</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span> <span class="n">arr</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">]]</span>
</span><span id="Symmetries-387"><a href="#Symmetries-387"><span class="linenos">387</span></a>  
</span><span id="Symmetries-388"><a href="#Symmetries-388"><span class="linenos">388</span></a>  
</span><span id="Symmetries-389"><a href="#Symmetries-389"><span class="linenos">389</span></a>  <span class="k">def</span> <span class="nf">_as_numpy_matrix</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">transform</span><span class="p">:</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">:</span>
</span><span id="Symmetries-390"><a href="#Symmetries-390"><span class="linenos">390</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Converts the supplied shapely affine transform list to an augmented</span>
</span><span id="Symmetries-391"><a href="#Symmetries-391"><span class="linenos">391</span></a><span class="sd">    affine transform matrix in numpy array form. This makes combining transforms</span>
</span><span id="Symmetries-392"><a href="#Symmetries-392"><span class="linenos">392</span></a><span class="sd">    much easier.</span>
</span><span id="Symmetries-393"><a href="#Symmetries-393"><span class="linenos">393</span></a>
</span><span id="Symmetries-394"><a href="#Symmetries-394"><span class="linenos">394</span></a><span class="sd">    Args:</span>
</span><span id="Symmetries-395"><a href="#Symmetries-395"><span class="linenos">395</span></a><span class="sd">      transform (list[float]): the transform in shapely format.</span>
</span><span id="Symmetries-396"><a href="#Symmetries-396"><span class="linenos">396</span></a>
</span><span id="Symmetries-397"><a href="#Symmetries-397"><span class="linenos">397</span></a><span class="sd">    Returns:</span>
</span><span id="Symmetries-398"><a href="#Symmetries-398"><span class="linenos">398</span></a><span class="sd">        np.array: the transform in numpy matrix format.</span>
</span><span id="Symmetries-399"><a href="#Symmetries-399"><span class="linenos">399</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Symmetries-400"><a href="#Symmetries-400"><span class="linenos">400</span></a>    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">transform</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">transform</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">transform</span><span class="p">[</span><span class="mi">4</span><span class="p">]],</span>
</span><span id="Symmetries-401"><a href="#Symmetries-401"><span class="linenos">401</span></a>                     <span class="p">[</span><span class="n">transform</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">transform</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">transform</span><span class="p">[</span><span class="mi">5</span><span class="p">]],</span>
</span><span id="Symmetries-402"><a href="#Symmetries-402"><span class="linenos">402</span></a>                     <span class="p">[</span>           <span class="mi">0</span><span class="p">,</span>            <span class="mi">0</span><span class="p">,</span>            <span class="mi">1</span><span class="p">]])</span>
</span><span id="Symmetries-403"><a href="#Symmetries-403"><span class="linenos">403</span></a>
</span><span id="Symmetries-404"><a href="#Symmetries-404"><span class="linenos">404</span></a>
</span><span id="Symmetries-405"><a href="#Symmetries-405"><span class="linenos">405</span></a>  <span class="k">def</span> <span class="nf">get_corner_labels</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="Symmetries-406"><a href="#Symmetries-406"><span class="linenos">406</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns all the reorderings of vertex labels corresponding to each</span>
</span><span id="Symmetries-407"><a href="#Symmetries-407"><span class="linenos">407</span></a><span class="sd">    symmetry.</span>
</span><span id="Symmetries-408"><a href="#Symmetries-408"><span class="linenos">408</span></a>
</span><span id="Symmetries-409"><a href="#Symmetries-409"><span class="linenos">409</span></a><span class="sd">    Returns:</span>
</span><span id="Symmetries-410"><a href="#Symmetries-410"><span class="linenos">410</span></a><span class="sd">      dict[str, list[str]]: A dictionary with two entries. &quot;rotations&quot; is</span>
</span><span id="Symmetries-411"><a href="#Symmetries-411"><span class="linenos">411</span></a><span class="sd">        a list of labels under the rotation symmetries, &quot;reflections&quot; those</span>
</span><span id="Symmetries-412"><a href="#Symmetries-412"><span class="linenos">412</span></a><span class="sd">        under the reflection symmetries.</span>
</span><span id="Symmetries-413"><a href="#Symmetries-413"><span class="linenos">413</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Symmetries-414"><a href="#Symmetries-414"><span class="linenos">414</span></a>    <span class="n">labels</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">string</span><span class="o">.</span><span class="n">ascii_letters</span><span class="o">.</span><span class="n">upper</span><span class="p">())[:</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">]</span>
</span><span id="Symmetries-415"><a href="#Symmetries-415"><span class="linenos">415</span></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_labels_under_symmetries</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span>
</span><span id="Symmetries-416"><a href="#Symmetries-416"><span class="linenos">416</span></a>
</span><span id="Symmetries-417"><a href="#Symmetries-417"><span class="linenos">417</span></a>
</span><span id="Symmetries-418"><a href="#Symmetries-418"><span class="linenos">418</span></a>  <span class="k">def</span> <span class="nf">get_unique_labels</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">offset</span><span class="p">:</span><span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="Symmetries-419"><a href="#Symmetries-419"><span class="linenos">419</span></a>    <span class="n">labellings</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_corner_labels</span><span class="p">()</span>
</span><span id="Symmetries-420"><a href="#Symmetries-420"><span class="linenos">420</span></a>    <span class="n">labellings</span> <span class="o">=</span> <span class="n">labellings</span><span class="p">[</span><span class="s2">&quot;rotations&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">labellings</span><span class="p">[</span><span class="s2">&quot;reflections&quot;</span><span class="p">]</span>
</span><span id="Symmetries-421"><a href="#Symmetries-421"><span class="linenos">421</span></a>    <span class="n">labellings</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">labellings</span><span class="p">)]</span>
</span><span id="Symmetries-422"><a href="#Symmetries-422"><span class="linenos">422</span></a>    <span class="n">n_new_labels</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">labellings</span><span class="p">))</span>
</span><span id="Symmetries-423"><a href="#Symmetries-423"><span class="linenos">423</span></a>    <span class="n">letters</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">string</span><span class="o">.</span><span class="n">ascii_letters</span><span class="o">.</span><span class="n">upper</span><span class="p">())[</span><span class="n">offset</span><span class="p">:</span><span class="n">offset</span> <span class="o">+</span> <span class="n">n_new_labels</span><span class="p">]</span>
</span><span id="Symmetries-424"><a href="#Symmetries-424"><span class="linenos">424</span></a>    <span class="n">mapping</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
</span><span id="Symmetries-425"><a href="#Symmetries-425"><span class="linenos">425</span></a>    <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Symmetries-426"><a href="#Symmetries-426"><span class="linenos">426</span></a>    <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">labellings</span><span class="p">:</span>
</span><span id="Symmetries-427"><a href="#Symmetries-427"><span class="linenos">427</span></a>      <span class="k">if</span> <span class="ow">not</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">mapping</span><span class="p">:</span>
</span><span id="Symmetries-428"><a href="#Symmetries-428"><span class="linenos">428</span></a>        <span class="n">mapping</span><span class="p">[</span><span class="n">label</span><span class="p">]</span> <span class="o">=</span> <span class="n">letters</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span><span id="Symmetries-429"><a href="#Symmetries-429"><span class="linenos">429</span></a>        <span class="n">i</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span>
</span><span id="Symmetries-430"><a href="#Symmetries-430"><span class="linenos">430</span></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_labels_under_symmetries</span><span class="p">([</span><span class="n">mapping</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">labellings</span><span class="p">])</span>
</span><span id="Symmetries-431"><a href="#Symmetries-431"><span class="linenos">431</span></a>  
</span><span id="Symmetries-432"><a href="#Symmetries-432"><span class="linenos">432</span></a>  
</span><span id="Symmetries-433"><a href="#Symmetries-433"><span class="linenos">433</span></a>  <span class="k">def</span> <span class="nf">_get_labels_under_symmetries</span><span class="p">(</span>
</span><span id="Symmetries-434"><a href="#Symmetries-434"><span class="linenos">434</span></a>      <span class="bp">self</span><span class="p">,</span> <span class="n">labels</span><span class="p">:</span><span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="Symmetries-435"><a href="#Symmetries-435"><span class="linenos">435</span></a>    <span class="n">cycle</span> <span class="o">=</span> <span class="n">labels</span> <span class="o">*</span> <span class="mi">2</span>
</span><span id="Symmetries-436"><a href="#Symmetries-436"><span class="linenos">436</span></a>    <span class="n">under_rotation</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">cycle</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">+</span> <span class="n">i</span><span class="p">])</span> 
</span><span id="Symmetries-437"><a href="#Symmetries-437"><span class="linenos">437</span></a>                      <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">rotation_shifts</span><span class="p">]</span>
</span><span id="Symmetries-438"><a href="#Symmetries-438"><span class="linenos">438</span></a>    <span class="n">under_reflection</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">cycle</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">+</span> <span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> 
</span><span id="Symmetries-439"><a href="#Symmetries-439"><span class="linenos">439</span></a>                        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">reflection_shifts</span><span class="p">]</span>
</span><span id="Symmetries-440"><a href="#Symmetries-440"><span class="linenos">440</span></a>    <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;rotations&quot;</span><span class="p">:</span> <span class="n">under_rotation</span><span class="p">,</span>
</span><span id="Symmetries-441"><a href="#Symmetries-441"><span class="linenos">441</span></a>            <span class="s2">&quot;reflections&quot;</span><span class="p">:</span> <span class="n">under_reflection</span><span class="p">}</span>
</span><span id="Symmetries-442"><a href="#Symmetries-442"><span class="linenos">442</span></a>
</span><span id="Symmetries-443"><a href="#Symmetries-443"><span class="linenos">443</span></a>
</span><span id="Symmetries-444"><a href="#Symmetries-444"><span class="linenos">444</span></a>  <span class="k">def</span> <span class="nf">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">which</span><span class="p">:</span><span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;both&quot;</span><span class="p">,</span> <span class="n">all_in_one</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
</span><span id="Symmetries-445"><a href="#Symmetries-445"><span class="linenos">445</span></a>    
</span><span id="Symmetries-446"><a href="#Symmetries-446"><span class="linenos">446</span></a>    <span class="k">if</span> <span class="n">all_in_one</span><span class="p">:</span>
</span><span id="Symmetries-447"><a href="#Symmetries-447"><span class="linenos">447</span></a>      <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;all_in_one option not yet implemented!&quot;</span><span class="p">)</span>
</span><span id="Symmetries-448"><a href="#Symmetries-448"><span class="linenos">448</span></a>    
</span><span id="Symmetries-449"><a href="#Symmetries-449"><span class="linenos">449</span></a>    <span class="k">if</span> <span class="n">which</span> <span class="o">==</span> <span class="s2">&quot;both&quot;</span><span class="p">:</span>
</span><span id="Symmetries-450"><a href="#Symmetries-450"><span class="linenos">450</span></a>      <span class="n">n_subplots</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rotation_shifts</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">reflection_shifts</span><span class="p">)</span>
</span><span id="Symmetries-451"><a href="#Symmetries-451"><span class="linenos">451</span></a>    <span class="k">elif</span> <span class="n">which</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;rot&quot;</span><span class="p">:</span>
</span><span id="Symmetries-452"><a href="#Symmetries-452"><span class="linenos">452</span></a>      <span class="n">n_subplots</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rotation_shifts</span><span class="p">)</span>
</span><span id="Symmetries-453"><a href="#Symmetries-453"><span class="linenos">453</span></a>    <span class="k">elif</span> <span class="n">which</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;ref&quot;</span><span class="p">:</span>
</span><span id="Symmetries-454"><a href="#Symmetries-454"><span class="linenos">454</span></a>      <span class="n">n_subplots</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">reflection_shifts</span><span class="p">)</span>
</span><span id="Symmetries-455"><a href="#Symmetries-455"><span class="linenos">455</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="Symmetries-456"><a href="#Symmetries-456"><span class="linenos">456</span></a>      <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Please specify symmetries to plot using the which parameter!&quot;</span><span class="p">)</span>
</span><span id="Symmetries-457"><a href="#Symmetries-457"><span class="linenos">457</span></a>      <span class="k">return</span>
</span><span id="Symmetries-458"><a href="#Symmetries-458"><span class="linenos">458</span></a>    
</span><span id="Symmetries-459"><a href="#Symmetries-459"><span class="linenos">459</span></a>    <span class="n">nr</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">n_subplots</span><span class="p">)))</span>
</span><span id="Symmetries-460"><a href="#Symmetries-460"><span class="linenos">460</span></a>    <span class="n">nc</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">n_subplots</span> <span class="o">/</span> <span class="n">nr</span><span class="p">))</span>
</span><span id="Symmetries-461"><a href="#Symmetries-461"><span class="linenos">461</span></a>    <span class="n">nplots</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Symmetries-462"><a href="#Symmetries-462"><span class="linenos">462</span></a>    <span class="n">mrr</span> <span class="o">=</span> <span class="n">shapely</span><span class="o">.</span><span class="n">oriented_envelope</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">polygon</span><span class="p">)</span>
</span><span id="Symmetries-463"><a href="#Symmetries-463"><span class="linenos">463</span></a>    <span class="n">w</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">tiling_utils</span><span class="o">.</span><span class="n">get_side_lengths</span><span class="p">(</span><span class="n">mrr</span><span class="p">)[:</span><span class="mi">2</span><span class="p">])</span>
</span><span id="Symmetries-464"><a href="#Symmetries-464"><span class="linenos">464</span></a>
</span><span id="Symmetries-465"><a href="#Symmetries-465"><span class="linenos">465</span></a>    <span class="n">fig</span> <span class="o">=</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
</span><span id="Symmetries-466"><a href="#Symmetries-466"><span class="linenos">466</span></a>    <span class="n">labels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_unique_labels</span><span class="p">()</span>
</span><span id="Symmetries-467"><a href="#Symmetries-467"><span class="linenos">467</span></a>    <span class="n">c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">polygon</span><span class="o">.</span><span class="n">centroid</span>
</span><span id="Symmetries-468"><a href="#Symmetries-468"><span class="linenos">468</span></a>
</span><span id="Symmetries-469"><a href="#Symmetries-469"><span class="linenos">469</span></a>    <span class="k">if</span> <span class="n">which</span> <span class="o">==</span> <span class="s2">&quot;both&quot;</span> <span class="ow">or</span> <span class="n">which</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;rot&quot;</span><span class="p">:</span>
</span><span id="Symmetries-470"><a href="#Symmetries-470"><span class="linenos">470</span></a>      <span class="n">rotations</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_rotations</span><span class="p">()[</span><span class="s2">&quot;angles&quot;</span><span class="p">]</span>
</span><span id="Symmetries-471"><a href="#Symmetries-471"><span class="linenos">471</span></a>      <span class="k">for</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">rotn</span><span class="p">),</span> <span class="n">label</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="nb">enumerate</span><span class="p">(</span><span class="n">rotations</span><span class="p">),</span> <span class="n">labels</span><span class="p">[</span><span class="s2">&quot;rotations&quot;</span><span class="p">]):</span>
</span><span id="Symmetries-472"><a href="#Symmetries-472"><span class="linenos">472</span></a>        <span class="n">nplots</span> <span class="o">=</span> <span class="n">nplots</span> <span class="o">+</span> <span class="mi">1</span>
</span><span id="Symmetries-473"><a href="#Symmetries-473"><span class="linenos">473</span></a>        <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">nr</span><span class="p">,</span> <span class="n">nc</span><span class="p">,</span> <span class="n">nplots</span><span class="p">)</span>
</span><span id="Symmetries-474"><a href="#Symmetries-474"><span class="linenos">474</span></a>        <span class="n">gpd</span><span class="o">.</span><span class="n">GeoSeries</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">polygon</span><span class="p">])</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span> <span class="o">=</span> <span class="n">ax</span><span class="p">,</span> <span class="n">fc</span> <span class="o">=</span> <span class="s2">&quot;lightgrey&quot;</span><span class="p">,</span> <span class="n">lw</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="Symmetries-475"><a href="#Symmetries-475"><span class="linenos">475</span></a>        <span class="k">for</span> <span class="n">lbl</span><span class="p">,</span> <span class="n">pt</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">label</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">polygon</span><span class="o">.</span><span class="n">exterior</span><span class="o">.</span><span class="n">coords</span><span class="p">):</span>
</span><span id="Symmetries-476"><a href="#Symmetries-476"><span class="linenos">476</span></a>          <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">lbl</span><span class="p">,</span> <span class="n">xy</span> <span class="o">=</span> <span class="n">pt</span><span class="p">,</span> <span class="n">ha</span> <span class="o">=</span> <span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">va</span> <span class="o">=</span> <span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">14</span><span class="p">)</span>
</span><span id="Symmetries-477"><a href="#Symmetries-477"><span class="linenos">477</span></a>        <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Symmetries-478"><a href="#Symmetries-478"><span class="linenos">478</span></a>          <span class="n">rotn</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">rotn</span><span class="p">)</span> 
</span><span id="Symmetries-479"><a href="#Symmetries-479"><span class="linenos">479</span></a>          <span class="n">arc</span> <span class="o">=</span> <span class="n">geom</span><span class="o">.</span><span class="n">LineString</span><span class="p">(</span>
</span><span id="Symmetries-480"><a href="#Symmetries-480"><span class="linenos">480</span></a>            <span class="p">[[</span><span class="n">w</span><span class="o">/</span><span class="mi">6</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="n">w</span><span class="o">/</span><span class="mi">6</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">a</span><span class="p">)]</span>
</span><span id="Symmetries-481"><a href="#Symmetries-481"><span class="linenos">481</span></a>             <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">rotn</span><span class="p">,</span> <span class="mi">50</span><span class="p">)])</span>
</span><span id="Symmetries-482"><a href="#Symmetries-482"><span class="linenos">482</span></a>          <span class="n">angle</span> <span class="o">=</span> <span class="n">geom</span><span class="o">.</span><span class="n">LineString</span><span class="p">(</span>
</span><span id="Symmetries-483"><a href="#Symmetries-483"><span class="linenos">483</span></a>            <span class="p">[(</span><span class="n">w</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> 
</span><span id="Symmetries-484"><a href="#Symmetries-484"><span class="linenos">484</span></a>             <span class="p">(</span><span class="n">w</span><span class="o">/</span><span class="mi">4</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">rotn</span><span class="p">),</span> <span class="n">w</span><span class="o">/</span><span class="mi">4</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">rotn</span><span class="p">))])</span>
</span><span id="Symmetries-485"><a href="#Symmetries-485"><span class="linenos">485</span></a>          <span class="n">ls</span> <span class="o">=</span> <span class="p">[</span><span class="n">affine</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">y</span><span class="p">)</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="p">[</span><span class="n">arc</span><span class="p">,</span> <span class="n">angle</span><span class="p">]]</span>
</span><span id="Symmetries-486"><a href="#Symmetries-486"><span class="linenos">486</span></a>          <span class="n">gpd</span><span class="o">.</span><span class="n">GeoSeries</span><span class="p">(</span><span class="n">ls</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span> <span class="o">=</span> <span class="n">ax</span><span class="p">,</span> <span class="n">ec</span> <span class="o">=</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="n">lw</span> <span class="o">=</span> <span class="mf">0.35</span><span class="p">)</span>
</span><span id="Symmetries-487"><a href="#Symmetries-487"><span class="linenos">487</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">get_corner_labels</span><span class="p">()</span>
</span><span id="Symmetries-488"><a href="#Symmetries-488"><span class="linenos">488</span></a>        <span class="n">pyplot</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>
</span><span id="Symmetries-489"><a href="#Symmetries-489"><span class="linenos">489</span></a>        
</span><span id="Symmetries-490"><a href="#Symmetries-490"><span class="linenos">490</span></a>    <span class="k">if</span> <span class="n">which</span> <span class="o">==</span> <span class="s2">&quot;both&quot;</span> <span class="ow">or</span> <span class="n">which</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;ref&quot;</span><span class="p">:</span>
</span><span id="Symmetries-491"><a href="#Symmetries-491"><span class="linenos">491</span></a>      <span class="n">reflections</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_reflections</span><span class="p">()[</span><span class="s2">&quot;angles&quot;</span><span class="p">]</span>
</span><span id="Symmetries-492"><a href="#Symmetries-492"><span class="linenos">492</span></a>      <span class="k">for</span> <span class="n">refn</span><span class="p">,</span> <span class="n">label</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">reflections</span><span class="p">,</span> <span class="n">labels</span><span class="p">[</span><span class="s2">&quot;reflections&quot;</span><span class="p">]):</span>
</span><span id="Symmetries-493"><a href="#Symmetries-493"><span class="linenos">493</span></a>        <span class="n">nplots</span> <span class="o">=</span> <span class="n">nplots</span> <span class="o">+</span> <span class="mi">1</span>
</span><span id="Symmetries-494"><a href="#Symmetries-494"><span class="linenos">494</span></a>        <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">nr</span><span class="p">,</span> <span class="n">nc</span><span class="p">,</span> <span class="n">nplots</span><span class="p">)</span>
</span><span id="Symmetries-495"><a href="#Symmetries-495"><span class="linenos">495</span></a>        <span class="n">gpd</span><span class="o">.</span><span class="n">GeoSeries</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">polygon</span><span class="p">])</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span> <span class="o">=</span> <span class="n">ax</span><span class="p">,</span> <span class="n">fc</span> <span class="o">=</span> <span class="s2">&quot;lightgrey&quot;</span><span class="p">,</span> <span class="n">lw</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="Symmetries-496"><a href="#Symmetries-496"><span class="linenos">496</span></a>        <span class="k">for</span> <span class="n">lbl</span><span class="p">,</span> <span class="n">pt</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">label</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">polygon</span><span class="o">.</span><span class="n">exterior</span><span class="o">.</span><span class="n">coords</span><span class="p">):</span>
</span><span id="Symmetries-497"><a href="#Symmetries-497"><span class="linenos">497</span></a>          <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">lbl</span><span class="p">,</span> <span class="n">xy</span> <span class="o">=</span> <span class="n">pt</span><span class="p">,</span> <span class="n">ha</span> <span class="o">=</span> <span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">va</span> <span class="o">=</span> <span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">14</span><span class="p">)</span>
</span><span id="Symmetries-498"><a href="#Symmetries-498"><span class="linenos">498</span></a>        <span class="n">ls</span> <span class="o">=</span> <span class="n">geom</span><span class="o">.</span><span class="n">LineString</span><span class="p">([(</span><span class="o">-</span><span class="n">h</span><span class="o">/</span><span class="mi">2</span> <span class="o">*</span> <span class="mf">1.1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="n">h</span><span class="o">/</span><span class="mi">2</span> <span class="o">*</span> <span class="mf">1.1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)])</span>
</span><span id="Symmetries-499"><a href="#Symmetries-499"><span class="linenos">499</span></a>        <span class="n">ls</span> <span class="o">=</span> <span class="n">affine</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span><span class="n">ls</span><span class="p">,</span> <span class="n">refn</span><span class="p">)</span>
</span><span id="Symmetries-500"><a href="#Symmetries-500"><span class="linenos">500</span></a>        <span class="n">ls</span> <span class="o">=</span> <span class="n">affine</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="n">ls</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
</span><span id="Symmetries-501"><a href="#Symmetries-501"><span class="linenos">501</span></a>        <span class="n">gpd</span><span class="o">.</span><span class="n">GeoSeries</span><span class="p">([</span><span class="n">ls</span><span class="p">])</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span> <span class="o">=</span> <span class="n">ax</span><span class="p">,</span> <span class="n">ec</span> <span class="o">=</span> <span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">ls</span> <span class="o">=</span> <span class="s2">&quot;dashed&quot;</span><span class="p">,</span> <span class="n">lw</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">)</span>
</span><span id="Symmetries-502"><a href="#Symmetries-502"><span class="linenos">502</span></a>        <span class="n">pyplot</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>
</span><span id="Symmetries-503"><a href="#Symmetries-503"><span class="linenos">503</span></a>
</span><span id="Symmetries-504"><a href="#Symmetries-504"><span class="linenos">504</span></a>    <span class="k">return</span> <span class="n">ax</span>
</span><span id="Symmetries-505"><a href="#Symmetries-505"><span class="linenos">505</span></a>
</span><span id="Symmetries-506"><a href="#Symmetries-506"><span class="linenos">506</span></a>
</span><span id="Symmetries-507"><a href="#Symmetries-507"><span class="linenos">507</span></a>  <span class="k">def</span> <span class="nf">find_matches</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">seq</span><span class="p">:</span><span class="n">Iterable</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">]],</span> 
</span><span id="Symmetries-508"><a href="#Symmetries-508"><span class="linenos">508</span></a>                   <span class="n">pat</span><span class="p">:</span><span class="n">Iterable</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">]],</span>
</span><span id="Symmetries-509"><a href="#Symmetries-509"><span class="linenos">509</span></a>                   <span class="n">equals</span> <span class="o">=</span> <span class="n">_equal_tuples</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
</span><span id="Symmetries-510"><a href="#Symmetries-510"><span class="linenos">510</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot; Implements Knuth-Morris-Pratt string pattern matching algorithm. See:</span>
</span><span id="Symmetries-511"><a href="#Symmetries-511"><span class="linenos">511</span></a><span class="sd">    https://en.wikipedia.org/wiki/KnuthMorrisPratt_algorithm which provides</span>
</span><span id="Symmetries-512"><a href="#Symmetries-512"><span class="linenos">512</span></a><span class="sd">    detailed pseudo-code on which this code is directly based. This</span>
</span><span id="Symmetries-513"><a href="#Symmetries-513"><span class="linenos">513</span></a><span class="sd">    implementation expects sequences of tuples of floats, although in principle</span>
</span><span id="Symmetries-514"><a href="#Symmetries-514"><span class="linenos">514</span></a><span class="sd">    any objects could be contained in the Iterables. The default equality</span>
</span><span id="Symmetries-515"><a href="#Symmetries-515"><span class="linenos">515</span></a><span class="sd">    function tests for close matches, not exact equality.</span>
</span><span id="Symmetries-516"><a href="#Symmetries-516"><span class="linenos">516</span></a>
</span><span id="Symmetries-517"><a href="#Symmetries-517"><span class="linenos">517</span></a><span class="sd">    Args:</span>
</span><span id="Symmetries-518"><a href="#Symmetries-518"><span class="linenos">518</span></a><span class="sd">      seq (Iterable[tuple[float]]): The sequence of float tuples to find   </span>
</span><span id="Symmetries-519"><a href="#Symmetries-519"><span class="linenos">519</span></a><span class="sd">        matches in.</span>
</span><span id="Symmetries-520"><a href="#Symmetries-520"><span class="linenos">520</span></a><span class="sd">      pat (Iterable[tuple[float]]): The sequence to match.</span>
</span><span id="Symmetries-521"><a href="#Symmetries-521"><span class="linenos">521</span></a><span class="sd">      equals (function, optional): A function to use to test for equality of</span>
</span><span id="Symmetries-522"><a href="#Symmetries-522"><span class="linenos">522</span></a><span class="sd">        elements in patterns. Defaults to _equal_tuples().</span>
</span><span id="Symmetries-523"><a href="#Symmetries-523"><span class="linenos">523</span></a>
</span><span id="Symmetries-524"><a href="#Symmetries-524"><span class="linenos">524</span></a><span class="sd">    Returns:</span>
</span><span id="Symmetries-525"><a href="#Symmetries-525"><span class="linenos">525</span></a><span class="sd">        Iterable[int]: _description_</span>
</span><span id="Symmetries-526"><a href="#Symmetries-526"><span class="linenos">526</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Symmetries-527"><a href="#Symmetries-527"><span class="linenos">527</span></a>    <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
</span><span id="Symmetries-528"><a href="#Symmetries-528"><span class="linenos">528</span></a>    <span class="n">finds</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Symmetries-529"><a href="#Symmetries-529"><span class="linenos">529</span></a>    <span class="n">table</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_table</span><span class="p">(</span><span class="n">pat</span><span class="p">,</span> <span class="n">equals</span><span class="p">)</span>
</span><span id="Symmetries-530"><a href="#Symmetries-530"><span class="linenos">530</span></a>    <span class="k">while</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">seq</span><span class="p">):</span>
</span><span id="Symmetries-531"><a href="#Symmetries-531"><span class="linenos">531</span></a>      <span class="k">if</span> <span class="n">equals</span><span class="p">(</span><span class="n">pat</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">seq</span><span class="p">[</span><span class="n">j</span><span class="p">]):</span>
</span><span id="Symmetries-532"><a href="#Symmetries-532"><span class="linenos">532</span></a>        <span class="n">j</span> <span class="o">=</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span>
</span><span id="Symmetries-533"><a href="#Symmetries-533"><span class="linenos">533</span></a>        <span class="n">k</span> <span class="o">=</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span>
</span><span id="Symmetries-534"><a href="#Symmetries-534"><span class="linenos">534</span></a>        <span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">pat</span><span class="p">):</span>
</span><span id="Symmetries-535"><a href="#Symmetries-535"><span class="linenos">535</span></a>          <span class="n">finds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">j</span> <span class="o">-</span> <span class="n">k</span><span class="p">)</span>
</span><span id="Symmetries-536"><a href="#Symmetries-536"><span class="linenos">536</span></a>          <span class="n">k</span> <span class="o">=</span> <span class="n">table</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
</span><span id="Symmetries-537"><a href="#Symmetries-537"><span class="linenos">537</span></a>      <span class="k">else</span><span class="p">:</span>
</span><span id="Symmetries-538"><a href="#Symmetries-538"><span class="linenos">538</span></a>        <span class="n">k</span> <span class="o">=</span> <span class="n">table</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
</span><span id="Symmetries-539"><a href="#Symmetries-539"><span class="linenos">539</span></a>        <span class="k">if</span> <span class="n">k</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Symmetries-540"><a href="#Symmetries-540"><span class="linenos">540</span></a>          <span class="n">j</span> <span class="o">=</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span>
</span><span id="Symmetries-541"><a href="#Symmetries-541"><span class="linenos">541</span></a>          <span class="n">k</span> <span class="o">=</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span>
</span><span id="Symmetries-542"><a href="#Symmetries-542"><span class="linenos">542</span></a>    <span class="k">return</span> <span class="n">finds</span>
</span><span id="Symmetries-543"><a href="#Symmetries-543"><span class="linenos">543</span></a>
</span><span id="Symmetries-544"><a href="#Symmetries-544"><span class="linenos">544</span></a>
</span><span id="Symmetries-545"><a href="#Symmetries-545"><span class="linenos">545</span></a>  <span class="k">def</span> <span class="nf">get_table</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pattern</span><span class="p">:</span><span class="n">Iterable</span><span class="p">,</span>
</span><span id="Symmetries-546"><a href="#Symmetries-546"><span class="linenos">546</span></a>                <span class="n">equals</span> <span class="o">=</span> <span class="n">_equal_tuples</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
</span><span id="Symmetries-547"><a href="#Symmetries-547"><span class="linenos">547</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns the &#39;offsets&#39; table used by KMP pattern matching algorithm as</span>
</span><span id="Symmetries-548"><a href="#Symmetries-548"><span class="linenos">548</span></a><span class="sd">    required by self.find_matches, based on the supplied pattern.</span>
</span><span id="Symmetries-549"><a href="#Symmetries-549"><span class="linenos">549</span></a>
</span><span id="Symmetries-550"><a href="#Symmetries-550"><span class="linenos">550</span></a><span class="sd">    Args:</span>
</span><span id="Symmetries-551"><a href="#Symmetries-551"><span class="linenos">551</span></a><span class="sd">      pattern (Iterable): The pattern to set up the table for.</span>
</span><span id="Symmetries-552"><a href="#Symmetries-552"><span class="linenos">552</span></a><span class="sd">      equals (function, optional): A function to use to test for equality of</span>
</span><span id="Symmetries-553"><a href="#Symmetries-553"><span class="linenos">553</span></a><span class="sd">        elements in patterns. Defaults to _equal_tuples().</span>
</span><span id="Symmetries-554"><a href="#Symmetries-554"><span class="linenos">554</span></a>
</span><span id="Symmetries-555"><a href="#Symmetries-555"><span class="linenos">555</span></a><span class="sd">    Returns:</span>
</span><span id="Symmetries-556"><a href="#Symmetries-556"><span class="linenos">556</span></a><span class="sd">        Iterable[int]: _description_</span>
</span><span id="Symmetries-557"><a href="#Symmetries-557"><span class="linenos">557</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Symmetries-558"><a href="#Symmetries-558"><span class="linenos">558</span></a>    <span class="n">pos</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="Symmetries-559"><a href="#Symmetries-559"><span class="linenos">559</span></a>    <span class="n">cnd</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Symmetries-560"><a href="#Symmetries-560"><span class="linenos">560</span></a>    <span class="n">T</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">}</span>
</span><span id="Symmetries-561"><a href="#Symmetries-561"><span class="linenos">561</span></a>    <span class="k">while</span> <span class="n">pos</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">pattern</span><span class="p">):</span>
</span><span id="Symmetries-562"><a href="#Symmetries-562"><span class="linenos">562</span></a>      <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">pattern</span><span class="p">[</span><span class="n">pos</span><span class="p">],</span> <span class="n">pattern</span><span class="p">[</span><span class="n">cnd</span><span class="p">]):</span>
</span><span id="Symmetries-563"><a href="#Symmetries-563"><span class="linenos">563</span></a>        <span class="n">T</span><span class="p">[</span><span class="n">pos</span><span class="p">]</span> <span class="o">=</span> <span class="n">T</span><span class="p">[</span><span class="n">cnd</span><span class="p">]</span>
</span><span id="Symmetries-564"><a href="#Symmetries-564"><span class="linenos">564</span></a>      <span class="k">else</span><span class="p">:</span>
</span><span id="Symmetries-565"><a href="#Symmetries-565"><span class="linenos">565</span></a>        <span class="n">T</span><span class="p">[</span><span class="n">pos</span><span class="p">]</span> <span class="o">=</span> <span class="n">cnd</span>
</span><span id="Symmetries-566"><a href="#Symmetries-566"><span class="linenos">566</span></a>        <span class="k">while</span> <span class="n">cnd</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">equals</span><span class="p">(</span><span class="n">pattern</span><span class="p">[</span><span class="n">pos</span><span class="p">],</span> <span class="n">pattern</span><span class="p">[</span><span class="n">cnd</span><span class="p">]):</span>
</span><span id="Symmetries-567"><a href="#Symmetries-567"><span class="linenos">567</span></a>          <span class="n">cnd</span> <span class="o">=</span> <span class="n">T</span><span class="p">[</span><span class="n">cnd</span><span class="p">]</span>
</span><span id="Symmetries-568"><a href="#Symmetries-568"><span class="linenos">568</span></a>      <span class="n">pos</span> <span class="o">=</span> <span class="n">pos</span> <span class="o">+</span> <span class="mi">1</span>
</span><span id="Symmetries-569"><a href="#Symmetries-569"><span class="linenos">569</span></a>      <span class="n">cnd</span> <span class="o">=</span> <span class="n">cnd</span> <span class="o">+</span> <span class="mi">1</span>
</span><span id="Symmetries-570"><a href="#Symmetries-570"><span class="linenos">570</span></a>    <span class="n">T</span><span class="p">[</span><span class="n">pos</span><span class="p">]</span> <span class="o">=</span> <span class="n">cnd</span>
</span><span id="Symmetries-571"><a href="#Symmetries-571"><span class="linenos">571</span></a>    <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">T</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
</span></pre></div>


    

                            <div id="Symmetries.__init__" class="classattr">
                                        <input id="Symmetries.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">Symmetries</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">polygon</span><span class="p">:</span> <span class="n">shapely</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">polygon</span><span class="o">.</span><span class="n">Polygon</span></span>)</span>

                <label class="view-source-button" for="Symmetries.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Symmetries.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Symmetries.__init__-43"><a href="#Symmetries.__init__-43"><span class="linenos">43</span></a>  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">polygon</span><span class="p">:</span><span class="n">geom</span><span class="o">.</span><span class="n">Polygon</span><span class="p">):</span>
</span><span id="Symmetries.__init__-44"><a href="#Symmetries.__init__-44"><span class="linenos">44</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">polygon</span> <span class="o">=</span> <span class="n">polygon</span>
</span><span id="Symmetries.__init__-45"><a href="#Symmetries.__init__-45"><span class="linenos">45</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">=</span> <span class="n">shapely</span><span class="o">.</span><span class="n">count_coordinates</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">polygon</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
</span><span id="Symmetries.__init__-46"><a href="#Symmetries.__init__-46"><span class="linenos">46</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">p_code</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_polygon_code</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">polygon</span><span class="p">)</span>
</span><span id="Symmetries.__init__-47"><a href="#Symmetries.__init__-47"><span class="linenos">47</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">p_code_r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_polygon_code</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">polygon</span><span class="p">,</span> <span class="n">mirrored</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</span><span id="Symmetries.__init__-48"><a href="#Symmetries.__init__-48"><span class="linenos">48</span></a>    <span class="n">symmetries</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_find_symmetries</span><span class="p">()</span>
</span><span id="Symmetries.__init__-49"><a href="#Symmetries.__init__-49"><span class="linenos">49</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">rotation_shifts</span> <span class="o">=</span> <span class="n">symmetries</span><span class="p">[</span><span class="s2">&quot;rotation-shifts&quot;</span><span class="p">]</span>
</span><span id="Symmetries.__init__-50"><a href="#Symmetries.__init__-50"><span class="linenos">50</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">reflection_shifts</span> <span class="o">=</span> <span class="n">symmetries</span><span class="p">[</span><span class="s2">&quot;reflection-shifts&quot;</span><span class="p">]</span>
</span></pre></div>


    

                            </div>
                            <div id="Symmetries.polygon" class="classattr">
                                <div class="attr variable">
            <span class="name">polygon</span><span class="annotation">: shapely.geometry.polygon.Polygon</span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#Symmetries.polygon"></a>
    
    

                            </div>
                            <div id="Symmetries.n" class="classattr">
                                <div class="attr variable">
            <span class="name">n</span><span class="annotation">: int</span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#Symmetries.n"></a>
    
    

                            </div>
                            <div id="Symmetries.p_code" class="classattr">
                                <div class="attr variable">
            <span class="name">p_code</span><span class="annotation">: list[tuple[float]]</span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#Symmetries.p_code"></a>
    
    

                            </div>
                            <div id="Symmetries.p_code_r" class="classattr">
                                <div class="attr variable">
            <span class="name">p_code_r</span><span class="annotation">: list[tuple[float]]</span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#Symmetries.p_code_r"></a>
    
    

                            </div>
                            <div id="Symmetries.rotation_shifts" class="classattr">
                                <div class="attr variable">
            <span class="name">rotation_shifts</span><span class="annotation">: list[int]</span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#Symmetries.rotation_shifts"></a>
    
    

                            </div>
                            <div id="Symmetries.reflection_shifts" class="classattr">
                                <div class="attr variable">
            <span class="name">reflection_shifts</span><span class="annotation">: list[int]</span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#Symmetries.reflection_shifts"></a>
    
    

                            </div>
                            <div id="Symmetries.get_rotations" class="classattr">
                                        <input id="Symmetries.get_rotations-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_rotations</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">offsets</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">) -> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span>:</span></span>

                <label class="view-source-button" for="Symmetries.get_rotations-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Symmetries.get_rotations"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Symmetries.get_rotations-143"><a href="#Symmetries.get_rotations-143"><span class="linenos">143</span></a>  <span class="k">def</span> <span class="nf">get_rotations</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">offsets</span><span class="p">:</span><span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]]:</span>
</span><span id="Symmetries.get_rotations-144"><a href="#Symmetries.get_rotations-144"><span class="linenos">144</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Gets the rotations associated with this collection of symmetries.</span>
</span><span id="Symmetries.get_rotations-145"><a href="#Symmetries.get_rotations-145"><span class="linenos">145</span></a>
</span><span id="Symmetries.get_rotations-146"><a href="#Symmetries.get_rotations-146"><span class="linenos">146</span></a><span class="sd">    Returns:</span>
</span><span id="Symmetries.get_rotations-147"><a href="#Symmetries.get_rotations-147"><span class="linenos">147</span></a><span class="sd">      dict[str, list[float], list[float]]: Two item dictionary with &#39;angles&#39; and</span>
</span><span id="Symmetries.get_rotations-148"><a href="#Symmetries.get_rotations-148"><span class="linenos">148</span></a><span class="sd">        &#39;transforms&#39; entries, each a list of floats.</span>
</span><span id="Symmetries.get_rotations-149"><a href="#Symmetries.get_rotations-149"><span class="linenos">149</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Symmetries.get_rotations-150"><a href="#Symmetries.get_rotations-150"><span class="linenos">150</span></a>    <span class="k">if</span> <span class="n">offsets</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Symmetries.get_rotations-151"><a href="#Symmetries.get_rotations-151"><span class="linenos">151</span></a>      <span class="n">offsets</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rotation_shifts</span>
</span><span id="Symmetries.get_rotations-152"><a href="#Symmetries.get_rotations-152"><span class="linenos">152</span></a>    <span class="n">c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">polygon</span><span class="o">.</span><span class="n">centroid</span>
</span><span id="Symmetries.get_rotations-153"><a href="#Symmetries.get_rotations-153"><span class="linenos">153</span></a>    <span class="n">rot_angles</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">i</span> <span class="o">*</span> <span class="mi">360</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">offsets</span><span class="p">]</span> 
</span><span id="Symmetries.get_rotations-154"><a href="#Symmetries.get_rotations-154"><span class="linenos">154</span></a>    <span class="n">rotations</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_rotation_transform</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">y</span><span class="p">)),</span> <span class="mi">6</span><span class="p">)</span> 
</span><span id="Symmetries.get_rotations-155"><a href="#Symmetries.get_rotations-155"><span class="linenos">155</span></a>                 <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">rot_angles</span><span class="p">]</span>
</span><span id="Symmetries.get_rotations-156"><a href="#Symmetries.get_rotations-156"><span class="linenos">156</span></a>    <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;angles&quot;</span><span class="p">:</span> <span class="n">rot_angles</span><span class="p">,</span> <span class="s2">&quot;transforms&quot;</span><span class="p">:</span> <span class="n">rotations</span><span class="p">}</span>
</span></pre></div>


            <div class="docstring"><p>Gets the rotations associated with this collection of symmetries.</p>

<p>Returns:
  dict[str, list[float], list[float]]: Two item dictionary with 'angles' and
    'transforms' entries, each a list of floats.</p>
</div>


                            </div>
                            <div id="Symmetries.get_reflections" class="classattr">
                                        <input id="Symmetries.get_reflections-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_reflections</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">offsets</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">) -> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span>:</span></span>

                <label class="view-source-button" for="Symmetries.get_reflections-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Symmetries.get_reflections"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Symmetries.get_reflections-159"><a href="#Symmetries.get_reflections-159"><span class="linenos">159</span></a>  <span class="k">def</span> <span class="nf">get_reflections</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">offsets</span><span class="p">:</span><span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]]:</span>
</span><span id="Symmetries.get_reflections-160"><a href="#Symmetries.get_reflections-160"><span class="linenos">160</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Gets the reflections associated with this collection of symmetries.</span>
</span><span id="Symmetries.get_reflections-161"><a href="#Symmetries.get_reflections-161"><span class="linenos">161</span></a>
</span><span id="Symmetries.get_reflections-162"><a href="#Symmetries.get_reflections-162"><span class="linenos">162</span></a><span class="sd">    Returns:</span>
</span><span id="Symmetries.get_reflections-163"><a href="#Symmetries.get_reflections-163"><span class="linenos">163</span></a><span class="sd">      dict[str, list[float], list[float]]: Two item dictionary with &#39;angles&#39; and</span>
</span><span id="Symmetries.get_reflections-164"><a href="#Symmetries.get_reflections-164"><span class="linenos">164</span></a><span class="sd">        &#39;transforms&#39; entries, each a list of floats.</span>
</span><span id="Symmetries.get_reflections-165"><a href="#Symmetries.get_reflections-165"><span class="linenos">165</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Symmetries.get_reflections-166"><a href="#Symmetries.get_reflections-166"><span class="linenos">166</span></a>    <span class="k">if</span> <span class="n">offsets</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Symmetries.get_reflections-167"><a href="#Symmetries.get_reflections-167"><span class="linenos">167</span></a>      <span class="n">offsets</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reflection_shifts</span>
</span><span id="Symmetries.get_reflections-168"><a href="#Symmetries.get_reflections-168"><span class="linenos">168</span></a>    <span class="c1"># calculate all possible reflection axes - ordering of these is important</span>
</span><span id="Symmetries.get_reflections-169"><a href="#Symmetries.get_reflections-169"><span class="linenos">169</span></a>    <span class="c1"># for correct picking - don&#39;t mess with this code!</span>
</span><span id="Symmetries.get_reflections-170"><a href="#Symmetries.get_reflections-170"><span class="linenos">170</span></a>    <span class="n">c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">polygon</span><span class="o">.</span><span class="n">centroid</span>
</span><span id="Symmetries.get_reflections-171"><a href="#Symmetries.get_reflections-171"><span class="linenos">171</span></a>    <span class="n">bearings</span> <span class="o">=</span> <span class="n">tiling_utils</span><span class="o">.</span><span class="n">get_side_bearings</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">polygon</span><span class="p">)</span>
</span><span id="Symmetries.get_reflections-172"><a href="#Symmetries.get_reflections-172"><span class="linenos">172</span></a>    <span class="n">reflection_axes</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Symmetries.get_reflections-173"><a href="#Symmetries.get_reflections-173"><span class="linenos">173</span></a>    <span class="n">interior_angles</span> <span class="o">=</span> <span class="n">tiling_utils</span><span class="o">.</span><span class="n">get_interior_angles</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">polygon</span><span class="p">)</span>
</span><span id="Symmetries.get_reflections-174"><a href="#Symmetries.get_reflections-174"><span class="linenos">174</span></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">):</span>
</span><span id="Symmetries.get_reflections-175"><a href="#Symmetries.get_reflections-175"><span class="linenos">175</span></a>      <span class="c1"># angle bisectors</span>
</span><span id="Symmetries.get_reflections-176"><a href="#Symmetries.get_reflections-176"><span class="linenos">176</span></a>      <span class="n">reflection_axes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">bearings</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">interior_angles</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="Symmetries.get_reflections-177"><a href="#Symmetries.get_reflections-177"><span class="linenos">177</span></a>      <span class="c1"># edge_perpendicular bisectors</span>
</span><span id="Symmetries.get_reflections-178"><a href="#Symmetries.get_reflections-178"><span class="linenos">178</span></a>      <span class="n">reflection_axes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">bearings</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="mi">90</span><span class="p">)</span>  <span class="c1"># normal to the edge</span>
</span><span id="Symmetries.get_reflections-179"><a href="#Symmetries.get_reflections-179"><span class="linenos">179</span></a>    <span class="c1"># pick out those where matches occurred</span>
</span><span id="Symmetries.get_reflections-180"><a href="#Symmetries.get_reflections-180"><span class="linenos">180</span></a>    <span class="n">ref_angles</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">reflection_axes</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="mi">6</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">offsets</span><span class="p">]</span>
</span><span id="Symmetries.get_reflections-181"><a href="#Symmetries.get_reflections-181"><span class="linenos">181</span></a>    <span class="n">reflections</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_reflection_transform</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">y</span><span class="p">)),</span> <span class="mi">6</span><span class="p">)</span>
</span><span id="Symmetries.get_reflections-182"><a href="#Symmetries.get_reflections-182"><span class="linenos">182</span></a>                   <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">ref_angles</span><span class="p">]</span>
</span><span id="Symmetries.get_reflections-183"><a href="#Symmetries.get_reflections-183"><span class="linenos">183</span></a>    <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;angles&quot;</span><span class="p">:</span> <span class="n">ref_angles</span><span class="p">,</span> <span class="s2">&quot;transforms&quot;</span><span class="p">:</span> <span class="n">reflections</span><span class="p">}</span>
</span></pre></div>


            <div class="docstring"><p>Gets the reflections associated with this collection of symmetries.</p>

<p>Returns:
  dict[str, list[float], list[float]]: Two item dictionary with 'angles' and
    'transforms' entries, each a list of floats.</p>
</div>


                            </div>
                            <div id="Symmetries.get_matching_transforms" class="classattr">
                                        <input id="Symmetries.get_matching_transforms-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_matching_transforms</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">other</span><span class="p">:</span> <span class="n">shapely</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">polygon</span><span class="o">.</span><span class="n">Polygon</span></span><span class="return-annotation">) -> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span>:</span></span>

                <label class="view-source-button" for="Symmetries.get_matching_transforms-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Symmetries.get_matching_transforms"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Symmetries.get_matching_transforms-186"><a href="#Symmetries.get_matching_transforms-186"><span class="linenos">186</span></a>  <span class="k">def</span> <span class="nf">get_matching_transforms</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> 
</span><span id="Symmetries.get_matching_transforms-187"><a href="#Symmetries.get_matching_transforms-187"><span class="linenos">187</span></a>                              <span class="n">other</span><span class="p">:</span><span class="n">geom</span><span class="o">.</span><span class="n">Polygon</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]]:</span>
</span><span id="Symmetries.get_matching_transforms-188"><a href="#Symmetries.get_matching_transforms-188"><span class="linenos">188</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Finds the transforms that will map another polygon onto this one.</span>
</span><span id="Symmetries.get_matching_transforms-189"><a href="#Symmetries.get_matching_transforms-189"><span class="linenos">189</span></a><span class="sd">    Reuses the _find_symmetries() method, but supplying the other polygon</span>
</span><span id="Symmetries.get_matching_transforms-190"><a href="#Symmetries.get_matching_transforms-190"><span class="linenos">190</span></a><span class="sd">    as that method&#39;s optional argument. Before determining the match the</span>
</span><span id="Symmetries.get_matching_transforms-191"><a href="#Symmetries.get_matching_transforms-191"><span class="linenos">191</span></a><span class="sd">    points on the perimeter of the other polygon are reordered so that the</span>
</span><span id="Symmetries.get_matching_transforms-192"><a href="#Symmetries.get_matching_transforms-192"><span class="linenos">192</span></a><span class="sd">    index positions match those of the reference polygon.</span>
</span><span id="Symmetries.get_matching_transforms-193"><a href="#Symmetries.get_matching_transforms-193"><span class="linenos">193</span></a>
</span><span id="Symmetries.get_matching_transforms-194"><a href="#Symmetries.get_matching_transforms-194"><span class="linenos">194</span></a><span class="sd">    Args:</span>
</span><span id="Symmetries.get_matching_transforms-195"><a href="#Symmetries.get_matching_transforms-195"><span class="linenos">195</span></a><span class="sd">        other (geom.Polygon): the polygon to match.</span>
</span><span id="Symmetries.get_matching_transforms-196"><a href="#Symmetries.get_matching_transforms-196"><span class="linenos">196</span></a>
</span><span id="Symmetries.get_matching_transforms-197"><a href="#Symmetries.get_matching_transforms-197"><span class="linenos">197</span></a><span class="sd">    Returns:</span>
</span><span id="Symmetries.get_matching_transforms-198"><a href="#Symmetries.get_matching_transforms-198"><span class="linenos">198</span></a><span class="sd">      dict[str,Union[str,list[float]]]: A dictionary with the following entries:</span>
</span><span id="Symmetries.get_matching_transforms-199"><a href="#Symmetries.get_matching_transforms-199"><span class="linenos">199</span></a><span class="sd">      &#39;rotation-shifts&#39;: vertex offsets to form matches by rotation</span>
</span><span id="Symmetries.get_matching_transforms-200"><a href="#Symmetries.get_matching_transforms-200"><span class="linenos">200</span></a><span class="sd">      &#39;reflection-shifts&#39;: vertex offsets to form matches by reflection</span>
</span><span id="Symmetries.get_matching_transforms-201"><a href="#Symmetries.get_matching_transforms-201"><span class="linenos">201</span></a><span class="sd">      &#39;rotation-angles&#39;: list of rotation angles of matches (in degrees)</span>
</span><span id="Symmetries.get_matching_transforms-202"><a href="#Symmetries.get_matching_transforms-202"><span class="linenos">202</span></a><span class="sd">      &#39;reflection-angles&#39;: list of angles of reflection axes (in degrees)</span>
</span><span id="Symmetries.get_matching_transforms-203"><a href="#Symmetries.get_matching_transforms-203"><span class="linenos">203</span></a><span class="sd">      &#39;rotation-transforms&#39;: list of shapely affine transform tuples of    </span>
</span><span id="Symmetries.get_matching_transforms-204"><a href="#Symmetries.get_matching_transforms-204"><span class="linenos">204</span></a><span class="sd">        rotation matches</span>
</span><span id="Symmetries.get_matching_transforms-205"><a href="#Symmetries.get_matching_transforms-205"><span class="linenos">205</span></a><span class="sd">      &#39;reflection-transforms&#39;: list of shapely affine transform tuples of</span>
</span><span id="Symmetries.get_matching_transforms-206"><a href="#Symmetries.get_matching_transforms-206"><span class="linenos">206</span></a><span class="sd">        reflection matches</span>
</span><span id="Symmetries.get_matching_transforms-207"><a href="#Symmetries.get_matching_transforms-207"><span class="linenos">207</span></a><span class="sd">      &#39;pre-translation&#39;: translation to align other with this polygon as tuple</span>
</span><span id="Symmetries.get_matching_transforms-208"><a href="#Symmetries.get_matching_transforms-208"><span class="linenos">208</span></a><span class="sd">        of floats</span>
</span><span id="Symmetries.get_matching_transforms-209"><a href="#Symmetries.get_matching_transforms-209"><span class="linenos">209</span></a><span class="sd">      &#39;pre-rotation&#39;: rotation to align other with this polygon (in degrees)</span>
</span><span id="Symmetries.get_matching_transforms-210"><a href="#Symmetries.get_matching_transforms-210"><span class="linenos">210</span></a><span class="sd">      &#39;pre-transform&#39;: shapely affine transform tuple that brings other into</span>
</span><span id="Symmetries.get_matching_transforms-211"><a href="#Symmetries.get_matching_transforms-211"><span class="linenos">211</span></a><span class="sd">        alignment with this polygon such that the matching transforms work </span>
</span><span id="Symmetries.get_matching_transforms-212"><a href="#Symmetries.get_matching_transforms-212"><span class="linenos">212</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Symmetries.get_matching_transforms-213"><a href="#Symmetries.get_matching_transforms-213"><span class="linenos">213</span></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">==</span> <span class="n">shapely</span><span class="o">.</span><span class="n">count_coordinates</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="Symmetries.get_matching_transforms-214"><a href="#Symmetries.get_matching_transforms-214"><span class="linenos">214</span></a>      <span class="c1"># shift them to the same centroid</span>
</span><span id="Symmetries.get_matching_transforms-215"><a href="#Symmetries.get_matching_transforms-215"><span class="linenos">215</span></a>      <span class="n">c0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">polygon</span><span class="o">.</span><span class="n">centroid</span>
</span><span id="Symmetries.get_matching_transforms-216"><a href="#Symmetries.get_matching_transforms-216"><span class="linenos">216</span></a>      <span class="n">trans</span> <span class="o">=</span> <span class="p">(</span><span class="n">c0</span><span class="o">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">other</span><span class="o">.</span><span class="n">centroid</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">c0</span><span class="o">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">other</span><span class="o">.</span><span class="n">centroid</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
</span><span id="Symmetries.get_matching_transforms-217"><a href="#Symmetries.get_matching_transforms-217"><span class="linenos">217</span></a>      <span class="n">other</span> <span class="o">=</span> <span class="n">affine</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">trans</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">trans</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="Symmetries.get_matching_transforms-218"><a href="#Symmetries.get_matching_transforms-218"><span class="linenos">218</span></a>      <span class="c1"># now see if they align at all</span>
</span><span id="Symmetries.get_matching_transforms-219"><a href="#Symmetries.get_matching_transforms-219"><span class="linenos">219</span></a>      <span class="n">symms</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_find_symmetries</span><span class="p">(</span><span class="n">other_polygon</span> <span class="o">=</span> <span class="n">other</span><span class="p">)</span>
</span><span id="Symmetries.get_matching_transforms-220"><a href="#Symmetries.get_matching_transforms-220"><span class="linenos">220</span></a>      <span class="n">rot_shifts</span> <span class="o">=</span> <span class="n">symms</span><span class="p">[</span><span class="s2">&quot;rotation-shifts&quot;</span><span class="p">]</span>
</span><span id="Symmetries.get_matching_transforms-221"><a href="#Symmetries.get_matching_transforms-221"><span class="linenos">221</span></a>      <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">rot_shifts</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Symmetries.get_matching_transforms-222"><a href="#Symmetries.get_matching_transforms-222"><span class="linenos">222</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Polygons do not match at all!&quot;</span><span class="p">)</span>
</span><span id="Symmetries.get_matching_transforms-223"><a href="#Symmetries.get_matching_transforms-223"><span class="linenos">223</span></a>        <span class="k">return</span> <span class="kc">None</span>
</span><span id="Symmetries.get_matching_transforms-224"><a href="#Symmetries.get_matching_transforms-224"><span class="linenos">224</span></a>      <span class="c1"># now align the corners so indexes of their corners match</span>
</span><span id="Symmetries.get_matching_transforms-225"><a href="#Symmetries.get_matching_transforms-225"><span class="linenos">225</span></a>      <span class="k">if</span> <span class="n">rot_shifts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Symmetries.get_matching_transforms-226"><a href="#Symmetries.get_matching_transforms-226"><span class="linenos">226</span></a>        <span class="n">other</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_shift_polygon_corners</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="o">-</span><span class="n">rot_shifts</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="Symmetries.get_matching_transforms-227"><a href="#Symmetries.get_matching_transforms-227"><span class="linenos">227</span></a>        <span class="n">rotation</span> <span class="o">=</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">get_rotations</span><span class="p">(</span><span class="n">rot_shifts</span><span class="p">)[</span><span class="s2">&quot;angles&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span><span id="Symmetries.get_matching_transforms-228"><a href="#Symmetries.get_matching_transforms-228"><span class="linenos">228</span></a>        <span class="n">other</span> <span class="o">=</span> <span class="n">tiling_utils</span><span class="o">.</span><span class="n">rotate_preserving_order</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">rotation</span><span class="p">,</span> <span class="n">c0</span><span class="p">)</span>
</span><span id="Symmetries.get_matching_transforms-229"><a href="#Symmetries.get_matching_transforms-229"><span class="linenos">229</span></a>      <span class="c1"># now determine the additional rotation needed to line them up</span>
</span><span id="Symmetries.get_matching_transforms-230"><a href="#Symmetries.get_matching_transforms-230"><span class="linenos">230</span></a>      <span class="n">p0_0</span> <span class="o">=</span> <span class="n">tiling_utils</span><span class="o">.</span><span class="n">get_corners</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">polygon</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="Symmetries.get_matching_transforms-231"><a href="#Symmetries.get_matching_transforms-231"><span class="linenos">231</span></a>      <span class="n">other_corners</span> <span class="o">=</span> <span class="n">tiling_utils</span><span class="o">.</span><span class="n">get_corners</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">repeat_first</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
</span><span id="Symmetries.get_matching_transforms-232"><a href="#Symmetries.get_matching_transforms-232"><span class="linenos">232</span></a>      <span class="n">rotation</span> <span class="o">=</span> <span class="n">rotation</span> <span class="o">+</span> \
</span><span id="Symmetries.get_matching_transforms-233"><a href="#Symmetries.get_matching_transforms-233"><span class="linenos">233</span></a>        <span class="n">tiling_utils</span><span class="o">.</span><span class="n">get_inner_angle</span><span class="p">(</span><span class="n">other_corners</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">c0</span><span class="p">,</span> <span class="n">p0_0</span><span class="p">)</span>
</span><span id="Symmetries.get_matching_transforms-234"><a href="#Symmetries.get_matching_transforms-234"><span class="linenos">234</span></a>      <span class="c1"># now find store and report the matching symmetries</span>
</span><span id="Symmetries.get_matching_transforms-235"><a href="#Symmetries.get_matching_transforms-235"><span class="linenos">235</span></a>      <span class="n">symms</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_find_symmetries</span><span class="p">(</span><span class="n">other_polygon</span> <span class="o">=</span> <span class="n">other</span><span class="p">)</span>
</span><span id="Symmetries.get_matching_transforms-236"><a href="#Symmetries.get_matching_transforms-236"><span class="linenos">236</span></a>      <span class="n">rot_shifts</span> <span class="o">=</span> <span class="n">symms</span><span class="p">[</span><span class="s2">&quot;rotation-shifts&quot;</span><span class="p">]</span>
</span><span id="Symmetries.get_matching_transforms-237"><a href="#Symmetries.get_matching_transforms-237"><span class="linenos">237</span></a>      <span class="n">rot_details</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_rotations</span><span class="p">(</span><span class="n">rot_shifts</span><span class="p">)</span>
</span><span id="Symmetries.get_matching_transforms-238"><a href="#Symmetries.get_matching_transforms-238"><span class="linenos">238</span></a>      <span class="n">symms</span><span class="p">[</span><span class="s2">&quot;rotation-angles&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">rot_details</span><span class="p">[</span><span class="s2">&quot;angles&quot;</span><span class="p">]</span>
</span><span id="Symmetries.get_matching_transforms-239"><a href="#Symmetries.get_matching_transforms-239"><span class="linenos">239</span></a>      <span class="n">symms</span><span class="p">[</span><span class="s2">&quot;rotation-transforms&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">rot_details</span><span class="p">[</span><span class="s2">&quot;transforms&quot;</span><span class="p">]</span>
</span><span id="Symmetries.get_matching_transforms-240"><a href="#Symmetries.get_matching_transforms-240"><span class="linenos">240</span></a>      <span class="n">ref_shifts</span> <span class="o">=</span> <span class="n">symms</span><span class="p">[</span><span class="s2">&quot;reflection-shifts&quot;</span><span class="p">]</span>
</span><span id="Symmetries.get_matching_transforms-241"><a href="#Symmetries.get_matching_transforms-241"><span class="linenos">241</span></a>      <span class="n">ref_details</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_reflections</span><span class="p">(</span><span class="n">ref_shifts</span><span class="p">)</span>
</span><span id="Symmetries.get_matching_transforms-242"><a href="#Symmetries.get_matching_transforms-242"><span class="linenos">242</span></a>      <span class="n">symms</span><span class="p">[</span><span class="s2">&quot;reflection-angles&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ref_details</span><span class="p">[</span><span class="s2">&quot;angles&quot;</span><span class="p">]</span>
</span><span id="Symmetries.get_matching_transforms-243"><a href="#Symmetries.get_matching_transforms-243"><span class="linenos">243</span></a>      <span class="n">symms</span><span class="p">[</span><span class="s2">&quot;reflection-transforms&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ref_details</span><span class="p">[</span><span class="s2">&quot;transforms&quot;</span><span class="p">]</span>
</span><span id="Symmetries.get_matching_transforms-244"><a href="#Symmetries.get_matching_transforms-244"><span class="linenos">244</span></a>      <span class="n">symms</span><span class="p">[</span><span class="s2">&quot;pre-translation&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">trans</span>
</span><span id="Symmetries.get_matching_transforms-245"><a href="#Symmetries.get_matching_transforms-245"><span class="linenos">245</span></a>      <span class="n">symms</span><span class="p">[</span><span class="s2">&quot;pre-rotation&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">rotation</span>
</span><span id="Symmetries.get_matching_transforms-246"><a href="#Symmetries.get_matching_transforms-246"><span class="linenos">246</span></a>      <span class="n">symms</span><span class="p">[</span><span class="s2">&quot;pre-transform&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_combine_transforms</span><span class="p">(</span>
</span><span id="Symmetries.get_matching_transforms-247"><a href="#Symmetries.get_matching_transforms-247"><span class="linenos">247</span></a>        <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_translation_transform</span><span class="p">(</span><span class="n">trans</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">trans</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span>
</span><span id="Symmetries.get_matching_transforms-248"><a href="#Symmetries.get_matching_transforms-248"><span class="linenos">248</span></a>         <span class="bp">self</span><span class="o">.</span><span class="n">_get_rotation_transform</span><span class="p">(</span><span class="n">rotation</span><span class="p">,</span> <span class="p">(</span><span class="n">c0</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">c0</span><span class="o">.</span><span class="n">y</span><span class="p">))])</span>
</span><span id="Symmetries.get_matching_transforms-249"><a href="#Symmetries.get_matching_transforms-249"><span class="linenos">249</span></a>      <span class="k">return</span> <span class="n">symms</span>
</span><span id="Symmetries.get_matching_transforms-250"><a href="#Symmetries.get_matching_transforms-250"><span class="linenos">250</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="Symmetries.get_matching_transforms-251"><a href="#Symmetries.get_matching_transforms-251"><span class="linenos">251</span></a>      <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Polygons have different numbers of sides!&quot;</span><span class="p">)</span>
</span><span id="Symmetries.get_matching_transforms-252"><a href="#Symmetries.get_matching_transforms-252"><span class="linenos">252</span></a>      <span class="k">return</span> <span class="kc">None</span>
</span></pre></div>


            <div class="docstring"><p>Finds the transforms that will map another polygon onto this one.
Reuses the _find_symmetries() method, but supplying the other polygon
as that method's optional argument. Before determining the match the
points on the perimeter of the other polygon are reordered so that the
index positions match those of the reference polygon.</p>

<p>Args:
    other (geom.Polygon): the polygon to match.</p>

<p>Returns:
  dict[str,Union[str,list[float]]]: A dictionary with the following entries:
  'rotation-shifts': vertex offsets to form matches by rotation
  'reflection-shifts': vertex offsets to form matches by reflection
  'rotation-angles': list of rotation angles of matches (in degrees)
  'reflection-angles': list of angles of reflection axes (in degrees)
  'rotation-transforms': list of shapely affine transform tuples of <br />
    rotation matches
  'reflection-transforms': list of shapely affine transform tuples of
    reflection matches
  'pre-translation': translation to align other with this polygon as tuple
    of floats
  'pre-rotation': rotation to align other with this polygon (in degrees)
  'pre-transform': shapely affine transform tuple that brings other into
    alignment with this polygon such that the matching transforms work</p>
</div>


                            </div>
                            <div id="Symmetries.get_corner_labels" class="classattr">
                                        <input id="Symmetries.get_corner_labels-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_corner_labels</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span>:</span></span>

                <label class="view-source-button" for="Symmetries.get_corner_labels-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Symmetries.get_corner_labels"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Symmetries.get_corner_labels-405"><a href="#Symmetries.get_corner_labels-405"><span class="linenos">405</span></a>  <span class="k">def</span> <span class="nf">get_corner_labels</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="Symmetries.get_corner_labels-406"><a href="#Symmetries.get_corner_labels-406"><span class="linenos">406</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns all the reorderings of vertex labels corresponding to each</span>
</span><span id="Symmetries.get_corner_labels-407"><a href="#Symmetries.get_corner_labels-407"><span class="linenos">407</span></a><span class="sd">    symmetry.</span>
</span><span id="Symmetries.get_corner_labels-408"><a href="#Symmetries.get_corner_labels-408"><span class="linenos">408</span></a>
</span><span id="Symmetries.get_corner_labels-409"><a href="#Symmetries.get_corner_labels-409"><span class="linenos">409</span></a><span class="sd">    Returns:</span>
</span><span id="Symmetries.get_corner_labels-410"><a href="#Symmetries.get_corner_labels-410"><span class="linenos">410</span></a><span class="sd">      dict[str, list[str]]: A dictionary with two entries. &quot;rotations&quot; is</span>
</span><span id="Symmetries.get_corner_labels-411"><a href="#Symmetries.get_corner_labels-411"><span class="linenos">411</span></a><span class="sd">        a list of labels under the rotation symmetries, &quot;reflections&quot; those</span>
</span><span id="Symmetries.get_corner_labels-412"><a href="#Symmetries.get_corner_labels-412"><span class="linenos">412</span></a><span class="sd">        under the reflection symmetries.</span>
</span><span id="Symmetries.get_corner_labels-413"><a href="#Symmetries.get_corner_labels-413"><span class="linenos">413</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Symmetries.get_corner_labels-414"><a href="#Symmetries.get_corner_labels-414"><span class="linenos">414</span></a>    <span class="n">labels</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">string</span><span class="o">.</span><span class="n">ascii_letters</span><span class="o">.</span><span class="n">upper</span><span class="p">())[:</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">]</span>
</span><span id="Symmetries.get_corner_labels-415"><a href="#Symmetries.get_corner_labels-415"><span class="linenos">415</span></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_labels_under_symmetries</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Returns all the reorderings of vertex labels corresponding to each
symmetry.</p>

<p>Returns:
  dict[str, list[str]]: A dictionary with two entries. "rotations" is
    a list of labels under the rotation symmetries, "reflections" those
    under the reflection symmetries.</p>
</div>


                            </div>
                            <div id="Symmetries.get_unique_labels" class="classattr">
                                        <input id="Symmetries.get_unique_labels-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_unique_labels</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">offset</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span></span><span class="return-annotation">) -> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="Symmetries.get_unique_labels-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Symmetries.get_unique_labels"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Symmetries.get_unique_labels-418"><a href="#Symmetries.get_unique_labels-418"><span class="linenos">418</span></a>  <span class="k">def</span> <span class="nf">get_unique_labels</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">offset</span><span class="p">:</span><span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="Symmetries.get_unique_labels-419"><a href="#Symmetries.get_unique_labels-419"><span class="linenos">419</span></a>    <span class="n">labellings</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_corner_labels</span><span class="p">()</span>
</span><span id="Symmetries.get_unique_labels-420"><a href="#Symmetries.get_unique_labels-420"><span class="linenos">420</span></a>    <span class="n">labellings</span> <span class="o">=</span> <span class="n">labellings</span><span class="p">[</span><span class="s2">&quot;rotations&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">labellings</span><span class="p">[</span><span class="s2">&quot;reflections&quot;</span><span class="p">]</span>
</span><span id="Symmetries.get_unique_labels-421"><a href="#Symmetries.get_unique_labels-421"><span class="linenos">421</span></a>    <span class="n">labellings</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">labellings</span><span class="p">)]</span>
</span><span id="Symmetries.get_unique_labels-422"><a href="#Symmetries.get_unique_labels-422"><span class="linenos">422</span></a>    <span class="n">n_new_labels</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">labellings</span><span class="p">))</span>
</span><span id="Symmetries.get_unique_labels-423"><a href="#Symmetries.get_unique_labels-423"><span class="linenos">423</span></a>    <span class="n">letters</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">string</span><span class="o">.</span><span class="n">ascii_letters</span><span class="o">.</span><span class="n">upper</span><span class="p">())[</span><span class="n">offset</span><span class="p">:</span><span class="n">offset</span> <span class="o">+</span> <span class="n">n_new_labels</span><span class="p">]</span>
</span><span id="Symmetries.get_unique_labels-424"><a href="#Symmetries.get_unique_labels-424"><span class="linenos">424</span></a>    <span class="n">mapping</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
</span><span id="Symmetries.get_unique_labels-425"><a href="#Symmetries.get_unique_labels-425"><span class="linenos">425</span></a>    <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Symmetries.get_unique_labels-426"><a href="#Symmetries.get_unique_labels-426"><span class="linenos">426</span></a>    <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">labellings</span><span class="p">:</span>
</span><span id="Symmetries.get_unique_labels-427"><a href="#Symmetries.get_unique_labels-427"><span class="linenos">427</span></a>      <span class="k">if</span> <span class="ow">not</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">mapping</span><span class="p">:</span>
</span><span id="Symmetries.get_unique_labels-428"><a href="#Symmetries.get_unique_labels-428"><span class="linenos">428</span></a>        <span class="n">mapping</span><span class="p">[</span><span class="n">label</span><span class="p">]</span> <span class="o">=</span> <span class="n">letters</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span><span id="Symmetries.get_unique_labels-429"><a href="#Symmetries.get_unique_labels-429"><span class="linenos">429</span></a>        <span class="n">i</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span>
</span><span id="Symmetries.get_unique_labels-430"><a href="#Symmetries.get_unique_labels-430"><span class="linenos">430</span></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_labels_under_symmetries</span><span class="p">([</span><span class="n">mapping</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">labellings</span><span class="p">])</span>
</span></pre></div>


    

                            </div>
                            <div id="Symmetries.plot" class="classattr">
                                        <input id="Symmetries.plot-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">plot</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">which</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;both&#39;</span>, </span><span class="param"><span class="n">all_in_one</span><span class="o">=</span><span class="kc">False</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Symmetries.plot-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Symmetries.plot"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Symmetries.plot-444"><a href="#Symmetries.plot-444"><span class="linenos">444</span></a>  <span class="k">def</span> <span class="nf">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">which</span><span class="p">:</span><span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;both&quot;</span><span class="p">,</span> <span class="n">all_in_one</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
</span><span id="Symmetries.plot-445"><a href="#Symmetries.plot-445"><span class="linenos">445</span></a>    
</span><span id="Symmetries.plot-446"><a href="#Symmetries.plot-446"><span class="linenos">446</span></a>    <span class="k">if</span> <span class="n">all_in_one</span><span class="p">:</span>
</span><span id="Symmetries.plot-447"><a href="#Symmetries.plot-447"><span class="linenos">447</span></a>      <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;all_in_one option not yet implemented!&quot;</span><span class="p">)</span>
</span><span id="Symmetries.plot-448"><a href="#Symmetries.plot-448"><span class="linenos">448</span></a>    
</span><span id="Symmetries.plot-449"><a href="#Symmetries.plot-449"><span class="linenos">449</span></a>    <span class="k">if</span> <span class="n">which</span> <span class="o">==</span> <span class="s2">&quot;both&quot;</span><span class="p">:</span>
</span><span id="Symmetries.plot-450"><a href="#Symmetries.plot-450"><span class="linenos">450</span></a>      <span class="n">n_subplots</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rotation_shifts</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">reflection_shifts</span><span class="p">)</span>
</span><span id="Symmetries.plot-451"><a href="#Symmetries.plot-451"><span class="linenos">451</span></a>    <span class="k">elif</span> <span class="n">which</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;rot&quot;</span><span class="p">:</span>
</span><span id="Symmetries.plot-452"><a href="#Symmetries.plot-452"><span class="linenos">452</span></a>      <span class="n">n_subplots</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rotation_shifts</span><span class="p">)</span>
</span><span id="Symmetries.plot-453"><a href="#Symmetries.plot-453"><span class="linenos">453</span></a>    <span class="k">elif</span> <span class="n">which</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;ref&quot;</span><span class="p">:</span>
</span><span id="Symmetries.plot-454"><a href="#Symmetries.plot-454"><span class="linenos">454</span></a>      <span class="n">n_subplots</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">reflection_shifts</span><span class="p">)</span>
</span><span id="Symmetries.plot-455"><a href="#Symmetries.plot-455"><span class="linenos">455</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="Symmetries.plot-456"><a href="#Symmetries.plot-456"><span class="linenos">456</span></a>      <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Please specify symmetries to plot using the which parameter!&quot;</span><span class="p">)</span>
</span><span id="Symmetries.plot-457"><a href="#Symmetries.plot-457"><span class="linenos">457</span></a>      <span class="k">return</span>
</span><span id="Symmetries.plot-458"><a href="#Symmetries.plot-458"><span class="linenos">458</span></a>    
</span><span id="Symmetries.plot-459"><a href="#Symmetries.plot-459"><span class="linenos">459</span></a>    <span class="n">nr</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">n_subplots</span><span class="p">)))</span>
</span><span id="Symmetries.plot-460"><a href="#Symmetries.plot-460"><span class="linenos">460</span></a>    <span class="n">nc</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">n_subplots</span> <span class="o">/</span> <span class="n">nr</span><span class="p">))</span>
</span><span id="Symmetries.plot-461"><a href="#Symmetries.plot-461"><span class="linenos">461</span></a>    <span class="n">nplots</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Symmetries.plot-462"><a href="#Symmetries.plot-462"><span class="linenos">462</span></a>    <span class="n">mrr</span> <span class="o">=</span> <span class="n">shapely</span><span class="o">.</span><span class="n">oriented_envelope</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">polygon</span><span class="p">)</span>
</span><span id="Symmetries.plot-463"><a href="#Symmetries.plot-463"><span class="linenos">463</span></a>    <span class="n">w</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">tiling_utils</span><span class="o">.</span><span class="n">get_side_lengths</span><span class="p">(</span><span class="n">mrr</span><span class="p">)[:</span><span class="mi">2</span><span class="p">])</span>
</span><span id="Symmetries.plot-464"><a href="#Symmetries.plot-464"><span class="linenos">464</span></a>
</span><span id="Symmetries.plot-465"><a href="#Symmetries.plot-465"><span class="linenos">465</span></a>    <span class="n">fig</span> <span class="o">=</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
</span><span id="Symmetries.plot-466"><a href="#Symmetries.plot-466"><span class="linenos">466</span></a>    <span class="n">labels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_unique_labels</span><span class="p">()</span>
</span><span id="Symmetries.plot-467"><a href="#Symmetries.plot-467"><span class="linenos">467</span></a>    <span class="n">c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">polygon</span><span class="o">.</span><span class="n">centroid</span>
</span><span id="Symmetries.plot-468"><a href="#Symmetries.plot-468"><span class="linenos">468</span></a>
</span><span id="Symmetries.plot-469"><a href="#Symmetries.plot-469"><span class="linenos">469</span></a>    <span class="k">if</span> <span class="n">which</span> <span class="o">==</span> <span class="s2">&quot;both&quot;</span> <span class="ow">or</span> <span class="n">which</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;rot&quot;</span><span class="p">:</span>
</span><span id="Symmetries.plot-470"><a href="#Symmetries.plot-470"><span class="linenos">470</span></a>      <span class="n">rotations</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_rotations</span><span class="p">()[</span><span class="s2">&quot;angles&quot;</span><span class="p">]</span>
</span><span id="Symmetries.plot-471"><a href="#Symmetries.plot-471"><span class="linenos">471</span></a>      <span class="k">for</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">rotn</span><span class="p">),</span> <span class="n">label</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="nb">enumerate</span><span class="p">(</span><span class="n">rotations</span><span class="p">),</span> <span class="n">labels</span><span class="p">[</span><span class="s2">&quot;rotations&quot;</span><span class="p">]):</span>
</span><span id="Symmetries.plot-472"><a href="#Symmetries.plot-472"><span class="linenos">472</span></a>        <span class="n">nplots</span> <span class="o">=</span> <span class="n">nplots</span> <span class="o">+</span> <span class="mi">1</span>
</span><span id="Symmetries.plot-473"><a href="#Symmetries.plot-473"><span class="linenos">473</span></a>        <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">nr</span><span class="p">,</span> <span class="n">nc</span><span class="p">,</span> <span class="n">nplots</span><span class="p">)</span>
</span><span id="Symmetries.plot-474"><a href="#Symmetries.plot-474"><span class="linenos">474</span></a>        <span class="n">gpd</span><span class="o">.</span><span class="n">GeoSeries</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">polygon</span><span class="p">])</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span> <span class="o">=</span> <span class="n">ax</span><span class="p">,</span> <span class="n">fc</span> <span class="o">=</span> <span class="s2">&quot;lightgrey&quot;</span><span class="p">,</span> <span class="n">lw</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="Symmetries.plot-475"><a href="#Symmetries.plot-475"><span class="linenos">475</span></a>        <span class="k">for</span> <span class="n">lbl</span><span class="p">,</span> <span class="n">pt</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">label</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">polygon</span><span class="o">.</span><span class="n">exterior</span><span class="o">.</span><span class="n">coords</span><span class="p">):</span>
</span><span id="Symmetries.plot-476"><a href="#Symmetries.plot-476"><span class="linenos">476</span></a>          <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">lbl</span><span class="p">,</span> <span class="n">xy</span> <span class="o">=</span> <span class="n">pt</span><span class="p">,</span> <span class="n">ha</span> <span class="o">=</span> <span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">va</span> <span class="o">=</span> <span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">14</span><span class="p">)</span>
</span><span id="Symmetries.plot-477"><a href="#Symmetries.plot-477"><span class="linenos">477</span></a>        <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Symmetries.plot-478"><a href="#Symmetries.plot-478"><span class="linenos">478</span></a>          <span class="n">rotn</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">rotn</span><span class="p">)</span> 
</span><span id="Symmetries.plot-479"><a href="#Symmetries.plot-479"><span class="linenos">479</span></a>          <span class="n">arc</span> <span class="o">=</span> <span class="n">geom</span><span class="o">.</span><span class="n">LineString</span><span class="p">(</span>
</span><span id="Symmetries.plot-480"><a href="#Symmetries.plot-480"><span class="linenos">480</span></a>            <span class="p">[[</span><span class="n">w</span><span class="o">/</span><span class="mi">6</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="n">w</span><span class="o">/</span><span class="mi">6</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">a</span><span class="p">)]</span>
</span><span id="Symmetries.plot-481"><a href="#Symmetries.plot-481"><span class="linenos">481</span></a>             <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">rotn</span><span class="p">,</span> <span class="mi">50</span><span class="p">)])</span>
</span><span id="Symmetries.plot-482"><a href="#Symmetries.plot-482"><span class="linenos">482</span></a>          <span class="n">angle</span> <span class="o">=</span> <span class="n">geom</span><span class="o">.</span><span class="n">LineString</span><span class="p">(</span>
</span><span id="Symmetries.plot-483"><a href="#Symmetries.plot-483"><span class="linenos">483</span></a>            <span class="p">[(</span><span class="n">w</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> 
</span><span id="Symmetries.plot-484"><a href="#Symmetries.plot-484"><span class="linenos">484</span></a>             <span class="p">(</span><span class="n">w</span><span class="o">/</span><span class="mi">4</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">rotn</span><span class="p">),</span> <span class="n">w</span><span class="o">/</span><span class="mi">4</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">rotn</span><span class="p">))])</span>
</span><span id="Symmetries.plot-485"><a href="#Symmetries.plot-485"><span class="linenos">485</span></a>          <span class="n">ls</span> <span class="o">=</span> <span class="p">[</span><span class="n">affine</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">y</span><span class="p">)</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="p">[</span><span class="n">arc</span><span class="p">,</span> <span class="n">angle</span><span class="p">]]</span>
</span><span id="Symmetries.plot-486"><a href="#Symmetries.plot-486"><span class="linenos">486</span></a>          <span class="n">gpd</span><span class="o">.</span><span class="n">GeoSeries</span><span class="p">(</span><span class="n">ls</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span> <span class="o">=</span> <span class="n">ax</span><span class="p">,</span> <span class="n">ec</span> <span class="o">=</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="n">lw</span> <span class="o">=</span> <span class="mf">0.35</span><span class="p">)</span>
</span><span id="Symmetries.plot-487"><a href="#Symmetries.plot-487"><span class="linenos">487</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">get_corner_labels</span><span class="p">()</span>
</span><span id="Symmetries.plot-488"><a href="#Symmetries.plot-488"><span class="linenos">488</span></a>        <span class="n">pyplot</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>
</span><span id="Symmetries.plot-489"><a href="#Symmetries.plot-489"><span class="linenos">489</span></a>        
</span><span id="Symmetries.plot-490"><a href="#Symmetries.plot-490"><span class="linenos">490</span></a>    <span class="k">if</span> <span class="n">which</span> <span class="o">==</span> <span class="s2">&quot;both&quot;</span> <span class="ow">or</span> <span class="n">which</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;ref&quot;</span><span class="p">:</span>
</span><span id="Symmetries.plot-491"><a href="#Symmetries.plot-491"><span class="linenos">491</span></a>      <span class="n">reflections</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_reflections</span><span class="p">()[</span><span class="s2">&quot;angles&quot;</span><span class="p">]</span>
</span><span id="Symmetries.plot-492"><a href="#Symmetries.plot-492"><span class="linenos">492</span></a>      <span class="k">for</span> <span class="n">refn</span><span class="p">,</span> <span class="n">label</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">reflections</span><span class="p">,</span> <span class="n">labels</span><span class="p">[</span><span class="s2">&quot;reflections&quot;</span><span class="p">]):</span>
</span><span id="Symmetries.plot-493"><a href="#Symmetries.plot-493"><span class="linenos">493</span></a>        <span class="n">nplots</span> <span class="o">=</span> <span class="n">nplots</span> <span class="o">+</span> <span class="mi">1</span>
</span><span id="Symmetries.plot-494"><a href="#Symmetries.plot-494"><span class="linenos">494</span></a>        <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">nr</span><span class="p">,</span> <span class="n">nc</span><span class="p">,</span> <span class="n">nplots</span><span class="p">)</span>
</span><span id="Symmetries.plot-495"><a href="#Symmetries.plot-495"><span class="linenos">495</span></a>        <span class="n">gpd</span><span class="o">.</span><span class="n">GeoSeries</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">polygon</span><span class="p">])</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span> <span class="o">=</span> <span class="n">ax</span><span class="p">,</span> <span class="n">fc</span> <span class="o">=</span> <span class="s2">&quot;lightgrey&quot;</span><span class="p">,</span> <span class="n">lw</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="Symmetries.plot-496"><a href="#Symmetries.plot-496"><span class="linenos">496</span></a>        <span class="k">for</span> <span class="n">lbl</span><span class="p">,</span> <span class="n">pt</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">label</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">polygon</span><span class="o">.</span><span class="n">exterior</span><span class="o">.</span><span class="n">coords</span><span class="p">):</span>
</span><span id="Symmetries.plot-497"><a href="#Symmetries.plot-497"><span class="linenos">497</span></a>          <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">lbl</span><span class="p">,</span> <span class="n">xy</span> <span class="o">=</span> <span class="n">pt</span><span class="p">,</span> <span class="n">ha</span> <span class="o">=</span> <span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">va</span> <span class="o">=</span> <span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">14</span><span class="p">)</span>
</span><span id="Symmetries.plot-498"><a href="#Symmetries.plot-498"><span class="linenos">498</span></a>        <span class="n">ls</span> <span class="o">=</span> <span class="n">geom</span><span class="o">.</span><span class="n">LineString</span><span class="p">([(</span><span class="o">-</span><span class="n">h</span><span class="o">/</span><span class="mi">2</span> <span class="o">*</span> <span class="mf">1.1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="n">h</span><span class="o">/</span><span class="mi">2</span> <span class="o">*</span> <span class="mf">1.1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)])</span>
</span><span id="Symmetries.plot-499"><a href="#Symmetries.plot-499"><span class="linenos">499</span></a>        <span class="n">ls</span> <span class="o">=</span> <span class="n">affine</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span><span class="n">ls</span><span class="p">,</span> <span class="n">refn</span><span class="p">)</span>
</span><span id="Symmetries.plot-500"><a href="#Symmetries.plot-500"><span class="linenos">500</span></a>        <span class="n">ls</span> <span class="o">=</span> <span class="n">affine</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="n">ls</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
</span><span id="Symmetries.plot-501"><a href="#Symmetries.plot-501"><span class="linenos">501</span></a>        <span class="n">gpd</span><span class="o">.</span><span class="n">GeoSeries</span><span class="p">([</span><span class="n">ls</span><span class="p">])</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span> <span class="o">=</span> <span class="n">ax</span><span class="p">,</span> <span class="n">ec</span> <span class="o">=</span> <span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">ls</span> <span class="o">=</span> <span class="s2">&quot;dashed&quot;</span><span class="p">,</span> <span class="n">lw</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">)</span>
</span><span id="Symmetries.plot-502"><a href="#Symmetries.plot-502"><span class="linenos">502</span></a>        <span class="n">pyplot</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>
</span><span id="Symmetries.plot-503"><a href="#Symmetries.plot-503"><span class="linenos">503</span></a>
</span><span id="Symmetries.plot-504"><a href="#Symmetries.plot-504"><span class="linenos">504</span></a>    <span class="k">return</span> <span class="n">ax</span>
</span></pre></div>


    

                            </div>
                            <div id="Symmetries.find_matches" class="classattr">
                                        <input id="Symmetries.find_matches-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">find_matches</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">seq</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span>,</span><span class="param">	<span class="n">pat</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span>,</span><span class="param">	<span class="n">equals</span><span class="o">=&lt;</span><span class="n">function</span> <span class="n">_equal_tuples</span><span class="o">&gt;</span></span><span class="return-annotation">) -> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="Symmetries.find_matches-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Symmetries.find_matches"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Symmetries.find_matches-507"><a href="#Symmetries.find_matches-507"><span class="linenos">507</span></a>  <span class="k">def</span> <span class="nf">find_matches</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">seq</span><span class="p">:</span><span class="n">Iterable</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">]],</span> 
</span><span id="Symmetries.find_matches-508"><a href="#Symmetries.find_matches-508"><span class="linenos">508</span></a>                   <span class="n">pat</span><span class="p">:</span><span class="n">Iterable</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">]],</span>
</span><span id="Symmetries.find_matches-509"><a href="#Symmetries.find_matches-509"><span class="linenos">509</span></a>                   <span class="n">equals</span> <span class="o">=</span> <span class="n">_equal_tuples</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
</span><span id="Symmetries.find_matches-510"><a href="#Symmetries.find_matches-510"><span class="linenos">510</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot; Implements Knuth-Morris-Pratt string pattern matching algorithm. See:</span>
</span><span id="Symmetries.find_matches-511"><a href="#Symmetries.find_matches-511"><span class="linenos">511</span></a><span class="sd">    https://en.wikipedia.org/wiki/KnuthMorrisPratt_algorithm which provides</span>
</span><span id="Symmetries.find_matches-512"><a href="#Symmetries.find_matches-512"><span class="linenos">512</span></a><span class="sd">    detailed pseudo-code on which this code is directly based. This</span>
</span><span id="Symmetries.find_matches-513"><a href="#Symmetries.find_matches-513"><span class="linenos">513</span></a><span class="sd">    implementation expects sequences of tuples of floats, although in principle</span>
</span><span id="Symmetries.find_matches-514"><a href="#Symmetries.find_matches-514"><span class="linenos">514</span></a><span class="sd">    any objects could be contained in the Iterables. The default equality</span>
</span><span id="Symmetries.find_matches-515"><a href="#Symmetries.find_matches-515"><span class="linenos">515</span></a><span class="sd">    function tests for close matches, not exact equality.</span>
</span><span id="Symmetries.find_matches-516"><a href="#Symmetries.find_matches-516"><span class="linenos">516</span></a>
</span><span id="Symmetries.find_matches-517"><a href="#Symmetries.find_matches-517"><span class="linenos">517</span></a><span class="sd">    Args:</span>
</span><span id="Symmetries.find_matches-518"><a href="#Symmetries.find_matches-518"><span class="linenos">518</span></a><span class="sd">      seq (Iterable[tuple[float]]): The sequence of float tuples to find   </span>
</span><span id="Symmetries.find_matches-519"><a href="#Symmetries.find_matches-519"><span class="linenos">519</span></a><span class="sd">        matches in.</span>
</span><span id="Symmetries.find_matches-520"><a href="#Symmetries.find_matches-520"><span class="linenos">520</span></a><span class="sd">      pat (Iterable[tuple[float]]): The sequence to match.</span>
</span><span id="Symmetries.find_matches-521"><a href="#Symmetries.find_matches-521"><span class="linenos">521</span></a><span class="sd">      equals (function, optional): A function to use to test for equality of</span>
</span><span id="Symmetries.find_matches-522"><a href="#Symmetries.find_matches-522"><span class="linenos">522</span></a><span class="sd">        elements in patterns. Defaults to _equal_tuples().</span>
</span><span id="Symmetries.find_matches-523"><a href="#Symmetries.find_matches-523"><span class="linenos">523</span></a>
</span><span id="Symmetries.find_matches-524"><a href="#Symmetries.find_matches-524"><span class="linenos">524</span></a><span class="sd">    Returns:</span>
</span><span id="Symmetries.find_matches-525"><a href="#Symmetries.find_matches-525"><span class="linenos">525</span></a><span class="sd">        Iterable[int]: _description_</span>
</span><span id="Symmetries.find_matches-526"><a href="#Symmetries.find_matches-526"><span class="linenos">526</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Symmetries.find_matches-527"><a href="#Symmetries.find_matches-527"><span class="linenos">527</span></a>    <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
</span><span id="Symmetries.find_matches-528"><a href="#Symmetries.find_matches-528"><span class="linenos">528</span></a>    <span class="n">finds</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Symmetries.find_matches-529"><a href="#Symmetries.find_matches-529"><span class="linenos">529</span></a>    <span class="n">table</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_table</span><span class="p">(</span><span class="n">pat</span><span class="p">,</span> <span class="n">equals</span><span class="p">)</span>
</span><span id="Symmetries.find_matches-530"><a href="#Symmetries.find_matches-530"><span class="linenos">530</span></a>    <span class="k">while</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">seq</span><span class="p">):</span>
</span><span id="Symmetries.find_matches-531"><a href="#Symmetries.find_matches-531"><span class="linenos">531</span></a>      <span class="k">if</span> <span class="n">equals</span><span class="p">(</span><span class="n">pat</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">seq</span><span class="p">[</span><span class="n">j</span><span class="p">]):</span>
</span><span id="Symmetries.find_matches-532"><a href="#Symmetries.find_matches-532"><span class="linenos">532</span></a>        <span class="n">j</span> <span class="o">=</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span>
</span><span id="Symmetries.find_matches-533"><a href="#Symmetries.find_matches-533"><span class="linenos">533</span></a>        <span class="n">k</span> <span class="o">=</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span>
</span><span id="Symmetries.find_matches-534"><a href="#Symmetries.find_matches-534"><span class="linenos">534</span></a>        <span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">pat</span><span class="p">):</span>
</span><span id="Symmetries.find_matches-535"><a href="#Symmetries.find_matches-535"><span class="linenos">535</span></a>          <span class="n">finds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">j</span> <span class="o">-</span> <span class="n">k</span><span class="p">)</span>
</span><span id="Symmetries.find_matches-536"><a href="#Symmetries.find_matches-536"><span class="linenos">536</span></a>          <span class="n">k</span> <span class="o">=</span> <span class="n">table</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
</span><span id="Symmetries.find_matches-537"><a href="#Symmetries.find_matches-537"><span class="linenos">537</span></a>      <span class="k">else</span><span class="p">:</span>
</span><span id="Symmetries.find_matches-538"><a href="#Symmetries.find_matches-538"><span class="linenos">538</span></a>        <span class="n">k</span> <span class="o">=</span> <span class="n">table</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
</span><span id="Symmetries.find_matches-539"><a href="#Symmetries.find_matches-539"><span class="linenos">539</span></a>        <span class="k">if</span> <span class="n">k</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Symmetries.find_matches-540"><a href="#Symmetries.find_matches-540"><span class="linenos">540</span></a>          <span class="n">j</span> <span class="o">=</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span>
</span><span id="Symmetries.find_matches-541"><a href="#Symmetries.find_matches-541"><span class="linenos">541</span></a>          <span class="n">k</span> <span class="o">=</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span>
</span><span id="Symmetries.find_matches-542"><a href="#Symmetries.find_matches-542"><span class="linenos">542</span></a>    <span class="k">return</span> <span class="n">finds</span>
</span></pre></div>


            <div class="docstring"><p>Implements Knuth-Morris-Pratt string pattern matching algorithm. See:
<a href="https://en.wikipedia.org/wiki/KnuthMorrisPratt_algorithm">https://en.wikipedia.org/wiki/KnuthMorrisPratt_algorithm</a> which provides
detailed pseudo-code on which this code is directly based. This
implementation expects sequences of tuples of floats, although in principle
any objects could be contained in the Iterables. The default equality
function tests for close matches, not exact equality.</p>

<p>Args:
  seq (Iterable[tuple[float]]): The sequence of float tuples to find <br />
    matches in.
  pat (Iterable[tuple[float]]): The sequence to match.
  equals (function, optional): A function to use to test for equality of
    elements in patterns. Defaults to _equal_tuples().</p>

<p>Returns:
    Iterable[int]: _description_</p>
</div>


                            </div>
                            <div id="Symmetries.get_table" class="classattr">
                                        <input id="Symmetries.get_table-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_table</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">pattern</span><span class="p">:</span> <span class="n">Iterable</span>,</span><span class="param">	<span class="n">equals</span><span class="o">=&lt;</span><span class="n">function</span> <span class="n">_equal_tuples</span><span class="o">&gt;</span></span><span class="return-annotation">) -> <span class="n">Iterable</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="Symmetries.get_table-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Symmetries.get_table"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Symmetries.get_table-545"><a href="#Symmetries.get_table-545"><span class="linenos">545</span></a>  <span class="k">def</span> <span class="nf">get_table</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pattern</span><span class="p">:</span><span class="n">Iterable</span><span class="p">,</span>
</span><span id="Symmetries.get_table-546"><a href="#Symmetries.get_table-546"><span class="linenos">546</span></a>                <span class="n">equals</span> <span class="o">=</span> <span class="n">_equal_tuples</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
</span><span id="Symmetries.get_table-547"><a href="#Symmetries.get_table-547"><span class="linenos">547</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns the &#39;offsets&#39; table used by KMP pattern matching algorithm as</span>
</span><span id="Symmetries.get_table-548"><a href="#Symmetries.get_table-548"><span class="linenos">548</span></a><span class="sd">    required by self.find_matches, based on the supplied pattern.</span>
</span><span id="Symmetries.get_table-549"><a href="#Symmetries.get_table-549"><span class="linenos">549</span></a>
</span><span id="Symmetries.get_table-550"><a href="#Symmetries.get_table-550"><span class="linenos">550</span></a><span class="sd">    Args:</span>
</span><span id="Symmetries.get_table-551"><a href="#Symmetries.get_table-551"><span class="linenos">551</span></a><span class="sd">      pattern (Iterable): The pattern to set up the table for.</span>
</span><span id="Symmetries.get_table-552"><a href="#Symmetries.get_table-552"><span class="linenos">552</span></a><span class="sd">      equals (function, optional): A function to use to test for equality of</span>
</span><span id="Symmetries.get_table-553"><a href="#Symmetries.get_table-553"><span class="linenos">553</span></a><span class="sd">        elements in patterns. Defaults to _equal_tuples().</span>
</span><span id="Symmetries.get_table-554"><a href="#Symmetries.get_table-554"><span class="linenos">554</span></a>
</span><span id="Symmetries.get_table-555"><a href="#Symmetries.get_table-555"><span class="linenos">555</span></a><span class="sd">    Returns:</span>
</span><span id="Symmetries.get_table-556"><a href="#Symmetries.get_table-556"><span class="linenos">556</span></a><span class="sd">        Iterable[int]: _description_</span>
</span><span id="Symmetries.get_table-557"><a href="#Symmetries.get_table-557"><span class="linenos">557</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Symmetries.get_table-558"><a href="#Symmetries.get_table-558"><span class="linenos">558</span></a>    <span class="n">pos</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="Symmetries.get_table-559"><a href="#Symmetries.get_table-559"><span class="linenos">559</span></a>    <span class="n">cnd</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Symmetries.get_table-560"><a href="#Symmetries.get_table-560"><span class="linenos">560</span></a>    <span class="n">T</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">}</span>
</span><span id="Symmetries.get_table-561"><a href="#Symmetries.get_table-561"><span class="linenos">561</span></a>    <span class="k">while</span> <span class="n">pos</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">pattern</span><span class="p">):</span>
</span><span id="Symmetries.get_table-562"><a href="#Symmetries.get_table-562"><span class="linenos">562</span></a>      <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">pattern</span><span class="p">[</span><span class="n">pos</span><span class="p">],</span> <span class="n">pattern</span><span class="p">[</span><span class="n">cnd</span><span class="p">]):</span>
</span><span id="Symmetries.get_table-563"><a href="#Symmetries.get_table-563"><span class="linenos">563</span></a>        <span class="n">T</span><span class="p">[</span><span class="n">pos</span><span class="p">]</span> <span class="o">=</span> <span class="n">T</span><span class="p">[</span><span class="n">cnd</span><span class="p">]</span>
</span><span id="Symmetries.get_table-564"><a href="#Symmetries.get_table-564"><span class="linenos">564</span></a>      <span class="k">else</span><span class="p">:</span>
</span><span id="Symmetries.get_table-565"><a href="#Symmetries.get_table-565"><span class="linenos">565</span></a>        <span class="n">T</span><span class="p">[</span><span class="n">pos</span><span class="p">]</span> <span class="o">=</span> <span class="n">cnd</span>
</span><span id="Symmetries.get_table-566"><a href="#Symmetries.get_table-566"><span class="linenos">566</span></a>        <span class="k">while</span> <span class="n">cnd</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">equals</span><span class="p">(</span><span class="n">pattern</span><span class="p">[</span><span class="n">pos</span><span class="p">],</span> <span class="n">pattern</span><span class="p">[</span><span class="n">cnd</span><span class="p">]):</span>
</span><span id="Symmetries.get_table-567"><a href="#Symmetries.get_table-567"><span class="linenos">567</span></a>          <span class="n">cnd</span> <span class="o">=</span> <span class="n">T</span><span class="p">[</span><span class="n">cnd</span><span class="p">]</span>
</span><span id="Symmetries.get_table-568"><a href="#Symmetries.get_table-568"><span class="linenos">568</span></a>      <span class="n">pos</span> <span class="o">=</span> <span class="n">pos</span> <span class="o">+</span> <span class="mi">1</span>
</span><span id="Symmetries.get_table-569"><a href="#Symmetries.get_table-569"><span class="linenos">569</span></a>      <span class="n">cnd</span> <span class="o">=</span> <span class="n">cnd</span> <span class="o">+</span> <span class="mi">1</span>
</span><span id="Symmetries.get_table-570"><a href="#Symmetries.get_table-570"><span class="linenos">570</span></a>    <span class="n">T</span><span class="p">[</span><span class="n">pos</span><span class="p">]</span> <span class="o">=</span> <span class="n">cnd</span>
</span><span id="Symmetries.get_table-571"><a href="#Symmetries.get_table-571"><span class="linenos">571</span></a>    <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">T</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
</span></pre></div>


            <div class="docstring"><p>Returns the 'offsets' table used by KMP pattern matching algorithm as
required by self.find_matches, based on the supplied pattern.</p>

<p>Args:
  pattern (Iterable): The pattern to set up the table for.
  equals (function, optional): A function to use to test for equality of
    elements in patterns. Defaults to _equal_tuples().</p>

<p>Returns:
    Iterable[int]: _description_</p>
</div>


                            </div>
                </section>
    </main>
<script>
    function escapeHTML(html) {
        return document.createElement('div').appendChild(document.createTextNode(html)).parentNode.innerHTML;
    }

    const originalContent = document.querySelector("main.pdoc");
    let currentContent = originalContent;

    function setContent(innerHTML) {
        let elem;
        if (innerHTML) {
            elem = document.createElement("main");
            elem.classList.add("pdoc");
            elem.innerHTML = innerHTML;
        } else {
            elem = originalContent;
        }
        if (currentContent !== elem) {
            currentContent.replaceWith(elem);
            currentContent = elem;
        }
    }

    function getSearchTerm() {
        return (new URL(window.location)).searchParams.get("search");
    }

    const searchBox = document.querySelector(".pdoc input[type=search]");
    searchBox.addEventListener("input", function () {
        let url = new URL(window.location);
        if (searchBox.value.trim()) {
            url.hash = "";
            url.searchParams.set("search", searchBox.value);
        } else {
            url.searchParams.delete("search");
        }
        history.replaceState("", "", url.toString());
        onInput();
    });
    window.addEventListener("popstate", onInput);


    let search, searchErr;

    async function initialize() {
        try {
            search = await new Promise((resolve, reject) => {
                const script = document.createElement("script");
                script.type = "text/javascript";
                script.async = true;
                script.onload = () => resolve(window.pdocSearch);
                script.onerror = (e) => reject(e);
                script.src = "../search.js";
                document.getElementsByTagName("head")[0].appendChild(script);
            });
        } catch (e) {
            console.error("Cannot fetch pdoc search index");
            searchErr = "Cannot fetch search index.";
        }
        onInput();

        document.querySelector("nav.pdoc").addEventListener("click", e => {
            if (e.target.hash) {
                searchBox.value = "";
                searchBox.dispatchEvent(new Event("input"));
            }
        });
    }

    function onInput() {
        setContent((() => {
            const term = getSearchTerm();
            if (!term) {
                return null
            }
            if (searchErr) {
                return `<h3>Error: ${searchErr}</h3>`
            }
            if (!search) {
                return "<h3>Searching...</h3>"
            }

            window.scrollTo({top: 0, left: 0, behavior: 'auto'});

            const results = search(term);

            let html;
            if (results.length === 0) {
                html = `No search results for '${escapeHTML(term)}'.`
            } else {
                html = `<h4>${results.length} search result${results.length > 1 ? "s" : ""} for '${escapeHTML(term)}'.</h4>`;
            }
            for (let result of results.slice(0, 10)) {
                let doc = result.doc;
                let url = `../${doc.modulename.replaceAll(".", "/")}.html`;
                if (doc.qualname) {
                    url += `#${doc.qualname}`;
                }

                let heading;
                switch (result.doc.kind) {
                    case "function":
                        if (doc.fullname.endsWith(".__init__")) {
                            heading = `<span class="name">${doc.fullname.replace(/\.__init__$/, "")}</span>${doc.signature}`;
                        } else {
                            heading = `<span class="def">${doc.funcdef}</span> <span class="name">${doc.fullname}</span>${doc.signature}`;
                        }
                        break;
                    case "class":
                        heading = `<span class="def">class</span> <span class="name">${doc.fullname}</span>`;
                        if (doc.bases)
                            heading += `<wbr>(<span class="base">${doc.bases}</span>)`;
                        heading += `:`;
                        break;
                    case "variable":
                        heading = `<span class="name">${doc.fullname}</span>`;
                        if (doc.annotation)
                            heading += `<span class="annotation">${doc.annotation}</span>`;
                        if (doc.default_value)
                            heading += `<span class="default_value"> = ${doc.default_value}</span>`;
                        break;
                    default:
                        heading = `<span class="name">${doc.fullname}</span>`;
                        break;
                }
                html += `
                        <section class="search-result">
                        <a href="${url}" class="attr ${doc.kind}">${heading}</a>
                        <div class="docstring">${doc.doc}</div>
                        </section>
                    `;

            }
            return html;
        })());
    }

    if (getSearchTerm()) {
        initialize();
        searchBox.value = getSearchTerm();
        onInput();
    } else {
        searchBox.addEventListener("focus", initialize, {once: true});
    }

    searchBox.addEventListener("keydown", e => {
        if (["ArrowDown", "ArrowUp", "Enter"].includes(e.key)) {
            let focused = currentContent.querySelector(".search-result.focused");
            if (!focused) {
                currentContent.querySelector(".search-result").classList.add("focused");
            } else if (
                e.key === "ArrowDown"
                && focused.nextElementSibling
                && focused.nextElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.nextElementSibling.classList.add("focused");
                focused.nextElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "ArrowUp"
                && focused.previousElementSibling
                && focused.previousElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.previousElementSibling.classList.add("focused");
                focused.previousElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "Enter"
            ) {
                focused.querySelector("a").click();
            }
        }
    });
</script></body>
</html>