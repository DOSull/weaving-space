<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="pdoc 15.0.4"/>
    <title>weavingspace.topology API documentation</title>

    <style>/*! * Bootstrap Reboot v5.0.0 (https://getbootstrap.com/) * Copyright 2011-2021 The Bootstrap Authors * Copyright 2011-2021 Twitter, Inc. * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE) * Forked from Normalize.css, licensed MIT (https://github.com/necolas/normalize.css/blob/master/LICENSE.md) */*,::after,::before{box-sizing:border-box}@media (prefers-reduced-motion:no-preference){:root{scroll-behavior:smooth}}body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Liberation Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;background-color:#fff;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}hr{margin:1rem 0;color:inherit;background-color:currentColor;border:0;opacity:.25}hr:not([size]){height:1px}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem;font-weight:500;line-height:1.2}h1{font-size:calc(1.375rem + 1.5vw)}@media (min-width:1200px){h1{font-size:2.5rem}}h2{font-size:calc(1.325rem + .9vw)}@media (min-width:1200px){h2{font-size:2rem}}h3{font-size:calc(1.3rem + .6vw)}@media (min-width:1200px){h3{font-size:1.75rem}}h4{font-size:calc(1.275rem + .3vw)}@media (min-width:1200px){h4{font-size:1.5rem}}h5{font-size:1.25rem}h6{font-size:1rem}p{margin-top:0;margin-bottom:1rem}abbr[data-bs-original-title],abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address{margin-bottom:1rem;font-style:normal;line-height:inherit}ol,ul{padding-left:2rem}dl,ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}dt{font-weight:700}dd{margin-bottom:.5rem;margin-left:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}small{font-size:.875em}mark{padding:.2em;background-color:#fcf8e3}sub,sup{position:relative;font-size:.75em;line-height:0;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}a{color:#0d6efd;text-decoration:underline}a:hover{color:#0a58ca}a:not([href]):not([class]),a:not([href]):not([class]):hover{color:inherit;text-decoration:none}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em;direction:ltr;unicode-bidi:bidi-override}pre{display:block;margin-top:0;margin-bottom:1rem;overflow:auto;font-size:.875em}pre code{font-size:inherit;color:inherit;word-break:normal}code{font-size:.875em;color:#d63384;word-wrap:break-word}a>code{color:inherit}kbd{padding:.2rem .4rem;font-size:.875em;color:#fff;background-color:#212529;border-radius:.2rem}kbd kbd{padding:0;font-size:1em;font-weight:700}figure{margin:0 0 1rem}img,svg{vertical-align:middle}table{caption-side:bottom;border-collapse:collapse}caption{padding-top:.5rem;padding-bottom:.5rem;color:#6c757d;text-align:left}th{text-align:inherit;text-align:-webkit-match-parent}tbody,td,tfoot,th,thead,tr{border-color:inherit;border-style:solid;border-width:0}label{display:inline-block}button{border-radius:0}button:focus:not(:focus-visible){outline:0}button,input,optgroup,select,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,select{text-transform:none}[role=button]{cursor:pointer}select{word-wrap:normal}select:disabled{opacity:1}[list]::-webkit-calendar-picker-indicator{display:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled),button:not(:disabled){cursor:pointer}::-moz-focus-inner{padding:0;border-style:none}textarea{resize:vertical}fieldset{min-width:0;padding:0;margin:0;border:0}legend{float:left;width:100%;padding:0;margin-bottom:.5rem;font-size:calc(1.275rem + .3vw);line-height:inherit}@media (min-width:1200px){legend{font-size:1.5rem}}legend+*{clear:left}::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-fields-wrapper,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-text,::-webkit-datetime-edit-year-field{padding:0}::-webkit-inner-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:textfield}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-color-swatch-wrapper{padding:0}::file-selector-button{font:inherit}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}output{display:inline-block}iframe{border:0}summary{display:list-item;cursor:pointer}progress{vertical-align:baseline}[hidden]{display:none!important}</style>
    <style>/*! syntax-highlighting.css */pre{line-height:125%;}span.linenos{color:inherit; background-color:transparent; padding-left:5px; padding-right:20px;}.pdoc-code .hll{background-color:#ffffcc}.pdoc-code{background:#f8f8f8;}.pdoc-code .c{color:#3D7B7B; font-style:italic}.pdoc-code .err{border:1px solid #FF0000}.pdoc-code .k{color:#008000; font-weight:bold}.pdoc-code .o{color:#666666}.pdoc-code .ch{color:#3D7B7B; font-style:italic}.pdoc-code .cm{color:#3D7B7B; font-style:italic}.pdoc-code .cp{color:#9C6500}.pdoc-code .cpf{color:#3D7B7B; font-style:italic}.pdoc-code .c1{color:#3D7B7B; font-style:italic}.pdoc-code .cs{color:#3D7B7B; font-style:italic}.pdoc-code .gd{color:#A00000}.pdoc-code .ge{font-style:italic}.pdoc-code .gr{color:#E40000}.pdoc-code .gh{color:#000080; font-weight:bold}.pdoc-code .gi{color:#008400}.pdoc-code .go{color:#717171}.pdoc-code .gp{color:#000080; font-weight:bold}.pdoc-code .gs{font-weight:bold}.pdoc-code .gu{color:#800080; font-weight:bold}.pdoc-code .gt{color:#0044DD}.pdoc-code .kc{color:#008000; font-weight:bold}.pdoc-code .kd{color:#008000; font-weight:bold}.pdoc-code .kn{color:#008000; font-weight:bold}.pdoc-code .kp{color:#008000}.pdoc-code .kr{color:#008000; font-weight:bold}.pdoc-code .kt{color:#B00040}.pdoc-code .m{color:#666666}.pdoc-code .s{color:#BA2121}.pdoc-code .na{color:#687822}.pdoc-code .nb{color:#008000}.pdoc-code .nc{color:#0000FF; font-weight:bold}.pdoc-code .no{color:#880000}.pdoc-code .nd{color:#AA22FF}.pdoc-code .ni{color:#717171; font-weight:bold}.pdoc-code .ne{color:#CB3F38; font-weight:bold}.pdoc-code .nf{color:#0000FF}.pdoc-code .nl{color:#767600}.pdoc-code .nn{color:#0000FF; font-weight:bold}.pdoc-code .nt{color:#008000; font-weight:bold}.pdoc-code .nv{color:#19177C}.pdoc-code .ow{color:#AA22FF; font-weight:bold}.pdoc-code .w{color:#bbbbbb}.pdoc-code .mb{color:#666666}.pdoc-code .mf{color:#666666}.pdoc-code .mh{color:#666666}.pdoc-code .mi{color:#666666}.pdoc-code .mo{color:#666666}.pdoc-code .sa{color:#BA2121}.pdoc-code .sb{color:#BA2121}.pdoc-code .sc{color:#BA2121}.pdoc-code .dl{color:#BA2121}.pdoc-code .sd{color:#BA2121; font-style:italic}.pdoc-code .s2{color:#BA2121}.pdoc-code .se{color:#AA5D1F; font-weight:bold}.pdoc-code .sh{color:#BA2121}.pdoc-code .si{color:#A45A77; font-weight:bold}.pdoc-code .sx{color:#008000}.pdoc-code .sr{color:#A45A77}.pdoc-code .s1{color:#BA2121}.pdoc-code .ss{color:#19177C}.pdoc-code .bp{color:#008000}.pdoc-code .fm{color:#0000FF}.pdoc-code .vc{color:#19177C}.pdoc-code .vg{color:#19177C}.pdoc-code .vi{color:#19177C}.pdoc-code .vm{color:#19177C}.pdoc-code .il{color:#666666}</style>
    <style>/*! theme.css */:root{--pdoc-background:#fff;}.pdoc{--text:#212529;--muted:#6c757d;--link:#3660a5;--link-hover:#1659c5;--code:#f8f8f8;--active:#fff598;--accent:#eee;--accent2:#c1c1c1;--nav-hover:rgba(255, 255, 255, 0.5);--name:#0066BB;--def:#008800;--annotation:#007020;}</style>
    <style>/*! layout.css */html, body{width:100%;height:100%;}html, main{scroll-behavior:smooth;}body{background-color:var(--pdoc-background);}@media (max-width:769px){#navtoggle{cursor:pointer;position:absolute;width:50px;height:40px;top:1rem;right:1rem;border-color:var(--text);color:var(--text);display:flex;opacity:0.8;z-index:999;}#navtoggle:hover{opacity:1;}#togglestate + div{display:none;}#togglestate:checked + div{display:inherit;}main, header{padding:2rem 3vw;}header + main{margin-top:-3rem;}.git-button{display:none !important;}nav input[type="search"]{max-width:77%;}nav input[type="search"]:first-child{margin-top:-6px;}nav input[type="search"]:valid ~ *{display:none !important;}}@media (min-width:770px){:root{--sidebar-width:clamp(12.5rem, 28vw, 22rem);}nav{position:fixed;overflow:auto;height:100vh;width:var(--sidebar-width);}main, header{padding:3rem 2rem 3rem calc(var(--sidebar-width) + 3rem);width:calc(54rem + var(--sidebar-width));max-width:100%;}header + main{margin-top:-4rem;}#navtoggle{display:none;}}#togglestate{position:absolute;height:0;opacity:0;}nav.pdoc{--pad:clamp(0.5rem, 2vw, 1.75rem);--indent:1.5rem;background-color:var(--accent);border-right:1px solid var(--accent2);box-shadow:0 0 20px rgba(50, 50, 50, .2) inset;padding:0 0 0 var(--pad);overflow-wrap:anywhere;scrollbar-width:thin; scrollbar-color:var(--accent2) transparent; z-index:1}nav.pdoc::-webkit-scrollbar{width:.4rem; }nav.pdoc::-webkit-scrollbar-thumb{background-color:var(--accent2); }nav.pdoc > div{padding:var(--pad) 0;}nav.pdoc .module-list-button{display:inline-flex;align-items:center;color:var(--text);border-color:var(--muted);margin-bottom:1rem;}nav.pdoc .module-list-button:hover{border-color:var(--text);}nav.pdoc input[type=search]{display:block;outline-offset:0;width:calc(100% - var(--pad));}nav.pdoc .logo{max-width:calc(100% - var(--pad));max-height:35vh;display:block;margin:0 auto 1rem;transform:translate(calc(-.5 * var(--pad)), 0);}nav.pdoc ul{list-style:none;padding-left:0;}nav.pdoc > div > ul{margin-left:calc(0px - var(--pad));}nav.pdoc li a{padding:.2rem 0 .2rem calc(var(--pad) + var(--indent));}nav.pdoc > div > ul > li > a{padding-left:var(--pad);}nav.pdoc li{transition:all 100ms;}nav.pdoc li:hover{background-color:var(--nav-hover);}nav.pdoc a, nav.pdoc a:hover{color:var(--text);}nav.pdoc a{display:block;}nav.pdoc > h2:first-of-type{margin-top:1.5rem;}nav.pdoc .class:before{content:"class ";color:var(--muted);}nav.pdoc .function:after{content:"()";color:var(--muted);}nav.pdoc footer:before{content:"";display:block;width:calc(100% - var(--pad));border-top:solid var(--accent2) 1px;margin-top:1.5rem;padding-top:.5rem;}nav.pdoc footer{font-size:small;}</style>
    <style>/*! content.css */.pdoc{color:var(--text);box-sizing:border-box;line-height:1.5;background:none;}.pdoc .pdoc-button{cursor:pointer;display:inline-block;border:solid black 1px;border-radius:2px;font-size:.75rem;padding:calc(0.5em - 1px) 1em;transition:100ms all;}.pdoc .alert{padding:1rem 1rem 1rem calc(1.5rem + 24px);border:1px solid transparent;border-radius:.25rem;background-repeat:no-repeat;background-position:.75rem center;margin-bottom:1rem;}.pdoc .alert > em{display:none;}.pdoc .alert > *:last-child{margin-bottom:0;}.pdoc .alert.note{color:#084298;background-color:#cfe2ff;border-color:#b6d4fe;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23084298%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8%2016A8%208%200%201%200%208%200a8%208%200%200%200%200%2016zm.93-9.412-1%204.705c-.07.34.029.533.304.533.194%200%20.487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703%200-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381%202.29-.287zM8%205.5a1%201%200%201%201%200-2%201%201%200%200%201%200%202z%22/%3E%3C/svg%3E");}.pdoc .alert.tip{color:#0a3622;background-color:#d1e7dd;border-color:#a3cfbb;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%230a3622%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M2%206a6%206%200%201%201%2010.174%204.31c-.203.196-.359.4-.453.619l-.762%201.769A.5.5%200%200%201%2010.5%2013a.5.5%200%200%201%200%201%20.5.5%200%200%201%200%201l-.224.447a1%201%200%200%201-.894.553H6.618a1%201%200%200%201-.894-.553L5.5%2015a.5.5%200%200%201%200-1%20.5.5%200%200%201%200-1%20.5.5%200%200%201-.46-.302l-.761-1.77a2%202%200%200%200-.453-.618A5.98%205.98%200%200%201%202%206m6-5a5%205%200%200%200-3.479%208.592c.263.254.514.564.676.941L5.83%2012h4.342l.632-1.467c.162-.377.413-.687.676-.941A5%205%200%200%200%208%201%22/%3E%3C/svg%3E");}.pdoc .alert.important{color:#055160;background-color:#cff4fc;border-color:#9eeaf9;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23055160%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M2%200a2%202%200%200%200-2%202v12a2%202%200%200%200%202%202h12a2%202%200%200%200%202-2V2a2%202%200%200%200-2-2zm6%204c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%204.995A.905.905%200%200%201%208%204m.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2%22/%3E%3C/svg%3E");}.pdoc .alert.warning{color:#664d03;background-color:#fff3cd;border-color:#ffecb5;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23664d03%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8.982%201.566a1.13%201.13%200%200%200-1.96%200L.165%2013.233c-.457.778.091%201.767.98%201.767h13.713c.889%200%201.438-.99.98-1.767L8.982%201.566zM8%205c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%205.995A.905.905%200%200%201%208%205zm.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2z%22/%3E%3C/svg%3E");}.pdoc .alert.caution{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M11.46.146A.5.5%200%200%200%2011.107%200H4.893a.5.5%200%200%200-.353.146L.146%204.54A.5.5%200%200%200%200%204.893v6.214a.5.5%200%200%200%20.146.353l4.394%204.394a.5.5%200%200%200%20.353.146h6.214a.5.5%200%200%200%20.353-.146l4.394-4.394a.5.5%200%200%200%20.146-.353V4.893a.5.5%200%200%200-.146-.353zM8%204c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%204.995A.905.905%200%200%201%208%204m.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2%22/%3E%3C/svg%3E");}.pdoc .alert.danger{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M5.52.359A.5.5%200%200%201%206%200h4a.5.5%200%200%201%20.474.658L8.694%206H12.5a.5.5%200%200%201%20.395.807l-7%209a.5.5%200%200%201-.873-.454L6.823%209.5H3.5a.5.5%200%200%201-.48-.641l2.5-8.5z%22/%3E%3C/svg%3E");}.pdoc .visually-hidden{position:absolute !important;width:1px !important;height:1px !important;padding:0 !important;margin:-1px !important;overflow:hidden !important;clip:rect(0, 0, 0, 0) !important;white-space:nowrap !important;border:0 !important;}.pdoc h1, .pdoc h2, .pdoc h3{font-weight:300;margin:.3em 0;padding:.2em 0;}.pdoc > section:not(.module-info) h1{font-size:1.5rem;font-weight:500;}.pdoc > section:not(.module-info) h2{font-size:1.4rem;font-weight:500;}.pdoc > section:not(.module-info) h3{font-size:1.3rem;font-weight:500;}.pdoc > section:not(.module-info) h4{font-size:1.2rem;}.pdoc > section:not(.module-info) h5{font-size:1.1rem;}.pdoc a{text-decoration:none;color:var(--link);}.pdoc a:hover{color:var(--link-hover);}.pdoc blockquote{margin-left:2rem;}.pdoc pre{border-top:1px solid var(--accent2);border-bottom:1px solid var(--accent2);margin-top:0;margin-bottom:1em;padding:.5rem 0 .5rem .5rem;overflow-x:auto;background-color:var(--code);}.pdoc code{color:var(--text);padding:.2em .4em;margin:0;font-size:85%;background-color:var(--accent);border-radius:6px;}.pdoc a > code{color:inherit;}.pdoc pre > code{display:inline-block;font-size:inherit;background:none;border:none;padding:0;}.pdoc > section:not(.module-info){margin-bottom:1.5rem;}.pdoc .modulename{margin-top:0;font-weight:bold;}.pdoc .modulename a{color:var(--link);transition:100ms all;}.pdoc .git-button{float:right;border:solid var(--link) 1px;}.pdoc .git-button:hover{background-color:var(--link);color:var(--pdoc-background);}.view-source-toggle-state,.view-source-toggle-state ~ .pdoc-code{display:none;}.view-source-toggle-state:checked ~ .pdoc-code{display:block;}.view-source-button{display:inline-block;float:right;font-size:.75rem;line-height:1.5rem;color:var(--muted);padding:0 .4rem 0 1.3rem;cursor:pointer;text-indent:-2px;}.view-source-button > span{visibility:hidden;}.module-info .view-source-button{float:none;display:flex;justify-content:flex-end;margin:-1.2rem .4rem -.2rem 0;}.view-source-button::before{position:absolute;content:"View Source";display:list-item;list-style-type:disclosure-closed;}.view-source-toggle-state:checked ~ .attr .view-source-button::before,.view-source-toggle-state:checked ~ .view-source-button::before{list-style-type:disclosure-open;}.pdoc .docstring{margin-bottom:1.5rem;}.pdoc section:not(.module-info) .docstring{margin-left:clamp(0rem, 5vw - 2rem, 1rem);}.pdoc .docstring .pdoc-code{margin-left:1em;margin-right:1em;}.pdoc h1:target,.pdoc h2:target,.pdoc h3:target,.pdoc h4:target,.pdoc h5:target,.pdoc h6:target,.pdoc .pdoc-code > pre > span:target{background-color:var(--active);box-shadow:-1rem 0 0 0 var(--active);}.pdoc .pdoc-code > pre > span:target{display:block;}.pdoc div:target > .attr,.pdoc section:target > .attr,.pdoc dd:target > a{background-color:var(--active);}.pdoc *{scroll-margin:2rem;}.pdoc .pdoc-code .linenos{user-select:none;}.pdoc .attr:hover{filter:contrast(0.95);}.pdoc section, .pdoc .classattr{position:relative;}.pdoc .headerlink{--width:clamp(1rem, 3vw, 2rem);position:absolute;top:0;left:calc(0rem - var(--width));transition:all 100ms ease-in-out;opacity:0;}.pdoc .headerlink::before{content:"#";display:block;text-align:center;width:var(--width);height:2.3rem;line-height:2.3rem;font-size:1.5rem;}.pdoc .attr:hover ~ .headerlink,.pdoc *:target > .headerlink,.pdoc .headerlink:hover{opacity:1;}.pdoc .attr{display:block;margin:.5rem 0 .5rem;padding:.4rem .4rem .4rem 1rem;background-color:var(--accent);overflow-x:auto;}.pdoc .classattr{margin-left:2rem;}.pdoc .decorator-deprecated{color:#842029;}.pdoc .decorator-deprecated ~ span{filter:grayscale(1) opacity(0.8);}.pdoc .name{color:var(--name);font-weight:bold;}.pdoc .def{color:var(--def);font-weight:bold;}.pdoc .signature{background-color:transparent;}.pdoc .param, .pdoc .return-annotation{white-space:pre;}.pdoc .signature.multiline .param{display:block;}.pdoc .signature.condensed .param{display:inline-block;}.pdoc .annotation{color:var(--annotation);}.pdoc .view-value-toggle-state,.pdoc .view-value-toggle-state ~ .default_value{display:none;}.pdoc .view-value-toggle-state:checked ~ .default_value{display:inherit;}.pdoc .view-value-button{font-size:.5rem;vertical-align:middle;border-style:dashed;margin-top:-0.1rem;}.pdoc .view-value-button:hover{background:white;}.pdoc .view-value-button::before{content:"show";text-align:center;width:2.2em;display:inline-block;}.pdoc .view-value-toggle-state:checked ~ .view-value-button::before{content:"hide";}.pdoc .inherited{margin-left:2rem;}.pdoc .inherited dt{font-weight:700;}.pdoc .inherited dt, .pdoc .inherited dd{display:inline;margin-left:0;margin-bottom:.5rem;}.pdoc .inherited dd:not(:last-child):after{content:", ";}.pdoc .inherited .class:before{content:"class ";}.pdoc .inherited .function a:after{content:"()";}.pdoc .search-result .docstring{overflow:auto;max-height:25vh;}.pdoc .search-result.focused > .attr{background-color:var(--active);}.pdoc .attribution{margin-top:2rem;display:block;opacity:0.5;transition:all 200ms;filter:grayscale(100%);}.pdoc .attribution:hover{opacity:1;filter:grayscale(0%);}.pdoc .attribution img{margin-left:5px;height:35px;vertical-align:middle;width:70px;transition:all 200ms;}.pdoc table{display:block;width:max-content;max-width:100%;overflow:auto;margin-bottom:1rem;}.pdoc table th{font-weight:600;}.pdoc table th, .pdoc table td{padding:6px 13px;border:1px solid var(--accent2);}</style>
    <style>/*! custom.css */</style><script>
    window.MathJax = {
        tex: {
            inlineMath: [['$', '$'], ['\\(', '\\)']]
        }
    };
</script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<script>
    /* Re-invoke MathJax when DOM content changes, for example during search. */
    document.addEventListener("DOMContentLoaded", () => {
        new MutationObserver(() => MathJax.typeset()).observe(
            document.querySelector("main.pdoc").parentNode,
            {childList: true}
        );
    })
</script>
<style>
    mjx-container {
        overflow-x: auto;
        overflow-y: hidden;
    }
</style></head>
<body>
    <nav class="pdoc">
        <label id="navtoggle" for="togglestate" class="pdoc-button"><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'><path stroke-linecap='round' stroke="currentColor" stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/></svg></label>
        <input id="togglestate" type="checkbox" aria-hidden="true" tabindex="-1">
        <div>            <a class="pdoc-button module-list-button" href="../weavingspace.html">
<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-box-arrow-in-left" viewBox="0 0 16 16">
  <path fill-rule="evenodd" d="M10 3.5a.5.5 0 0 0-.5-.5h-8a.5.5 0 0 0-.5.5v9a.5.5 0 0 0 .5.5h8a.5.5 0 0 0 .5-.5v-2a.5.5 0 0 1 1 0v2A1.5 1.5 0 0 1 9.5 14h-8A1.5 1.5 0 0 1 0 12.5v-9A1.5 1.5 0 0 1 1.5 2h8A1.5 1.5 0 0 1 11 3.5v2a.5.5 0 0 1-1 0v-2z"/>
  <path fill-rule="evenodd" d="M4.146 8.354a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5H14.5a.5.5 0 0 1 0 1H5.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3z"/>
</svg>                &nbsp;weavingspace</a>


            <input type="search" placeholder="Search..." role="searchbox" aria-label="search"
                   pattern=".+" required>



            <h2>API Documentation</h2>
                <ul class="memberlist">
            <li>
                    <a class="variable" href="#LABELS">LABELS</a>
            </li>
            <li>
                    <a class="variable" href="#labels">labels</a>
            </li>
            <li>
                    <a class="class" href="#Topology">Topology</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#Topology.__init__">Topology</a>
                        </li>
                        <li>
                                <a class="variable" href="#Topology.tileable">tileable</a>
                        </li>
                        <li>
                                <a class="variable" href="#Topology.tiles">tiles</a>
                        </li>
                        <li>
                                <a class="variable" href="#Topology.points">points</a>
                        </li>
                        <li>
                                <a class="variable" href="#Topology.edges">edges</a>
                        </li>
                        <li>
                                <a class="variable" href="#Topology.unique_tile_shapes">unique_tile_shapes</a>
                        </li>
                        <li>
                                <a class="variable" href="#Topology.dual_tiles">dual_tiles</a>
                        </li>
                        <li>
                                <a class="variable" href="#Topology.n_tiles">n_tiles</a>
                        </li>
                        <li>
                                <a class="variable" href="#Topology.shape_groups">shape_groups</a>
                        </li>
                        <li>
                                <a class="variable" href="#Topology.tile_matching_transforms">tile_matching_transforms</a>
                        </li>
                        <li>
                                <a class="variable" href="#Topology.tile_transitivity_classes">tile_transitivity_classes</a>
                        </li>
                        <li>
                                <a class="variable" href="#Topology.vertex_transitivity_classes">vertex_transitivity_classes</a>
                        </li>
                        <li>
                                <a class="variable" href="#Topology.edge_transitivity_classes">edge_transitivity_classes</a>
                        </li>
                        <li>
                                <a class="function" href="#Topology.get_potential_symmetries">get_potential_symmetries</a>
                        </li>
                        <li>
                                <a class="function" href="#Topology.vertices_in_tiles">vertices_in_tiles</a>
                        </li>
                        <li>
                                <a class="function" href="#Topology.edges_in_tiles">edges_in_tiles</a>
                        </li>
                        <li>
                                <a class="function" href="#Topology.generate_dual">generate_dual</a>
                        </li>
                        <li>
                                <a class="function" href="#Topology.get_dual_tiles">get_dual_tiles</a>
                        </li>
                        <li>
                                <a class="function" href="#Topology.add_vertex">add_vertex</a>
                        </li>
                        <li>
                                <a class="function" href="#Topology.add_edge">add_edge</a>
                        </li>
                        <li>
                                <a class="function" href="#Topology.polygon_matches">polygon_matches</a>
                        </li>
                        <li>
                                <a class="function" href="#Topology.plot">plot</a>
                        </li>
                        <li>
                                <a class="function" href="#Topology.plot_tiling_symmetries">plot_tiling_symmetries</a>
                        </li>
                        <li>
                                <a class="function" href="#Topology.transform_geometry">transform_geometry</a>
                        </li>
                        <li>
                                <a class="function" href="#Topology.get_kwargs">get_kwargs</a>
                        </li>
                        <li>
                                <a class="function" href="#Topology.zigzag_edge">zigzag_edge</a>
                        </li>
                        <li>
                                <a class="function" href="#Topology.zigzag_between_points">zigzag_between_points</a>
                        </li>
                        <li>
                                <a class="function" href="#Topology.rotate_edge">rotate_edge</a>
                        </li>
                        <li>
                                <a class="function" href="#Topology.scale_edge">scale_edge</a>
                        </li>
                        <li>
                                <a class="function" href="#Topology.push_vertex">push_vertex</a>
                        </li>
                        <li>
                                <a class="function" href="#Topology.nudge_vertex">nudge_vertex</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#Tile">Tile</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#Tile.__init__">Tile</a>
                        </li>
                        <li>
                                <a class="variable" href="#Tile.ID">ID</a>
                        </li>
                        <li>
                                <a class="variable" href="#Tile.base_ID">base_ID</a>
                        </li>
                        <li>
                                <a class="variable" href="#Tile.corners">corners</a>
                        </li>
                        <li>
                                <a class="variable" href="#Tile.edges">edges</a>
                        </li>
                        <li>
                                <a class="variable" href="#Tile.edges_CW">edges_CW</a>
                        </li>
                        <li>
                                <a class="variable" href="#Tile.label">label</a>
                        </li>
                        <li>
                                <a class="variable" href="#Tile.vertex_labels">vertex_labels</a>
                        </li>
                        <li>
                                <a class="variable" href="#Tile.edge_labels">edge_labels</a>
                        </li>
                        <li>
                                <a class="variable" href="#Tile.shape">shape</a>
                        </li>
                        <li>
                                <a class="variable" href="#Tile.centre">centre</a>
                        </li>
                        <li>
                                <a class="variable" href="#Tile.shape_group">shape_group</a>
                        </li>
                        <li>
                                <a class="variable" href="#Tile.transitivity_class">transitivity_class</a>
                        </li>
                        <li>
                                <a class="function" href="#Tile.get_corner_IDs">get_corner_IDs</a>
                        </li>
                        <li>
                                <a class="function" href="#Tile.get_edge_IDs">get_edge_IDs</a>
                        </li>
                        <li>
                                <a class="function" href="#Tile.set_shape_from_corners">set_shape_from_corners</a>
                        </li>
                        <li>
                                <a class="function" href="#Tile.set_corners_from_edges">set_corners_from_edges</a>
                        </li>
                        <li>
                                <a class="function" href="#Tile.set_edge_directions">set_edge_directions</a>
                        </li>
                        <li>
                                <a class="function" href="#Tile.insert_vertex_at">insert_vertex_at</a>
                        </li>
                        <li>
                                <a class="function" href="#Tile.merge_edges_at_vertex">merge_edges_at_vertex</a>
                        </li>
                        <li>
                                <a class="function" href="#Tile.get_updated_edges_from_merge">get_updated_edges_from_merge</a>
                        </li>
                        <li>
                                <a class="function" href="#Tile.get_edge_IDs_including_vertex">get_edge_IDs_including_vertex</a>
                        </li>
                        <li>
                                <a class="function" href="#Tile.get_merged_edge">get_merged_edge</a>
                        </li>
                        <li>
                                <a class="function" href="#Tile.offset_corners">offset_corners</a>
                        </li>
                        <li>
                                <a class="function" href="#Tile.get_edge_label">get_edge_label</a>
                        </li>
                        <li>
                                <a class="function" href="#Tile.get_corner_label">get_corner_label</a>
                        </li>
                        <li>
                                <a class="function" href="#Tile.angle_at">angle_at</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#Vertex">Vertex</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#Vertex.__init__">Vertex</a>
                        </li>
                        <li>
                                <a class="variable" href="#Vertex.point">point</a>
                        </li>
                        <li>
                                <a class="variable" href="#Vertex.ID">ID</a>
                        </li>
                        <li>
                                <a class="variable" href="#Vertex.tiles">tiles</a>
                        </li>
                        <li>
                                <a class="variable" href="#Vertex.neighbours">neighbours</a>
                        </li>
                        <li>
                                <a class="variable" href="#Vertex.base_ID">base_ID</a>
                        </li>
                        <li>
                                <a class="variable" href="#Vertex.transitivity_class">transitivity_class</a>
                        </li>
                        <li>
                                <a class="variable" href="#Vertex.label">label</a>
                        </li>
                        <li>
                                <a class="variable" href="#Vertex.is_tiling_vertex">is_tiling_vertex</a>
                        </li>
                        <li>
                                <a class="function" href="#Vertex.get_tile_IDs">get_tile_IDs</a>
                        </li>
                        <li>
                                <a class="function" href="#Vertex.add_tile">add_tile</a>
                        </li>
                        <li>
                                <a class="function" href="#Vertex.add_neighbour">add_neighbour</a>
                        </li>
                        <li>
                                <a class="function" href="#Vertex.clockwise_order_incident_tiles">clockwise_order_incident_tiles</a>
                        </li>
                        <li>
                                <a class="function" href="#Vertex.is_interior">is_interior</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#Edge">Edge</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#Edge.__init__">Edge</a>
                        </li>
                        <li>
                                <a class="variable" href="#Edge.ID">ID</a>
                        </li>
                        <li>
                                <a class="variable" href="#Edge.vertices">vertices</a>
                        </li>
                        <li>
                                <a class="variable" href="#Edge.corners">corners</a>
                        </li>
                        <li>
                                <a class="variable" href="#Edge.right_tile">right_tile</a>
                        </li>
                        <li>
                                <a class="variable" href="#Edge.left_tile">left_tile</a>
                        </li>
                        <li>
                                <a class="variable" href="#Edge.base_ID">base_ID</a>
                        </li>
                        <li>
                                <a class="variable" href="#Edge.transitivity_class">transitivity_class</a>
                        </li>
                        <li>
                                <a class="variable" href="#Edge.label">label</a>
                        </li>
                        <li>
                                <a class="function" href="#Edge.get_corner_IDs">get_corner_IDs</a>
                        </li>
                        <li>
                                <a class="function" href="#Edge.get_vertex_IDs">get_vertex_IDs</a>
                        </li>
                        <li>
                                <a class="function" href="#Edge.insert_vertex">insert_vertex</a>
                        </li>
                        <li>
                                <a class="function" href="#Edge.get_geometry">get_geometry</a>
                        </li>
                        <li>
                                <a class="function" href="#Edge.get_topology">get_topology</a>
                        </li>
                </ul>

            </li>
    </ul>



        <a class="attribution" title="pdoc: Python API documentation generator" href="https://pdoc.dev" target="_blank">
            built with <span class="visually-hidden">pdoc</span><img
                alt="pdoc logo"
                src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20role%3D%22img%22%20aria-label%3D%22pdoc%20logo%22%20width%3D%22300%22%20height%3D%22150%22%20viewBox%3D%22-1%200%2060%2030%22%3E%3Ctitle%3Epdoc%3C/title%3E%3Cpath%20d%3D%22M29.621%2021.293c-.011-.273-.214-.475-.511-.481a.5.5%200%200%200-.489.503l-.044%201.393c-.097.551-.695%201.215-1.566%201.704-.577.428-1.306.486-2.193.182-1.426-.617-2.467-1.654-3.304-2.487l-.173-.172a3.43%203.43%200%200%200-.365-.306.49.49%200%200%200-.286-.196c-1.718-1.06-4.931-1.47-7.353.191l-.219.15c-1.707%201.187-3.413%202.131-4.328%201.03-.02-.027-.49-.685-.141-1.763.233-.721.546-2.408.772-4.076.042-.09.067-.187.046-.288.166-1.347.277-2.625.241-3.351%201.378-1.008%202.271-2.586%202.271-4.362%200-.976-.272-1.935-.788-2.774-.057-.094-.122-.18-.184-.268.033-.167.052-.339.052-.516%200-1.477-1.202-2.679-2.679-2.679-.791%200-1.496.352-1.987.9a6.3%206.3%200%200%200-1.001.029c-.492-.564-1.207-.929-2.012-.929-1.477%200-2.679%201.202-2.679%202.679A2.65%202.65%200%200%200%20.97%206.554c-.383.747-.595%201.572-.595%202.41%200%202.311%201.507%204.29%203.635%205.107-.037.699-.147%202.27-.423%203.294l-.137.461c-.622%202.042-2.515%208.257%201.727%2010.643%201.614.908%203.06%201.248%204.317%201.248%202.665%200%204.492-1.524%205.322-2.401%201.476-1.559%202.886-1.854%206.491.82%201.877%201.393%203.514%201.753%204.861%201.068%202.223-1.713%202.811-3.867%203.399-6.374.077-.846.056-1.469.054-1.537zm-4.835%204.313c-.054.305-.156.586-.242.629-.034-.007-.131-.022-.307-.157-.145-.111-.314-.478-.456-.908.221.121.432.25.675.355.115.039.219.051.33.081zm-2.251-1.238c-.05.33-.158.648-.252.694-.022.001-.125-.018-.307-.157-.217-.166-.488-.906-.639-1.573.358.344.754.693%201.198%201.036zm-3.887-2.337c-.006-.116-.018-.231-.041-.342.635.145%201.189.368%201.599.625.097.231.166.481.174.642-.03.049-.055.101-.067.158-.046.013-.128.026-.298.004-.278-.037-.901-.57-1.367-1.087zm-1.127-.497c.116.306.176.625.12.71-.019.014-.117.045-.345.016-.206-.027-.604-.332-.986-.695.41-.051.816-.056%201.211-.031zm-4.535%201.535c.209.22.379.47.358.598-.006.041-.088.138-.351.234-.144.055-.539-.063-.979-.259a11.66%2011.66%200%200%200%20.972-.573zm.983-.664c.359-.237.738-.418%201.126-.554.25.237.479.548.457.694-.006.042-.087.138-.351.235-.174.064-.694-.105-1.232-.375zm-3.381%201.794c-.022.145-.061.29-.149.401-.133.166-.358.248-.69.251h-.002c-.133%200-.306-.26-.45-.621.417.091.854.07%201.291-.031zm-2.066-8.077a4.78%204.78%200%200%201-.775-.584c.172-.115.505-.254.88-.378l-.105.962zm-.331%202.302a10.32%2010.32%200%200%201-.828-.502c.202-.143.576-.328.984-.49l-.156.992zm-.45%202.157l-.701-.403c.214-.115.536-.249.891-.376a11.57%2011.57%200%200%201-.19.779zm-.181%201.716c.064.398.194.702.298.893-.194-.051-.435-.162-.736-.398.061-.119.224-.3.438-.495zM8.87%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zm-.735-.389a1.15%201.15%200%200%200-.314.783%201.16%201.16%200%200%200%201.162%201.162c.457%200%20.842-.27%201.032-.653.026.117.042.238.042.362a1.68%201.68%200%200%201-1.679%201.679%201.68%201.68%200%200%201-1.679-1.679c0-.843.626-1.535%201.436-1.654zM5.059%205.406A1.68%201.68%200%200%201%203.38%207.085a1.68%201.68%200%200%201-1.679-1.679c0-.037.009-.072.011-.109.21.3.541.508.935.508a1.16%201.16%200%200%200%201.162-1.162%201.14%201.14%200%200%200-.474-.912c.015%200%20.03-.005.045-.005.926.001%201.679.754%201.679%201.68zM3.198%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zM1.375%208.964c0-.52.103-1.035.288-1.52.466.394%201.06.64%201.717.64%201.144%200%202.116-.725%202.499-1.738.383%201.012%201.355%201.738%202.499%201.738.867%200%201.631-.421%202.121-1.062.307.605.478%201.267.478%201.942%200%202.486-2.153%204.51-4.801%204.51s-4.801-2.023-4.801-4.51zm24.342%2019.349c-.985.498-2.267.168-3.813-.979-3.073-2.281-5.453-3.199-7.813-.705-1.315%201.391-4.163%203.365-8.423.97-3.174-1.786-2.239-6.266-1.261-9.479l.146-.492c.276-1.02.395-2.457.444-3.268a6.11%206.11%200%200%200%201.18.115%206.01%206.01%200%200%200%202.536-.562l-.006.175c-.802.215-1.848.612-2.021%201.25-.079.295.021.601.274.837.219.203.415.364.598.501-.667.304-1.243.698-1.311%201.179-.02.144-.022.507.393.787.213.144.395.26.564.365-1.285.521-1.361.96-1.381%201.126-.018.142-.011.496.427.746l.854.489c-.473.389-.971.914-.999%201.429-.018.278.095.532.316.713.675.556%201.231.721%201.653.721.059%200%20.104-.014.158-.02.207.707.641%201.64%201.513%201.64h.013c.8-.008%201.236-.345%201.462-.626.173-.216.268-.457.325-.692.424.195.93.374%201.372.374.151%200%20.294-.021.423-.068.732-.27.944-.704.993-1.021.009-.061.003-.119.002-.179.266.086.538.147.789.147.15%200%20.294-.021.423-.069.542-.2.797-.489.914-.754.237.147.478.258.704.288.106.014.205.021.296.021.356%200%20.595-.101.767-.229.438.435%201.094.992%201.656%201.067.106.014.205.021.296.021a1.56%201.56%200%200%200%20.323-.035c.17.575.453%201.289.866%201.605.358.273.665.362.914.362a.99.99%200%200%200%20.421-.093%201.03%201.03%200%200%200%20.245-.164c.168.428.39.846.68%201.068.358.273.665.362.913.362a.99.99%200%200%200%20.421-.093c.317-.148.512-.448.639-.762.251.157.495.257.726.257.127%200%20.25-.024.37-.071.427-.17.706-.617.841-1.314.022-.015.047-.022.068-.038.067-.051.133-.104.196-.159-.443%201.486-1.107%202.761-2.086%203.257zM8.66%209.925a.5.5%200%201%200-1%200c0%20.653-.818%201.205-1.787%201.205s-1.787-.552-1.787-1.205a.5.5%200%201%200-1%200c0%201.216%201.25%202.205%202.787%202.205s2.787-.989%202.787-2.205zm4.4%2015.965l-.208.097c-2.661%201.258-4.708%201.436-6.086.527-1.542-1.017-1.88-3.19-1.844-4.198a.4.4%200%200%200-.385-.414c-.242-.029-.406.164-.414.385-.046%201.249.367%203.686%202.202%204.896.708.467%201.547.7%202.51.7%201.248%200%202.706-.392%204.362-1.174l.185-.086a.4.4%200%200%200%20.205-.527c-.089-.204-.326-.291-.527-.206zM9.547%202.292c.093.077.205.114.317.114a.5.5%200%200%200%20.318-.886L8.817.397a.5.5%200%200%200-.703.068.5.5%200%200%200%20.069.703l1.364%201.124zm-7.661-.065c.086%200%20.173-.022.253-.068l1.523-.893a.5.5%200%200%200-.506-.863l-1.523.892a.5.5%200%200%200-.179.685c.094.158.261.247.432.247z%22%20transform%3D%22matrix%28-1%200%200%201%2058%200%29%22%20fill%3D%22%233bb300%22/%3E%3Cpath%20d%3D%22M.3%2021.86V10.18q0-.46.02-.68.04-.22.18-.5.28-.54%201.34-.54%201.06%200%201.42.28.38.26.44.78.76-1.04%202.38-1.04%201.64%200%203.1%201.54%201.46%201.54%201.46%203.58%200%202.04-1.46%203.58-1.44%201.54-3.08%201.54-1.64%200-2.38-.92v4.04q0%20.46-.04.68-.02.22-.18.5-.14.3-.5.42-.36.12-.98.12-.62%200-1-.12-.36-.12-.52-.4-.14-.28-.18-.5-.02-.22-.02-.68zm3.96-9.42q-.46.54-.46%201.18%200%20.64.46%201.18.48.52%201.2.52.74%200%201.24-.52.52-.52.52-1.18%200-.66-.48-1.18-.48-.54-1.26-.54-.76%200-1.22.54zm14.741-8.36q.16-.3.54-.42.38-.12%201-.12.64%200%201.02.12.38.12.52.42.16.3.18.54.04.22.04.68v11.94q0%20.46-.04.7-.02.22-.18.5-.3.54-1.7.54-1.38%200-1.54-.98-.84.96-2.34.96-1.8%200-3.28-1.56-1.48-1.58-1.48-3.66%200-2.1%201.48-3.68%201.5-1.58%203.28-1.58%201.48%200%202.3%201v-4.2q0-.46.02-.68.04-.24.18-.52zm-3.24%2010.86q.52.54%201.26.54.74%200%201.22-.54.5-.54.5-1.18%200-.66-.48-1.22-.46-.56-1.26-.56-.8%200-1.28.56-.48.54-.48%201.2%200%20.66.52%201.2zm7.833-1.2q0-2.4%201.68-3.96%201.68-1.56%203.84-1.56%202.16%200%203.82%201.56%201.66%201.54%201.66%203.94%200%201.66-.86%202.96-.86%201.28-2.1%201.9-1.22.6-2.54.6-1.32%200-2.56-.64-1.24-.66-2.1-1.92-.84-1.28-.84-2.88zm4.18%201.44q.64.48%201.3.48.66%200%201.32-.5.66-.5.66-1.48%200-.98-.62-1.46-.62-.48-1.34-.48-.72%200-1.34.5-.62.5-.62%201.48%200%20.96.64%201.46zm11.412-1.44q0%20.84.56%201.32.56.46%201.18.46.64%200%201.18-.36.56-.38.9-.38.6%200%201.46%201.06.46.58.46%201.04%200%20.76-1.1%201.42-1.14.8-2.8.8-1.86%200-3.58-1.34-.82-.64-1.34-1.7-.52-1.08-.52-2.36%200-1.3.52-2.34.52-1.06%201.34-1.7%201.66-1.32%203.54-1.32.76%200%201.48.22.72.2%201.06.4l.32.2q.36.24.56.38.52.4.52.92%200%20.5-.42%201.14-.72%201.1-1.38%201.1-.38%200-1.08-.44-.36-.34-1.04-.34-.66%200-1.24.48-.58.48-.58%201.34z%22%20fill%3D%22green%22/%3E%3C/svg%3E"/>
        </a>
</div>
    </nav>
    <main class="pdoc">
            <section class="module-info">
                    <h1 class="modulename">
<a href="./../weavingspace.html">weavingspace</a><wbr>.topology    </h1>

                        <div class="docstring"><p>Classes for working with topology of tilings.</p>

<p>Together the <code><a href="#Topology">Topology</a></code>, <code><a href="#Tile">Tile</a></code>, <code><a href="#Vertex">Vertex</a></code>, <code><a href="#Edge">Edge</a></code>, and
<code><a href="symmetry.html#Symmetries">weavingspace.symmetry.Symmetries</a></code> classes enable extraction of the topological
structure of periodic <code><a href="tileable.html#Tileable">weavingspace.tileable.Tileable</a></code> objects so that
modification of equivalent tiles can be carried out while retaining
tileability.</p>

<p>It is important to note that these are not fully generalised classes and
methods, that is, the Topology object that is supported is not a permanent
'backing' data structure for our Tileable objects. While it might become that
in time, it is not yet such a data structure. Instead usage is</p>

<pre><code>tile = TileUnit(...)
topology = Topology(tile)
topology = topology.transform_*(...)
new_tile = topology.tile_unit
</code></pre>

<p>A Topology plot function is provided for a user to be able to see what they are
doing, because how edges and vertices in a tiling are labelled under tile
equivalences is an essential step in the process.</p>

<p>Note that these classes do not precisely represent the distinctions made in the
mathematical literature between tiling vertices and tile corners, or between
tiling edges and tile sides.</p>
</div>

                        <input id="mod-topology-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">

                        <label class="view-source-button" for="mod-topology-view-source"><span>View Source</span></label>

                        <div class="pdoc-code codehilite"><pre><span></span><span id="L-1"><a href="#L-1"><span class="linenos">   1</span></a><span class="sd">&quot;&quot;&quot;Classes for working with topology of tilings.</span>
</span><span id="L-2"><a href="#L-2"><span class="linenos">   2</span></a>
</span><span id="L-3"><a href="#L-3"><span class="linenos">   3</span></a><span class="sd">Together the `Topology`, `Tile`, `Vertex`, `Edge`, and</span>
</span><span id="L-4"><a href="#L-4"><span class="linenos">   4</span></a><span class="sd">`weavingspace.symmetry.Symmetries` classes enable extraction of the topological</span>
</span><span id="L-5"><a href="#L-5"><span class="linenos">   5</span></a><span class="sd">structure of periodic `weavingspace.tileable.Tileable` objects so that</span>
</span><span id="L-6"><a href="#L-6"><span class="linenos">   6</span></a><span class="sd">modification of equivalent tiles can be carried out while retaining</span>
</span><span id="L-7"><a href="#L-7"><span class="linenos">   7</span></a><span class="sd">tileability.</span>
</span><span id="L-8"><a href="#L-8"><span class="linenos">   8</span></a>
</span><span id="L-9"><a href="#L-9"><span class="linenos">   9</span></a><span class="sd">It is important to note that these are not fully generalised classes and</span>
</span><span id="L-10"><a href="#L-10"><span class="linenos">  10</span></a><span class="sd">methods, that is, the Topology object that is supported is not a permanent</span>
</span><span id="L-11"><a href="#L-11"><span class="linenos">  11</span></a><span class="sd">&#39;backing&#39; data structure for our Tileable objects. While it might become that</span>
</span><span id="L-12"><a href="#L-12"><span class="linenos">  12</span></a><span class="sd">in time, it is not yet such a data structure. Instead usage is</span>
</span><span id="L-13"><a href="#L-13"><span class="linenos">  13</span></a>
</span><span id="L-14"><a href="#L-14"><span class="linenos">  14</span></a><span class="sd">    tile = TileUnit(...)</span>
</span><span id="L-15"><a href="#L-15"><span class="linenos">  15</span></a><span class="sd">    topology = Topology(tile)</span>
</span><span id="L-16"><a href="#L-16"><span class="linenos">  16</span></a><span class="sd">    topology = topology.transform_*(...)</span>
</span><span id="L-17"><a href="#L-17"><span class="linenos">  17</span></a><span class="sd">    new_tile = topology.tile_unit</span>
</span><span id="L-18"><a href="#L-18"><span class="linenos">  18</span></a>
</span><span id="L-19"><a href="#L-19"><span class="linenos">  19</span></a><span class="sd">A Topology plot function is provided for a user to be able to see what they are</span>
</span><span id="L-20"><a href="#L-20"><span class="linenos">  20</span></a><span class="sd">doing, because how edges and vertices in a tiling are labelled under tile</span>
</span><span id="L-21"><a href="#L-21"><span class="linenos">  21</span></a><span class="sd">equivalences is an essential step in the process.</span>
</span><span id="L-22"><a href="#L-22"><span class="linenos">  22</span></a>
</span><span id="L-23"><a href="#L-23"><span class="linenos">  23</span></a><span class="sd">Note that these classes do not precisely represent the distinctions made in the</span>
</span><span id="L-24"><a href="#L-24"><span class="linenos">  24</span></a><span class="sd">mathematical literature between tiling vertices and tile corners, or between</span>
</span><span id="L-25"><a href="#L-25"><span class="linenos">  25</span></a><span class="sd">tiling edges and tile sides.</span>
</span><span id="L-26"><a href="#L-26"><span class="linenos">  26</span></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-27"><a href="#L-27"><span class="linenos">  27</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">__future__</span><span class="w"> </span><span class="kn">import</span> <span class="n">annotations</span>
</span><span id="L-28"><a href="#L-28"><span class="linenos">  28</span></a>
</span><span id="L-29"><a href="#L-29"><span class="linenos">  29</span></a><span class="kn">import</span><span class="w"> </span><span class="nn">inspect</span>
</span><span id="L-30"><a href="#L-30"><span class="linenos">  30</span></a><span class="kn">import</span><span class="w"> </span><span class="nn">itertools</span>
</span><span id="L-31"><a href="#L-31"><span class="linenos">  31</span></a><span class="kn">import</span><span class="w"> </span><span class="nn">pickle</span>
</span><span id="L-32"><a href="#L-32"><span class="linenos">  32</span></a><span class="kn">import</span><span class="w"> </span><span class="nn">string</span>
</span><span id="L-33"><a href="#L-33"><span class="linenos">  33</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">collections</span><span class="w"> </span><span class="kn">import</span> <span class="n">defaultdict</span>
</span><span id="L-34"><a href="#L-34"><span class="linenos">  34</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">TYPE_CHECKING</span>
</span><span id="L-35"><a href="#L-35"><span class="linenos">  35</span></a>
</span><span id="L-36"><a href="#L-36"><span class="linenos">  36</span></a><span class="kn">import</span><span class="w"> </span><span class="nn">geopandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">gpd</span>
</span><span id="L-37"><a href="#L-37"><span class="linenos">  37</span></a><span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
</span><span id="L-38"><a href="#L-38"><span class="linenos">  38</span></a><span class="kn">import</span><span class="w"> </span><span class="nn">networkx</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">nx</span>
</span><span id="L-39"><a href="#L-39"><span class="linenos">  39</span></a><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
</span><span id="L-40"><a href="#L-40"><span class="linenos">  40</span></a><span class="kn">import</span><span class="w"> </span><span class="nn">shapely.affinity</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">affine</span>
</span><span id="L-41"><a href="#L-41"><span class="linenos">  41</span></a><span class="kn">import</span><span class="w"> </span><span class="nn">shapely.geometry</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">geom</span>
</span><span id="L-42"><a href="#L-42"><span class="linenos">  42</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">scipy</span><span class="w"> </span><span class="kn">import</span> <span class="n">interpolate</span>
</span><span id="L-43"><a href="#L-43"><span class="linenos">  43</span></a>
</span><span id="L-44"><a href="#L-44"><span class="linenos">  44</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">weavingspace</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
</span><span id="L-45"><a href="#L-45"><span class="linenos">  45</span></a>  <span class="n">ShapeMatcher</span><span class="p">,</span>
</span><span id="L-46"><a href="#L-46"><span class="linenos">  46</span></a>  <span class="n">Symmetries</span><span class="p">,</span>
</span><span id="L-47"><a href="#L-47"><span class="linenos">  47</span></a>  <span class="n">Tileable</span><span class="p">,</span>
</span><span id="L-48"><a href="#L-48"><span class="linenos">  48</span></a>  <span class="n">Transform</span><span class="p">,</span>
</span><span id="L-49"><a href="#L-49"><span class="linenos">  49</span></a>  <span class="n">tiling_utils</span><span class="p">,</span>
</span><span id="L-50"><a href="#L-50"><span class="linenos">  50</span></a><span class="p">)</span>
</span><span id="L-51"><a href="#L-51"><span class="linenos">  51</span></a>
</span><span id="L-52"><a href="#L-52"><span class="linenos">  52</span></a><span class="k">if</span> <span class="n">TYPE_CHECKING</span><span class="p">:</span>
</span><span id="L-53"><a href="#L-53"><span class="linenos">  53</span></a>  <span class="kn">from</span><span class="w"> </span><span class="nn">collections.abc</span><span class="w"> </span><span class="kn">import</span> <span class="n">Callable</span><span class="p">,</span> <span class="n">Iterable</span>
</span><span id="L-54"><a href="#L-54"><span class="linenos">  54</span></a>
</span><span id="L-55"><a href="#L-55"><span class="linenos">  55</span></a><span class="c1"># all two letter combinations of the alphabet for labelling</span>
</span><span id="L-56"><a href="#L-56"><span class="linenos">  56</span></a><span class="n">LABELS</span> <span class="o">=</span> \
</span><span id="L-57"><a href="#L-57"><span class="linenos">  57</span></a>  <span class="nb">list</span><span class="p">(</span><span class="n">string</span><span class="o">.</span><span class="n">ascii_letters</span><span class="o">.</span><span class="n">upper</span><span class="p">())</span> <span class="o">+</span> \
</span><span id="L-58"><a href="#L-58"><span class="linenos">  58</span></a>  <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span>
</span><span id="L-59"><a href="#L-59"><span class="linenos">  59</span></a>   <span class="n">itertools</span><span class="o">.</span><span class="n">combinations</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">string</span><span class="o">.</span><span class="n">ascii_letters</span><span class="o">.</span><span class="n">upper</span><span class="p">()),</span> <span class="mi">2</span><span class="p">)]</span>
</span><span id="L-60"><a href="#L-60"><span class="linenos">  60</span></a><span class="n">labels</span> <span class="o">=</span> \
</span><span id="L-61"><a href="#L-61"><span class="linenos">  61</span></a>  <span class="nb">list</span><span class="p">(</span><span class="n">string</span><span class="o">.</span><span class="n">ascii_letters</span><span class="o">.</span><span class="n">lower</span><span class="p">())</span> <span class="o">+</span> \
</span><span id="L-62"><a href="#L-62"><span class="linenos">  62</span></a>  <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span>
</span><span id="L-63"><a href="#L-63"><span class="linenos">  63</span></a>   <span class="n">itertools</span><span class="o">.</span><span class="n">combinations</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">string</span><span class="o">.</span><span class="n">ascii_letters</span><span class="o">.</span><span class="n">lower</span><span class="p">()),</span> <span class="mi">2</span><span class="p">)]</span>
</span><span id="L-64"><a href="#L-64"><span class="linenos">  64</span></a>
</span><span id="L-65"><a href="#L-65"><span class="linenos">  65</span></a>
</span><span id="L-66"><a href="#L-66"><span class="linenos">  66</span></a><span class="k">class</span><span class="w"> </span><span class="nc">Topology</span><span class="p">:</span>
</span><span id="L-67"><a href="#L-67"><span class="linenos">  67</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;Class to represent topology of a Tileable object.</span>
</span><span id="L-68"><a href="#L-68"><span class="linenos">  68</span></a>
</span><span id="L-69"><a href="#L-69"><span class="linenos">  69</span></a><span class="sd">  NOTE: It is important that get_local_patch return the tileable elements and</span>
</span><span id="L-70"><a href="#L-70"><span class="linenos">  70</span></a><span class="sd">  the translated copies in consistent sequence, i.e. if there are (say) four</span>
</span><span id="L-71"><a href="#L-71"><span class="linenos">  71</span></a><span class="sd">  tiles in the unit, the local patch should be 1 2 3 4 1 2 3 4 1 2 3 4 ... and</span>
</span><span id="L-72"><a href="#L-72"><span class="linenos">  72</span></a><span class="sd">  so on. This is because self.tiles[i % n_tiles] is frequently used to</span>
</span><span id="L-73"><a href="#L-73"><span class="linenos">  73</span></a><span class="sd">  reference the base unit Tile which corresponds to self.tiles[i].</span>
</span><span id="L-74"><a href="#L-74"><span class="linenos">  74</span></a><span class="sd">  &quot;&quot;&quot;</span>
</span><span id="L-75"><a href="#L-75"><span class="linenos">  75</span></a>
</span><span id="L-76"><a href="#L-76"><span class="linenos">  76</span></a>  <span class="n">tileable</span><span class="p">:</span> <span class="n">Tileable</span>
</span><span id="L-77"><a href="#L-77"><span class="linenos">  77</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;the Tileable on which the topology will be based.&quot;&quot;&quot;</span>
</span><span id="L-78"><a href="#L-78"><span class="linenos">  78</span></a>  <span class="n">tiles</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Tile</span><span class="p">]</span>
</span><span id="L-79"><a href="#L-79"><span class="linenos">  79</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;list of the Tiles in the topology. We use polygons returned by the</span>
</span><span id="L-80"><a href="#L-80"><span class="linenos">  80</span></a><span class="sd">  tileable.get_local_patch method for these. That is the base tiles and 8</span>
</span><span id="L-81"><a href="#L-81"><span class="linenos">  81</span></a><span class="sd">  adjacent copies (for a rectangular tiling), or 6 adjacent copies (for a</span>
</span><span id="L-82"><a href="#L-82"><span class="linenos">  82</span></a><span class="sd">  hexagonal tiling).&quot;&quot;&quot;</span>
</span><span id="L-83"><a href="#L-83"><span class="linenos">  83</span></a>  <span class="n">points</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">Vertex</span><span class="p">]</span>
</span><span id="L-84"><a href="#L-84"><span class="linenos">  84</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;dictionary of all points (vertices and corners) in the tiling, keyed by</span>
</span><span id="L-85"><a href="#L-85"><span class="linenos">  85</span></a><span class="sd">  Vertex ID.&quot;&quot;&quot;</span>
</span><span id="L-86"><a href="#L-86"><span class="linenos">  86</span></a>  <span class="n">edges</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span><span class="nb">int</span><span class="p">],</span> <span class="n">Edge</span><span class="p">]</span>
</span><span id="L-87"><a href="#L-87"><span class="linenos">  87</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;dictionary of the tiling edges, keyed by Edge ID.&quot;&quot;&quot;</span>
</span><span id="L-88"><a href="#L-88"><span class="linenos">  88</span></a>  <span class="n">unique_tile_shapes</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">geom</span><span class="o">.</span><span class="n">Polygon</span><span class="p">]</span>
</span><span id="L-89"><a href="#L-89"><span class="linenos">  89</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;a &#39;reference&#39; tile shape one per tile shape (up to vertices, so two tiles</span>
</span><span id="L-90"><a href="#L-90"><span class="linenos">  90</span></a><span class="sd">  might be the same shape, but one might have extra vertices induced by the</span>
</span><span id="L-91"><a href="#L-91"><span class="linenos">  91</span></a><span class="sd">  tiling and hence is a different shape under this definition).&quot;&quot;&quot;</span>
</span><span id="L-92"><a href="#L-92"><span class="linenos">  92</span></a>  <span class="n">dual_tiles</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">geom</span><span class="o">.</span><span class="n">Polygon</span><span class="p">]</span>
</span><span id="L-93"><a href="#L-93"><span class="linenos">  93</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;list of geom.Polygons from which a dual tiling might be constructed.&quot;&quot;&quot;</span>
</span><span id="L-94"><a href="#L-94"><span class="linenos">  94</span></a>  <span class="n">n_tiles</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-95"><a href="#L-95"><span class="linenos">  95</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;number of tiles in the base Tileable (retained for convenience).&quot;&quot;&quot;</span>
</span><span id="L-96"><a href="#L-96"><span class="linenos">  96</span></a>  <span class="n">shape_groups</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]]</span>
</span><span id="L-97"><a href="#L-97"><span class="linenos">  97</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;list of lists of tile IDs distinguished by shape and optionally tile_id&quot;&quot;&quot;</span>
</span><span id="L-98"><a href="#L-98"><span class="linenos">  98</span></a>  <span class="n">tile_matching_transforms</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span>
</span><span id="L-99"><a href="#L-99"><span class="linenos">  99</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;shapely transform tuples that map tiles onto other tiles&quot;&quot;&quot;</span>
</span><span id="L-100"><a href="#L-100"><span class="linenos"> 100</span></a>  <span class="n">tile_transitivity_classes</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">]]</span>
</span><span id="L-101"><a href="#L-101"><span class="linenos"> 101</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;list of lists of tile IDs in each transitivity class&quot;&quot;&quot;</span>
</span><span id="L-102"><a href="#L-102"><span class="linenos"> 102</span></a>  <span class="n">vertex_transitivity_classes</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]]</span>
</span><span id="L-103"><a href="#L-103"><span class="linenos"> 103</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;list of lists of vertex IDs in each transitivity class&quot;&quot;&quot;</span>
</span><span id="L-104"><a href="#L-104"><span class="linenos"> 104</span></a>  <span class="n">edge_transitivity_classes</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">]]]</span>
</span><span id="L-105"><a href="#L-105"><span class="linenos"> 105</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;list of lists of edge IDs in each transitivity class&quot;&quot;&quot;</span>
</span><span id="L-106"><a href="#L-106"><span class="linenos"> 106</span></a>
</span><span id="L-107"><a href="#L-107"><span class="linenos"> 107</span></a>  <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="L-108"><a href="#L-108"><span class="linenos"> 108</span></a>      <span class="bp">self</span><span class="p">,</span>
</span><span id="L-109"><a href="#L-109"><span class="linenos"> 109</span></a>      <span class="n">unit</span><span class="p">:</span> <span class="n">Tileable</span><span class="p">,</span>
</span><span id="L-110"><a href="#L-110"><span class="linenos"> 110</span></a>      <span class="n">ignore_tile_ids</span><span class="p">:</span><span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="L-111"><a href="#L-111"><span class="linenos"> 111</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-112"><a href="#L-112"><span class="linenos"> 112</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Class constructor.</span>
</span><span id="L-113"><a href="#L-113"><span class="linenos"> 113</span></a>
</span><span id="L-114"><a href="#L-114"><span class="linenos"> 114</span></a><span class="sd">    Args:</span>
</span><span id="L-115"><a href="#L-115"><span class="linenos"> 115</span></a><span class="sd">      unit (Tileable): the Tileable whose topology is required.</span>
</span><span id="L-116"><a href="#L-116"><span class="linenos"> 116</span></a><span class="sd">      ignore_tile_ids (bool): (EXPERIMENTAL) if True then only consider the tile</span>
</span><span id="L-117"><a href="#L-117"><span class="linenos"> 117</span></a><span class="sd">        shapes, not labels. If False consider any labels. Defaults to True.</span>
</span><span id="L-118"><a href="#L-118"><span class="linenos"> 118</span></a>
</span><span id="L-119"><a href="#L-119"><span class="linenos"> 119</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-120"><a href="#L-120"><span class="linenos"> 120</span></a>    <span class="c1"># Note that the order of these setup steps is fragile sometimes</span>
</span><span id="L-121"><a href="#L-121"><span class="linenos"> 121</span></a>    <span class="c1"># not obviously so.</span>
</span><span id="L-122"><a href="#L-122"><span class="linenos"> 122</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">tileable</span> <span class="o">=</span> <span class="n">unit</span> <span class="c1"># keep this for reference</span>
</span><span id="L-123"><a href="#L-123"><span class="linenos"> 123</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">n_tiles</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tileable</span><span class="o">.</span><span class="n">tiles</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-124"><a href="#L-124"><span class="linenos"> 124</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_initialise_points_into_tiles</span><span class="p">()</span>
</span><span id="L-125"><a href="#L-125"><span class="linenos"> 125</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_setup_vertex_tile_relations</span><span class="p">()</span>
</span><span id="L-126"><a href="#L-126"><span class="linenos"> 126</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_setup_edges</span><span class="p">()</span>
</span><span id="L-127"><a href="#L-127"><span class="linenos"> 127</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_copy_base_tiles_to_patch</span><span class="p">()</span>
</span><span id="L-128"><a href="#L-128"><span class="linenos"> 128</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_assign_vertex_and_edge_base_IDs</span><span class="p">()</span>
</span><span id="L-129"><a href="#L-129"><span class="linenos"> 129</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_identify_distinct_tile_shapes</span><span class="p">(</span><span class="n">ignore_tile_ids</span><span class="p">)</span>
</span><span id="L-130"><a href="#L-130"><span class="linenos"> 130</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_find_tile_transitivity_classes</span><span class="p">(</span><span class="n">ignore_tile_ids</span><span class="p">)</span>
</span><span id="L-131"><a href="#L-131"><span class="linenos"> 131</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_find_vertex_transitivity_classes</span><span class="p">(</span><span class="n">ignore_tile_ids</span><span class="p">)</span>
</span><span id="L-132"><a href="#L-132"><span class="linenos"> 132</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_find_edge_transitivity_classes</span><span class="p">(</span><span class="n">ignore_tile_ids</span><span class="p">)</span>
</span><span id="L-133"><a href="#L-133"><span class="linenos"> 133</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">generate_dual</span><span class="p">()</span>
</span><span id="L-134"><a href="#L-134"><span class="linenos"> 134</span></a>
</span><span id="L-135"><a href="#L-135"><span class="linenos"> 135</span></a>
</span><span id="L-136"><a href="#L-136"><span class="linenos"> 136</span></a>  <span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="L-137"><a href="#L-137"><span class="linenos"> 137</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return string representation of this Topology.</span>
</span><span id="L-138"><a href="#L-138"><span class="linenos"> 138</span></a>
</span><span id="L-139"><a href="#L-139"><span class="linenos"> 139</span></a><span class="sd">    Returns:</span>
</span><span id="L-140"><a href="#L-140"><span class="linenos"> 140</span></a><span class="sd">      str: a message that recommends examining the tiles, points and edges</span>
</span><span id="L-141"><a href="#L-141"><span class="linenos"> 141</span></a><span class="sd">        attributes.</span>
</span><span id="L-142"><a href="#L-142"><span class="linenos"> 142</span></a>
</span><span id="L-143"><a href="#L-143"><span class="linenos"> 143</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-144"><a href="#L-144"><span class="linenos"> 144</span></a>    <span class="k">return</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&quot;&quot;Topology of Tileable with </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">n_tiles</span><span class="si">}</span><span class="s2"> tiles.</span><span class="se">\n</span>
</span><span id="L-145"><a href="#L-145"><span class="linenos"> 145</span></a><span class="s2">            Examine .tiles, .points and .edges for more details.&quot;&quot;&quot;</span><span class="p">)</span>
</span><span id="L-146"><a href="#L-146"><span class="linenos"> 146</span></a>
</span><span id="L-147"><a href="#L-147"><span class="linenos"> 147</span></a>
</span><span id="L-148"><a href="#L-148"><span class="linenos"> 148</span></a>  <span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="L-149"><a href="#L-149"><span class="linenos"> 149</span></a>    <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="L-150"><a href="#L-150"><span class="linenos"> 150</span></a>
</span><span id="L-151"><a href="#L-151"><span class="linenos"> 151</span></a>
</span><span id="L-152"><a href="#L-152"><span class="linenos"> 152</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">_initialise_points_into_tiles</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">debug</span><span class="p">:</span><span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-153"><a href="#L-153"><span class="linenos"> 153</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Set up dictionary of unique point locations and assign them to Tiles.</span>
</span><span id="L-154"><a href="#L-154"><span class="linenos"> 154</span></a>
</span><span id="L-155"><a href="#L-155"><span class="linenos"> 155</span></a><span class="sd">    Args:</span>
</span><span id="L-156"><a href="#L-156"><span class="linenos"> 156</span></a><span class="sd">      debug (bool): if True prints useful debugging information.</span>
</span><span id="L-157"><a href="#L-157"><span class="linenos"> 157</span></a>
</span><span id="L-158"><a href="#L-158"><span class="linenos"> 158</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-159"><a href="#L-159"><span class="linenos"> 159</span></a>    <span class="n">shapes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tileable</span><span class="o">.</span><span class="n">get_local_patch</span><span class="p">(</span><span class="n">r</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">include_0</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">geometry</span>
</span><span id="L-160"><a href="#L-160"><span class="linenos"> 160</span></a>    <span class="n">shapes</span> <span class="o">=</span> <span class="p">[</span><span class="n">tiling_utils</span><span class="o">.</span><span class="n">get_clean_polygon</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">shapes</span><span class="p">]</span>
</span><span id="L-161"><a href="#L-161"><span class="linenos"> 161</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">n_1_order_patch</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">shapes</span><span class="p">)</span>
</span><span id="L-162"><a href="#L-162"><span class="linenos"> 162</span></a>    <span class="n">labels</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tileable</span><span class="o">.</span><span class="n">tiles</span><span class="o">.</span><span class="n">tile_id</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">shapes</span><span class="p">)</span> <span class="o">//</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_tiles</span><span class="p">)</span>
</span><span id="L-163"><a href="#L-163"><span class="linenos"> 163</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">tiles</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-164"><a href="#L-164"><span class="linenos"> 164</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">points</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="L-165"><a href="#L-165"><span class="linenos"> 165</span></a>    <span class="k">for</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">shape</span><span class="p">),</span> <span class="n">label</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="nb">enumerate</span><span class="p">(</span><span class="n">shapes</span><span class="p">),</span> <span class="n">labels</span><span class="p">,</span> <span class="n">strict</span> <span class="o">=</span> <span class="kc">True</span><span class="p">):</span>
</span><span id="L-166"><a href="#L-166"><span class="linenos"> 166</span></a>      <span class="n">tile</span> <span class="o">=</span> <span class="n">Tile</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</span><span id="L-167"><a href="#L-167"><span class="linenos"> 167</span></a>      <span class="n">tile</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="n">label</span>
</span><span id="L-168"><a href="#L-168"><span class="linenos"> 168</span></a>      <span class="n">tile</span><span class="o">.</span><span class="n">base_ID</span> <span class="o">=</span> <span class="n">tile</span><span class="o">.</span><span class="n">ID</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_tiles</span>
</span><span id="L-169"><a href="#L-169"><span class="linenos"> 169</span></a>      <span class="bp">self</span><span class="o">.</span><span class="n">tiles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tile</span><span class="p">)</span>
</span><span id="L-170"><a href="#L-170"><span class="linenos"> 170</span></a>      <span class="n">tile</span><span class="o">.</span><span class="n">corners</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-171"><a href="#L-171"><span class="linenos"> 171</span></a>      <span class="n">corners</span> <span class="o">=</span> <span class="n">tiling_utils</span><span class="o">.</span><span class="n">get_corners</span><span class="p">(</span><span class="n">shape</span><span class="p">,</span> <span class="n">repeat_first</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
</span><span id="L-172"><a href="#L-172"><span class="linenos"> 172</span></a>      <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">corners</span><span class="p">:</span>
</span><span id="L-173"><a href="#L-173"><span class="linenos"> 173</span></a>        <span class="n">prev_vertex</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-174"><a href="#L-174"><span class="linenos"> 174</span></a>        <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">points</span><span class="o">.</span><span class="n">values</span><span class="p">()):</span>
</span><span id="L-175"><a href="#L-175"><span class="linenos"> 175</span></a>          <span class="k">if</span> <span class="n">c</span><span class="o">.</span><span class="n">distance</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">point</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">tiling_utils</span><span class="o">.</span><span class="n">RESOLUTION</span><span class="p">:</span>
</span><span id="L-176"><a href="#L-176"><span class="linenos"> 176</span></a>            <span class="c1"># found an already existing vertex, so add to the tile and break</span>
</span><span id="L-177"><a href="#L-177"><span class="linenos"> 177</span></a>            <span class="n">prev_vertex</span> <span class="o">=</span> <span class="n">p</span>
</span><span id="L-178"><a href="#L-178"><span class="linenos"> 178</span></a>            <span class="n">tile</span><span class="o">.</span><span class="n">corners</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">prev_vertex</span><span class="p">)</span>
</span><span id="L-179"><a href="#L-179"><span class="linenos"> 179</span></a>            <span class="k">break</span>
</span><span id="L-180"><a href="#L-180"><span class="linenos"> 180</span></a>        <span class="k">if</span> <span class="n">prev_vertex</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-181"><a href="#L-181"><span class="linenos"> 181</span></a>          <span class="c1"># new vertex, add it to the topology dictionary and to the tile</span>
</span><span id="L-182"><a href="#L-182"><span class="linenos"> 182</span></a>          <span class="n">v</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_vertex</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
</span><span id="L-183"><a href="#L-183"><span class="linenos"> 183</span></a>          <span class="n">tile</span><span class="o">.</span><span class="n">corners</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
</span><span id="L-184"><a href="#L-184"><span class="linenos"> 184</span></a>          <span class="k">if</span> <span class="n">debug</span><span class="p">:</span>
</span><span id="L-185"><a href="#L-185"><span class="linenos"> 185</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Added new Vertex </span><span class="si">{</span><span class="n">v</span><span class="si">}</span><span class="s2"> to Tile </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-186"><a href="#L-186"><span class="linenos"> 186</span></a>
</span><span id="L-187"><a href="#L-187"><span class="linenos"> 187</span></a>
</span><span id="L-188"><a href="#L-188"><span class="linenos"> 188</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">_setup_vertex_tile_relations</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">debug</span><span class="p">:</span><span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-189"><a href="#L-189"><span class="linenos"> 189</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Determine relations between vertices and tiles.</span>
</span><span id="L-190"><a href="#L-190"><span class="linenos"> 190</span></a>
</span><span id="L-191"><a href="#L-191"><span class="linenos"> 191</span></a><span class="sd">    In particular vertices along tile edges that are not yet included in their</span>
</span><span id="L-192"><a href="#L-192"><span class="linenos"> 192</span></a><span class="sd">    list of vertices are added. Meanwhile vertex lists of incident tiles and</span>
</span><span id="L-193"><a href="#L-193"><span class="linenos"> 193</span></a><span class="sd">    neighbours are set up.</span>
</span><span id="L-194"><a href="#L-194"><span class="linenos"> 194</span></a>
</span><span id="L-195"><a href="#L-195"><span class="linenos"> 195</span></a><span class="sd">    Args:</span>
</span><span id="L-196"><a href="#L-196"><span class="linenos"> 196</span></a><span class="sd">      debug (bool): if True prints debugging information.</span>
</span><span id="L-197"><a href="#L-197"><span class="linenos"> 197</span></a>
</span><span id="L-198"><a href="#L-198"><span class="linenos"> 198</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-199"><a href="#L-199"><span class="linenos"> 199</span></a>    <span class="c1"># we do this for all tiles in the radius-1 local patch</span>
</span><span id="L-200"><a href="#L-200"><span class="linenos"> 200</span></a>    <span class="k">for</span> <span class="n">tile</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tiles</span><span class="p">:</span>
</span><span id="L-201"><a href="#L-201"><span class="linenos"> 201</span></a>      <span class="k">if</span> <span class="n">debug</span><span class="p">:</span>
</span><span id="L-202"><a href="#L-202"><span class="linenos"> 202</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Checking for vertices incident on Tile </span><span class="si">{</span><span class="n">tile</span><span class="o">.</span><span class="n">ID</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-203"><a href="#L-203"><span class="linenos"> 203</span></a>      <span class="n">corners</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-204"><a href="#L-204"><span class="linenos"> 204</span></a>      <span class="c1"># performance is much improved using the vertex IDs</span>
</span><span id="L-205"><a href="#L-205"><span class="linenos"> 205</span></a>      <span class="n">initial_corner_IDs</span> <span class="o">=</span> <span class="n">tile</span><span class="o">.</span><span class="n">get_corner_IDs</span><span class="p">()</span>
</span><span id="L-206"><a href="#L-206"><span class="linenos"> 206</span></a>      <span class="c1"># we need the current shape (not yet set) to check for incident vertices</span>
</span><span id="L-207"><a href="#L-207"><span class="linenos"> 207</span></a>      <span class="n">shape</span> <span class="o">=</span> <span class="n">geom</span><span class="o">.</span><span class="n">Polygon</span><span class="p">([</span><span class="n">c</span><span class="o">.</span><span class="n">point</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">tile</span><span class="o">.</span><span class="n">corners</span><span class="p">])</span>
</span><span id="L-208"><a href="#L-208"><span class="linenos"> 208</span></a>      <span class="c1"># get points incident on tile boundary, not already in the tile corners</span>
</span><span id="L-209"><a href="#L-209"><span class="linenos"> 209</span></a>      <span class="n">new_points</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">points</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
</span><span id="L-210"><a href="#L-210"><span class="linenos"> 210</span></a>                    <span class="k">if</span> <span class="n">v</span><span class="o">.</span><span class="n">ID</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">initial_corner_IDs</span> <span class="ow">and</span>
</span><span id="L-211"><a href="#L-211"><span class="linenos"> 211</span></a>                    <span class="n">v</span><span class="o">.</span><span class="n">point</span><span class="o">.</span><span class="n">distance</span><span class="p">(</span><span class="n">shape</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">tiling_utils</span><span class="o">.</span><span class="n">RESOLUTION</span><span class="p">]</span>
</span><span id="L-212"><a href="#L-212"><span class="linenos"> 212</span></a>      <span class="c1"># iterate over sides of the tile to see which the vertex is incident on</span>
</span><span id="L-213"><a href="#L-213"><span class="linenos"> 213</span></a>      <span class="k">for</span> <span class="n">c1</span><span class="p">,</span> <span class="n">c2</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">tile</span><span class="o">.</span><span class="n">corners</span><span class="p">,</span> <span class="n">tile</span><span class="o">.</span><span class="n">corners</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">+</span> <span class="n">tile</span><span class="o">.</span><span class="n">corners</span><span class="p">[:</span><span class="mi">1</span><span class="p">],</span>
</span><span id="L-214"><a href="#L-214"><span class="linenos"> 214</span></a>                        <span class="n">strict</span> <span class="o">=</span> <span class="kc">True</span><span class="p">):</span>
</span><span id="L-215"><a href="#L-215"><span class="linenos"> 215</span></a>        <span class="n">all_points</span> <span class="o">=</span> <span class="p">[</span><span class="n">c1</span><span class="p">,</span> <span class="n">c2</span><span class="p">]</span>
</span><span id="L-216"><a href="#L-216"><span class="linenos"> 216</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_points</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-217"><a href="#L-217"><span class="linenos"> 217</span></a>          <span class="k">if</span> <span class="n">debug</span><span class="p">:</span>
</span><span id="L-218"><a href="#L-218"><span class="linenos"> 218</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="p">[</span><span class="n">v</span><span class="o">.</span><span class="n">ID</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">v</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">new_points</span><span class="p">]</span><span class="si">}</span><span class="s2"> incident on tile&quot;</span><span class="p">)</span>
</span><span id="L-219"><a href="#L-219"><span class="linenos"> 219</span></a>          <span class="n">ls</span> <span class="o">=</span> <span class="n">geom</span><span class="o">.</span><span class="n">LineString</span><span class="p">([</span><span class="n">c1</span><span class="o">.</span><span class="n">point</span><span class="p">,</span> <span class="n">c2</span><span class="o">.</span><span class="n">point</span><span class="p">])</span>
</span><span id="L-220"><a href="#L-220"><span class="linenos"> 220</span></a>          <span class="n">to_insert</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">new_points</span>
</span><span id="L-221"><a href="#L-221"><span class="linenos"> 221</span></a>                       <span class="k">if</span> <span class="n">v</span><span class="o">.</span><span class="n">point</span><span class="o">.</span><span class="n">distance</span><span class="p">(</span><span class="n">ls</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">tiling_utils</span><span class="o">.</span><span class="n">RESOLUTION</span><span class="p">]</span>
</span><span id="L-222"><a href="#L-222"><span class="linenos"> 222</span></a>          <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">to_insert</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-223"><a href="#L-223"><span class="linenos"> 223</span></a>            <span class="c1"># sort by distance along the side</span>
</span><span id="L-224"><a href="#L-224"><span class="linenos"> 224</span></a>            <span class="n">d_along</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">([(</span><span class="n">ls</span><span class="o">.</span><span class="n">line_locate_point</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">point</span><span class="p">),</span> <span class="n">v</span><span class="p">)</span>
</span><span id="L-225"><a href="#L-225"><span class="linenos"> 225</span></a>                              <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">to_insert</span><span class="p">],</span> <span class="n">key</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="L-226"><a href="#L-226"><span class="linenos"> 226</span></a>            <span class="n">to_insert</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span> <span class="k">for</span> <span class="n">d</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">d_along</span><span class="p">]</span>
</span><span id="L-227"><a href="#L-227"><span class="linenos"> 227</span></a>            <span class="n">all_points</span> <span class="o">=</span> <span class="n">all_points</span><span class="p">[:</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">to_insert</span> <span class="o">+</span> <span class="n">all_points</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
</span><span id="L-228"><a href="#L-228"><span class="linenos"> 228</span></a>        <span class="n">corners</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">all_points</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</span><span id="L-229"><a href="#L-229"><span class="linenos"> 229</span></a>        <span class="k">for</span> <span class="n">x1</span><span class="p">,</span> <span class="n">x2</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">all_points</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">all_points</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">strict</span> <span class="o">=</span> <span class="kc">True</span><span class="p">):</span>
</span><span id="L-230"><a href="#L-230"><span class="linenos"> 230</span></a>          <span class="c1"># x2 will add the tile and neigbour when we get to the next side</span>
</span><span id="L-231"><a href="#L-231"><span class="linenos"> 231</span></a>          <span class="c1"># every vertex gets a turn!</span>
</span><span id="L-232"><a href="#L-232"><span class="linenos"> 232</span></a>          <span class="n">x1</span><span class="o">.</span><span class="n">add_tile</span><span class="p">(</span><span class="n">tile</span><span class="p">)</span>
</span><span id="L-233"><a href="#L-233"><span class="linenos"> 233</span></a>          <span class="n">x1</span><span class="o">.</span><span class="n">add_neighbour</span><span class="p">(</span><span class="n">x2</span><span class="o">.</span><span class="n">ID</span><span class="p">)</span>
</span><span id="L-234"><a href="#L-234"><span class="linenos"> 234</span></a>      <span class="n">tile</span><span class="o">.</span><span class="n">corners</span> <span class="o">=</span> <span class="n">corners</span>
</span><span id="L-235"><a href="#L-235"><span class="linenos"> 235</span></a>      <span class="n">tile</span><span class="o">.</span><span class="n">set_shape_from_corners</span><span class="p">()</span>
</span><span id="L-236"><a href="#L-236"><span class="linenos"> 236</span></a>
</span><span id="L-237"><a href="#L-237"><span class="linenos"> 237</span></a>
</span><span id="L-238"><a href="#L-238"><span class="linenos"> 238</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">_setup_edges</span><span class="p">(</span>
</span><span id="L-239"><a href="#L-239"><span class="linenos"> 239</span></a>      <span class="bp">self</span><span class="p">,</span>
</span><span id="L-240"><a href="#L-240"><span class="linenos"> 240</span></a>      <span class="n">debug</span><span class="p">:</span><span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="L-241"><a href="#L-241"><span class="linenos"> 241</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-242"><a href="#L-242"><span class="linenos"> 242</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Set up the tiling edges.</span>
</span><span id="L-243"><a href="#L-243"><span class="linenos"> 243</span></a>
</span><span id="L-244"><a href="#L-244"><span class="linenos"> 244</span></a><span class="sd">    First vertices in the base tiles are classified as tiling vertices or not -</span>
</span><span id="L-245"><a href="#L-245"><span class="linenos"> 245</span></a><span class="sd">    only these can be classified reliably (e.g vertices on the perimeter are</span>
</span><span id="L-246"><a href="#L-246"><span class="linenos"> 246</span></a><span class="sd">    tricky).. Up to here all vertices have been considered tiling vertices.</span>
</span><span id="L-247"><a href="#L-247"><span class="linenos"> 247</span></a>
</span><span id="L-248"><a href="#L-248"><span class="linenos"> 248</span></a><span class="sd">    Second edges are created by traversing tile corner lists. Edges are stored</span>
</span><span id="L-249"><a href="#L-249"><span class="linenos"> 249</span></a><span class="sd">    once only by checking for edges in the reverse direction already in the</span>
</span><span id="L-250"><a href="#L-250"><span class="linenos"> 250</span></a><span class="sd">    edges dictionary. Edge right and left tiles are initialised.</span>
</span><span id="L-251"><a href="#L-251"><span class="linenos"> 251</span></a>
</span><span id="L-252"><a href="#L-252"><span class="linenos"> 252</span></a><span class="sd">    Third tile edge direction lists are initialised.</span>
</span><span id="L-253"><a href="#L-253"><span class="linenos"> 253</span></a>
</span><span id="L-254"><a href="#L-254"><span class="linenos"> 254</span></a><span class="sd">    Args:</span>
</span><span id="L-255"><a href="#L-255"><span class="linenos"> 255</span></a><span class="sd">      debug (bool): if True print debug messages. Defaults to False.</span>
</span><span id="L-256"><a href="#L-256"><span class="linenos"> 256</span></a>
</span><span id="L-257"><a href="#L-257"><span class="linenos"> 257</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-258"><a href="#L-258"><span class="linenos"> 258</span></a>    <span class="c1"># classify vertices in the base tiles</span>
</span><span id="L-259"><a href="#L-259"><span class="linenos"> 259</span></a>    <span class="k">for</span> <span class="n">tile</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tiles</span><span class="p">[:</span><span class="bp">self</span><span class="o">.</span><span class="n">n_tiles</span><span class="p">]:</span>
</span><span id="L-260"><a href="#L-260"><span class="linenos"> 260</span></a>      <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">tile</span><span class="o">.</span><span class="n">corners</span><span class="p">:</span>
</span><span id="L-261"><a href="#L-261"><span class="linenos"> 261</span></a>        <span class="n">v</span><span class="o">.</span><span class="n">is_tiling_vertex</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">neighbours</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span>
</span><span id="L-262"><a href="#L-262"><span class="linenos"> 262</span></a>    <span class="k">if</span> <span class="n">debug</span><span class="p">:</span>
</span><span id="L-263"><a href="#L-263"><span class="linenos"> 263</span></a>      <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Classified base tile vertices&quot;</span><span class="p">)</span>
</span><span id="L-264"><a href="#L-264"><span class="linenos"> 264</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">edges</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="L-265"><a href="#L-265"><span class="linenos"> 265</span></a>    <span class="k">for</span> <span class="n">tile</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tiles</span><span class="p">:</span>
</span><span id="L-266"><a href="#L-266"><span class="linenos"> 266</span></a>      <span class="k">if</span> <span class="n">debug</span><span class="p">:</span>
</span><span id="L-267"><a href="#L-267"><span class="linenos"> 267</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Adding edges from Tile </span><span class="si">{</span><span class="n">tile</span><span class="o">.</span><span class="n">ID</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-268"><a href="#L-268"><span class="linenos"> 268</span></a>      <span class="n">tile</span><span class="o">.</span><span class="n">edges</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-269"><a href="#L-269"><span class="linenos"> 269</span></a>      <span class="n">vertices</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">tile</span><span class="o">.</span><span class="n">corners</span> <span class="k">if</span> <span class="n">v</span><span class="o">.</span><span class="n">is_tiling_vertex</span><span class="p">]</span>
</span><span id="L-270"><a href="#L-270"><span class="linenos"> 270</span></a>      <span class="c1"># note that through here finding ints in lists is much faster than</span>
</span><span id="L-271"><a href="#L-271"><span class="linenos"> 271</span></a>      <span class="c1"># finding Vertex objects, hence we use lists of IDs not Vertex objects</span>
</span><span id="L-272"><a href="#L-272"><span class="linenos"> 272</span></a>      <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">vertices</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="L-273"><a href="#L-273"><span class="linenos"> 273</span></a>        <span class="k">for</span> <span class="n">v1</span><span class="p">,</span> <span class="n">v2</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">vertices</span><span class="p">,</span> <span class="n">vertices</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">+</span> <span class="n">vertices</span><span class="p">[:</span><span class="mi">1</span><span class="p">],</span> <span class="n">strict</span> <span class="o">=</span> <span class="kc">True</span><span class="p">):</span>
</span><span id="L-274"><a href="#L-274"><span class="linenos"> 274</span></a>          <span class="n">corner_IDs</span> <span class="o">=</span> <span class="n">tile</span><span class="o">.</span><span class="n">get_corner_IDs</span><span class="p">()</span>
</span><span id="L-275"><a href="#L-275"><span class="linenos"> 275</span></a>          <span class="n">idx1</span> <span class="o">=</span> <span class="n">corner_IDs</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">v1</span><span class="o">.</span><span class="n">ID</span><span class="p">)</span>
</span><span id="L-276"><a href="#L-276"><span class="linenos"> 276</span></a>          <span class="n">idx2</span> <span class="o">=</span> <span class="n">corner_IDs</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">v2</span><span class="o">.</span><span class="n">ID</span><span class="p">)</span>
</span><span id="L-277"><a href="#L-277"><span class="linenos"> 277</span></a>          <span class="k">if</span> <span class="n">idx1</span> <span class="o">&lt;</span> <span class="n">idx2</span><span class="p">:</span>
</span><span id="L-278"><a href="#L-278"><span class="linenos"> 278</span></a>            <span class="n">corners</span> <span class="o">=</span> <span class="n">corner_IDs</span><span class="p">[</span><span class="n">idx1</span><span class="p">:(</span><span class="n">idx2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span>
</span><span id="L-279"><a href="#L-279"><span class="linenos"> 279</span></a>          <span class="k">else</span><span class="p">:</span>
</span><span id="L-280"><a href="#L-280"><span class="linenos"> 280</span></a>            <span class="n">corners</span> <span class="o">=</span> <span class="n">corner_IDs</span><span class="p">[</span><span class="n">idx1</span><span class="p">:]</span> <span class="o">+</span> <span class="n">corner_IDs</span><span class="p">[:(</span><span class="n">idx2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span>
</span><span id="L-281"><a href="#L-281"><span class="linenos"> 281</span></a>          <span class="n">ID</span> <span class="o">=</span> <span class="p">(</span><span class="n">corners</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">corners</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</span><span id="L-282"><a href="#L-282"><span class="linenos"> 282</span></a>          <span class="k">if</span> <span class="n">ID</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">:</span>
</span><span id="L-283"><a href="#L-283"><span class="linenos"> 283</span></a>            <span class="c1"># check that reverse direction edge is not present first</span>
</span><span id="L-284"><a href="#L-284"><span class="linenos"> 284</span></a>            <span class="n">r_ID</span> <span class="o">=</span> <span class="n">ID</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-285"><a href="#L-285"><span class="linenos"> 285</span></a>            <span class="k">if</span> <span class="n">r_ID</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">:</span>
</span><span id="L-286"><a href="#L-286"><span class="linenos"> 286</span></a>              <span class="c1"># if it is, then add it and set left_tile</span>
</span><span id="L-287"><a href="#L-287"><span class="linenos"> 287</span></a>              <span class="k">if</span> <span class="n">debug</span><span class="p">:</span>
</span><span id="L-288"><a href="#L-288"><span class="linenos"> 288</span></a>                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;reverse edge </span><span class="si">{</span><span class="n">r_ID</span><span class="si">}</span><span class="s2"> found&quot;</span><span class="p">)</span>
</span><span id="L-289"><a href="#L-289"><span class="linenos"> 289</span></a>              <span class="n">e</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">r_ID</span><span class="p">]</span>
</span><span id="L-290"><a href="#L-290"><span class="linenos"> 290</span></a>              <span class="n">e</span><span class="o">.</span><span class="n">left_tile</span> <span class="o">=</span> <span class="n">tile</span>
</span><span id="L-291"><a href="#L-291"><span class="linenos"> 291</span></a>              <span class="n">tile</span><span class="o">.</span><span class="n">edges</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</span><span id="L-292"><a href="#L-292"><span class="linenos"> 292</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-293"><a href="#L-293"><span class="linenos"> 293</span></a>              <span class="c1"># we&#39;ve found a new edge so make and add it</span>
</span><span id="L-294"><a href="#L-294"><span class="linenos"> 294</span></a>              <span class="k">if</span> <span class="n">debug</span><span class="p">:</span>
</span><span id="L-295"><a href="#L-295"><span class="linenos"> 295</span></a>                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;adding new edge </span><span class="si">{</span><span class="n">corners</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-296"><a href="#L-296"><span class="linenos"> 296</span></a>              <span class="n">e</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_edge</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">points</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">corners</span><span class="p">])</span>
</span><span id="L-297"><a href="#L-297"><span class="linenos"> 297</span></a>              <span class="n">e</span><span class="o">.</span><span class="n">right_tile</span> <span class="o">=</span> <span class="n">tile</span>
</span><span id="L-298"><a href="#L-298"><span class="linenos"> 298</span></a>              <span class="n">tile</span><span class="o">.</span><span class="n">edges</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</span><span id="L-299"><a href="#L-299"><span class="linenos"> 299</span></a>      <span class="c1"># initialise the edge direction information in the tile</span>
</span><span id="L-300"><a href="#L-300"><span class="linenos"> 300</span></a>      <span class="n">tile</span><span class="o">.</span><span class="n">set_edge_directions</span><span class="p">()</span>
</span><span id="L-301"><a href="#L-301"><span class="linenos"> 301</span></a>
</span><span id="L-302"><a href="#L-302"><span class="linenos"> 302</span></a>
</span><span id="L-303"><a href="#L-303"><span class="linenos"> 303</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">_assign_vertex_and_edge_base_IDs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-304"><a href="#L-304"><span class="linenos"> 304</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Assign the base_ID attributes of vertices and edges.</span>
</span><span id="L-305"><a href="#L-305"><span class="linenos"> 305</span></a>
</span><span id="L-306"><a href="#L-306"><span class="linenos"> 306</span></a><span class="sd">    These allow us to determine corrspondences between vertices and edges in</span>
</span><span id="L-307"><a href="#L-307"><span class="linenos"> 307</span></a><span class="sd">    the &#39;base&#39; tiles in the Topology tileable, and those we have added at</span>
</span><span id="L-308"><a href="#L-308"><span class="linenos"> 308</span></a><span class="sd">    radius 1 for labelling and visualisation.</span>
</span><span id="L-309"><a href="#L-309"><span class="linenos"> 309</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-310"><a href="#L-310"><span class="linenos"> 310</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_assign_vertex_base_IDs</span><span class="p">()</span>
</span><span id="L-311"><a href="#L-311"><span class="linenos"> 311</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_assign_edge_base_IDs</span><span class="p">()</span>
</span><span id="L-312"><a href="#L-312"><span class="linenos"> 312</span></a>
</span><span id="L-313"><a href="#L-313"><span class="linenos"> 313</span></a>
</span><span id="L-314"><a href="#L-314"><span class="linenos"> 314</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">_assign_vertex_base_IDs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-315"><a href="#L-315"><span class="linenos"> 315</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Assign base_ID attribute of vertices.&quot;&quot;&quot;</span>
</span><span id="L-316"><a href="#L-316"><span class="linenos"> 316</span></a>    <span class="c1"># assign vertex base_ID frome the core tiles</span>
</span><span id="L-317"><a href="#L-317"><span class="linenos"> 317</span></a>    <span class="k">for</span> <span class="n">tile0</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tiles</span><span class="p">[:</span><span class="bp">self</span><span class="o">.</span><span class="n">n_tiles</span><span class="p">]:</span>
</span><span id="L-318"><a href="#L-318"><span class="linenos"> 318</span></a>      <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">tile0</span><span class="o">.</span><span class="n">get_corner_IDs</span><span class="p">():</span>
</span><span id="L-319"><a href="#L-319"><span class="linenos"> 319</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">points</span><span class="p">[</span><span class="n">v</span><span class="p">]</span><span class="o">.</span><span class="n">base_ID</span> <span class="o">=</span> <span class="n">v</span>
</span><span id="L-320"><a href="#L-320"><span class="linenos"> 320</span></a>    <span class="c1"># assign others from their corresponding vertex in the core</span>
</span><span id="L-321"><a href="#L-321"><span class="linenos"> 321</span></a>    <span class="k">for</span> <span class="n">t0</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tiles</span><span class="p">[:</span><span class="bp">self</span><span class="o">.</span><span class="n">n_tiles</span><span class="p">]:</span>
</span><span id="L-322"><a href="#L-322"><span class="linenos"> 322</span></a>      <span class="k">for</span> <span class="n">t1</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tiles</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">n_tiles</span><span class="p">:]:</span>
</span><span id="L-323"><a href="#L-323"><span class="linenos"> 323</span></a>        <span class="k">if</span> <span class="n">t1</span><span class="o">.</span><span class="n">base_ID</span> <span class="o">==</span> <span class="n">t0</span><span class="o">.</span><span class="n">base_ID</span><span class="p">:</span>
</span><span id="L-324"><a href="#L-324"><span class="linenos"> 324</span></a>          <span class="k">for</span> <span class="n">v0</span><span class="p">,</span> <span class="n">v1</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">t0</span><span class="o">.</span><span class="n">corners</span><span class="p">,</span> <span class="n">t1</span><span class="o">.</span><span class="n">corners</span><span class="p">,</span> <span class="n">strict</span> <span class="o">=</span> <span class="kc">True</span><span class="p">):</span>
</span><span id="L-325"><a href="#L-325"><span class="linenos"> 325</span></a>            <span class="n">v1</span><span class="o">.</span><span class="n">base_ID</span> <span class="o">=</span> <span class="n">v0</span><span class="o">.</span><span class="n">base_ID</span>
</span><span id="L-326"><a href="#L-326"><span class="linenos"> 326</span></a>
</span><span id="L-327"><a href="#L-327"><span class="linenos"> 327</span></a>
</span><span id="L-328"><a href="#L-328"><span class="linenos"> 328</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">_assign_edge_base_IDs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-329"><a href="#L-329"><span class="linenos"> 329</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Assign base_ID attribute of edges, based on base_IDs of vertices.&quot;&quot;&quot;</span>
</span><span id="L-330"><a href="#L-330"><span class="linenos"> 330</span></a>    <span class="k">for</span> <span class="n">tile0</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tiles</span><span class="p">[:</span><span class="bp">self</span><span class="o">.</span><span class="n">n_tiles</span><span class="p">]:</span>
</span><span id="L-331"><a href="#L-331"><span class="linenos"> 331</span></a>      <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">tile0</span><span class="o">.</span><span class="n">get_edge_IDs</span><span class="p">():</span>
</span><span id="L-332"><a href="#L-332"><span class="linenos"> 332</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">e</span><span class="p">]</span><span class="o">.</span><span class="n">base_ID</span> <span class="o">=</span> <span class="n">e</span>
</span><span id="L-333"><a href="#L-333"><span class="linenos"> 333</span></a>    <span class="k">for</span> <span class="n">t0</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tiles</span><span class="p">[:</span><span class="bp">self</span><span class="o">.</span><span class="n">n_tiles</span><span class="p">]:</span>
</span><span id="L-334"><a href="#L-334"><span class="linenos"> 334</span></a>      <span class="k">for</span> <span class="n">t1</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tiles</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">n_tiles</span><span class="p">:]:</span>
</span><span id="L-335"><a href="#L-335"><span class="linenos"> 335</span></a>        <span class="k">if</span> <span class="n">t1</span><span class="o">.</span><span class="n">base_ID</span> <span class="o">==</span> <span class="n">t0</span><span class="o">.</span><span class="n">base_ID</span><span class="p">:</span>
</span><span id="L-336"><a href="#L-336"><span class="linenos"> 336</span></a>          <span class="k">for</span> <span class="n">e0</span><span class="p">,</span> <span class="n">e1</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">t0</span><span class="o">.</span><span class="n">edges</span><span class="p">,</span> <span class="n">t1</span><span class="o">.</span><span class="n">edges</span><span class="p">,</span> <span class="n">strict</span> <span class="o">=</span> <span class="kc">True</span><span class="p">):</span>
</span><span id="L-337"><a href="#L-337"><span class="linenos"> 337</span></a>            <span class="n">e1</span><span class="o">.</span><span class="n">base_ID</span> <span class="o">=</span> <span class="n">e0</span><span class="o">.</span><span class="n">base_ID</span>
</span><span id="L-338"><a href="#L-338"><span class="linenos"> 338</span></a>
</span><span id="L-339"><a href="#L-339"><span class="linenos"> 339</span></a>
</span><span id="L-340"><a href="#L-340"><span class="linenos"> 340</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">_copy_base_tiles_to_patch</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-341"><a href="#L-341"><span class="linenos"> 341</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Copy attributes of base tiles to corresponding tiles in radius-1 patch.</span>
</span><span id="L-342"><a href="#L-342"><span class="linenos"> 342</span></a>
</span><span id="L-343"><a href="#L-343"><span class="linenos"> 343</span></a><span class="sd">    This requires:</span>
</span><span id="L-344"><a href="#L-344"><span class="linenos"> 344</span></a>
</span><span id="L-345"><a href="#L-345"><span class="linenos"> 345</span></a><span class="sd">    First, inserting any additional corners in the base tiles not found in the</span>
</span><span id="L-346"><a href="#L-346"><span class="linenos"> 346</span></a><span class="sd">    radius-1 tiles.</span>
</span><span id="L-347"><a href="#L-347"><span class="linenos"> 347</span></a>
</span><span id="L-348"><a href="#L-348"><span class="linenos"> 348</span></a><span class="sd">    Second, any vertices in the base tiles that are NOT tiling vertices are</span>
</span><span id="L-349"><a href="#L-349"><span class="linenos"> 349</span></a><span class="sd">    applied to radius-1 tiles leading to merging of some edges.</span>
</span><span id="L-350"><a href="#L-350"><span class="linenos"> 350</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-351"><a href="#L-351"><span class="linenos"> 351</span></a>    <span class="c1"># the number of tiles in the base + radius-1</span>
</span><span id="L-352"><a href="#L-352"><span class="linenos"> 352</span></a>    <span class="n">n_r1</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tiles</span><span class="p">)</span>
</span><span id="L-353"><a href="#L-353"><span class="linenos"> 353</span></a>    <span class="c1"># first add any missing vertices to the non-base tiles</span>
</span><span id="L-354"><a href="#L-354"><span class="linenos"> 354</span></a>    <span class="c1"># we add all the missing vertices before doing any merges</span>
</span><span id="L-355"><a href="#L-355"><span class="linenos"> 355</span></a>    <span class="k">for</span> <span class="n">base</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tiles</span><span class="p">[:</span><span class="bp">self</span><span class="o">.</span><span class="n">n_tiles</span><span class="p">]:</span>
</span><span id="L-356"><a href="#L-356"><span class="linenos"> 356</span></a>      <span class="k">for</span> <span class="n">other</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tiles</span><span class="p">[</span><span class="n">base</span><span class="o">.</span><span class="n">ID</span><span class="p">:</span><span class="n">n_r1</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">n_tiles</span><span class="p">]:</span>
</span><span id="L-357"><a href="#L-357"><span class="linenos"> 357</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_match_reference_tile_vertices</span><span class="p">(</span><span class="n">base</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span>
</span><span id="L-358"><a href="#L-358"><span class="linenos"> 358</span></a>    <span class="c1"># then merge any edges that meet at a corner</span>
</span><span id="L-359"><a href="#L-359"><span class="linenos"> 359</span></a>    <span class="k">for</span> <span class="n">base</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tiles</span><span class="p">[:</span><span class="bp">self</span><span class="o">.</span><span class="n">n_tiles</span><span class="p">]:</span>
</span><span id="L-360"><a href="#L-360"><span class="linenos"> 360</span></a>      <span class="k">for</span> <span class="n">other</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tiles</span><span class="p">[</span><span class="n">base</span><span class="o">.</span><span class="n">ID</span><span class="p">:</span><span class="n">n_r1</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">n_tiles</span><span class="p">]:</span>
</span><span id="L-361"><a href="#L-361"><span class="linenos"> 361</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_match_reference_tile_corners</span><span class="p">(</span><span class="n">base</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span>
</span><span id="L-362"><a href="#L-362"><span class="linenos"> 362</span></a>
</span><span id="L-363"><a href="#L-363"><span class="linenos"> 363</span></a>
</span><span id="L-364"><a href="#L-364"><span class="linenos"> 364</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">_match_reference_tile_vertices</span><span class="p">(</span>
</span><span id="L-365"><a href="#L-365"><span class="linenos"> 365</span></a>      <span class="bp">self</span><span class="p">,</span>
</span><span id="L-366"><a href="#L-366"><span class="linenos"> 366</span></a>      <span class="n">tile1</span><span class="p">:</span><span class="n">Tile</span><span class="p">,</span>
</span><span id="L-367"><a href="#L-367"><span class="linenos"> 367</span></a>      <span class="n">tile2</span><span class="p">:</span><span class="n">Tile</span><span class="p">,</span>
</span><span id="L-368"><a href="#L-368"><span class="linenos"> 368</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-369"><a href="#L-369"><span class="linenos"> 369</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Add vertices to tile2 so it matches tile1 adjusting edges as required.</span>
</span><span id="L-370"><a href="#L-370"><span class="linenos"> 370</span></a>
</span><span id="L-371"><a href="#L-371"><span class="linenos"> 371</span></a><span class="sd">    This assumes the tiles are the same shape, but that tile2 may be missing</span>
</span><span id="L-372"><a href="#L-372"><span class="linenos"> 372</span></a><span class="sd">    some tiling vertices along some edges.</span>
</span><span id="L-373"><a href="#L-373"><span class="linenos"> 373</span></a>
</span><span id="L-374"><a href="#L-374"><span class="linenos"> 374</span></a><span class="sd">    Args:</span>
</span><span id="L-375"><a href="#L-375"><span class="linenos"> 375</span></a><span class="sd">      tile1 (Tile): reference tile.</span>
</span><span id="L-376"><a href="#L-376"><span class="linenos"> 376</span></a><span class="sd">      tile2 (Tile): tile to change.</span>
</span><span id="L-377"><a href="#L-377"><span class="linenos"> 377</span></a>
</span><span id="L-378"><a href="#L-378"><span class="linenos"> 378</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-379"><a href="#L-379"><span class="linenos"> 379</span></a>    <span class="n">to_add</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">tile1</span><span class="o">.</span><span class="n">corners</span><span class="p">)</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">tile2</span><span class="o">.</span><span class="n">corners</span><span class="p">)</span>
</span><span id="L-380"><a href="#L-380"><span class="linenos"> 380</span></a>    <span class="k">while</span> <span class="n">to_add</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-381"><a href="#L-381"><span class="linenos"> 381</span></a>      <span class="c1"># find the reference x-y offset</span>
</span><span id="L-382"><a href="#L-382"><span class="linenos"> 382</span></a>      <span class="n">dxy</span> <span class="o">=</span> <span class="p">(</span><span class="n">tile2</span><span class="o">.</span><span class="n">centre</span><span class="o">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">tile1</span><span class="o">.</span><span class="n">centre</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">tile2</span><span class="o">.</span><span class="n">centre</span><span class="o">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">tile1</span><span class="o">.</span><span class="n">centre</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
</span><span id="L-383"><a href="#L-383"><span class="linenos"> 383</span></a>      <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">t1c</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">([</span><span class="n">c</span><span class="o">.</span><span class="n">point</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">tile1</span><span class="o">.</span><span class="n">corners</span><span class="p">]):</span>
</span><span id="L-384"><a href="#L-384"><span class="linenos"> 384</span></a>        <span class="n">t2c</span> <span class="o">=</span> <span class="n">tile2</span><span class="o">.</span><span class="n">corners</span><span class="p">[</span><span class="n">i</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">tile2</span><span class="o">.</span><span class="n">corners</span><span class="p">)]</span><span class="o">.</span><span class="n">point</span>
</span><span id="L-385"><a href="#L-385"><span class="linenos"> 385</span></a>        <span class="k">if</span> <span class="nb">abs</span><span class="p">((</span><span class="n">t2c</span><span class="o">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">t1c</span><span class="o">.</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="n">dxy</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">tiling_utils</span><span class="o">.</span><span class="n">RESOLUTION</span> <span class="ow">or</span> \
</span><span id="L-386"><a href="#L-386"><span class="linenos"> 386</span></a>           <span class="nb">abs</span><span class="p">((</span><span class="n">t2c</span><span class="o">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">t1c</span><span class="o">.</span><span class="n">y</span><span class="p">)</span> <span class="o">-</span> <span class="n">dxy</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">tiling_utils</span><span class="o">.</span><span class="n">RESOLUTION</span><span class="p">:</span>
</span><span id="L-387"><a href="#L-387"><span class="linenos"> 387</span></a>          <span class="c1"># add vertex to t2 by copying the t1 vertex appropriately offset</span>
</span><span id="L-388"><a href="#L-388"><span class="linenos"> 388</span></a>          <span class="c1"># note that this might alter the length of t2.corners</span>
</span><span id="L-389"><a href="#L-389"><span class="linenos"> 389</span></a>          <span class="n">v</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_vertex</span><span class="p">(</span><span class="n">geom</span><span class="o">.</span><span class="n">Point</span><span class="p">(</span><span class="n">t1c</span><span class="o">.</span><span class="n">x</span> <span class="o">+</span> <span class="n">dxy</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">t1c</span><span class="o">.</span><span class="n">y</span> <span class="o">+</span> <span class="n">dxy</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
</span><span id="L-390"><a href="#L-390"><span class="linenos"> 390</span></a>          <span class="n">v</span><span class="o">.</span><span class="n">is_tiling_vertex</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="L-391"><a href="#L-391"><span class="linenos"> 391</span></a>          <span class="n">old_edge</span><span class="p">,</span> <span class="n">new_edges</span> <span class="o">=</span> <span class="n">tile2</span><span class="o">.</span><span class="n">insert_vertex_at</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
</span><span id="L-392"><a href="#L-392"><span class="linenos"> 392</span></a>          <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">old_edge</span><span class="p">]</span>
</span><span id="L-393"><a href="#L-393"><span class="linenos"> 393</span></a>          <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">new_edges</span><span class="p">:</span>
</span><span id="L-394"><a href="#L-394"><span class="linenos"> 394</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">ID</span><span class="p">]</span> <span class="o">=</span> <span class="n">e</span>
</span><span id="L-395"><a href="#L-395"><span class="linenos"> 395</span></a>          <span class="n">to_add</span> <span class="o">=</span> <span class="n">to_add</span> <span class="o">-</span> <span class="mi">1</span>
</span><span id="L-396"><a href="#L-396"><span class="linenos"> 396</span></a>
</span><span id="L-397"><a href="#L-397"><span class="linenos"> 397</span></a>
</span><span id="L-398"><a href="#L-398"><span class="linenos"> 398</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">_match_reference_tile_corners</span><span class="p">(</span>
</span><span id="L-399"><a href="#L-399"><span class="linenos"> 399</span></a>      <span class="bp">self</span><span class="p">,</span>
</span><span id="L-400"><a href="#L-400"><span class="linenos"> 400</span></a>      <span class="n">tile1</span><span class="p">:</span><span class="n">Tile</span><span class="p">,</span>
</span><span id="L-401"><a href="#L-401"><span class="linenos"> 401</span></a>      <span class="n">tile2</span><span class="p">:</span><span class="n">Tile</span><span class="p">,</span>
</span><span id="L-402"><a href="#L-402"><span class="linenos"> 402</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-403"><a href="#L-403"><span class="linenos"> 403</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Make vertices that are corners in tile1 corners in tile2.</span>
</span><span id="L-404"><a href="#L-404"><span class="linenos"> 404</span></a>
</span><span id="L-405"><a href="#L-405"><span class="linenos"> 405</span></a><span class="sd">    Edges are merged as required.</span>
</span><span id="L-406"><a href="#L-406"><span class="linenos"> 406</span></a>
</span><span id="L-407"><a href="#L-407"><span class="linenos"> 407</span></a><span class="sd">    Args:</span>
</span><span id="L-408"><a href="#L-408"><span class="linenos"> 408</span></a><span class="sd">        tile1 (Tile): reference tile.</span>
</span><span id="L-409"><a href="#L-409"><span class="linenos"> 409</span></a><span class="sd">        tile2 (Tile): tile to make match.</span>
</span><span id="L-410"><a href="#L-410"><span class="linenos"> 410</span></a>
</span><span id="L-411"><a href="#L-411"><span class="linenos"> 411</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-412"><a href="#L-412"><span class="linenos"> 412</span></a>    <span class="n">vs_to_change</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="L-413"><a href="#L-413"><span class="linenos"> 413</span></a>      <span class="n">vj</span> <span class="k">for</span> <span class="n">vi</span><span class="p">,</span> <span class="n">vj</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">tile1</span><span class="o">.</span><span class="n">corners</span><span class="p">,</span> <span class="n">tile2</span><span class="o">.</span><span class="n">corners</span><span class="p">,</span> <span class="n">strict</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</span><span id="L-414"><a href="#L-414"><span class="linenos"> 414</span></a>      <span class="k">if</span> <span class="ow">not</span> <span class="n">vi</span><span class="o">.</span><span class="n">is_tiling_vertex</span> <span class="ow">and</span> <span class="n">vj</span><span class="o">.</span><span class="n">is_tiling_vertex</span><span class="p">]</span>
</span><span id="L-415"><a href="#L-415"><span class="linenos"> 415</span></a>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">vs_to_change</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-416"><a href="#L-416"><span class="linenos"> 416</span></a>      <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">vs_to_change</span><span class="p">:</span>
</span><span id="L-417"><a href="#L-417"><span class="linenos"> 417</span></a>        <span class="n">v</span><span class="o">.</span><span class="n">is_tiling_vertex</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-418"><a href="#L-418"><span class="linenos"> 418</span></a>        <span class="c1"># it&#39;s a corner not an edge so will have no more than 2 v.tiles</span>
</span><span id="L-419"><a href="#L-419"><span class="linenos"> 419</span></a>        <span class="n">old_edges</span><span class="p">,</span> <span class="n">new_edge</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">tiles</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">merge_edges_at_vertex</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
</span><span id="L-420"><a href="#L-420"><span class="linenos"> 420</span></a>        <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">old_edges</span><span class="p">:</span>
</span><span id="L-421"><a href="#L-421"><span class="linenos"> 421</span></a>          <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">e</span><span class="p">]</span>
</span><span id="L-422"><a href="#L-422"><span class="linenos"> 422</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">new_edge</span><span class="o">.</span><span class="n">ID</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_edge</span>
</span><span id="L-423"><a href="#L-423"><span class="linenos"> 423</span></a>
</span><span id="L-424"><a href="#L-424"><span class="linenos"> 424</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">_identify_distinct_tile_shapes</span><span class="p">(</span>
</span><span id="L-425"><a href="#L-425"><span class="linenos"> 425</span></a>      <span class="bp">self</span><span class="p">,</span>
</span><span id="L-426"><a href="#L-426"><span class="linenos"> 426</span></a>      <span class="n">ignore_tile_id_labels</span><span class="p">:</span><span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="L-427"><a href="#L-427"><span class="linenos"> 427</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-428"><a href="#L-428"><span class="linenos"> 428</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Identify unique tiles based on their symmetries and shapes.</span>
</span><span id="L-429"><a href="#L-429"><span class="linenos"> 429</span></a>
</span><span id="L-430"><a href="#L-430"><span class="linenos"> 430</span></a><span class="sd">    At the same time assembles a list of the affine transforms under which</span>
</span><span id="L-431"><a href="#L-431"><span class="linenos"> 431</span></a><span class="sd">    matches occurs since these are potential symmetries of the tiling.</span>
</span><span id="L-432"><a href="#L-432"><span class="linenos"> 432</span></a>
</span><span id="L-433"><a href="#L-433"><span class="linenos"> 433</span></a><span class="sd">    TODO: reimplement consideration of tile_id</span>
</span><span id="L-434"><a href="#L-434"><span class="linenos"> 434</span></a>
</span><span id="L-435"><a href="#L-435"><span class="linenos"> 435</span></a><span class="sd">    Args:</span>
</span><span id="L-436"><a href="#L-436"><span class="linenos"> 436</span></a><span class="sd">      ignore_tile_id_labels (bool): if True only the shape of tiles matters; if</span>
</span><span id="L-437"><a href="#L-437"><span class="linenos"> 437</span></a><span class="sd">        False the tile_id label is also considered. Defaults to True.</span>
</span><span id="L-438"><a href="#L-438"><span class="linenos"> 438</span></a>
</span><span id="L-439"><a href="#L-439"><span class="linenos"> 439</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-440"><a href="#L-440"><span class="linenos"> 440</span></a>    <span class="k">if</span> <span class="n">ignore_tile_id_labels</span><span class="p">:</span>
</span><span id="L-441"><a href="#L-441"><span class="linenos"> 441</span></a>      <span class="n">matches</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="L-442"><a href="#L-442"><span class="linenos"> 442</span></a>      <span class="n">offsets</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="L-443"><a href="#L-443"><span class="linenos"> 443</span></a>      <span class="k">for</span> <span class="n">tile</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tiles</span><span class="p">[:</span><span class="bp">self</span><span class="o">.</span><span class="n">n_tiles</span><span class="p">]:</span>
</span><span id="L-444"><a href="#L-444"><span class="linenos"> 444</span></a>        <span class="n">matches</span><span class="p">[</span><span class="n">tile</span><span class="o">.</span><span class="n">base_ID</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">tile</span><span class="o">.</span><span class="n">base_ID</span><span class="p">]</span>
</span><span id="L-445"><a href="#L-445"><span class="linenos"> 445</span></a>        <span class="n">matched</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-446"><a href="#L-446"><span class="linenos"> 446</span></a>        <span class="n">s</span> <span class="o">=</span> <span class="n">Symmetries</span><span class="p">(</span><span class="n">tile</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</span><span id="L-447"><a href="#L-447"><span class="linenos"> 447</span></a>        <span class="k">for</span> <span class="n">other</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tiles</span><span class="p">[:</span><span class="bp">self</span><span class="o">.</span><span class="n">n_tiles</span><span class="p">]:</span>
</span><span id="L-448"><a href="#L-448"><span class="linenos"> 448</span></a>          <span class="k">if</span> <span class="n">other</span><span class="o">.</span><span class="n">ID</span> <span class="o">&gt;</span> <span class="n">tile</span><span class="o">.</span><span class="n">ID</span><span class="p">:</span>
</span><span id="L-449"><a href="#L-449"><span class="linenos"> 449</span></a>            <span class="n">offset</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">get_corner_offset</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</span><span id="L-450"><a href="#L-450"><span class="linenos"> 450</span></a>            <span class="k">if</span> <span class="n">offset</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-451"><a href="#L-451"><span class="linenos"> 451</span></a>              <span class="n">offsets</span><span class="p">[</span><span class="n">tile</span><span class="o">.</span><span class="n">base_ID</span><span class="p">]</span> <span class="o">=</span> <span class="n">offset</span>
</span><span id="L-452"><a href="#L-452"><span class="linenos"> 452</span></a>              <span class="n">matches</span><span class="p">[</span><span class="n">tile</span><span class="o">.</span><span class="n">base_ID</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">base_ID</span><span class="p">)</span>
</span><span id="L-453"><a href="#L-453"><span class="linenos"> 453</span></a>              <span class="n">matched</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="L-454"><a href="#L-454"><span class="linenos"> 454</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">matched</span><span class="p">:</span>
</span><span id="L-455"><a href="#L-455"><span class="linenos"> 455</span></a>          <span class="n">offsets</span><span class="p">[</span><span class="n">tile</span><span class="o">.</span><span class="n">base_ID</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-456"><a href="#L-456"><span class="linenos"> 456</span></a>      <span class="n">base_groups</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span>
</span><span id="L-457"><a href="#L-457"><span class="linenos"> 457</span></a>        <span class="n">nx</span><span class="o">.</span><span class="n">connected_components</span><span class="p">(</span><span class="n">nx</span><span class="o">.</span><span class="n">from_dict_of_lists</span><span class="p">(</span><span class="n">matches</span><span class="p">)))</span>
</span><span id="L-458"><a href="#L-458"><span class="linenos"> 458</span></a>      <span class="bp">self</span><span class="o">.</span><span class="n">shape_groups</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-459"><a href="#L-459"><span class="linenos"> 459</span></a>      <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">group</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">base_groups</span><span class="p">):</span>
</span><span id="L-460"><a href="#L-460"><span class="linenos"> 460</span></a>        <span class="n">full_group</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-461"><a href="#L-461"><span class="linenos"> 461</span></a>        <span class="k">for</span> <span class="n">tile</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tiles</span><span class="p">:</span>
</span><span id="L-462"><a href="#L-462"><span class="linenos"> 462</span></a>          <span class="k">if</span> <span class="n">tile</span><span class="o">.</span><span class="n">base_ID</span> <span class="ow">in</span> <span class="n">group</span><span class="p">:</span>
</span><span id="L-463"><a href="#L-463"><span class="linenos"> 463</span></a>            <span class="n">tile</span><span class="o">.</span><span class="n">shape_group</span> <span class="o">=</span> <span class="n">i</span>
</span><span id="L-464"><a href="#L-464"><span class="linenos"> 464</span></a>            <span class="n">tile</span><span class="o">.</span><span class="n">offset_corners</span><span class="p">(</span><span class="n">offsets</span><span class="p">[</span><span class="n">tile</span><span class="o">.</span><span class="n">base_ID</span><span class="p">])</span>
</span><span id="L-465"><a href="#L-465"><span class="linenos"> 465</span></a>            <span class="n">full_group</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tile</span><span class="o">.</span><span class="n">ID</span><span class="p">)</span>
</span><span id="L-466"><a href="#L-466"><span class="linenos"> 466</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">shape_groups</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">full_group</span><span class="p">)</span>
</span><span id="L-467"><a href="#L-467"><span class="linenos"> 467</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="L-468"><a href="#L-468"><span class="linenos"> 468</span></a>      <span class="bp">self</span><span class="o">.</span><span class="n">shape_groups</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-469"><a href="#L-469"><span class="linenos"> 469</span></a>      <span class="k">for</span> <span class="n">ti</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tiles</span><span class="p">[:</span><span class="bp">self</span><span class="o">.</span><span class="n">n_tiles</span><span class="p">]:</span>
</span><span id="L-470"><a href="#L-470"><span class="linenos"> 470</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">shape_groups</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
</span><span id="L-471"><a href="#L-471"><span class="linenos"> 471</span></a>          <span class="p">[</span><span class="n">tj</span><span class="o">.</span><span class="n">ID</span> <span class="k">for</span> <span class="n">tj</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tiles</span> <span class="k">if</span> <span class="n">tj</span><span class="o">.</span><span class="n">base_ID</span> <span class="o">==</span> <span class="n">ti</span><span class="o">.</span><span class="n">base_ID</span><span class="p">])</span>
</span><span id="L-472"><a href="#L-472"><span class="linenos"> 472</span></a>      <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">group</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">shape_groups</span><span class="p">):</span>
</span><span id="L-473"><a href="#L-473"><span class="linenos"> 473</span></a>        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">group</span><span class="p">:</span>
</span><span id="L-474"><a href="#L-474"><span class="linenos"> 474</span></a>          <span class="bp">self</span><span class="o">.</span><span class="n">tiles</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">shape_group</span> <span class="o">=</span> <span class="n">i</span>
</span><span id="L-475"><a href="#L-475"><span class="linenos"> 475</span></a>
</span><span id="L-476"><a href="#L-476"><span class="linenos"> 476</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">_find_tile_transitivity_classes</span><span class="p">(</span>
</span><span id="L-477"><a href="#L-477"><span class="linenos"> 477</span></a>      <span class="bp">self</span><span class="p">,</span>
</span><span id="L-478"><a href="#L-478"><span class="linenos"> 478</span></a>      <span class="n">ignore_tile_id_labels</span><span class="p">:</span><span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="L-479"><a href="#L-479"><span class="linenos"> 479</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-480"><a href="#L-480"><span class="linenos"> 480</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Find tiles equivalent under symmetries.</span>
</span><span id="L-481"><a href="#L-481"><span class="linenos"> 481</span></a>
</span><span id="L-482"><a href="#L-482"><span class="linenos"> 482</span></a><span class="sd">    Also update the tile_matching_transforms attribute to contain only those</span>
</span><span id="L-483"><a href="#L-483"><span class="linenos"> 483</span></a><span class="sd">    transforms that pass this test.</span>
</span><span id="L-484"><a href="#L-484"><span class="linenos"> 484</span></a>
</span><span id="L-485"><a href="#L-485"><span class="linenos"> 485</span></a><span class="sd">    Args:</span>
</span><span id="L-486"><a href="#L-486"><span class="linenos"> 486</span></a><span class="sd">      ignore_tile_id_labels (bool): if True then consider only shapes; if False</span>
</span><span id="L-487"><a href="#L-487"><span class="linenos"> 487</span></a><span class="sd">        also consider labels of tiles. Defaults to True.</span>
</span><span id="L-488"><a href="#L-488"><span class="linenos"> 488</span></a>
</span><span id="L-489"><a href="#L-489"><span class="linenos"> 489</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-490"><a href="#L-490"><span class="linenos"> 490</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">tile_matching_transforms</span> <span class="o">=</span> \
</span><span id="L-491"><a href="#L-491"><span class="linenos"> 491</span></a>      <span class="bp">self</span><span class="o">.</span><span class="n">get_potential_symmetries</span><span class="p">(</span><span class="n">ignore_tile_id_labels</span><span class="p">)</span>
</span><span id="L-492"><a href="#L-492"><span class="linenos"> 492</span></a>    <span class="k">if</span> <span class="n">ignore_tile_id_labels</span><span class="p">:</span>
</span><span id="L-493"><a href="#L-493"><span class="linenos"> 493</span></a>      <span class="n">base_tiles</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tiles</span><span class="p">[:</span><span class="bp">self</span><span class="o">.</span><span class="n">n_tiles</span><span class="p">]</span>
</span><span id="L-494"><a href="#L-494"><span class="linenos"> 494</span></a>      <span class="c1"># it is quicker (should be!) to only do within shape group tests</span>
</span><span id="L-495"><a href="#L-495"><span class="linenos"> 495</span></a>      <span class="c1"># often there is only one when it will make no difference</span>
</span><span id="L-496"><a href="#L-496"><span class="linenos"> 496</span></a>      <span class="n">by_group_equivalent_tiles</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-497"><a href="#L-497"><span class="linenos"> 497</span></a>      <span class="c1"># maintain a set of transforms still potentially tiling symmetries</span>
</span><span id="L-498"><a href="#L-498"><span class="linenos"> 498</span></a>      <span class="n">poss_transforms</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tile_matching_transforms</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
</span><span id="L-499"><a href="#L-499"><span class="linenos"> 499</span></a>      <span class="c1"># and a dictionary of booleans tracking which transforms are still valid</span>
</span><span id="L-500"><a href="#L-500"><span class="linenos"> 500</span></a>      <span class="n">eq_under_transform</span> <span class="o">=</span> <span class="nb">dict</span><span class="o">.</span><span class="n">fromkeys</span><span class="p">(</span><span class="n">poss_transforms</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
</span><span id="L-501"><a href="#L-501"><span class="linenos"> 501</span></a>      <span class="k">for</span> <span class="n">g</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">shape_groups</span><span class="p">):</span>
</span><span id="L-502"><a href="#L-502"><span class="linenos"> 502</span></a>        <span class="n">by_group_equivalent_tiles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">set</span><span class="p">())</span>
</span><span id="L-503"><a href="#L-503"><span class="linenos"> 503</span></a>        <span class="n">source_tiles</span> <span class="o">=</span> <span class="p">[</span><span class="n">tile</span> <span class="k">for</span> <span class="n">tile</span> <span class="ow">in</span> <span class="n">base_tiles</span> <span class="k">if</span> <span class="n">tile</span><span class="o">.</span><span class="n">shape_group</span> <span class="o">==</span> <span class="n">g</span><span class="p">]</span>
</span><span id="L-504"><a href="#L-504"><span class="linenos"> 504</span></a>        <span class="n">target_tiles</span> <span class="o">=</span> <span class="p">[</span><span class="n">tile</span> <span class="k">for</span> <span class="n">tile</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tiles</span> <span class="k">if</span> <span class="n">tile</span><span class="o">.</span><span class="n">shape_group</span> <span class="o">==</span> <span class="n">g</span><span class="p">]</span>
</span><span id="L-505"><a href="#L-505"><span class="linenos"> 505</span></a>        <span class="k">for</span> <span class="n">tr</span> <span class="ow">in</span> <span class="n">poss_transforms</span><span class="p">:</span>
</span><span id="L-506"><a href="#L-506"><span class="linenos"> 506</span></a>          <span class="n">transform</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tile_matching_transforms</span><span class="p">[</span><span class="n">tr</span><span class="p">]</span><span class="o">.</span><span class="n">transform</span>
</span><span id="L-507"><a href="#L-507"><span class="linenos"> 507</span></a>          <span class="n">matched_tiles</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="L-508"><a href="#L-508"><span class="linenos"> 508</span></a>          <span class="n">eq_under_transform</span><span class="p">[</span><span class="n">tr</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="L-509"><a href="#L-509"><span class="linenos"> 509</span></a>          <span class="k">for</span> <span class="n">source_tile</span> <span class="ow">in</span> <span class="n">source_tiles</span><span class="p">:</span>
</span><span id="L-510"><a href="#L-510"><span class="linenos"> 510</span></a>            <span class="n">matched_tile_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_match_geoms_under_transform</span><span class="p">(</span>
</span><span id="L-511"><a href="#L-511"><span class="linenos"> 511</span></a>              <span class="n">source_tile</span><span class="p">,</span> <span class="n">target_tiles</span><span class="p">,</span> <span class="n">transform</span><span class="p">)</span>
</span><span id="L-512"><a href="#L-512"><span class="linenos"> 512</span></a>            <span class="k">if</span> <span class="n">matched_tile_id</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
</span><span id="L-513"><a href="#L-513"><span class="linenos"> 513</span></a>              <span class="n">eq_under_transform</span><span class="p">[</span><span class="n">tr</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-514"><a href="#L-514"><span class="linenos"> 514</span></a>              <span class="k">break</span>
</span><span id="L-515"><a href="#L-515"><span class="linenos"> 515</span></a>            <span class="n">matched_tiles</span><span class="p">[</span><span class="n">source_tile</span><span class="o">.</span><span class="n">ID</span><span class="p">]</span> <span class="o">=</span> <span class="n">matched_tile_id</span> <span class="c1"># actually a base_ID</span>
</span><span id="L-516"><a href="#L-516"><span class="linenos"> 516</span></a>          <span class="k">if</span> <span class="n">eq_under_transform</span><span class="p">[</span><span class="n">tr</span><span class="p">]:</span>
</span><span id="L-517"><a href="#L-517"><span class="linenos"> 517</span></a>            <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">matched_tiles</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="L-518"><a href="#L-518"><span class="linenos"> 518</span></a>              <span class="c1"># here we record the transform, in case it is later invalidated</span>
</span><span id="L-519"><a href="#L-519"><span class="linenos"> 519</span></a>              <span class="n">by_group_equivalent_tiles</span><span class="p">[</span><span class="n">g</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">((</span><span class="n">tr</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">))</span>
</span><span id="L-520"><a href="#L-520"><span class="linenos"> 520</span></a>        <span class="c1"># remove valid transforms that didn&#39;t make it through this group</span>
</span><span id="L-521"><a href="#L-521"><span class="linenos"> 521</span></a>        <span class="n">poss_transforms</span> <span class="o">=</span> <span class="p">{</span><span class="n">t</span> <span class="k">for</span> <span class="n">t</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">eq_under_transform</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">x</span><span class="p">}</span>
</span><span id="L-522"><a href="#L-522"><span class="linenos"> 522</span></a>      <span class="c1"># compile equivalences from all groups made under still valid transforms</span>
</span><span id="L-523"><a href="#L-523"><span class="linenos"> 523</span></a>      <span class="c1"># a dict of sets so singletons aren&#39;t lost in finding connected components</span>
</span><span id="L-524"><a href="#L-524"><span class="linenos"> 524</span></a>      <span class="n">equivalents</span> <span class="o">=</span> <span class="p">{</span><span class="n">i</span><span class="p">:</span> <span class="nb">set</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_tiles</span><span class="p">)}</span>
</span><span id="L-525"><a href="#L-525"><span class="linenos"> 525</span></a>      <span class="k">for</span> <span class="n">group_equivalents</span> <span class="ow">in</span> <span class="n">by_group_equivalent_tiles</span><span class="p">:</span>
</span><span id="L-526"><a href="#L-526"><span class="linenos"> 526</span></a>        <span class="k">for</span> <span class="p">(</span><span class="n">tr</span><span class="p">,</span> <span class="n">tile_i</span><span class="p">,</span> <span class="n">tile_j</span><span class="p">)</span> <span class="ow">in</span> <span class="n">group_equivalents</span><span class="p">:</span>
</span><span id="L-527"><a href="#L-527"><span class="linenos"> 527</span></a>          <span class="k">if</span> <span class="n">tr</span> <span class="ow">in</span> <span class="n">poss_transforms</span><span class="p">:</span>
</span><span id="L-528"><a href="#L-528"><span class="linenos"> 528</span></a>            <span class="n">equivalents</span><span class="p">[</span><span class="n">tile_i</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">tile_j</span><span class="p">)</span>
</span><span id="L-529"><a href="#L-529"><span class="linenos"> 529</span></a>      <span class="bp">self</span><span class="o">.</span><span class="n">tile_matching_transforms</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="L-530"><a href="#L-530"><span class="linenos"> 530</span></a>        <span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tile_matching_transforms</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
</span><span id="L-531"><a href="#L-531"><span class="linenos"> 531</span></a>        <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">poss_transforms</span><span class="p">}</span>
</span><span id="L-532"><a href="#L-532"><span class="linenos"> 532</span></a>      <span class="bp">self</span><span class="o">.</span><span class="n">tile_transitivity_classes</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-533"><a href="#L-533"><span class="linenos"> 533</span></a>      <span class="n">equivalents</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">connected_components</span><span class="p">(</span><span class="n">nx</span><span class="o">.</span><span class="n">from_dict_of_lists</span><span class="p">(</span><span class="n">equivalents</span><span class="p">))</span>
</span><span id="L-534"><a href="#L-534"><span class="linenos"> 534</span></a>      <span class="k">for</span> <span class="n">c</span><span class="p">,</span> <span class="n">base_IDs</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">equivalents</span><span class="p">):</span>
</span><span id="L-535"><a href="#L-535"><span class="linenos"> 535</span></a>        <span class="n">transitivity_class</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-536"><a href="#L-536"><span class="linenos"> 536</span></a>        <span class="k">for</span> <span class="n">tile</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tiles</span><span class="p">:</span>
</span><span id="L-537"><a href="#L-537"><span class="linenos"> 537</span></a>          <span class="k">if</span> <span class="n">tile</span><span class="o">.</span><span class="n">base_ID</span> <span class="ow">in</span> <span class="n">base_IDs</span><span class="p">:</span>
</span><span id="L-538"><a href="#L-538"><span class="linenos"> 538</span></a>            <span class="n">transitivity_class</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tile</span><span class="o">.</span><span class="n">ID</span><span class="p">)</span>
</span><span id="L-539"><a href="#L-539"><span class="linenos"> 539</span></a>            <span class="n">tile</span><span class="o">.</span><span class="n">transitivity_class</span> <span class="o">=</span> <span class="n">c</span>
</span><span id="L-540"><a href="#L-540"><span class="linenos"> 540</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">tile_transitivity_classes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">transitivity_class</span><span class="p">)</span>
</span><span id="L-541"><a href="#L-541"><span class="linenos"> 541</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="L-542"><a href="#L-542"><span class="linenos"> 542</span></a>      <span class="c1"># transitivity classes are just the individual tiles</span>
</span><span id="L-543"><a href="#L-543"><span class="linenos"> 543</span></a>      <span class="bp">self</span><span class="o">.</span><span class="n">tile_transitivity_classes</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-544"><a href="#L-544"><span class="linenos"> 544</span></a>      <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">tile</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tiles</span><span class="p">):</span>
</span><span id="L-545"><a href="#L-545"><span class="linenos"> 545</span></a>        <span class="n">tile</span><span class="o">.</span><span class="n">transitivity_class</span> <span class="o">=</span> <span class="n">tile</span><span class="o">.</span><span class="n">base_ID</span>
</span><span id="L-546"><a href="#L-546"><span class="linenos"> 546</span></a>        <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_tiles</span><span class="p">:</span>
</span><span id="L-547"><a href="#L-547"><span class="linenos"> 547</span></a>          <span class="bp">self</span><span class="o">.</span><span class="n">tile_transitivity_classes</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">tile</span><span class="o">.</span><span class="n">ID</span><span class="p">])</span>
</span><span id="L-548"><a href="#L-548"><span class="linenos"> 548</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-549"><a href="#L-549"><span class="linenos"> 549</span></a>          <span class="bp">self</span><span class="o">.</span><span class="n">tile_transitivity_classes</span><span class="p">[</span><span class="n">tile</span><span class="o">.</span><span class="n">base_ID</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tile</span><span class="o">.</span><span class="n">ID</span><span class="p">)</span>
</span><span id="L-550"><a href="#L-550"><span class="linenos"> 550</span></a>
</span><span id="L-551"><a href="#L-551"><span class="linenos"> 551</span></a>
</span><span id="L-552"><a href="#L-552"><span class="linenos"> 552</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">get_potential_symmetries</span><span class="p">(</span>
</span><span id="L-553"><a href="#L-553"><span class="linenos"> 553</span></a>      <span class="bp">self</span><span class="p">,</span>
</span><span id="L-554"><a href="#L-554"><span class="linenos"> 554</span></a>      <span class="n">ignore_tile_id_labels</span><span class="p">:</span><span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="L-555"><a href="#L-555"><span class="linenos"> 555</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">Transform</span><span class="p">]:</span>
</span><span id="L-556"><a href="#L-556"><span class="linenos"> 556</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Assemble potential symmetries from symmetries of prototile and tiles.</span>
</span><span id="L-557"><a href="#L-557"><span class="linenos"> 557</span></a>
</span><span id="L-558"><a href="#L-558"><span class="linenos"> 558</span></a><span class="sd">    Also remove any duplicates that result. The result is assigned to the</span>
</span><span id="L-559"><a href="#L-559"><span class="linenos"> 559</span></a><span class="sd">    tile_matching_transforms attribute.</span>
</span><span id="L-560"><a href="#L-560"><span class="linenos"> 560</span></a>
</span><span id="L-561"><a href="#L-561"><span class="linenos"> 561</span></a><span class="sd">    TODO: consider retaining the Symmetry objects as these carry additional</span>
</span><span id="L-562"><a href="#L-562"><span class="linenos"> 562</span></a><span class="sd">    information that might facilitate labelling under a limited number of the</span>
</span><span id="L-563"><a href="#L-563"><span class="linenos"> 563</span></a><span class="sd">    symmetries not all of them.</span>
</span><span id="L-564"><a href="#L-564"><span class="linenos"> 564</span></a>
</span><span id="L-565"><a href="#L-565"><span class="linenos"> 565</span></a><span class="sd">    Returns:</span>
</span><span id="L-566"><a href="#L-566"><span class="linenos"> 566</span></a><span class="sd">      dict[int, tuple[float]]: dictionary of the symmetries (transforms</span>
</span><span id="L-567"><a href="#L-567"><span class="linenos"> 567</span></a><span class="sd">        actually) in shapely affine transform 6-tuple format.</span>
</span><span id="L-568"><a href="#L-568"><span class="linenos"> 568</span></a>
</span><span id="L-569"><a href="#L-569"><span class="linenos"> 569</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-570"><a href="#L-570"><span class="linenos"> 570</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">tile_matching_transforms</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="L-571"><a href="#L-571"><span class="linenos"> 571</span></a>      <span class="n">k</span><span class="p">:</span> <span class="n">Transform</span><span class="p">(</span><span class="s2">&quot;translation&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">geom</span><span class="o">.</span><span class="n">Point</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">v</span><span class="p">,</span>
</span><span id="L-572"><a href="#L-572"><span class="linenos"> 572</span></a>                   <span class="n">tiling_utils</span><span class="o">.</span><span class="n">get_translation_transform</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
</span><span id="L-573"><a href="#L-573"><span class="linenos"> 573</span></a>      <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tileable</span><span class="o">.</span><span class="n">get_vectors</span><span class="p">())}</span>
</span><span id="L-574"><a href="#L-574"><span class="linenos"> 574</span></a>    <span class="k">if</span> <span class="n">ignore_tile_id_labels</span><span class="p">:</span>
</span><span id="L-575"><a href="#L-575"><span class="linenos"> 575</span></a>      <span class="n">n_symmetries</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tile_matching_transforms</span><span class="p">)</span>
</span><span id="L-576"><a href="#L-576"><span class="linenos"> 576</span></a>      <span class="n">ptile</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tileable</span><span class="o">.</span><span class="n">prototile</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;geometry&quot;</span><span class="p">]</span>
</span><span id="L-577"><a href="#L-577"><span class="linenos"> 577</span></a>      <span class="k">for</span> <span class="n">tr</span> <span class="ow">in</span> <span class="n">ShapeMatcher</span><span class="p">(</span><span class="n">ptile</span><span class="p">)</span><span class="o">.</span><span class="n">get_polygon_matches</span><span class="p">(</span><span class="n">ptile</span><span class="p">):</span>
</span><span id="L-578"><a href="#L-578"><span class="linenos"> 578</span></a>        <span class="k">if</span> <span class="n">tr</span><span class="o">.</span><span class="n">transform_type</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;identity&quot;</span><span class="p">,</span> <span class="s2">&quot;translation&quot;</span><span class="p">]:</span>
</span><span id="L-579"><a href="#L-579"><span class="linenos"> 579</span></a>          <span class="bp">self</span><span class="o">.</span><span class="n">tile_matching_transforms</span><span class="p">[</span><span class="n">n_symmetries</span><span class="p">]</span> <span class="o">=</span> <span class="n">tr</span>
</span><span id="L-580"><a href="#L-580"><span class="linenos"> 580</span></a>          <span class="n">n_symmetries</span> <span class="o">=</span> <span class="n">n_symmetries</span> <span class="o">+</span> <span class="mi">1</span>
</span><span id="L-581"><a href="#L-581"><span class="linenos"> 581</span></a>      <span class="k">for</span> <span class="n">tile</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tiles</span><span class="p">[:</span><span class="bp">self</span><span class="o">.</span><span class="n">n_tiles</span><span class="p">]:</span>
</span><span id="L-582"><a href="#L-582"><span class="linenos"> 582</span></a>        <span class="k">for</span> <span class="n">tr</span> <span class="ow">in</span> <span class="n">ShapeMatcher</span><span class="p">(</span><span class="n">tile</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span><span class="o">.</span><span class="n">get_polygon_matches</span><span class="p">(</span><span class="n">tile</span><span class="o">.</span><span class="n">shape</span><span class="p">):</span>
</span><span id="L-583"><a href="#L-583"><span class="linenos"> 583</span></a>          <span class="k">if</span> <span class="n">tr</span><span class="o">.</span><span class="n">transform_type</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;identity&quot;</span><span class="p">,</span> <span class="s2">&quot;translation&quot;</span><span class="p">]:</span>
</span><span id="L-584"><a href="#L-584"><span class="linenos"> 584</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">tile_matching_transforms</span><span class="p">[</span><span class="n">n_symmetries</span><span class="p">]</span> <span class="o">=</span> <span class="n">tr</span>
</span><span id="L-585"><a href="#L-585"><span class="linenos"> 585</span></a>            <span class="n">n_symmetries</span> <span class="o">=</span> <span class="n">n_symmetries</span> <span class="o">+</span> <span class="mi">1</span>
</span><span id="L-586"><a href="#L-586"><span class="linenos"> 586</span></a>      <span class="k">for</span> <span class="n">tile</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tiles</span><span class="p">[:</span><span class="bp">self</span><span class="o">.</span><span class="n">n_tiles</span><span class="p">]:</span>
</span><span id="L-587"><a href="#L-587"><span class="linenos"> 587</span></a>        <span class="n">sm</span> <span class="o">=</span> <span class="n">ShapeMatcher</span><span class="p">(</span><span class="n">tile</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</span><span id="L-588"><a href="#L-588"><span class="linenos"> 588</span></a>        <span class="n">transforms</span> <span class="o">=</span> <span class="p">[</span><span class="n">sm</span><span class="o">.</span><span class="n">get_polygon_matches</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tiles</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</span><span id="L-589"><a href="#L-589"><span class="linenos"> 589</span></a>          <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">shape_groups</span><span class="p">[</span><span class="n">tile</span><span class="o">.</span><span class="n">shape_group</span><span class="p">]</span> <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_tiles</span><span class="p">]</span>
</span><span id="L-590"><a href="#L-590"><span class="linenos"> 590</span></a>        <span class="k">for</span> <span class="n">tr</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="p">(</span><span class="o">*</span><span class="n">transforms</span><span class="p">):</span>
</span><span id="L-591"><a href="#L-591"><span class="linenos"> 591</span></a>          <span class="k">if</span> <span class="n">tr</span><span class="o">.</span><span class="n">transform_type</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;identity&quot;</span><span class="p">,</span> <span class="s2">&quot;translation&quot;</span><span class="p">]:</span>
</span><span id="L-592"><a href="#L-592"><span class="linenos"> 592</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">tile_matching_transforms</span><span class="p">[</span><span class="n">n_symmetries</span><span class="p">]</span> <span class="o">=</span> <span class="n">tr</span>
</span><span id="L-593"><a href="#L-593"><span class="linenos"> 593</span></a>            <span class="n">n_symmetries</span> <span class="o">=</span> <span class="n">n_symmetries</span> <span class="o">+</span> <span class="mi">1</span>
</span><span id="L-594"><a href="#L-594"><span class="linenos"> 594</span></a>      <span class="bp">self</span><span class="o">.</span><span class="n">tile_matching_transforms</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_remove_duplicate_symmetries</span><span class="p">(</span>
</span><span id="L-595"><a href="#L-595"><span class="linenos"> 595</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">tile_matching_transforms</span><span class="p">)</span>
</span><span id="L-596"><a href="#L-596"><span class="linenos"> 596</span></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">tile_matching_transforms</span>
</span><span id="L-597"><a href="#L-597"><span class="linenos"> 597</span></a>
</span><span id="L-598"><a href="#L-598"><span class="linenos"> 598</span></a>
</span><span id="L-599"><a href="#L-599"><span class="linenos"> 599</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">_remove_duplicate_symmetries</span><span class="p">(</span>
</span><span id="L-600"><a href="#L-600"><span class="linenos"> 600</span></a>      <span class="bp">self</span><span class="p">,</span>
</span><span id="L-601"><a href="#L-601"><span class="linenos"> 601</span></a>      <span class="n">transforms</span><span class="p">:</span><span class="nb">dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span><span class="n">Transform</span><span class="p">],</span>
</span><span id="L-602"><a href="#L-602"><span class="linenos"> 602</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span><span class="n">Transform</span><span class="p">]:</span>
</span><span id="L-603"><a href="#L-603"><span class="linenos"> 603</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Filter list of shapely affine transforms to remove duplicates.</span>
</span><span id="L-604"><a href="#L-604"><span class="linenos"> 604</span></a>
</span><span id="L-605"><a href="#L-605"><span class="linenos"> 605</span></a><span class="sd">    Args:</span>
</span><span id="L-606"><a href="#L-606"><span class="linenos"> 606</span></a><span class="sd">      transforms (dict[int,Transform]): dictionary of Transforms to filter.</span>
</span><span id="L-607"><a href="#L-607"><span class="linenos"> 607</span></a>
</span><span id="L-608"><a href="#L-608"><span class="linenos"> 608</span></a><span class="sd">    Returns:</span>
</span><span id="L-609"><a href="#L-609"><span class="linenos"> 609</span></a><span class="sd">      dict[int,Transform]: the filtered dictionary with duplicates removed.</span>
</span><span id="L-610"><a href="#L-610"><span class="linenos"> 610</span></a>
</span><span id="L-611"><a href="#L-611"><span class="linenos"> 611</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-612"><a href="#L-612"><span class="linenos"> 612</span></a>    <span class="n">uniques</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="L-613"><a href="#L-613"><span class="linenos"> 613</span></a>    <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">transforms</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="L-614"><a href="#L-614"><span class="linenos"> 614</span></a>      <span class="n">already_exists</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-615"><a href="#L-615"><span class="linenos"> 615</span></a>      <span class="k">for</span> <span class="n">u</span> <span class="ow">in</span> <span class="n">uniques</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
</span><span id="L-616"><a href="#L-616"><span class="linenos"> 616</span></a>        <span class="n">already_exists</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span>
</span><span id="L-617"><a href="#L-617"><span class="linenos"> 617</span></a>          <span class="n">v</span><span class="o">.</span><span class="n">transform</span><span class="p">,</span> <span class="n">u</span><span class="o">.</span><span class="n">transform</span><span class="p">,</span> <span class="n">atol</span> <span class="o">=</span> <span class="mf">1e-4</span><span class="p">,</span> <span class="n">rtol</span> <span class="o">=</span> <span class="mf">1e-4</span><span class="p">)</span>
</span><span id="L-618"><a href="#L-618"><span class="linenos"> 618</span></a>        <span class="k">if</span> <span class="n">already_exists</span><span class="p">:</span>
</span><span id="L-619"><a href="#L-619"><span class="linenos"> 619</span></a>          <span class="k">break</span>
</span><span id="L-620"><a href="#L-620"><span class="linenos"> 620</span></a>      <span class="k">if</span> <span class="ow">not</span> <span class="n">already_exists</span><span class="p">:</span>
</span><span id="L-621"><a href="#L-621"><span class="linenos"> 621</span></a>        <span class="n">uniques</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>
</span><span id="L-622"><a href="#L-622"><span class="linenos"> 622</span></a>    <span class="k">return</span> <span class="n">uniques</span>
</span><span id="L-623"><a href="#L-623"><span class="linenos"> 623</span></a>
</span><span id="L-624"><a href="#L-624"><span class="linenos"> 624</span></a>
</span><span id="L-625"><a href="#L-625"><span class="linenos"> 625</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">_find_vertex_transitivity_classes</span><span class="p">(</span>
</span><span id="L-626"><a href="#L-626"><span class="linenos"> 626</span></a>      <span class="bp">self</span><span class="p">,</span>
</span><span id="L-627"><a href="#L-627"><span class="linenos"> 627</span></a>      <span class="n">ignore_tile_id_labels</span><span class="p">:</span><span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="L-628"><a href="#L-628"><span class="linenos"> 628</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-629"><a href="#L-629"><span class="linenos"> 629</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Find vertex transitivity classes.</span>
</span><span id="L-630"><a href="#L-630"><span class="linenos"> 630</span></a>
</span><span id="L-631"><a href="#L-631"><span class="linenos"> 631</span></a><span class="sd">    This function checks which vertices align with which others under transforms</span>
</span><span id="L-632"><a href="#L-632"><span class="linenos"> 632</span></a><span class="sd">    in the tile_matching_transforms attribute. The process need only determine</span>
</span><span id="L-633"><a href="#L-633"><span class="linenos"> 633</span></a><span class="sd">    the classes for vertices in the core tileable.tiles, then assign those to</span>
</span><span id="L-634"><a href="#L-634"><span class="linenos"> 634</span></a><span class="sd">    all vertices by matched base_ID.</span>
</span><span id="L-635"><a href="#L-635"><span class="linenos"> 635</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-636"><a href="#L-636"><span class="linenos"> 636</span></a>    <span class="k">if</span> <span class="n">ignore_tile_id_labels</span><span class="p">:</span>
</span><span id="L-637"><a href="#L-637"><span class="linenos"> 637</span></a>      <span class="n">equivalent_vertices</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">set</span><span class="p">)</span>
</span><span id="L-638"><a href="#L-638"><span class="linenos"> 638</span></a>      <span class="n">base_vertices</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span>
</span><span id="L-639"><a href="#L-639"><span class="linenos"> 639</span></a>                      <span class="bp">self</span><span class="o">.</span><span class="n">vertices_in_tiles</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tiles</span><span class="p">[:</span><span class="bp">self</span><span class="o">.</span><span class="n">n_tiles</span><span class="p">])</span>
</span><span id="L-640"><a href="#L-640"><span class="linenos"> 640</span></a>                      <span class="k">if</span> <span class="n">v</span><span class="o">.</span><span class="n">is_tiling_vertex</span><span class="p">]</span>
</span><span id="L-641"><a href="#L-641"><span class="linenos"> 641</span></a>      <span class="k">for</span> <span class="n">transform</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tile_matching_transforms</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
</span><span id="L-642"><a href="#L-642"><span class="linenos"> 642</span></a>        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">base_vertices</span><span class="p">:</span>
</span><span id="L-643"><a href="#L-643"><span class="linenos"> 643</span></a>          <span class="n">equivalent_vertices</span><span class="p">[</span><span class="n">v</span><span class="o">.</span><span class="n">ID</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">ID</span><span class="p">)</span>
</span><span id="L-644"><a href="#L-644"><span class="linenos"> 644</span></a>          <span class="n">match_ID</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_match_geoms_under_transform</span><span class="p">(</span>
</span><span id="L-645"><a href="#L-645"><span class="linenos"> 645</span></a>            <span class="n">v</span><span class="p">,</span> <span class="n">base_vertices</span><span class="p">,</span> <span class="n">transform</span><span class="o">.</span><span class="n">transform</span><span class="p">)</span>
</span><span id="L-646"><a href="#L-646"><span class="linenos"> 646</span></a>          <span class="k">if</span> <span class="n">match_ID</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
</span><span id="L-647"><a href="#L-647"><span class="linenos"> 647</span></a>            <span class="n">equivalent_vertices</span><span class="p">[</span><span class="n">v</span><span class="o">.</span><span class="n">ID</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">match_ID</span><span class="p">)</span>
</span><span id="L-648"><a href="#L-648"><span class="linenos"> 648</span></a>      <span class="n">equivalent_vertices</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_exclusive_supersets</span><span class="p">(</span>
</span><span id="L-649"><a href="#L-649"><span class="linenos"> 649</span></a>        <span class="p">[</span><span class="nb">tuple</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">s</span><span class="p">))</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">equivalent_vertices</span><span class="o">.</span><span class="n">values</span><span class="p">()])</span>
</span><span id="L-650"><a href="#L-650"><span class="linenos"> 650</span></a>      <span class="bp">self</span><span class="o">.</span><span class="n">vertex_transitivity_classes</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
</span><span id="L-651"><a href="#L-651"><span class="linenos"> 651</span></a>      <span class="k">for</span> <span class="n">c</span><span class="p">,</span> <span class="n">vclass</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">equivalent_vertices</span><span class="p">):</span>
</span><span id="L-652"><a href="#L-652"><span class="linenos"> 652</span></a>        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">points</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
</span><span id="L-653"><a href="#L-653"><span class="linenos"> 653</span></a>          <span class="k">if</span> <span class="n">v</span><span class="o">.</span><span class="n">base_ID</span> <span class="ow">in</span> <span class="n">vclass</span><span class="p">:</span>
</span><span id="L-654"><a href="#L-654"><span class="linenos"> 654</span></a>            <span class="n">v</span><span class="o">.</span><span class="n">transitivity_class</span> <span class="o">=</span> <span class="n">c</span>
</span><span id="L-655"><a href="#L-655"><span class="linenos"> 655</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">vertex_transitivity_classes</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">ID</span><span class="p">)</span>
</span><span id="L-656"><a href="#L-656"><span class="linenos"> 656</span></a>      <span class="bp">self</span><span class="o">.</span><span class="n">vertex_transitivity_classes</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span>
</span><span id="L-657"><a href="#L-657"><span class="linenos"> 657</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">vertex_transitivity_classes</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
</span><span id="L-658"><a href="#L-658"><span class="linenos"> 658</span></a>      <span class="c1"># label vertices based on their transitivity class</span>
</span><span id="L-659"><a href="#L-659"><span class="linenos"> 659</span></a>      <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">points</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
</span><span id="L-660"><a href="#L-660"><span class="linenos"> 660</span></a>        <span class="k">if</span> <span class="n">v</span><span class="o">.</span><span class="n">is_tiling_vertex</span><span class="p">:</span>
</span><span id="L-661"><a href="#L-661"><span class="linenos"> 661</span></a>          <span class="n">v</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="n">LABELS</span><span class="p">[</span><span class="n">v</span><span class="o">.</span><span class="n">transitivity_class</span><span class="p">]</span>
</span><span id="L-662"><a href="#L-662"><span class="linenos"> 662</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="L-663"><a href="#L-663"><span class="linenos"> 663</span></a>      <span class="bp">self</span><span class="o">.</span><span class="n">vertex_transitivity_classes</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
</span><span id="L-664"><a href="#L-664"><span class="linenos"> 664</span></a>      <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">points</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
</span><span id="L-665"><a href="#L-665"><span class="linenos"> 665</span></a>        <span class="k">if</span> <span class="n">v</span><span class="o">.</span><span class="n">is_tiling_vertex</span><span class="p">:</span>
</span><span id="L-666"><a href="#L-666"><span class="linenos"> 666</span></a>          <span class="bp">self</span><span class="o">.</span><span class="n">vertex_transitivity_classes</span><span class="p">[</span><span class="n">v</span><span class="o">.</span><span class="n">base_ID</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">ID</span><span class="p">)</span>
</span><span id="L-667"><a href="#L-667"><span class="linenos"> 667</span></a>          <span class="n">v</span><span class="o">.</span><span class="n">transitivity_class</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">base_ID</span>
</span><span id="L-668"><a href="#L-668"><span class="linenos"> 668</span></a>      <span class="bp">self</span><span class="o">.</span><span class="n">vertex_transitivity_classes</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span>
</span><span id="L-669"><a href="#L-669"><span class="linenos"> 669</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">vertex_transitivity_classes</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
</span><span id="L-670"><a href="#L-670"><span class="linenos"> 670</span></a>      <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">points</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
</span><span id="L-671"><a href="#L-671"><span class="linenos"> 671</span></a>        <span class="k">if</span> <span class="n">v</span><span class="o">.</span><span class="n">is_tiling_vertex</span><span class="p">:</span>
</span><span id="L-672"><a href="#L-672"><span class="linenos"> 672</span></a>          <span class="n">v</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="n">LABELS</span><span class="p">[</span><span class="n">v</span><span class="o">.</span><span class="n">transitivity_class</span><span class="p">]</span>
</span><span id="L-673"><a href="#L-673"><span class="linenos"> 673</span></a>
</span><span id="L-674"><a href="#L-674"><span class="linenos"> 674</span></a>
</span><span id="L-675"><a href="#L-675"><span class="linenos"> 675</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">_find_edge_transitivity_classes</span><span class="p">(</span>
</span><span id="L-676"><a href="#L-676"><span class="linenos"> 676</span></a>      <span class="bp">self</span><span class="p">,</span>
</span><span id="L-677"><a href="#L-677"><span class="linenos"> 677</span></a>      <span class="n">ignore_tile_id_labels</span><span class="p">:</span><span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="L-678"><a href="#L-678"><span class="linenos"> 678</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-679"><a href="#L-679"><span class="linenos"> 679</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Find edge transitivity classes.</span>
</span><span id="L-680"><a href="#L-680"><span class="linenos"> 680</span></a>
</span><span id="L-681"><a href="#L-681"><span class="linenos"> 681</span></a><span class="sd">    This function works by checking which edges align with which others under</span>
</span><span id="L-682"><a href="#L-682"><span class="linenos"> 682</span></a><span class="sd">    transforms in the tile_matching_transforms attribute. The process need only</span>
</span><span id="L-683"><a href="#L-683"><span class="linenos"> 683</span></a><span class="sd">    determine the classes for edges in the core tileable.tiles, then assign</span>
</span><span id="L-684"><a href="#L-684"><span class="linenos"> 684</span></a><span class="sd">    those to all edges by matched base_ID.</span>
</span><span id="L-685"><a href="#L-685"><span class="linenos"> 685</span></a>
</span><span id="L-686"><a href="#L-686"><span class="linenos"> 686</span></a><span class="sd">    TODO: Note that this code is identical to the vertex transitivity code</span>
</span><span id="L-687"><a href="#L-687"><span class="linenos"> 687</span></a><span class="sd">    so it might make sense to merge.</span>
</span><span id="L-688"><a href="#L-688"><span class="linenos"> 688</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-689"><a href="#L-689"><span class="linenos"> 689</span></a>    <span class="k">if</span> <span class="n">ignore_tile_id_labels</span><span class="p">:</span>
</span><span id="L-690"><a href="#L-690"><span class="linenos"> 690</span></a>      <span class="n">equivalent_edges</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">set</span><span class="p">)</span>
</span><span id="L-691"><a href="#L-691"><span class="linenos"> 691</span></a>      <span class="n">base_edges</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges_in_tiles</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tiles</span><span class="p">[:</span><span class="bp">self</span><span class="o">.</span><span class="n">n_tiles</span><span class="p">])</span>
</span><span id="L-692"><a href="#L-692"><span class="linenos"> 692</span></a>      <span class="k">for</span> <span class="n">transform</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tile_matching_transforms</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
</span><span id="L-693"><a href="#L-693"><span class="linenos"> 693</span></a>        <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">base_edges</span><span class="p">:</span>
</span><span id="L-694"><a href="#L-694"><span class="linenos"> 694</span></a>          <span class="n">equivalent_edges</span><span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">ID</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">ID</span><span class="p">)</span>
</span><span id="L-695"><a href="#L-695"><span class="linenos"> 695</span></a>          <span class="n">match_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_match_geoms_under_transform</span><span class="p">(</span>
</span><span id="L-696"><a href="#L-696"><span class="linenos"> 696</span></a>            <span class="n">e</span><span class="p">,</span> <span class="n">base_edges</span><span class="p">,</span> <span class="n">transform</span><span class="o">.</span><span class="n">transform</span><span class="p">)</span>
</span><span id="L-697"><a href="#L-697"><span class="linenos"> 697</span></a>          <span class="k">if</span> <span class="n">match_id</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
</span><span id="L-698"><a href="#L-698"><span class="linenos"> 698</span></a>            <span class="n">equivalent_edges</span><span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">ID</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">match_id</span><span class="p">)</span>
</span><span id="L-699"><a href="#L-699"><span class="linenos"> 699</span></a>      <span class="n">equivalent_edges</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_exclusive_supersets</span><span class="p">(</span>
</span><span id="L-700"><a href="#L-700"><span class="linenos"> 700</span></a>        <span class="p">[</span><span class="nb">tuple</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">s</span><span class="p">))</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">equivalent_edges</span><span class="o">.</span><span class="n">values</span><span class="p">()])</span>
</span><span id="L-701"><a href="#L-701"><span class="linenos"> 701</span></a>      <span class="bp">self</span><span class="o">.</span><span class="n">edge_transitivity_classes</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
</span><span id="L-702"><a href="#L-702"><span class="linenos"> 702</span></a>      <span class="k">for</span> <span class="n">c</span><span class="p">,</span> <span class="n">eclass</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">equivalent_edges</span><span class="p">):</span>
</span><span id="L-703"><a href="#L-703"><span class="linenos"> 703</span></a>        <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
</span><span id="L-704"><a href="#L-704"><span class="linenos"> 704</span></a>          <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">base_ID</span> <span class="ow">in</span> <span class="n">eclass</span><span class="p">:</span>
</span><span id="L-705"><a href="#L-705"><span class="linenos"> 705</span></a>            <span class="n">e</span><span class="o">.</span><span class="n">transitivity_class</span> <span class="o">=</span> <span class="n">c</span>
</span><span id="L-706"><a href="#L-706"><span class="linenos"> 706</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">edge_transitivity_classes</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">ID</span><span class="p">)</span>
</span><span id="L-707"><a href="#L-707"><span class="linenos"> 707</span></a>      <span class="bp">self</span><span class="o">.</span><span class="n">edge_transitivity_classes</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span>
</span><span id="L-708"><a href="#L-708"><span class="linenos"> 708</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">edge_transitivity_classes</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
</span><span id="L-709"><a href="#L-709"><span class="linenos"> 709</span></a>      <span class="c1"># label edges based on their transitivity class</span>
</span><span id="L-710"><a href="#L-710"><span class="linenos"> 710</span></a>      <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
</span><span id="L-711"><a href="#L-711"><span class="linenos"> 711</span></a>        <span class="n">e</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="n">labels</span><span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">transitivity_class</span><span class="p">]</span>
</span><span id="L-712"><a href="#L-712"><span class="linenos"> 712</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="L-713"><a href="#L-713"><span class="linenos"> 713</span></a>      <span class="bp">self</span><span class="o">.</span><span class="n">edge_transitivity_classes</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
</span><span id="L-714"><a href="#L-714"><span class="linenos"> 714</span></a>      <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
</span><span id="L-715"><a href="#L-715"><span class="linenos"> 715</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">edge_transitivity_classes</span><span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">base_ID</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">ID</span><span class="p">)</span>
</span><span id="L-716"><a href="#L-716"><span class="linenos"> 716</span></a>      <span class="bp">self</span><span class="o">.</span><span class="n">edge_transitivity_classes</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span>
</span><span id="L-717"><a href="#L-717"><span class="linenos"> 717</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">edge_transitivity_classes</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
</span><span id="L-718"><a href="#L-718"><span class="linenos"> 718</span></a>      <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">eclass</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">edge_transitivity_classes</span><span class="p">):</span>
</span><span id="L-719"><a href="#L-719"><span class="linenos"> 719</span></a>        <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">eclass</span><span class="p">:</span>
</span><span id="L-720"><a href="#L-720"><span class="linenos"> 720</span></a>          <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">e</span><span class="p">]</span><span class="o">.</span><span class="n">transitivity_class</span> <span class="o">=</span> <span class="n">i</span>
</span><span id="L-721"><a href="#L-721"><span class="linenos"> 721</span></a>          <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">e</span><span class="p">]</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="n">labels</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span><span id="L-722"><a href="#L-722"><span class="linenos"> 722</span></a>
</span><span id="L-723"><a href="#L-723"><span class="linenos"> 723</span></a>
</span><span id="L-724"><a href="#L-724"><span class="linenos"> 724</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">_match_geoms_under_transform</span><span class="p">(</span>
</span><span id="L-725"><a href="#L-725"><span class="linenos"> 725</span></a>      <span class="bp">self</span><span class="p">,</span>
</span><span id="L-726"><a href="#L-726"><span class="linenos"> 726</span></a>      <span class="n">geom1</span><span class="p">:</span><span class="n">Tile</span><span class="o">|</span><span class="n">Vertex</span><span class="o">|</span><span class="n">Edge</span><span class="p">,</span>
</span><span id="L-727"><a href="#L-727"><span class="linenos"> 727</span></a>      <span class="n">geoms2</span><span class="p">:</span><span class="nb">list</span><span class="p">[</span><span class="n">Tile</span><span class="o">|</span><span class="n">Vertex</span><span class="o">|</span><span class="n">Edge</span><span class="p">],</span>
</span><span id="L-728"><a href="#L-728"><span class="linenos"> 728</span></a>      <span class="n">transform</span><span class="p">:</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span><span class="o">...</span><span class="p">],</span>
</span><span id="L-729"><a href="#L-729"><span class="linenos"> 729</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="o">|</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
</span><span id="L-730"><a href="#L-730"><span class="linenos"> 730</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Determine if a geometry maps onto any in a patch under supplied symmetry.</span>
</span><span id="L-731"><a href="#L-731"><span class="linenos"> 731</span></a>
</span><span id="L-732"><a href="#L-732"><span class="linenos"> 732</span></a><span class="sd">    Args:</span>
</span><span id="L-733"><a href="#L-733"><span class="linenos"> 733</span></a><span class="sd">      geom1 (Tile|Vertex|Edge): element whose geometry we want to match.</span>
</span><span id="L-734"><a href="#L-734"><span class="linenos"> 734</span></a><span class="sd">      geoms2 (list[Tile|Vertex|Edge]): set of elements among which a</span>
</span><span id="L-735"><a href="#L-735"><span class="linenos"> 735</span></a><span class="sd">        match is sought.</span>
</span><span id="L-736"><a href="#L-736"><span class="linenos"> 736</span></a><span class="sd">      transform (tuple[float]): shapely affine transform 6-tuple to apply.</span>
</span><span id="L-737"><a href="#L-737"><span class="linenos"> 737</span></a>
</span><span id="L-738"><a href="#L-738"><span class="linenos"> 738</span></a><span class="sd">    Returns:</span>
</span><span id="L-739"><a href="#L-739"><span class="linenos"> 739</span></a><span class="sd">      int|tuple[int,int]: ID of the element in patch that matches the geom1</span>
</span><span id="L-740"><a href="#L-740"><span class="linenos"> 740</span></a><span class="sd">        element under the transform if one exists, otherwise returns -1. For</span>
</span><span id="L-741"><a href="#L-741"><span class="linenos"> 741</span></a><span class="sd">        edges note that the ID is a tuple.</span>
</span><span id="L-742"><a href="#L-742"><span class="linenos"> 742</span></a>
</span><span id="L-743"><a href="#L-743"><span class="linenos"> 743</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-744"><a href="#L-744"><span class="linenos"> 744</span></a>    <span class="n">match_id</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
</span><span id="L-745"><a href="#L-745"><span class="linenos"> 745</span></a>    <span class="k">for</span> <span class="n">geom2</span> <span class="ow">in</span> <span class="n">geoms2</span><span class="p">:</span>
</span><span id="L-746"><a href="#L-746"><span class="linenos"> 746</span></a>      <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">geom1</span><span class="p">,</span> <span class="n">Tile</span><span class="p">):</span>
</span><span id="L-747"><a href="#L-747"><span class="linenos"> 747</span></a>        <span class="c1"># an area of intersection based test</span>
</span><span id="L-748"><a href="#L-748"><span class="linenos"> 748</span></a>        <span class="n">match</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">polygon_matches</span><span class="p">(</span>
</span><span id="L-749"><a href="#L-749"><span class="linenos"> 749</span></a>          <span class="n">affine</span><span class="o">.</span><span class="n">affine_transform</span><span class="p">(</span><span class="n">geom1</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">transform</span><span class="p">),</span> <span class="n">geom2</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</span><span id="L-750"><a href="#L-750"><span class="linenos"> 750</span></a>      <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">geom1</span><span class="p">,</span> <span class="n">Vertex</span><span class="p">):</span>
</span><span id="L-751"><a href="#L-751"><span class="linenos"> 751</span></a>        <span class="c1"># distance test</span>
</span><span id="L-752"><a href="#L-752"><span class="linenos"> 752</span></a>        <span class="n">match</span> <span class="o">=</span> <span class="n">affine</span><span class="o">.</span><span class="n">affine_transform</span><span class="p">(</span><span class="n">geom1</span><span class="o">.</span><span class="n">point</span><span class="p">,</span> <span class="n">transform</span><span class="p">)</span><span class="o">.</span><span class="n">distance</span><span class="p">(</span>
</span><span id="L-753"><a href="#L-753"><span class="linenos"> 753</span></a>          <span class="n">geom2</span><span class="o">.</span><span class="n">point</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">tiling_utils</span><span class="o">.</span><span class="n">RESOLUTION</span>
</span><span id="L-754"><a href="#L-754"><span class="linenos"> 754</span></a>      <span class="k">else</span><span class="p">:</span> <span class="c1"># must be an Edge</span>
</span><span id="L-755"><a href="#L-755"><span class="linenos"> 755</span></a>        <span class="c1"># since edges _should not_ intersect this test should work in</span>
</span><span id="L-756"><a href="#L-756"><span class="linenos"> 756</span></a>        <span class="c1"># lieu of a more complete point by point comparison</span>
</span><span id="L-757"><a href="#L-757"><span class="linenos"> 757</span></a>        <span class="n">c1</span> <span class="o">=</span> <span class="n">geom1</span><span class="o">.</span><span class="n">get_geometry</span><span class="p">()</span><span class="o">.</span><span class="n">centroid</span>
</span><span id="L-758"><a href="#L-758"><span class="linenos"> 758</span></a>        <span class="n">c2</span> <span class="o">=</span> <span class="n">geom2</span><span class="o">.</span><span class="n">get_geometry</span><span class="p">()</span><span class="o">.</span><span class="n">centroid</span>
</span><span id="L-759"><a href="#L-759"><span class="linenos"> 759</span></a>        <span class="n">match</span> <span class="o">=</span> <span class="n">affine</span><span class="o">.</span><span class="n">affine_transform</span><span class="p">(</span><span class="n">c1</span><span class="p">,</span> <span class="n">transform</span><span class="p">)</span> \
</span><span id="L-760"><a href="#L-760"><span class="linenos"> 760</span></a>          <span class="o">.</span><span class="n">distance</span><span class="p">(</span><span class="n">c2</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">10</span> <span class="o">*</span><span class="n">tiling_utils</span><span class="o">.</span><span class="n">RESOLUTION</span>
</span><span id="L-761"><a href="#L-761"><span class="linenos"> 761</span></a>      <span class="k">if</span> <span class="n">match</span><span class="p">:</span>
</span><span id="L-762"><a href="#L-762"><span class="linenos"> 762</span></a>        <span class="k">return</span> <span class="n">geom2</span><span class="o">.</span><span class="n">base_ID</span>
</span><span id="L-763"><a href="#L-763"><span class="linenos"> 763</span></a>    <span class="k">return</span> <span class="n">match_id</span>
</span><span id="L-764"><a href="#L-764"><span class="linenos"> 764</span></a>
</span><span id="L-765"><a href="#L-765"><span class="linenos"> 765</span></a>
</span><span id="L-766"><a href="#L-766"><span class="linenos"> 766</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">_get_exclusive_supersets</span><span class="p">(</span>
</span><span id="L-767"><a href="#L-767"><span class="linenos"> 767</span></a>      <span class="bp">self</span><span class="p">,</span> <span class="n">sets</span><span class="p">:</span><span class="nb">list</span><span class="p">[</span><span class="n">Iterable</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Iterable</span><span class="p">]:</span>
</span><span id="L-768"><a href="#L-768"><span class="linenos"> 768</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return sets of elements not found in the same set among those supplied.</span>
</span><span id="L-769"><a href="#L-769"><span class="linenos"> 769</span></a>
</span><span id="L-770"><a href="#L-770"><span class="linenos"> 770</span></a><span class="sd">    The supplied sets share elements, i.e., they are non-exclusives sets. The</span>
</span><span id="L-771"><a href="#L-771"><span class="linenos"> 771</span></a><span class="sd">    returned sets are exclusive: each element will only appear in one of the</span>
</span><span id="L-772"><a href="#L-772"><span class="linenos"> 772</span></a><span class="sd">    sets in the returned list. This is accomplished using networkx&#39;s</span>
</span><span id="L-773"><a href="#L-773"><span class="linenos"> 773</span></a><span class="sd">    connected components applied to a graph where each intersection between two</span>
</span><span id="L-774"><a href="#L-774"><span class="linenos"> 774</span></a><span class="sd">    sets is an edge.</span>
</span><span id="L-775"><a href="#L-775"><span class="linenos"> 775</span></a>
</span><span id="L-776"><a href="#L-776"><span class="linenos"> 776</span></a><span class="sd">    Args:</span>
</span><span id="L-777"><a href="#L-777"><span class="linenos"> 777</span></a><span class="sd">        sets (list[Iterable]): list of lists of possibly overlapping sets.</span>
</span><span id="L-778"><a href="#L-778"><span class="linenos"> 778</span></a>
</span><span id="L-779"><a href="#L-779"><span class="linenos"> 779</span></a><span class="sd">    Returns:</span>
</span><span id="L-780"><a href="#L-780"><span class="linenos"> 780</span></a><span class="sd">      list[Iterable]: list of lists that include all the original</span>
</span><span id="L-781"><a href="#L-781"><span class="linenos"> 781</span></a><span class="sd">        elements without overlaps.</span>
</span><span id="L-782"><a href="#L-782"><span class="linenos"> 782</span></a>
</span><span id="L-783"><a href="#L-783"><span class="linenos"> 783</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-784"><a href="#L-784"><span class="linenos"> 784</span></a>    <span class="n">overlaps</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-785"><a href="#L-785"><span class="linenos"> 785</span></a>    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">si</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">sets</span><span class="p">):</span>
</span><span id="L-786"><a href="#L-786"><span class="linenos"> 786</span></a>      <span class="n">s1</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">si</span><span class="p">)</span>
</span><span id="L-787"><a href="#L-787"><span class="linenos"> 787</span></a>      <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">sj</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">sets</span><span class="p">):</span>
</span><span id="L-788"><a href="#L-788"><span class="linenos"> 788</span></a>        <span class="n">s2</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">sj</span><span class="p">)</span>
</span><span id="L-789"><a href="#L-789"><span class="linenos"> 789</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">s1</span> <span class="o">&amp;</span> <span class="n">s2</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-790"><a href="#L-790"><span class="linenos"> 790</span></a>          <span class="n">overlaps</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>
</span><span id="L-791"><a href="#L-791"><span class="linenos"> 791</span></a>    <span class="n">G</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">from_edgelist</span><span class="p">(</span><span class="n">overlaps</span><span class="p">)</span>
</span><span id="L-792"><a href="#L-792"><span class="linenos"> 792</span></a>    <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-793"><a href="#L-793"><span class="linenos"> 793</span></a>    <span class="k">for</span> <span class="n">component</span> <span class="ow">in</span> <span class="n">nx</span><span class="o">.</span><span class="n">connected_components</span><span class="p">(</span><span class="n">G</span><span class="p">):</span>
</span><span id="L-794"><a href="#L-794"><span class="linenos"> 794</span></a>      <span class="n">s</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
</span><span id="L-795"><a href="#L-795"><span class="linenos"> 795</span></a>      <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">component</span><span class="p">:</span>
</span><span id="L-796"><a href="#L-796"><span class="linenos"> 796</span></a>        <span class="n">s</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">sets</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span><span id="L-797"><a href="#L-797"><span class="linenos"> 797</span></a>      <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">s</span><span class="p">))</span>
</span><span id="L-798"><a href="#L-798"><span class="linenos"> 798</span></a>    <span class="k">return</span> <span class="n">result</span>
</span><span id="L-799"><a href="#L-799"><span class="linenos"> 799</span></a>
</span><span id="L-800"><a href="#L-800"><span class="linenos"> 800</span></a>
</span><span id="L-801"><a href="#L-801"><span class="linenos"> 801</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">vertices_in_tiles</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tiles</span><span class="p">:</span><span class="nb">list</span><span class="p">[</span><span class="n">Tile</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Vertex</span><span class="p">]:</span>
</span><span id="L-802"><a href="#L-802"><span class="linenos"> 802</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get vertices incident on tiles in supplied list.</span>
</span><span id="L-803"><a href="#L-803"><span class="linenos"> 803</span></a>
</span><span id="L-804"><a href="#L-804"><span class="linenos"> 804</span></a><span class="sd">    Args:</span>
</span><span id="L-805"><a href="#L-805"><span class="linenos"> 805</span></a><span class="sd">      tiles (list[Tile]): tiles whose vertices are required.</span>
</span><span id="L-806"><a href="#L-806"><span class="linenos"> 806</span></a>
</span><span id="L-807"><a href="#L-807"><span class="linenos"> 807</span></a><span class="sd">    Returns:</span>
</span><span id="L-808"><a href="#L-808"><span class="linenos"> 808</span></a><span class="sd">      list[Vertex]: the required vertices.</span>
</span><span id="L-809"><a href="#L-809"><span class="linenos"> 809</span></a>
</span><span id="L-810"><a href="#L-810"><span class="linenos"> 810</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-811"><a href="#L-811"><span class="linenos"> 811</span></a>    <span class="n">vs</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
</span><span id="L-812"><a href="#L-812"><span class="linenos"> 812</span></a>    <span class="k">for</span> <span class="n">tile</span> <span class="ow">in</span> <span class="n">tiles</span><span class="p">:</span>
</span><span id="L-813"><a href="#L-813"><span class="linenos"> 813</span></a>      <span class="n">vs</span> <span class="o">=</span> <span class="n">vs</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">tile</span><span class="o">.</span><span class="n">get_corner_IDs</span><span class="p">())</span>
</span><span id="L-814"><a href="#L-814"><span class="linenos"> 814</span></a>    <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">points</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">vs</span><span class="p">]</span>
</span><span id="L-815"><a href="#L-815"><span class="linenos"> 815</span></a>
</span><span id="L-816"><a href="#L-816"><span class="linenos"> 816</span></a>
</span><span id="L-817"><a href="#L-817"><span class="linenos"> 817</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">edges_in_tiles</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tiles</span><span class="p">:</span><span class="nb">list</span><span class="p">[</span><span class="n">Tile</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Edge</span><span class="p">]:</span>
</span><span id="L-818"><a href="#L-818"><span class="linenos"> 818</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get edges that are part of the boundary of tiles in supplied list.</span>
</span><span id="L-819"><a href="#L-819"><span class="linenos"> 819</span></a>
</span><span id="L-820"><a href="#L-820"><span class="linenos"> 820</span></a><span class="sd">    Args:</span>
</span><span id="L-821"><a href="#L-821"><span class="linenos"> 821</span></a><span class="sd">      tiles (list[Tile]): tiles whose edges are required.</span>
</span><span id="L-822"><a href="#L-822"><span class="linenos"> 822</span></a>
</span><span id="L-823"><a href="#L-823"><span class="linenos"> 823</span></a><span class="sd">    Returns:</span>
</span><span id="L-824"><a href="#L-824"><span class="linenos"> 824</span></a><span class="sd">      list[Edge]: the required edges.</span>
</span><span id="L-825"><a href="#L-825"><span class="linenos"> 825</span></a>
</span><span id="L-826"><a href="#L-826"><span class="linenos"> 826</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-827"><a href="#L-827"><span class="linenos"> 827</span></a>    <span class="n">es</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
</span><span id="L-828"><a href="#L-828"><span class="linenos"> 828</span></a>    <span class="k">for</span> <span class="n">tile</span> <span class="ow">in</span> <span class="n">tiles</span><span class="p">:</span>
</span><span id="L-829"><a href="#L-829"><span class="linenos"> 829</span></a>      <span class="n">es</span> <span class="o">=</span> <span class="n">es</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">tile</span><span class="o">.</span><span class="n">get_edge_IDs</span><span class="p">())</span>
</span><span id="L-830"><a href="#L-830"><span class="linenos"> 830</span></a>    <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">e</span><span class="p">]</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">es</span><span class="p">]</span>
</span><span id="L-831"><a href="#L-831"><span class="linenos"> 831</span></a>
</span><span id="L-832"><a href="#L-832"><span class="linenos"> 832</span></a>
</span><span id="L-833"><a href="#L-833"><span class="linenos"> 833</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">generate_dual</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">geom</span><span class="o">.</span><span class="n">Polygon</span><span class="p">]:</span>
</span><span id="L-834"><a href="#L-834"><span class="linenos"> 834</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Create the dual tiiing for the tiling of this Topology.</span>
</span><span id="L-835"><a href="#L-835"><span class="linenos"> 835</span></a>
</span><span id="L-836"><a href="#L-836"><span class="linenos"> 836</span></a><span class="sd">    TODO: make this a viable replacement for the existing dual tiling</span>
</span><span id="L-837"><a href="#L-837"><span class="linenos"> 837</span></a><span class="sd">    generation.</span>
</span><span id="L-838"><a href="#L-838"><span class="linenos"> 838</span></a>
</span><span id="L-839"><a href="#L-839"><span class="linenos"> 839</span></a><span class="sd">    TODO: also need to ensure that this finds a set of dual tiles that exhaust</span>
</span><span id="L-840"><a href="#L-840"><span class="linenos"> 840</span></a><span class="sd">    the plane...</span>
</span><span id="L-841"><a href="#L-841"><span class="linenos"> 841</span></a>
</span><span id="L-842"><a href="#L-842"><span class="linenos"> 842</span></a><span class="sd">    Returns:</span>
</span><span id="L-843"><a href="#L-843"><span class="linenos"> 843</span></a><span class="sd">      list[geom.Polygon]: a list of polygon objects.</span>
</span><span id="L-844"><a href="#L-844"><span class="linenos"> 844</span></a>
</span><span id="L-845"><a href="#L-845"><span class="linenos"> 845</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-846"><a href="#L-846"><span class="linenos"> 846</span></a>    <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">points</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
</span><span id="L-847"><a href="#L-847"><span class="linenos"> 847</span></a>      <span class="n">v</span><span class="o">.</span><span class="n">clockwise_order_incident_tiles</span><span class="p">()</span>
</span><span id="L-848"><a href="#L-848"><span class="linenos"> 848</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">dual_tiles</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="L-849"><a href="#L-849"><span class="linenos"> 849</span></a>    <span class="n">base_id_sets</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
</span><span id="L-850"><a href="#L-850"><span class="linenos"> 850</span></a>    <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">points</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
</span><span id="L-851"><a href="#L-851"><span class="linenos"> 851</span></a>      <span class="n">base_id_sets</span><span class="p">[</span><span class="n">v</span><span class="o">.</span><span class="n">base_ID</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">ID</span><span class="p">)</span>
</span><span id="L-852"><a href="#L-852"><span class="linenos"> 852</span></a>    <span class="n">minimal_set</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">points</span><span class="p">[</span><span class="nb">min</span><span class="p">(</span><span class="n">s</span><span class="p">)]</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">base_id_sets</span><span class="o">.</span><span class="n">values</span><span class="p">()]</span>
</span><span id="L-853"><a href="#L-853"><span class="linenos"> 853</span></a>    <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">minimal_set</span><span class="p">:</span>
</span><span id="L-854"><a href="#L-854"><span class="linenos"> 854</span></a>    <span class="c1"># for v in self.points.values():</span>
</span><span id="L-855"><a href="#L-855"><span class="linenos"> 855</span></a>      <span class="k">if</span> <span class="n">v</span><span class="o">.</span><span class="n">is_interior</span><span class="p">()</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">tiles</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="L-856"><a href="#L-856"><span class="linenos"> 856</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">dual_tiles</span><span class="p">[</span><span class="n">v</span><span class="o">.</span><span class="n">ID</span><span class="p">]</span> <span class="o">=</span> \
</span><span id="L-857"><a href="#L-857"><span class="linenos"> 857</span></a>          <span class="n">geom</span><span class="o">.</span><span class="n">Polygon</span><span class="p">([</span><span class="n">t</span><span class="o">.</span><span class="n">centre</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">v</span><span class="o">.</span><span class="n">tiles</span><span class="p">])</span>
</span><span id="L-858"><a href="#L-858"><span class="linenos"> 858</span></a>
</span><span id="L-859"><a href="#L-859"><span class="linenos"> 859</span></a>
</span><span id="L-860"><a href="#L-860"><span class="linenos"> 860</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">get_dual_tiles</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">:</span>
</span><span id="L-861"><a href="#L-861"><span class="linenos"> 861</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return dual tiles as GeoDataFrame.&quot;&quot;&quot;</span>
</span><span id="L-862"><a href="#L-862"><span class="linenos"> 862</span></a>    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dual_tiles</span><span class="p">)</span>
</span><span id="L-863"><a href="#L-863"><span class="linenos"> 863</span></a>    <span class="k">return</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">(</span>
</span><span id="L-864"><a href="#L-864"><span class="linenos"> 864</span></a>      <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;tile_id&quot;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tileable</span><span class="o">.</span><span class="n">tiles</span><span class="o">.</span><span class="n">tile_id</span><span class="p">)[:</span><span class="n">n</span><span class="p">]},</span>
</span><span id="L-865"><a href="#L-865"><span class="linenos"> 865</span></a>      <span class="n">geometry</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoSeries</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dual_tiles</span><span class="o">.</span><span class="n">values</span><span class="p">()),</span>
</span><span id="L-866"><a href="#L-866"><span class="linenos"> 866</span></a>      <span class="n">crs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tileable</span><span class="o">.</span><span class="n">crs</span><span class="p">)</span>
</span><span id="L-867"><a href="#L-867"><span class="linenos"> 867</span></a>
</span><span id="L-868"><a href="#L-868"><span class="linenos"> 868</span></a>
</span><span id="L-869"><a href="#L-869"><span class="linenos"> 869</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">add_vertex</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pt</span><span class="p">:</span><span class="n">geom</span><span class="o">.</span><span class="n">Point</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Vertex</span><span class="p">:</span>
</span><span id="L-870"><a href="#L-870"><span class="linenos"> 870</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Add and return Vertex at the specified point location.</span>
</span><span id="L-871"><a href="#L-871"><span class="linenos"> 871</span></a>
</span><span id="L-872"><a href="#L-872"><span class="linenos"> 872</span></a><span class="sd">    No attempt is made to ensure Vertex IDs are an unbroken sequence: a new ID</span>
</span><span id="L-873"><a href="#L-873"><span class="linenos"> 873</span></a><span class="sd">    is generated one greater than the existing highest ID. IDs will usually be</span>
</span><span id="L-874"><a href="#L-874"><span class="linenos"> 874</span></a><span class="sd">    an unbroken sequence up to removals when geometry transformations are</span>
</span><span id="L-875"><a href="#L-875"><span class="linenos"> 875</span></a><span class="sd">    applied.</span>
</span><span id="L-876"><a href="#L-876"><span class="linenos"> 876</span></a>
</span><span id="L-877"><a href="#L-877"><span class="linenos"> 877</span></a><span class="sd">    Args:</span>
</span><span id="L-878"><a href="#L-878"><span class="linenos"> 878</span></a><span class="sd">      pt (geom.Point): point location of the Vertex.</span>
</span><span id="L-879"><a href="#L-879"><span class="linenos"> 879</span></a>
</span><span id="L-880"><a href="#L-880"><span class="linenos"> 880</span></a><span class="sd">    Returns:</span>
</span><span id="L-881"><a href="#L-881"><span class="linenos"> 881</span></a><span class="sd">      Vertex: the added Vertex object.</span>
</span><span id="L-882"><a href="#L-882"><span class="linenos"> 882</span></a>
</span><span id="L-883"><a href="#L-883"><span class="linenos"> 883</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-884"><a href="#L-884"><span class="linenos"> 884</span></a>    <span class="n">n</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">points</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">points</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="o">+</span> <span class="mi">1</span>
</span><span id="L-885"><a href="#L-885"><span class="linenos"> 885</span></a>    <span class="n">v</span> <span class="o">=</span> <span class="n">Vertex</span><span class="p">(</span><span class="n">pt</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
</span><span id="L-886"><a href="#L-886"><span class="linenos"> 886</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">points</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>
</span><span id="L-887"><a href="#L-887"><span class="linenos"> 887</span></a>    <span class="k">return</span> <span class="n">v</span>
</span><span id="L-888"><a href="#L-888"><span class="linenos"> 888</span></a>
</span><span id="L-889"><a href="#L-889"><span class="linenos"> 889</span></a>
</span><span id="L-890"><a href="#L-890"><span class="linenos"> 890</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">add_edge</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vs</span><span class="p">:</span><span class="nb">list</span><span class="p">[</span><span class="n">Vertex</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Edge</span><span class="p">:</span>
</span><span id="L-891"><a href="#L-891"><span class="linenos"> 891</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Create an Edge from the suppled vertices and return it.</span>
</span><span id="L-892"><a href="#L-892"><span class="linenos"> 892</span></a>
</span><span id="L-893"><a href="#L-893"><span class="linenos"> 893</span></a><span class="sd">    The new Edge is added to the edges dictionary. Edges are self indexing by</span>
</span><span id="L-894"><a href="#L-894"><span class="linenos"> 894</span></a><span class="sd">    the IDs of their end Vertices.</span>
</span><span id="L-895"><a href="#L-895"><span class="linenos"> 895</span></a>
</span><span id="L-896"><a href="#L-896"><span class="linenos"> 896</span></a><span class="sd">    Args:</span>
</span><span id="L-897"><a href="#L-897"><span class="linenos"> 897</span></a><span class="sd">      vs (list[Vertex]): list of Vertices in the Edge to be created.</span>
</span><span id="L-898"><a href="#L-898"><span class="linenos"> 898</span></a>
</span><span id="L-899"><a href="#L-899"><span class="linenos"> 899</span></a><span class="sd">    Returns:</span>
</span><span id="L-900"><a href="#L-900"><span class="linenos"> 900</span></a><span class="sd">        Edge: the added Edge.</span>
</span><span id="L-901"><a href="#L-901"><span class="linenos"> 901</span></a>
</span><span id="L-902"><a href="#L-902"><span class="linenos"> 902</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-903"><a href="#L-903"><span class="linenos"> 903</span></a>    <span class="n">e</span> <span class="o">=</span> <span class="n">Edge</span><span class="p">(</span><span class="n">vs</span><span class="p">)</span>
</span><span id="L-904"><a href="#L-904"><span class="linenos"> 904</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">ID</span><span class="p">]</span> <span class="o">=</span> <span class="n">e</span>
</span><span id="L-905"><a href="#L-905"><span class="linenos"> 905</span></a>    <span class="k">return</span> <span class="n">e</span>
</span><span id="L-906"><a href="#L-906"><span class="linenos"> 906</span></a>
</span><span id="L-907"><a href="#L-907"><span class="linenos"> 907</span></a>
</span><span id="L-908"><a href="#L-908"><span class="linenos"> 908</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">polygon_matches</span><span class="p">(</span>
</span><span id="L-909"><a href="#L-909"><span class="linenos"> 909</span></a>      <span class="bp">self</span><span class="p">,</span>
</span><span id="L-910"><a href="#L-910"><span class="linenos"> 910</span></a>      <span class="n">geom1</span><span class="p">:</span><span class="n">geom</span><span class="o">.</span><span class="n">Polygon</span><span class="p">,</span>
</span><span id="L-911"><a href="#L-911"><span class="linenos"> 911</span></a>      <span class="n">geom2</span><span class="p">:</span><span class="n">geom</span><span class="o">.</span><span class="n">Polygon</span><span class="p">,</span>
</span><span id="L-912"><a href="#L-912"><span class="linenos"> 912</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="L-913"><a href="#L-913"><span class="linenos"> 913</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Test if supplied polygons match geometrically.</span>
</span><span id="L-914"><a href="#L-914"><span class="linenos"> 914</span></a>
</span><span id="L-915"><a href="#L-915"><span class="linenos"> 915</span></a><span class="sd">    Tests for equality of area, and equality of their area of overlap to their</span>
</span><span id="L-916"><a href="#L-916"><span class="linenos"> 916</span></a><span class="sd">    shared area, i.e. Area1 == Area2 == (Area 1 intersection 2).</span>
</span><span id="L-917"><a href="#L-917"><span class="linenos"> 917</span></a>
</span><span id="L-918"><a href="#L-918"><span class="linenos"> 918</span></a><span class="sd">    Args:</span>
</span><span id="L-919"><a href="#L-919"><span class="linenos"> 919</span></a><span class="sd">      geom1 (geom.Polygon): first polygon.</span>
</span><span id="L-920"><a href="#L-920"><span class="linenos"> 920</span></a><span class="sd">      geom2 (geom.Polygon): second polygon.</span>
</span><span id="L-921"><a href="#L-921"><span class="linenos"> 921</span></a>
</span><span id="L-922"><a href="#L-922"><span class="linenos"> 922</span></a><span class="sd">    Returns:</span>
</span><span id="L-923"><a href="#L-923"><span class="linenos"> 923</span></a><span class="sd">      bool: True if the polygons are the same, False otherwise.</span>
</span><span id="L-924"><a href="#L-924"><span class="linenos"> 924</span></a>
</span><span id="L-925"><a href="#L-925"><span class="linenos"> 925</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-926"><a href="#L-926"><span class="linenos"> 926</span></a>    <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">geom1</span><span class="o">.</span><span class="n">area</span><span class="p">,</span> <span class="n">geom2</span><span class="o">.</span><span class="n">area</span>
</span><span id="L-927"><a href="#L-927"><span class="linenos"> 927</span></a>    <span class="k">return</span> <span class="nb">bool</span><span class="p">(</span>
</span><span id="L-928"><a href="#L-928"><span class="linenos"> 928</span></a>      <span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span>
</span><span id="L-929"><a href="#L-929"><span class="linenos"> 929</span></a>                 <span class="n">rtol</span> <span class="o">=</span> <span class="n">tiling_utils</span><span class="o">.</span><span class="n">RESOLUTION</span> <span class="o">*</span> <span class="mi">100</span><span class="p">,</span>
</span><span id="L-930"><a href="#L-930"><span class="linenos"> 930</span></a>                 <span class="n">atol</span> <span class="o">=</span> <span class="n">tiling_utils</span><span class="o">.</span><span class="n">RESOLUTION</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span> <span class="ow">and</span>
</span><span id="L-931"><a href="#L-931"><span class="linenos"> 931</span></a>      <span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">geom1</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">geom2</span><span class="p">)</span><span class="o">.</span><span class="n">area</span><span class="p">,</span>
</span><span id="L-932"><a href="#L-932"><span class="linenos"> 932</span></a>                 <span class="n">rtol</span> <span class="o">=</span> <span class="n">tiling_utils</span><span class="o">.</span><span class="n">RESOLUTION</span> <span class="o">*</span> <span class="mi">100</span><span class="p">,</span>
</span><span id="L-933"><a href="#L-933"><span class="linenos"> 933</span></a>                 <span class="n">atol</span> <span class="o">=</span> <span class="n">tiling_utils</span><span class="o">.</span><span class="n">RESOLUTION</span> <span class="o">*</span> <span class="mi">100</span><span class="p">))</span>
</span><span id="L-934"><a href="#L-934"><span class="linenos"> 934</span></a>
</span><span id="L-935"><a href="#L-935"><span class="linenos"> 935</span></a>
</span><span id="L-936"><a href="#L-936"><span class="linenos"> 936</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">_get_tile_geoms</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">:</span>
</span><span id="L-937"><a href="#L-937"><span class="linenos"> 937</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return GeoDataFrame of the tiles.</span>
</span><span id="L-938"><a href="#L-938"><span class="linenos"> 938</span></a>
</span><span id="L-939"><a href="#L-939"><span class="linenos"> 939</span></a><span class="sd">    Returns:</span>
</span><span id="L-940"><a href="#L-940"><span class="linenos"> 940</span></a><span class="sd">      gpd.GeoDataFrame: the tiles as a GeoDataFrame.</span>
</span><span id="L-941"><a href="#L-941"><span class="linenos"> 941</span></a>
</span><span id="L-942"><a href="#L-942"><span class="linenos"> 942</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-943"><a href="#L-943"><span class="linenos"> 943</span></a>    <span class="k">return</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">(</span>
</span><span id="L-944"><a href="#L-944"><span class="linenos"> 944</span></a>      <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;transitivity_class&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">transitivity_class</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tiles</span><span class="p">]},</span>
</span><span id="L-945"><a href="#L-945"><span class="linenos"> 945</span></a>      <span class="n">geometry</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoSeries</span><span class="p">([</span><span class="n">t</span><span class="o">.</span><span class="n">shape</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tiles</span><span class="p">]))</span>
</span><span id="L-946"><a href="#L-946"><span class="linenos"> 946</span></a>
</span><span id="L-947"><a href="#L-947"><span class="linenos"> 947</span></a>
</span><span id="L-948"><a href="#L-948"><span class="linenos"> 948</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">_get_tile_centre_geoms</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoSeries</span><span class="p">:</span>
</span><span id="L-949"><a href="#L-949"><span class="linenos"> 949</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the centre of tiles as a GeoDataFrame.</span>
</span><span id="L-950"><a href="#L-950"><span class="linenos"> 950</span></a>
</span><span id="L-951"><a href="#L-951"><span class="linenos"> 951</span></a><span class="sd">    Returns:</span>
</span><span id="L-952"><a href="#L-952"><span class="linenos"> 952</span></a><span class="sd">      gpd.GeoDataFrame: the tiles centres.</span>
</span><span id="L-953"><a href="#L-953"><span class="linenos"> 953</span></a>
</span><span id="L-954"><a href="#L-954"><span class="linenos"> 954</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-955"><a href="#L-955"><span class="linenos"> 955</span></a>    <span class="k">return</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoSeries</span><span class="p">([</span><span class="n">t</span><span class="o">.</span><span class="n">centre</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tiles</span><span class="p">])</span>
</span><span id="L-956"><a href="#L-956"><span class="linenos"> 956</span></a>
</span><span id="L-957"><a href="#L-957"><span class="linenos"> 957</span></a>
</span><span id="L-958"><a href="#L-958"><span class="linenos"> 958</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">_get_point_geoms</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoSeries</span><span class="p">:</span>
</span><span id="L-959"><a href="#L-959"><span class="linenos"> 959</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return tiling vertices and tile corners as a GeoDataFrame of Points.</span>
</span><span id="L-960"><a href="#L-960"><span class="linenos"> 960</span></a>
</span><span id="L-961"><a href="#L-961"><span class="linenos"> 961</span></a><span class="sd">    Returns:</span>
</span><span id="L-962"><a href="#L-962"><span class="linenos"> 962</span></a><span class="sd">      gpd.GeoDataFrame: corners and vertices of the tiling.</span>
</span><span id="L-963"><a href="#L-963"><span class="linenos"> 963</span></a>
</span><span id="L-964"><a href="#L-964"><span class="linenos"> 964</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-965"><a href="#L-965"><span class="linenos"> 965</span></a>    <span class="k">return</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoSeries</span><span class="p">([</span><span class="n">v</span><span class="o">.</span><span class="n">point</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">points</span><span class="o">.</span><span class="n">values</span><span class="p">()])</span>
</span><span id="L-966"><a href="#L-966"><span class="linenos"> 966</span></a>
</span><span id="L-967"><a href="#L-967"><span class="linenos"> 967</span></a>
</span><span id="L-968"><a href="#L-968"><span class="linenos"> 968</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">_get_vertex_geoms</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoSeries</span><span class="p">:</span>
</span><span id="L-969"><a href="#L-969"><span class="linenos"> 969</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return tiling vertices (not corners) as a GeoDataFrame of Points.</span>
</span><span id="L-970"><a href="#L-970"><span class="linenos"> 970</span></a>
</span><span id="L-971"><a href="#L-971"><span class="linenos"> 971</span></a><span class="sd">    Returns:</span>
</span><span id="L-972"><a href="#L-972"><span class="linenos"> 972</span></a><span class="sd">      gpd.GeoDataFrame: vertices of the tiling.</span>
</span><span id="L-973"><a href="#L-973"><span class="linenos"> 973</span></a>
</span><span id="L-974"><a href="#L-974"><span class="linenos"> 974</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-975"><a href="#L-975"><span class="linenos"> 975</span></a>    <span class="k">return</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoSeries</span><span class="p">([</span><span class="n">v</span><span class="o">.</span><span class="n">point</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">points</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
</span><span id="L-976"><a href="#L-976"><span class="linenos"> 976</span></a>                          <span class="k">if</span> <span class="n">v</span><span class="o">.</span><span class="n">is_tiling_vertex</span><span class="p">])</span>
</span><span id="L-977"><a href="#L-977"><span class="linenos"> 977</span></a>
</span><span id="L-978"><a href="#L-978"><span class="linenos"> 978</span></a>
</span><span id="L-979"><a href="#L-979"><span class="linenos"> 979</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">_get_edge_geoms</span><span class="p">(</span>
</span><span id="L-980"><a href="#L-980"><span class="linenos"> 980</span></a>      <span class="bp">self</span><span class="p">,</span>
</span><span id="L-981"><a href="#L-981"><span class="linenos"> 981</span></a>      <span class="n">offset</span><span class="p">:</span><span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
</span><span id="L-982"><a href="#L-982"><span class="linenos"> 982</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoSeries</span><span class="p">:</span>
</span><span id="L-983"><a href="#L-983"><span class="linenos"> 983</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return tiling edges a GeoSeries of LineStrings optionally offset.</span>
</span><span id="L-984"><a href="#L-984"><span class="linenos"> 984</span></a>
</span><span id="L-985"><a href="#L-985"><span class="linenos"> 985</span></a><span class="sd">    Offsetting the edges allows their direction to be seen when visualised.</span>
</span><span id="L-986"><a href="#L-986"><span class="linenos"> 986</span></a>
</span><span id="L-987"><a href="#L-987"><span class="linenos"> 987</span></a><span class="sd">    Returns:</span>
</span><span id="L-988"><a href="#L-988"><span class="linenos"> 988</span></a><span class="sd">      gpd.GeoDataFrame: edges of the tiling.</span>
</span><span id="L-989"><a href="#L-989"><span class="linenos"> 989</span></a>
</span><span id="L-990"><a href="#L-990"><span class="linenos"> 990</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-991"><a href="#L-991"><span class="linenos"> 991</span></a>    <span class="k">return</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoSeries</span><span class="p">([</span><span class="n">e</span><span class="o">.</span><span class="n">get_topology</span><span class="p">()</span><span class="o">.</span><span class="n">parallel_offset</span><span class="p">(</span><span class="n">offset</span><span class="p">)</span>
</span><span id="L-992"><a href="#L-992"><span class="linenos"> 992</span></a>                          <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="o">.</span><span class="n">values</span><span class="p">()])</span>
</span><span id="L-993"><a href="#L-993"><span class="linenos"> 993</span></a>
</span><span id="L-994"><a href="#L-994"><span class="linenos"> 994</span></a>
</span><span id="L-995"><a href="#L-995"><span class="linenos"> 995</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">plot</span><span class="p">(</span>
</span><span id="L-996"><a href="#L-996"><span class="linenos"> 996</span></a>      <span class="bp">self</span><span class="p">,</span>
</span><span id="L-997"><a href="#L-997"><span class="linenos"> 997</span></a>      <span class="n">show_original_tiles</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="L-998"><a href="#L-998"><span class="linenos"> 998</span></a>      <span class="n">show_tile_centres</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="L-999"><a href="#L-999"><span class="linenos"> 999</span></a>      <span class="n">show_vertex_labels</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="L-1000"><a href="#L-1000"><span class="linenos">1000</span></a>      <span class="n">show_vertex_ids</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="L-1001"><a href="#L-1001"><span class="linenos">1001</span></a>      <span class="n">show_edges</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="L-1002"><a href="#L-1002"><span class="linenos">1002</span></a>      <span class="n">offset_edges</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="L-1003"><a href="#L-1003"><span class="linenos">1003</span></a>      <span class="n">show_edge_labels</span><span class="p">:</span><span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="L-1004"><a href="#L-1004"><span class="linenos">1004</span></a>      <span class="n">show_dual_tiles</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="L-1005"><a href="#L-1005"><span class="linenos">1005</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">plt</span><span class="o">.</span><span class="n">Axes</span><span class="p">:</span>
</span><span id="L-1006"><a href="#L-1006"><span class="linenos">1006</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Delegate plotting of requested elements and return plt.Axes.</span>
</span><span id="L-1007"><a href="#L-1007"><span class="linenos">1007</span></a>
</span><span id="L-1008"><a href="#L-1008"><span class="linenos">1008</span></a><span class="sd">    Args:</span>
</span><span id="L-1009"><a href="#L-1009"><span class="linenos">1009</span></a><span class="sd">      show_original_tiles (bool, optional): if True show the tiles. Defaults to</span>
</span><span id="L-1010"><a href="#L-1010"><span class="linenos">1010</span></a><span class="sd">        True.</span>
</span><span id="L-1011"><a href="#L-1011"><span class="linenos">1011</span></a><span class="sd">      show_tile_centres (bool, optional): if True show tile centres with upper</span>
</span><span id="L-1012"><a href="#L-1012"><span class="linenos">1012</span></a><span class="sd">        case alphabetical labels. Defaults to False.</span>
</span><span id="L-1013"><a href="#L-1013"><span class="linenos">1013</span></a><span class="sd">      show_vertex_labels (bool, optional): if True show tiling vertices labelled</span>
</span><span id="L-1014"><a href="#L-1014"><span class="linenos">1014</span></a><span class="sd">        to show their equivalence classes. Defaults to True.</span>
</span><span id="L-1015"><a href="#L-1015"><span class="linenos">1015</span></a><span class="sd">      show_vertex_ids (bool, optional): if True show vertex IDs (i.e., sequence</span>
</span><span id="L-1016"><a href="#L-1016"><span class="linenos">1016</span></a><span class="sd">        numbers) which is useful for debugging. Defaults to False.</span>
</span><span id="L-1017"><a href="#L-1017"><span class="linenos">1017</span></a><span class="sd">      show_edges (bool, optional): if True show tiling edges (not tile sides).</span>
</span><span id="L-1018"><a href="#L-1018"><span class="linenos">1018</span></a><span class="sd">        Defaults to True.</span>
</span><span id="L-1019"><a href="#L-1019"><span class="linenos">1019</span></a><span class="sd">      offset_edges (bool, optional): if True offset edges a little from and</span>
</span><span id="L-1020"><a href="#L-1020"><span class="linenos">1020</span></a><span class="sd">        parallel to their geometric position. Defaults to True.</span>
</span><span id="L-1021"><a href="#L-1021"><span class="linenos">1021</span></a><span class="sd">      show_edge_labels (bool, optional): if true show lower case alphabetical</span>
</span><span id="L-1022"><a href="#L-1022"><span class="linenos">1022</span></a><span class="sd">        labels identifying edge equivalence classes. Defaults to False.</span>
</span><span id="L-1023"><a href="#L-1023"><span class="linenos">1023</span></a><span class="sd">      show_dual_tiles (bool, optional): if True show a candidate set of dual</span>
</span><span id="L-1024"><a href="#L-1024"><span class="linenos">1024</span></a><span class="sd">        tiles as an overlay. Defaults to False.</span>
</span><span id="L-1025"><a href="#L-1025"><span class="linenos">1025</span></a>
</span><span id="L-1026"><a href="#L-1026"><span class="linenos">1026</span></a><span class="sd">    Returns:</span>
</span><span id="L-1027"><a href="#L-1027"><span class="linenos">1027</span></a><span class="sd">      plt.Axes: a plot of the Topology as requested.</span>
</span><span id="L-1028"><a href="#L-1028"><span class="linenos">1028</span></a>
</span><span id="L-1029"><a href="#L-1029"><span class="linenos">1029</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-1030"><a href="#L-1030"><span class="linenos">1030</span></a>    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
</span><span id="L-1031"><a href="#L-1031"><span class="linenos">1031</span></a>    <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
</span><span id="L-1032"><a href="#L-1032"><span class="linenos">1032</span></a>    <span class="n">extent</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoSeries</span><span class="p">([</span><span class="n">t</span><span class="o">.</span><span class="n">shape</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tiles</span><span class="p">])</span><span class="o">.</span><span class="n">total_bounds</span>
</span><span id="L-1033"><a href="#L-1033"><span class="linenos">1033</span></a>    <span class="n">dist</span> <span class="o">=</span> <span class="nb">max</span><span class="p">([</span><span class="n">extent</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="n">extent</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">extent</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">-</span> <span class="n">extent</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span> <span class="o">/</span> <span class="mi">100</span>
</span><span id="L-1034"><a href="#L-1034"><span class="linenos">1034</span></a>    <span class="k">if</span> <span class="n">show_original_tiles</span><span class="p">:</span>
</span><span id="L-1035"><a href="#L-1035"><span class="linenos">1035</span></a>      <span class="bp">self</span><span class="o">.</span><span class="n">_plot_tiles</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
</span><span id="L-1036"><a href="#L-1036"><span class="linenos">1036</span></a>    <span class="k">if</span> <span class="n">show_tile_centres</span><span class="p">:</span>
</span><span id="L-1037"><a href="#L-1037"><span class="linenos">1037</span></a>      <span class="bp">self</span><span class="o">.</span><span class="n">_plot_tile_centres</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
</span><span id="L-1038"><a href="#L-1038"><span class="linenos">1038</span></a>    <span class="k">if</span> <span class="n">show_vertex_labels</span><span class="p">:</span>
</span><span id="L-1039"><a href="#L-1039"><span class="linenos">1039</span></a>      <span class="bp">self</span><span class="o">.</span><span class="n">_plot_vertex_labels</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">show_vertex_ids</span><span class="p">)</span>
</span><span id="L-1040"><a href="#L-1040"><span class="linenos">1040</span></a>    <span class="k">if</span> <span class="n">show_edge_labels</span> <span class="ow">or</span> <span class="n">show_edges</span><span class="p">:</span>
</span><span id="L-1041"><a href="#L-1041"><span class="linenos">1041</span></a>      <span class="bp">self</span><span class="o">.</span><span class="n">_plot_edges</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">show_edges</span><span class="p">,</span> <span class="n">show_edge_labels</span><span class="p">,</span> <span class="n">dist</span><span class="p">,</span> <span class="n">offset_edges</span><span class="p">)</span>
</span><span id="L-1042"><a href="#L-1042"><span class="linenos">1042</span></a>    <span class="k">if</span> <span class="n">show_dual_tiles</span><span class="p">:</span>
</span><span id="L-1043"><a href="#L-1043"><span class="linenos">1043</span></a>      <span class="bp">self</span><span class="o">.</span><span class="n">_plot_dual_tiles</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">dist</span><span class="p">)</span>
</span><span id="L-1044"><a href="#L-1044"><span class="linenos">1044</span></a>    <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>
</span><span id="L-1045"><a href="#L-1045"><span class="linenos">1045</span></a>    <span class="k">return</span> <span class="n">ax</span>
</span><span id="L-1046"><a href="#L-1046"><span class="linenos">1046</span></a>
</span><span id="L-1047"><a href="#L-1047"><span class="linenos">1047</span></a>
</span><span id="L-1048"><a href="#L-1048"><span class="linenos">1048</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">_plot_tiles</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">:</span><span class="n">plt</span><span class="o">.</span><span class="n">Axes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">plt</span><span class="o">.</span><span class="n">Axes</span><span class="p">:</span>
</span><span id="L-1049"><a href="#L-1049"><span class="linenos">1049</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Plot Topology&#39;s tiles on supplied Axes.</span>
</span><span id="L-1050"><a href="#L-1050"><span class="linenos">1050</span></a>
</span><span id="L-1051"><a href="#L-1051"><span class="linenos">1051</span></a><span class="sd">    Tiles are coloured by equivalence class.</span>
</span><span id="L-1052"><a href="#L-1052"><span class="linenos">1052</span></a>
</span><span id="L-1053"><a href="#L-1053"><span class="linenos">1053</span></a><span class="sd">    Args:</span>
</span><span id="L-1054"><a href="#L-1054"><span class="linenos">1054</span></a><span class="sd">      ax (plt.Axes): Axes on which to plot.</span>
</span><span id="L-1055"><a href="#L-1055"><span class="linenos">1055</span></a>
</span><span id="L-1056"><a href="#L-1056"><span class="linenos">1056</span></a><span class="sd">    Returns:</span>
</span><span id="L-1057"><a href="#L-1057"><span class="linenos">1057</span></a><span class="sd">      plt.Axes: the Axes.</span>
</span><span id="L-1058"><a href="#L-1058"><span class="linenos">1058</span></a>
</span><span id="L-1059"><a href="#L-1059"><span class="linenos">1059</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-1060"><a href="#L-1060"><span class="linenos">1060</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_get_tile_geoms</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">column</span> <span class="o">=</span> <span class="s2">&quot;transitivity_class&quot;</span><span class="p">,</span>
</span><span id="L-1061"><a href="#L-1061"><span class="linenos">1061</span></a>      <span class="n">ax</span> <span class="o">=</span> <span class="n">ax</span><span class="p">,</span> <span class="n">ec</span> <span class="o">=</span> <span class="s2">&quot;#444444&quot;</span><span class="p">,</span> <span class="n">lw</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.25</span><span class="p">,</span> <span class="n">cmap</span> <span class="o">=</span> <span class="s2">&quot;Greys&quot;</span><span class="p">)</span>
</span><span id="L-1062"><a href="#L-1062"><span class="linenos">1062</span></a>    <span class="k">return</span> <span class="n">ax</span>
</span><span id="L-1063"><a href="#L-1063"><span class="linenos">1063</span></a>
</span><span id="L-1064"><a href="#L-1064"><span class="linenos">1064</span></a>
</span><span id="L-1065"><a href="#L-1065"><span class="linenos">1065</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">_plot_tile_centres</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">:</span><span class="n">plt</span><span class="o">.</span><span class="n">Axes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">plt</span><span class="o">.</span><span class="n">Axes</span><span class="p">:</span>
</span><span id="L-1066"><a href="#L-1066"><span class="linenos">1066</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Print tile transitivity class at each tile centroid.</span>
</span><span id="L-1067"><a href="#L-1067"><span class="linenos">1067</span></a>
</span><span id="L-1068"><a href="#L-1068"><span class="linenos">1068</span></a><span class="sd">    Args:</span>
</span><span id="L-1069"><a href="#L-1069"><span class="linenos">1069</span></a><span class="sd">      ax (plt.Axes): Axes on which to plot.</span>
</span><span id="L-1070"><a href="#L-1070"><span class="linenos">1070</span></a>
</span><span id="L-1071"><a href="#L-1071"><span class="linenos">1071</span></a><span class="sd">    Returns:</span>
</span><span id="L-1072"><a href="#L-1072"><span class="linenos">1072</span></a><span class="sd">      plt.Axes: the Axes.</span>
</span><span id="L-1073"><a href="#L-1073"><span class="linenos">1073</span></a>
</span><span id="L-1074"><a href="#L-1074"><span class="linenos">1074</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-1075"><a href="#L-1075"><span class="linenos">1075</span></a>    <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">tile</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tiles</span><span class="p">):</span>
</span><span id="L-1076"><a href="#L-1076"><span class="linenos">1076</span></a>      <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">tile</span><span class="o">.</span><span class="n">transitivity_class</span><span class="p">,</span> <span class="n">xy</span> <span class="o">=</span> <span class="p">(</span><span class="n">tile</span><span class="o">.</span><span class="n">centre</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">tile</span><span class="o">.</span><span class="n">centre</span><span class="o">.</span><span class="n">y</span><span class="p">),</span>
</span><span id="L-1077"><a href="#L-1077"><span class="linenos">1077</span></a>                  <span class="n">ha</span> <span class="o">=</span> <span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">va</span> <span class="o">=</span> <span class="s2">&quot;center&quot;</span><span class="p">)</span>
</span><span id="L-1078"><a href="#L-1078"><span class="linenos">1078</span></a>    <span class="k">return</span> <span class="n">ax</span>
</span><span id="L-1079"><a href="#L-1079"><span class="linenos">1079</span></a>
</span><span id="L-1080"><a href="#L-1080"><span class="linenos">1080</span></a>
</span><span id="L-1081"><a href="#L-1081"><span class="linenos">1081</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">_plot_vertex_labels</span><span class="p">(</span>
</span><span id="L-1082"><a href="#L-1082"><span class="linenos">1082</span></a>      <span class="bp">self</span><span class="p">,</span>
</span><span id="L-1083"><a href="#L-1083"><span class="linenos">1083</span></a>      <span class="n">ax</span><span class="p">:</span><span class="n">plt</span><span class="o">.</span><span class="n">Axes</span><span class="p">,</span>
</span><span id="L-1084"><a href="#L-1084"><span class="linenos">1084</span></a>      <span class="n">show_vertex_ids</span><span class="p">:</span><span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="L-1085"><a href="#L-1085"><span class="linenos">1085</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">plt</span><span class="o">.</span><span class="n">Axes</span><span class="p">:</span>
</span><span id="L-1086"><a href="#L-1086"><span class="linenos">1086</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Plot either the Vertex transitivity class label or its sequential ID.</span>
</span><span id="L-1087"><a href="#L-1087"><span class="linenos">1087</span></a>
</span><span id="L-1088"><a href="#L-1088"><span class="linenos">1088</span></a><span class="sd">    Args:</span>
</span><span id="L-1089"><a href="#L-1089"><span class="linenos">1089</span></a><span class="sd">      ax (plt.Axes): Axes on which to plot.</span>
</span><span id="L-1090"><a href="#L-1090"><span class="linenos">1090</span></a><span class="sd">      show_vertex_ids (bool, optional): If True plots the ID, else plots the</span>
</span><span id="L-1091"><a href="#L-1091"><span class="linenos">1091</span></a><span class="sd">        transitivity class. Defaults to False.</span>
</span><span id="L-1092"><a href="#L-1092"><span class="linenos">1092</span></a>
</span><span id="L-1093"><a href="#L-1093"><span class="linenos">1093</span></a><span class="sd">    Returns:</span>
</span><span id="L-1094"><a href="#L-1094"><span class="linenos">1094</span></a><span class="sd">      plt.Axes: the Axes.</span>
</span><span id="L-1095"><a href="#L-1095"><span class="linenos">1095</span></a>
</span><span id="L-1096"><a href="#L-1096"><span class="linenos">1096</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-1097"><a href="#L-1097"><span class="linenos">1097</span></a>    <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">points</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
</span><span id="L-1098"><a href="#L-1098"><span class="linenos">1098</span></a>      <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">ID</span> <span class="k">if</span> <span class="n">show_vertex_ids</span> <span class="k">else</span> <span class="n">v</span><span class="o">.</span><span class="n">label</span><span class="p">,</span>
</span><span id="L-1099"><a href="#L-1099"><span class="linenos">1099</span></a>                  <span class="n">xy</span> <span class="o">=</span> <span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">point</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">v</span><span class="o">.</span><span class="n">point</span><span class="o">.</span><span class="n">y</span><span class="p">),</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;k&quot;</span><span class="p">,</span>
</span><span id="L-1100"><a href="#L-1100"><span class="linenos">1100</span></a>                  <span class="n">ha</span> <span class="o">=</span> <span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">va</span> <span class="o">=</span> <span class="s2">&quot;center&quot;</span><span class="p">)</span>
</span><span id="L-1101"><a href="#L-1101"><span class="linenos">1101</span></a>    <span class="k">return</span> <span class="n">ax</span>
</span><span id="L-1102"><a href="#L-1102"><span class="linenos">1102</span></a>
</span><span id="L-1103"><a href="#L-1103"><span class="linenos">1103</span></a>
</span><span id="L-1104"><a href="#L-1104"><span class="linenos">1104</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">_plot_edges</span><span class="p">(</span>
</span><span id="L-1105"><a href="#L-1105"><span class="linenos">1105</span></a>      <span class="bp">self</span><span class="p">,</span>
</span><span id="L-1106"><a href="#L-1106"><span class="linenos">1106</span></a>      <span class="n">ax</span><span class="p">:</span><span class="n">plt</span><span class="o">.</span><span class="n">Axes</span><span class="p">,</span>
</span><span id="L-1107"><a href="#L-1107"><span class="linenos">1107</span></a>      <span class="n">show_edges</span><span class="p">:</span><span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="L-1108"><a href="#L-1108"><span class="linenos">1108</span></a>      <span class="n">show_edge_labels</span><span class="p">:</span><span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="L-1109"><a href="#L-1109"><span class="linenos">1109</span></a>      <span class="n">dist</span><span class="p">:</span><span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
</span><span id="L-1110"><a href="#L-1110"><span class="linenos">1110</span></a>      <span class="n">offset_edges</span><span class="p">:</span><span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="L-1111"><a href="#L-1111"><span class="linenos">1111</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">plt</span><span class="o">.</span><span class="n">Axes</span><span class="p">:</span>
</span><span id="L-1112"><a href="#L-1112"><span class="linenos">1112</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Plot edges, including an offset if specified and labels if requested.</span>
</span><span id="L-1113"><a href="#L-1113"><span class="linenos">1113</span></a>
</span><span id="L-1114"><a href="#L-1114"><span class="linenos">1114</span></a><span class="sd">    Can also be called to only plot the labels.</span>
</span><span id="L-1115"><a href="#L-1115"><span class="linenos">1115</span></a>
</span><span id="L-1116"><a href="#L-1116"><span class="linenos">1116</span></a><span class="sd">    Args:</span>
</span><span id="L-1117"><a href="#L-1117"><span class="linenos">1117</span></a><span class="sd">      ax (plt.Axes): Axes on which to plot.</span>
</span><span id="L-1118"><a href="#L-1118"><span class="linenos">1118</span></a><span class="sd">      show_edges (bool, optional): if True includes the edges as. a dotted blue</span>
</span><span id="L-1119"><a href="#L-1119"><span class="linenos">1119</span></a><span class="sd">        line, optionally offset (for clarity) from the tile boundary. Defaults</span>
</span><span id="L-1120"><a href="#L-1120"><span class="linenos">1120</span></a><span class="sd">        to False.</span>
</span><span id="L-1121"><a href="#L-1121"><span class="linenos">1121</span></a><span class="sd">      show_edge_labels (bool, optional): if True shows an edge label. Defaults</span>
</span><span id="L-1122"><a href="#L-1122"><span class="linenos">1122</span></a><span class="sd">        to False.</span>
</span><span id="L-1123"><a href="#L-1123"><span class="linenos">1123</span></a><span class="sd">      dist (float, optional): a distance by which to offset the dotted line for</span>
</span><span id="L-1124"><a href="#L-1124"><span class="linenos">1124</span></a><span class="sd">        the edge from the tile boundary. Defaults to 0.0.</span>
</span><span id="L-1125"><a href="#L-1125"><span class="linenos">1125</span></a><span class="sd">      offset_edges (bool, optional): if True applies the edge drawing offset,</span>
</span><span id="L-1126"><a href="#L-1126"><span class="linenos">1126</span></a><span class="sd">        if False the edge is drawn as a single line segment between its end</span>
</span><span id="L-1127"><a href="#L-1127"><span class="linenos">1127</span></a><span class="sd">        vertices (and may not align with the sides of tiles. Defaults to True.</span>
</span><span id="L-1128"><a href="#L-1128"><span class="linenos">1128</span></a>
</span><span id="L-1129"><a href="#L-1129"><span class="linenos">1129</span></a><span class="sd">    Returns:</span>
</span><span id="L-1130"><a href="#L-1130"><span class="linenos">1130</span></a><span class="sd">      plt.Axes: the Axes.</span>
</span><span id="L-1131"><a href="#L-1131"><span class="linenos">1131</span></a>
</span><span id="L-1132"><a href="#L-1132"><span class="linenos">1132</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-1133"><a href="#L-1133"><span class="linenos">1133</span></a>    <span class="k">if</span> <span class="n">show_edges</span><span class="p">:</span>
</span><span id="L-1134"><a href="#L-1134"><span class="linenos">1134</span></a>      <span class="n">edges</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_edge_geoms</span><span class="p">(</span><span class="n">dist</span> <span class="k">if</span> <span class="n">offset_edges</span> <span class="k">else</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="L-1135"><a href="#L-1135"><span class="linenos">1135</span></a>      <span class="n">edges</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span> <span class="o">=</span> <span class="n">ax</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;dodgerblue&quot;</span><span class="p">,</span> <span class="n">ls</span> <span class="o">=</span> <span class="s2">&quot;:&quot;</span><span class="p">)</span>
</span><span id="L-1136"><a href="#L-1136"><span class="linenos">1136</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="L-1137"><a href="#L-1137"><span class="linenos">1137</span></a>      <span class="n">edges</span> <span class="o">=</span> <span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">get_geometry</span><span class="p">()</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="o">.</span><span class="n">values</span><span class="p">()]</span>
</span><span id="L-1138"><a href="#L-1138"><span class="linenos">1138</span></a>    <span class="k">if</span> <span class="n">show_edge_labels</span><span class="p">:</span>
</span><span id="L-1139"><a href="#L-1139"><span class="linenos">1139</span></a>      <span class="k">for</span> <span class="n">ls</span><span class="p">,</span> <span class="n">e</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">edges</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="o">.</span><span class="n">values</span><span class="p">(),</span> <span class="n">strict</span> <span class="o">=</span> <span class="kc">True</span><span class="p">):</span>
</span><span id="L-1140"><a href="#L-1140"><span class="linenos">1140</span></a>        <span class="n">c</span> <span class="o">=</span> <span class="n">ls</span><span class="o">.</span><span class="n">centroid</span>
</span><span id="L-1141"><a href="#L-1141"><span class="linenos">1141</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">label</span><span class="p">,</span> <span class="n">xy</span> <span class="o">=</span> <span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">y</span><span class="p">),</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;k&quot;</span><span class="p">,</span>
</span><span id="L-1142"><a href="#L-1142"><span class="linenos">1142</span></a>                    <span class="n">ha</span> <span class="o">=</span> <span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">va</span> <span class="o">=</span> <span class="s2">&quot;center&quot;</span><span class="p">)</span>
</span><span id="L-1143"><a href="#L-1143"><span class="linenos">1143</span></a>    <span class="k">return</span> <span class="n">ax</span>
</span><span id="L-1144"><a href="#L-1144"><span class="linenos">1144</span></a>
</span><span id="L-1145"><a href="#L-1145"><span class="linenos">1145</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">_plot_dual_tiles</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">:</span><span class="n">plt</span><span class="o">.</span><span class="n">Axes</span><span class="p">,</span>
</span><span id="L-1146"><a href="#L-1146"><span class="linenos">1146</span></a>                       <span class="n">dist</span><span class="p">:</span><span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">plt</span><span class="o">.</span><span class="n">Axes</span><span class="p">:</span>
</span><span id="L-1147"><a href="#L-1147"><span class="linenos">1147</span></a>    <span class="n">gpd</span><span class="o">.</span><span class="n">GeoSeries</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dual_tiles</span><span class="p">)</span><span class="o">.</span><span class="n">buffer</span><span class="p">(</span>
</span><span id="L-1148"><a href="#L-1148"><span class="linenos">1148</span></a>      <span class="o">-</span><span class="n">dist</span> <span class="o">/</span> <span class="mi">4</span><span class="p">,</span> <span class="n">join_style</span> <span class="o">=</span> <span class="s2">&quot;mitre&quot;</span><span class="p">,</span> <span class="n">cap_style</span> <span class="o">=</span> <span class="s2">&quot;square&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
</span><span id="L-1149"><a href="#L-1149"><span class="linenos">1149</span></a>        <span class="n">ax</span> <span class="o">=</span> <span class="n">ax</span><span class="p">,</span> <span class="n">fc</span> <span class="o">=</span> <span class="s2">&quot;g&quot;</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.25</span><span class="p">)</span>
</span><span id="L-1150"><a href="#L-1150"><span class="linenos">1150</span></a>    <span class="k">return</span> <span class="n">ax</span>
</span><span id="L-1151"><a href="#L-1151"><span class="linenos">1151</span></a>
</span><span id="L-1152"><a href="#L-1152"><span class="linenos">1152</span></a>
</span><span id="L-1153"><a href="#L-1153"><span class="linenos">1153</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">plot_tiling_symmetries</span><span class="p">(</span>
</span><span id="L-1154"><a href="#L-1154"><span class="linenos">1154</span></a>      <span class="bp">self</span><span class="p">,</span>
</span><span id="L-1155"><a href="#L-1155"><span class="linenos">1155</span></a>      <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span><span class="nb">float</span><span class="p">,</span>
</span><span id="L-1156"><a href="#L-1156"><span class="linenos">1156</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-1157"><a href="#L-1157"><span class="linenos">1157</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Plot the symmetries of Topology&#39;s tiling.</span>
</span><span id="L-1158"><a href="#L-1158"><span class="linenos">1158</span></a>
</span><span id="L-1159"><a href="#L-1159"><span class="linenos">1159</span></a><span class="sd">    Most of the work here is delegated to `_plot_tiling_symmetry` which is run</span>
</span><span id="L-1160"><a href="#L-1160"><span class="linenos">1160</span></a><span class="sd">    once per symmetry on a grid of plt.Axes built by this function.</span>
</span><span id="L-1161"><a href="#L-1161"><span class="linenos">1161</span></a>
</span><span id="L-1162"><a href="#L-1162"><span class="linenos">1162</span></a><span class="sd">    Args:</span>
</span><span id="L-1163"><a href="#L-1163"><span class="linenos">1163</span></a><span class="sd">      kwargs: passed through to `_plot_tiling_symmetry`</span>
</span><span id="L-1164"><a href="#L-1164"><span class="linenos">1164</span></a>
</span><span id="L-1165"><a href="#L-1165"><span class="linenos">1165</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-1166"><a href="#L-1166"><span class="linenos">1166</span></a>    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tile_matching_transforms</span><span class="p">)</span>
</span><span id="L-1167"><a href="#L-1167"><span class="linenos">1167</span></a>    <span class="n">nc</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">n</span><span class="p">)))</span>
</span><span id="L-1168"><a href="#L-1168"><span class="linenos">1168</span></a>    <span class="n">nr</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">n</span> <span class="o">/</span> <span class="n">nc</span><span class="p">))</span>
</span><span id="L-1169"><a href="#L-1169"><span class="linenos">1169</span></a>    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">12</span> <span class="o">*</span> <span class="n">nr</span> <span class="o">/</span> <span class="n">nc</span><span class="p">))</span>
</span><span id="L-1170"><a href="#L-1170"><span class="linenos">1170</span></a>    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">tr</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tile_matching_transforms</span><span class="o">.</span><span class="n">values</span><span class="p">()):</span>
</span><span id="L-1171"><a href="#L-1171"><span class="linenos">1171</span></a>      <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">nr</span><span class="p">,</span> <span class="n">nc</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="L-1172"><a href="#L-1172"><span class="linenos">1172</span></a>      <span class="bp">self</span><span class="o">.</span><span class="n">_plot_tiling_symmetry</span><span class="p">(</span><span class="n">tr</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-1173"><a href="#L-1173"><span class="linenos">1173</span></a>
</span><span id="L-1174"><a href="#L-1174"><span class="linenos">1174</span></a>
</span><span id="L-1175"><a href="#L-1175"><span class="linenos">1175</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">_plot_tiling_symmetry</span><span class="p">(</span>
</span><span id="L-1176"><a href="#L-1176"><span class="linenos">1176</span></a>      <span class="bp">self</span><span class="p">,</span>
</span><span id="L-1177"><a href="#L-1177"><span class="linenos">1177</span></a>      <span class="n">transform</span><span class="p">:</span><span class="n">Transform</span><span class="p">,</span>
</span><span id="L-1178"><a href="#L-1178"><span class="linenos">1178</span></a>      <span class="n">ax</span><span class="p">:</span><span class="n">plt</span><span class="o">.</span><span class="n">Axes</span><span class="p">,</span>
</span><span id="L-1179"><a href="#L-1179"><span class="linenos">1179</span></a>      <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span><span class="nb">float</span><span class="p">,</span>
</span><span id="L-1180"><a href="#L-1180"><span class="linenos">1180</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-1181"><a href="#L-1181"><span class="linenos">1181</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Plot the supplied Transform on the supplied plt.Axes.</span>
</span><span id="L-1182"><a href="#L-1182"><span class="linenos">1182</span></a>
</span><span id="L-1183"><a href="#L-1183"><span class="linenos">1183</span></a><span class="sd">    Args:</span>
</span><span id="L-1184"><a href="#L-1184"><span class="linenos">1184</span></a><span class="sd">        transform (Transform): the Transform to plot.</span>
</span><span id="L-1185"><a href="#L-1185"><span class="linenos">1185</span></a><span class="sd">        ax (plt.Axes): the Axes on which to plot.</span>
</span><span id="L-1186"><a href="#L-1186"><span class="linenos">1186</span></a><span class="sd">        kwargs: passed through to plt.plot functions.</span>
</span><span id="L-1187"><a href="#L-1187"><span class="linenos">1187</span></a>
</span><span id="L-1188"><a href="#L-1188"><span class="linenos">1188</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-1189"><a href="#L-1189"><span class="linenos">1189</span></a>    <span class="n">tiles</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoSeries</span><span class="p">([</span><span class="n">t</span><span class="o">.</span><span class="n">shape</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tiles</span><span class="p">])</span>
</span><span id="L-1190"><a href="#L-1190"><span class="linenos">1190</span></a>    <span class="n">base_tiles</span> <span class="o">=</span> <span class="n">tiles</span><span class="p">[:</span><span class="bp">self</span><span class="o">.</span><span class="n">n_tiles</span><span class="p">]</span>
</span><span id="L-1191"><a href="#L-1191"><span class="linenos">1191</span></a>    <span class="n">tiles</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span> <span class="o">=</span> <span class="n">ax</span><span class="p">,</span> <span class="n">fc</span> <span class="o">=</span> <span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">.15</span><span class="p">,</span> <span class="n">ec</span> <span class="o">=</span> <span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="n">lw</span> <span class="o">=</span> <span class="mf">.5</span><span class="p">)</span>
</span><span id="L-1192"><a href="#L-1192"><span class="linenos">1192</span></a>    <span class="n">base_tiles</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span> <span class="o">=</span> <span class="n">ax</span><span class="p">,</span> <span class="n">fc</span> <span class="o">=</span> <span class="s2">&quot;#00000000&quot;</span><span class="p">,</span> <span class="n">ec</span> <span class="o">=</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="n">lw</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">zorder</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="L-1193"><a href="#L-1193"><span class="linenos">1193</span></a>    <span class="n">transformed_base_tiles</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoSeries</span><span class="p">(</span>
</span><span id="L-1194"><a href="#L-1194"><span class="linenos">1194</span></a>      <span class="p">[</span><span class="n">transform</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">g</span><span class="p">)</span> <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">base_tiles</span><span class="p">])</span>
</span><span id="L-1195"><a href="#L-1195"><span class="linenos">1195</span></a>    <span class="n">transformed_base_tiles</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span> <span class="o">=</span> <span class="n">ax</span><span class="p">,</span> <span class="n">fc</span> <span class="o">=</span> <span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">.2</span><span class="p">,</span> <span class="n">lw</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">ec</span> <span class="o">=</span> <span class="s2">&quot;k&quot;</span><span class="p">)</span>
</span><span id="L-1196"><a href="#L-1196"><span class="linenos">1196</span></a>    <span class="n">transform</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="c1"># delegate to Transform.draw</span>
</span><span id="L-1197"><a href="#L-1197"><span class="linenos">1197</span></a>    <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>
</span><span id="L-1198"><a href="#L-1198"><span class="linenos">1198</span></a>
</span><span id="L-1199"><a href="#L-1199"><span class="linenos">1199</span></a>
</span><span id="L-1200"><a href="#L-1200"><span class="linenos">1200</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">transform_geometry</span><span class="p">(</span>
</span><span id="L-1201"><a href="#L-1201"><span class="linenos">1201</span></a>      <span class="bp">self</span><span class="p">,</span>
</span><span id="L-1202"><a href="#L-1202"><span class="linenos">1202</span></a>      <span class="n">new_topology</span><span class="p">:</span><span class="nb">bool</span><span class="p">,</span>
</span><span id="L-1203"><a href="#L-1203"><span class="linenos">1203</span></a>      <span class="n">apply_to_tiles</span><span class="p">:</span><span class="nb">bool</span><span class="p">,</span>
</span><span id="L-1204"><a href="#L-1204"><span class="linenos">1204</span></a>      <span class="n">selector</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span>
</span><span id="L-1205"><a href="#L-1205"><span class="linenos">1205</span></a>      <span class="n">transform_type</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span>
</span><span id="L-1206"><a href="#L-1206"><span class="linenos">1206</span></a>      <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span><span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Topology</span><span class="p">:</span>
</span><span id="L-1207"><a href="#L-1207"><span class="linenos">1207</span></a><span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Get a new Topology by applying specified transformation.</span>
</span><span id="L-1208"><a href="#L-1208"><span class="linenos">1208</span></a>
</span><span id="L-1209"><a href="#L-1209"><span class="linenos">1209</span></a><span class="sd">    A transformation specified by `transform_type` and keyword arguments is</span>
</span><span id="L-1210"><a href="#L-1210"><span class="linenos">1210</span></a><span class="sd">    applied to elements in the Topology whose labels match the selector</span>
</span><span id="L-1211"><a href="#L-1211"><span class="linenos">1211</span></a><span class="sd">    parameter. The transform is optionally applied to update tiles and</span>
</span><span id="L-1212"><a href="#L-1212"><span class="linenos">1212</span></a><span class="sd">    optionally requests a new Topology object.</span>
</span><span id="L-1213"><a href="#L-1213"><span class="linenos">1213</span></a>
</span><span id="L-1214"><a href="#L-1214"><span class="linenos">1214</span></a><span class="sd">    Implemented in this way so that transformations can be applied one at a time</span>
</span><span id="L-1215"><a href="#L-1215"><span class="linenos">1215</span></a><span class="sd">    without creating an intermediate set of new tiles, which may be invalid and</span>
</span><span id="L-1216"><a href="#L-1216"><span class="linenos">1216</span></a><span class="sd">    fail. So, if you wish to apply (say) 3 transforms and generate a new</span>
</span><span id="L-1217"><a href="#L-1217"><span class="linenos">1217</span></a><span class="sd">    Topology leaving the existing one intact:</span>
</span><span id="L-1218"><a href="#L-1218"><span class="linenos">1218</span></a>
</span><span id="L-1219"><a href="#L-1219"><span class="linenos">1219</span></a><span class="sd">        new_topo = old_topo.transform_geometry(True,  False, &quot;a&quot;, ...) \</span>
</span><span id="L-1220"><a href="#L-1220"><span class="linenos">1220</span></a><span class="sd">                           .transform_geometry(False, False, &quot;B&quot;, ...) \</span>
</span><span id="L-1221"><a href="#L-1221"><span class="linenos">1221</span></a><span class="sd">                           .transform_geometry(False, True,  &quot;C&quot;, ...)</span>
</span><span id="L-1222"><a href="#L-1222"><span class="linenos">1222</span></a>
</span><span id="L-1223"><a href="#L-1223"><span class="linenos">1223</span></a><span class="sd">    The first transform requests a new Topology, subsequent steps do not, and it</span>
</span><span id="L-1224"><a href="#L-1224"><span class="linenos">1224</span></a><span class="sd">    is only the last step which attempts to create the new tile polygons.</span>
</span><span id="L-1225"><a href="#L-1225"><span class="linenos">1225</span></a>
</span><span id="L-1226"><a href="#L-1226"><span class="linenos">1226</span></a><span class="sd">    **kwargs supply named parameters for the requested transformation.</span>
</span><span id="L-1227"><a href="#L-1227"><span class="linenos">1227</span></a>
</span><span id="L-1228"><a href="#L-1228"><span class="linenos">1228</span></a><span class="sd">    Args:</span>
</span><span id="L-1229"><a href="#L-1229"><span class="linenos">1229</span></a><span class="sd">      new_topology (bool): if True returns a new Topology object, else returns</span>
</span><span id="L-1230"><a href="#L-1230"><span class="linenos">1230</span></a><span class="sd">        the current Topology modified.</span>
</span><span id="L-1231"><a href="#L-1231"><span class="linenos">1231</span></a><span class="sd">      apply_to_tiles (bool): if True attempts to create new Tiles after the</span>
</span><span id="L-1232"><a href="#L-1232"><span class="linenos">1232</span></a><span class="sd">        transformation has been applied. Usually set to False, unless the last</span>
</span><span id="L-1233"><a href="#L-1233"><span class="linenos">1233</span></a><span class="sd">        transformation in a pipeline, to avoid problems of topologically invalid</span>
</span><span id="L-1234"><a href="#L-1234"><span class="linenos">1234</span></a><span class="sd">        tiles at intermediate steps.</span>
</span><span id="L-1235"><a href="#L-1235"><span class="linenos">1235</span></a><span class="sd">      selector (str): label of elements to which to apply the transformation.</span>
</span><span id="L-1236"><a href="#L-1236"><span class="linenos">1236</span></a><span class="sd">        Note that all letters in the supplied string are checked, so you can</span>
</span><span id="L-1237"><a href="#L-1237"><span class="linenos">1237</span></a><span class="sd">        use e.g. &quot;abc&quot; to apply a transformation to edges labelled &quot;a&quot;, &quot;b&quot; or</span>
</span><span id="L-1238"><a href="#L-1238"><span class="linenos">1238</span></a><span class="sd">        &quot;c&quot;, or &quot;AB&quot; for vertices labelled &quot;A&quot; or &quot;B&quot;.</span>
</span><span id="L-1239"><a href="#L-1239"><span class="linenos">1239</span></a><span class="sd">      transform_type (str): name of the type of transformation requested.</span>
</span><span id="L-1240"><a href="#L-1240"><span class="linenos">1240</span></a><span class="sd">        Currently supported are `zigzag_edge`, `rotate_edge`, `scale_edge`,</span>
</span><span id="L-1241"><a href="#L-1241"><span class="linenos">1241</span></a><span class="sd">        `push_vertex`, and `nudge_vertex`. Keyword arguments for each are</span>
</span><span id="L-1242"><a href="#L-1242"><span class="linenos">1242</span></a><span class="sd">        documented in the corresponding methods.</span>
</span><span id="L-1243"><a href="#L-1243"><span class="linenos">1243</span></a><span class="sd">      kwargs: contains any needed arguments of the requested transform_type.</span>
</span><span id="L-1244"><a href="#L-1244"><span class="linenos">1244</span></a>
</span><span id="L-1245"><a href="#L-1245"><span class="linenos">1245</span></a><span class="sd">    Returns:</span>
</span><span id="L-1246"><a href="#L-1246"><span class="linenos">1246</span></a><span class="sd">      Topology: if new_topology is True a new Topology based on this one with</span>
</span><span id="L-1247"><a href="#L-1247"><span class="linenos">1247</span></a><span class="sd">        after transformation, if False this Topology is returned after the</span>
</span><span id="L-1248"><a href="#L-1248"><span class="linenos">1248</span></a><span class="sd">        transformation.</span>
</span><span id="L-1249"><a href="#L-1249"><span class="linenos">1249</span></a>
</span><span id="L-1250"><a href="#L-1250"><span class="linenos">1250</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-1251"><a href="#L-1251"><span class="linenos">1251</span></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;CAUTION: new Topology will probably not be correctly labelled. &quot;</span>
</span><span id="L-1252"><a href="#L-1252"><span class="linenos">1252</span></a>          <span class="s2">&quot;To build a correct Topology, extract the tileable attribute and &quot;</span>
</span><span id="L-1253"><a href="#L-1253"><span class="linenos">1253</span></a>          <span class="s2">&quot;rebuild Topology from that.&quot;</span><span class="p">)</span>
</span><span id="L-1254"><a href="#L-1254"><span class="linenos">1254</span></a>    <span class="c1"># pickle seems to be more reliable than copy.deepcopy here</span>
</span><span id="L-1255"><a href="#L-1255"><span class="linenos">1255</span></a>    <span class="n">topo</span> <span class="o">=</span> <span class="p">(</span><span class="n">pickle</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">pickle</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>   <span class="c1"># noqa: S301</span>
</span><span id="L-1256"><a href="#L-1256"><span class="linenos">1256</span></a>            <span class="k">if</span> <span class="n">new_topology</span>
</span><span id="L-1257"><a href="#L-1257"><span class="linenos">1257</span></a>            <span class="k">else</span> <span class="bp">self</span><span class="p">)</span>
</span><span id="L-1258"><a href="#L-1258"><span class="linenos">1258</span></a>    <span class="n">transform_args</span> <span class="o">=</span> <span class="n">topo</span><span class="o">.</span><span class="n">get_kwargs</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">topo</span><span class="p">,</span> <span class="n">transform_type</span><span class="p">),</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-1259"><a href="#L-1259"><span class="linenos">1259</span></a>    <span class="k">match</span> <span class="n">transform_type</span><span class="p">:</span>
</span><span id="L-1260"><a href="#L-1260"><span class="linenos">1260</span></a>      <span class="k">case</span> <span class="s2">&quot;zigzag_edge&quot;</span><span class="p">:</span>
</span><span id="L-1261"><a href="#L-1261"><span class="linenos">1261</span></a>        <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">topo</span><span class="o">.</span><span class="n">edges</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
</span><span id="L-1262"><a href="#L-1262"><span class="linenos">1262</span></a>          <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">label</span> <span class="ow">in</span> <span class="n">selector</span><span class="p">:</span>
</span><span id="L-1263"><a href="#L-1263"><span class="linenos">1263</span></a>            <span class="n">topo</span><span class="o">.</span><span class="n">zigzag_edge</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="o">**</span><span class="n">transform_args</span><span class="p">)</span>
</span><span id="L-1264"><a href="#L-1264"><span class="linenos">1264</span></a>      <span class="k">case</span> <span class="s2">&quot;rotate_edge&quot;</span><span class="p">:</span>
</span><span id="L-1265"><a href="#L-1265"><span class="linenos">1265</span></a>        <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">topo</span><span class="o">.</span><span class="n">edges</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
</span><span id="L-1266"><a href="#L-1266"><span class="linenos">1266</span></a>          <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">label</span> <span class="ow">in</span> <span class="n">selector</span><span class="p">:</span>
</span><span id="L-1267"><a href="#L-1267"><span class="linenos">1267</span></a>            <span class="n">topo</span><span class="o">.</span><span class="n">rotate_edge</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="o">**</span><span class="n">transform_args</span><span class="p">)</span>
</span><span id="L-1268"><a href="#L-1268"><span class="linenos">1268</span></a>      <span class="k">case</span> <span class="s2">&quot;scale_edge&quot;</span><span class="p">:</span>
</span><span id="L-1269"><a href="#L-1269"><span class="linenos">1269</span></a>        <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">topo</span><span class="o">.</span><span class="n">edges</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
</span><span id="L-1270"><a href="#L-1270"><span class="linenos">1270</span></a>          <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">label</span> <span class="ow">in</span> <span class="n">selector</span><span class="p">:</span>
</span><span id="L-1271"><a href="#L-1271"><span class="linenos">1271</span></a>            <span class="n">topo</span><span class="o">.</span><span class="n">scale_edge</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="o">**</span><span class="n">transform_args</span><span class="p">)</span>
</span><span id="L-1272"><a href="#L-1272"><span class="linenos">1272</span></a>      <span class="k">case</span> <span class="s2">&quot;push_vertex&quot;</span><span class="p">:</span>
</span><span id="L-1273"><a href="#L-1273"><span class="linenos">1273</span></a>        <span class="n">pushes</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="L-1274"><a href="#L-1274"><span class="linenos">1274</span></a>        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">topo</span><span class="o">.</span><span class="n">vertices_in_tiles</span><span class="p">(</span><span class="n">topo</span><span class="o">.</span><span class="n">tiles</span><span class="p">[:</span><span class="n">topo</span><span class="o">.</span><span class="n">n_tiles</span><span class="p">]):</span>
</span><span id="L-1275"><a href="#L-1275"><span class="linenos">1275</span></a>          <span class="k">if</span> <span class="n">v</span><span class="o">.</span><span class="n">label</span> <span class="ow">in</span> <span class="n">selector</span><span class="p">:</span>
</span><span id="L-1276"><a href="#L-1276"><span class="linenos">1276</span></a>            <span class="n">pushes</span><span class="p">[</span><span class="n">v</span><span class="o">.</span><span class="n">base_ID</span><span class="p">]</span> <span class="o">=</span> <span class="n">topo</span><span class="o">.</span><span class="n">push_vertex</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="o">**</span><span class="n">transform_args</span><span class="p">)</span>
</span><span id="L-1277"><a href="#L-1277"><span class="linenos">1277</span></a>        <span class="k">for</span> <span class="n">base_ID</span><span class="p">,</span> <span class="p">(</span><span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="p">)</span> <span class="ow">in</span> <span class="n">pushes</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="L-1278"><a href="#L-1278"><span class="linenos">1278</span></a>          <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="p">[</span><span class="n">v</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">topo</span><span class="o">.</span><span class="n">points</span><span class="o">.</span><span class="n">values</span><span class="p">()</span> <span class="k">if</span> <span class="n">v</span><span class="o">.</span><span class="n">base_ID</span> <span class="o">==</span> <span class="n">base_ID</span><span class="p">]:</span>
</span><span id="L-1279"><a href="#L-1279"><span class="linenos">1279</span></a>            <span class="n">v</span><span class="o">.</span><span class="n">point</span> <span class="o">=</span> <span class="n">affine</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">point</span><span class="p">,</span> <span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="p">)</span>
</span><span id="L-1280"><a href="#L-1280"><span class="linenos">1280</span></a>      <span class="k">case</span> <span class="s2">&quot;nudge_vertex&quot;</span><span class="p">:</span>
</span><span id="L-1281"><a href="#L-1281"><span class="linenos">1281</span></a>         <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">topo</span><span class="o">.</span><span class="n">points</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
</span><span id="L-1282"><a href="#L-1282"><span class="linenos">1282</span></a>          <span class="k">if</span> <span class="n">v</span><span class="o">.</span><span class="n">label</span> <span class="ow">in</span> <span class="n">selector</span><span class="p">:</span>
</span><span id="L-1283"><a href="#L-1283"><span class="linenos">1283</span></a>            <span class="n">topo</span><span class="o">.</span><span class="n">nudge_vertex</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="o">**</span><span class="n">transform_args</span><span class="p">)</span>
</span><span id="L-1284"><a href="#L-1284"><span class="linenos">1284</span></a>    <span class="k">if</span> <span class="n">apply_to_tiles</span><span class="p">:</span>
</span><span id="L-1285"><a href="#L-1285"><span class="linenos">1285</span></a>      <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">topo</span><span class="o">.</span><span class="n">tiles</span><span class="p">:</span>
</span><span id="L-1286"><a href="#L-1286"><span class="linenos">1286</span></a>        <span class="n">t</span><span class="o">.</span><span class="n">set_corners_from_edges</span><span class="p">()</span>
</span><span id="L-1287"><a href="#L-1287"><span class="linenos">1287</span></a>    <span class="n">topo</span><span class="o">.</span><span class="n">tileable</span><span class="o">.</span><span class="n">tiles</span><span class="o">.</span><span class="n">geometry</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoSeries</span><span class="p">(</span>
</span><span id="L-1288"><a href="#L-1288"><span class="linenos">1288</span></a>      <span class="p">[</span><span class="n">topo</span><span class="o">.</span><span class="n">tiles</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">topo</span><span class="o">.</span><span class="n">n_tiles</span><span class="p">)])</span>
</span><span id="L-1289"><a href="#L-1289"><span class="linenos">1289</span></a>    <span class="n">topo</span><span class="o">.</span><span class="n">tileable</span><span class="o">.</span><span class="n">_setup_regularised_prototile</span><span class="p">()</span>
</span><span id="L-1290"><a href="#L-1290"><span class="linenos">1290</span></a>    <span class="k">return</span> <span class="n">topo</span>
</span><span id="L-1291"><a href="#L-1291"><span class="linenos">1291</span></a>
</span><span id="L-1292"><a href="#L-1292"><span class="linenos">1292</span></a>
</span><span id="L-1293"><a href="#L-1293"><span class="linenos">1293</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">get_kwargs</span><span class="p">(</span>
</span><span id="L-1294"><a href="#L-1294"><span class="linenos">1294</span></a>      <span class="bp">self</span><span class="p">,</span>
</span><span id="L-1295"><a href="#L-1295"><span class="linenos">1295</span></a>      <span class="n">fn</span><span class="p">:</span><span class="n">Callable</span><span class="p">,</span>
</span><span id="L-1296"><a href="#L-1296"><span class="linenos">1296</span></a>      <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span><span class="nb">str</span><span class="o">|</span><span class="nb">float</span><span class="p">,</span>
</span><span id="L-1297"><a href="#L-1297"><span class="linenos">1297</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
</span><span id="L-1298"><a href="#L-1298"><span class="linenos">1298</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Filter the supplied kwargs to only contain arguments required by fn.</span>
</span><span id="L-1299"><a href="#L-1299"><span class="linenos">1299</span></a>
</span><span id="L-1300"><a href="#L-1300"><span class="linenos">1300</span></a><span class="sd">    Args:</span>
</span><span id="L-1301"><a href="#L-1301"><span class="linenos">1301</span></a><span class="sd">      fn (Callable): the function that is to be inspected.</span>
</span><span id="L-1302"><a href="#L-1302"><span class="linenos">1302</span></a><span class="sd">      **kwargs (str|float): kwargs to be filtered.</span>
</span><span id="L-1303"><a href="#L-1303"><span class="linenos">1303</span></a>
</span><span id="L-1304"><a href="#L-1304"><span class="linenos">1304</span></a><span class="sd">    Returns:</span>
</span><span id="L-1305"><a href="#L-1305"><span class="linenos">1305</span></a><span class="sd">      str|float: filtered dictionary of kwargs.</span>
</span><span id="L-1306"><a href="#L-1306"><span class="linenos">1306</span></a>
</span><span id="L-1307"><a href="#L-1307"><span class="linenos">1307</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-1308"><a href="#L-1308"><span class="linenos">1308</span></a>    <span class="n">args</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">signature</span><span class="p">(</span><span class="n">fn</span><span class="p">)</span><span class="o">.</span><span class="n">parameters</span>
</span><span id="L-1309"><a href="#L-1309"><span class="linenos">1309</span></a>    <span class="k">return</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">dict</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span> <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">args</span><span class="p">}</span>
</span><span id="L-1310"><a href="#L-1310"><span class="linenos">1310</span></a>
</span><span id="L-1311"><a href="#L-1311"><span class="linenos">1311</span></a>
</span><span id="L-1312"><a href="#L-1312"><span class="linenos">1312</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">zigzag_edge</span><span class="p">(</span>
</span><span id="L-1313"><a href="#L-1313"><span class="linenos">1313</span></a>      <span class="bp">self</span><span class="p">,</span>
</span><span id="L-1314"><a href="#L-1314"><span class="linenos">1314</span></a>      <span class="n">edge</span><span class="p">:</span><span class="n">Edge</span><span class="p">,</span>
</span><span id="L-1315"><a href="#L-1315"><span class="linenos">1315</span></a>      <span class="n">start</span><span class="p">:</span><span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;A&quot;</span><span class="p">,</span>
</span><span id="L-1316"><a href="#L-1316"><span class="linenos">1316</span></a>      <span class="n">n</span><span class="p">:</span><span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
</span><span id="L-1317"><a href="#L-1317"><span class="linenos">1317</span></a>      <span class="n">h</span><span class="p">:</span><span class="nb">float</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span>
</span><span id="L-1318"><a href="#L-1318"><span class="linenos">1318</span></a>      <span class="n">smoothness</span><span class="p">:</span><span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
</span><span id="L-1319"><a href="#L-1319"><span class="linenos">1319</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-1320"><a href="#L-1320"><span class="linenos">1320</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Apply zigzag transformation to supplied Edge.</span>
</span><span id="L-1321"><a href="#L-1321"><span class="linenos">1321</span></a>
</span><span id="L-1322"><a href="#L-1322"><span class="linenos">1322</span></a><span class="sd">    Currently this will only work correctly if h is even.</span>
</span><span id="L-1323"><a href="#L-1323"><span class="linenos">1323</span></a>
</span><span id="L-1324"><a href="#L-1324"><span class="linenos">1324</span></a><span class="sd">    TODO: make it possible for odd numbers of &#39;peaks&#39; to work (this may require</span>
</span><span id="L-1325"><a href="#L-1325"><span class="linenos">1325</span></a><span class="sd">    allowing bidirectional Edges, i.e. storing Edges in both directions so that</span>
</span><span id="L-1326"><a href="#L-1326"><span class="linenos">1326</span></a><span class="sd">    all Tile edges are drawn CW). The `start` parameter is a temporary hack for</span>
</span><span id="L-1327"><a href="#L-1327"><span class="linenos">1327</span></a><span class="sd">    this.</span>
</span><span id="L-1328"><a href="#L-1328"><span class="linenos">1328</span></a>
</span><span id="L-1329"><a href="#L-1329"><span class="linenos">1329</span></a><span class="sd">    Args:</span>
</span><span id="L-1330"><a href="#L-1330"><span class="linenos">1330</span></a><span class="sd">      edge (Edge): Edge to transform</span>
</span><span id="L-1331"><a href="#L-1331"><span class="linenos">1331</span></a><span class="sd">      start (str, optional): label at one end of edge which is used to determine</span>
</span><span id="L-1332"><a href="#L-1332"><span class="linenos">1332</span></a><span class="sd">        the sense of h, enabling C-curves with an odd number n of zigs and zags</span>
</span><span id="L-1333"><a href="#L-1333"><span class="linenos">1333</span></a><span class="sd">        to be applied. Defaults to &#39;A&#39;.</span>
</span><span id="L-1334"><a href="#L-1334"><span class="linenos">1334</span></a><span class="sd">      n (int, optional): number of zigs and zags in the edge. Defaults to 2.</span>
</span><span id="L-1335"><a href="#L-1335"><span class="linenos">1335</span></a><span class="sd">      h (float, optional): width of the zig zags relative to edge length.</span>
</span><span id="L-1336"><a href="#L-1336"><span class="linenos">1336</span></a><span class="sd">        Defaults to 0.5.</span>
</span><span id="L-1337"><a href="#L-1337"><span class="linenos">1337</span></a><span class="sd">      smoothness (int, optional): spline smoothness. 0 gives a zig zag proper,</span>
</span><span id="L-1338"><a href="#L-1338"><span class="linenos">1338</span></a><span class="sd">        higher values will produce a sinusoid. Defaults to 0.</span>
</span><span id="L-1339"><a href="#L-1339"><span class="linenos">1339</span></a>
</span><span id="L-1340"><a href="#L-1340"><span class="linenos">1340</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-1341"><a href="#L-1341"><span class="linenos">1341</span></a>    <span class="n">v0</span><span class="p">,</span> <span class="n">v1</span> <span class="o">=</span> <span class="n">edge</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">edge</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-1342"><a href="#L-1342"><span class="linenos">1342</span></a>    <span class="k">if</span> <span class="n">n</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">v0</span><span class="o">.</span><span class="n">label</span> <span class="o">!=</span> <span class="n">start</span><span class="p">:</span>
</span><span id="L-1343"><a href="#L-1343"><span class="linenos">1343</span></a>      <span class="n">h</span> <span class="o">=</span> <span class="o">-</span><span class="n">h</span>
</span><span id="L-1344"><a href="#L-1344"><span class="linenos">1344</span></a>    <span class="n">ls</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">zigzag_between_points</span><span class="p">(</span><span class="n">v0</span><span class="o">.</span><span class="n">point</span><span class="p">,</span> <span class="n">v1</span><span class="o">.</span><span class="n">point</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">smoothness</span><span class="p">)</span>
</span><span id="L-1345"><a href="#L-1345"><span class="linenos">1345</span></a>    <span class="c1"># remove current corners</span>
</span><span id="L-1346"><a href="#L-1346"><span class="linenos">1346</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">points</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">points</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
</span><span id="L-1347"><a href="#L-1347"><span class="linenos">1347</span></a>                   <span class="k">if</span> <span class="n">k</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">edge</span><span class="o">.</span><span class="n">get_corner_IDs</span><span class="p">()[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]}</span>
</span><span id="L-1348"><a href="#L-1348"><span class="linenos">1348</span></a>    <span class="c1"># add the new ones</span>
</span><span id="L-1349"><a href="#L-1349"><span class="linenos">1349</span></a>    <span class="n">new_corners</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">add_vertex</span><span class="p">(</span><span class="n">geom</span><span class="o">.</span><span class="n">Point</span><span class="p">(</span><span class="n">xy</span><span class="p">))</span> <span class="k">for</span> <span class="n">xy</span> <span class="ow">in</span> <span class="n">ls</span><span class="o">.</span><span class="n">coords</span><span class="p">]</span>
</span><span id="L-1350"><a href="#L-1350"><span class="linenos">1350</span></a>    <span class="n">edge</span><span class="o">.</span><span class="n">corners</span> <span class="o">=</span> <span class="n">edge</span><span class="o">.</span><span class="n">vertices</span><span class="p">[:</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">new_corners</span> <span class="o">+</span> <span class="n">edge</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">:]</span>
</span><span id="L-1351"><a href="#L-1351"><span class="linenos">1351</span></a>    <span class="k">if</span> <span class="n">edge</span><span class="o">.</span><span class="n">right_tile</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-1352"><a href="#L-1352"><span class="linenos">1352</span></a>      <span class="n">edge</span><span class="o">.</span><span class="n">right_tile</span><span class="o">.</span><span class="n">set_corners_from_edges</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
</span><span id="L-1353"><a href="#L-1353"><span class="linenos">1353</span></a>    <span class="k">if</span> <span class="n">edge</span><span class="o">.</span><span class="n">left_tile</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-1354"><a href="#L-1354"><span class="linenos">1354</span></a>      <span class="n">edge</span><span class="o">.</span><span class="n">left_tile</span><span class="o">.</span><span class="n">set_corners_from_edges</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
</span><span id="L-1355"><a href="#L-1355"><span class="linenos">1355</span></a>
</span><span id="L-1356"><a href="#L-1356"><span class="linenos">1356</span></a>
</span><span id="L-1357"><a href="#L-1357"><span class="linenos">1357</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">zigzag_between_points</span><span class="p">(</span>
</span><span id="L-1358"><a href="#L-1358"><span class="linenos">1358</span></a>      <span class="bp">self</span><span class="p">,</span>
</span><span id="L-1359"><a href="#L-1359"><span class="linenos">1359</span></a>      <span class="n">p0</span><span class="p">:</span><span class="n">geom</span><span class="o">.</span><span class="n">Point</span><span class="p">,</span>
</span><span id="L-1360"><a href="#L-1360"><span class="linenos">1360</span></a>      <span class="n">p1</span><span class="p">:</span><span class="n">geom</span><span class="o">.</span><span class="n">Point</span><span class="p">,</span>
</span><span id="L-1361"><a href="#L-1361"><span class="linenos">1361</span></a>      <span class="n">n</span><span class="p">:</span><span class="nb">int</span><span class="p">,</span>
</span><span id="L-1362"><a href="#L-1362"><span class="linenos">1362</span></a>      <span class="n">h</span><span class="p">:</span><span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
</span><span id="L-1363"><a href="#L-1363"><span class="linenos">1363</span></a>      <span class="n">smoothness</span><span class="p">:</span><span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
</span><span id="L-1364"><a href="#L-1364"><span class="linenos">1364</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">geom</span><span class="o">.</span><span class="n">LineString</span><span class="p">:</span>
</span><span id="L-1365"><a href="#L-1365"><span class="linenos">1365</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return a zig zag line optionally smoothed as a spline between two points.</span>
</span><span id="L-1366"><a href="#L-1366"><span class="linenos">1366</span></a>
</span><span id="L-1367"><a href="#L-1367"><span class="linenos">1367</span></a><span class="sd">    Args:</span>
</span><span id="L-1368"><a href="#L-1368"><span class="linenos">1368</span></a><span class="sd">      p0 (geom.Point): start point.</span>
</span><span id="L-1369"><a href="#L-1369"><span class="linenos">1369</span></a><span class="sd">      p1 (geom.Point): end point.</span>
</span><span id="L-1370"><a href="#L-1370"><span class="linenos">1370</span></a><span class="sd">      n (int): number of zig zags.</span>
</span><span id="L-1371"><a href="#L-1371"><span class="linenos">1371</span></a><span class="sd">      h (float, optional): amplitude of zig zags relative to distance between</span>
</span><span id="L-1372"><a href="#L-1372"><span class="linenos">1372</span></a><span class="sd">        points. Defaults to 1.0.</span>
</span><span id="L-1373"><a href="#L-1373"><span class="linenos">1373</span></a><span class="sd">      smoothness (int, optional): number of spline smoothed points to add. If</span>
</span><span id="L-1374"><a href="#L-1374"><span class="linenos">1374</span></a><span class="sd">        set to 0 a straight line zig zag is produced. Defaults to 0.</span>
</span><span id="L-1375"><a href="#L-1375"><span class="linenos">1375</span></a>
</span><span id="L-1376"><a href="#L-1376"><span class="linenos">1376</span></a><span class="sd">    Returns:</span>
</span><span id="L-1377"><a href="#L-1377"><span class="linenos">1377</span></a><span class="sd">      geom.LineString: the resulting zig zag line.</span>
</span><span id="L-1378"><a href="#L-1378"><span class="linenos">1378</span></a>
</span><span id="L-1379"><a href="#L-1379"><span class="linenos">1379</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-1380"><a href="#L-1380"><span class="linenos">1380</span></a>    <span class="n">r</span> <span class="o">=</span> <span class="n">p0</span><span class="o">.</span><span class="n">distance</span><span class="p">(</span><span class="n">p1</span><span class="p">)</span>
</span><span id="L-1381"><a href="#L-1381"><span class="linenos">1381</span></a>    <span class="c1"># make a sinusoidal template</span>
</span><span id="L-1382"><a href="#L-1382"><span class="linenos">1382</span></a>    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">n</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">endpoint</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</span><span id="L-1383"><a href="#L-1383"><span class="linenos">1383</span></a>    <span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">x</span><span class="p">]</span>
</span><span id="L-1384"><a href="#L-1384"><span class="linenos">1384</span></a>    <span class="n">spline</span> <span class="o">=</span> <span class="n">interpolate</span><span class="o">.</span><span class="n">InterpolatedUnivariateSpline</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="L-1385"><a href="#L-1385"><span class="linenos">1385</span></a>
</span><span id="L-1386"><a href="#L-1386"><span class="linenos">1386</span></a>    <span class="n">spline_steps</span> <span class="o">=</span> <span class="p">(</span><span class="n">n</span> <span class="o">+</span> <span class="n">smoothness</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span>
</span><span id="L-1387"><a href="#L-1387"><span class="linenos">1387</span></a>    <span class="n">xs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">spline_steps</span><span class="p">,</span> <span class="n">endpoint</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</span><span id="L-1388"><a href="#L-1388"><span class="linenos">1388</span></a>    <span class="n">ys</span> <span class="o">=</span> <span class="n">spline</span><span class="p">(</span><span class="n">xs</span><span class="p">)</span>
</span><span id="L-1389"><a href="#L-1389"><span class="linenos">1389</span></a>
</span><span id="L-1390"><a href="#L-1390"><span class="linenos">1390</span></a>    <span class="n">sfx</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="nb">max</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">*</span> <span class="n">r</span>
</span><span id="L-1391"><a href="#L-1391"><span class="linenos">1391</span></a>    <span class="n">sfy</span> <span class="o">=</span> <span class="n">h</span> <span class="o">*</span> <span class="n">r</span> <span class="o">/</span> <span class="mi">2</span>
</span><span id="L-1392"><a href="#L-1392"><span class="linenos">1392</span></a>    <span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arctan2</span><span class="p">(</span><span class="n">p1</span><span class="o">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">p0</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">p1</span><span class="o">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">p0</span><span class="o">.</span><span class="n">x</span><span class="p">)</span>
</span><span id="L-1393"><a href="#L-1393"><span class="linenos">1393</span></a>
</span><span id="L-1394"><a href="#L-1394"><span class="linenos">1394</span></a>    <span class="n">ls</span> <span class="o">=</span> <span class="n">geom</span><span class="o">.</span><span class="n">LineString</span><span class="p">(</span>
</span><span id="L-1395"><a href="#L-1395"><span class="linenos">1395</span></a>      <span class="p">[</span><span class="n">geom</span><span class="o">.</span><span class="n">Point</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">ys</span><span class="p">,</span> <span class="n">strict</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)])</span>
</span><span id="L-1396"><a href="#L-1396"><span class="linenos">1396</span></a>    <span class="n">ls</span> <span class="o">=</span> <span class="n">affine</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="n">ls</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="p">(</span><span class="n">ls</span><span class="o">.</span><span class="n">bounds</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">ls</span><span class="o">.</span><span class="n">bounds</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="L-1397"><a href="#L-1397"><span class="linenos">1397</span></a>    <span class="n">ls</span> <span class="o">=</span> <span class="n">affine</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">ls</span><span class="p">,</span> <span class="n">xfact</span> <span class="o">=</span> <span class="n">sfx</span><span class="p">,</span> <span class="n">yfact</span> <span class="o">=</span> <span class="n">sfy</span><span class="p">,</span> <span class="n">origin</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
</span><span id="L-1398"><a href="#L-1398"><span class="linenos">1398</span></a>    <span class="n">ls</span> <span class="o">=</span> <span class="n">affine</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span><span class="n">ls</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">use_radians</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</span><span id="L-1399"><a href="#L-1399"><span class="linenos">1399</span></a>    <span class="n">x0</span><span class="p">,</span> <span class="n">y0</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">ls</span><span class="o">.</span><span class="n">coords</span><span class="p">))</span>
</span><span id="L-1400"><a href="#L-1400"><span class="linenos">1400</span></a>    <span class="k">return</span> <span class="n">affine</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="n">ls</span><span class="p">,</span> <span class="n">p0</span><span class="o">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">x0</span><span class="p">,</span> <span class="n">p0</span><span class="o">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">y0</span><span class="p">)</span>
</span><span id="L-1401"><a href="#L-1401"><span class="linenos">1401</span></a>
</span><span id="L-1402"><a href="#L-1402"><span class="linenos">1402</span></a>
</span><span id="L-1403"><a href="#L-1403"><span class="linenos">1403</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">rotate_edge</span><span class="p">(</span>
</span><span id="L-1404"><a href="#L-1404"><span class="linenos">1404</span></a>      <span class="bp">self</span><span class="p">,</span>
</span><span id="L-1405"><a href="#L-1405"><span class="linenos">1405</span></a>      <span class="n">edge</span><span class="p">:</span><span class="n">Edge</span><span class="p">,</span>
</span><span id="L-1406"><a href="#L-1406"><span class="linenos">1406</span></a>      <span class="n">centre</span><span class="p">:</span><span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="L-1407"><a href="#L-1407"><span class="linenos">1407</span></a>      <span class="n">angle</span><span class="p">:</span><span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
</span><span id="L-1408"><a href="#L-1408"><span class="linenos">1408</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-1409"><a href="#L-1409"><span class="linenos">1409</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Rotate edge.</span>
</span><span id="L-1410"><a href="#L-1410"><span class="linenos">1410</span></a>
</span><span id="L-1411"><a href="#L-1411"><span class="linenos">1411</span></a><span class="sd">    Args:</span>
</span><span id="L-1412"><a href="#L-1412"><span class="linenos">1412</span></a><span class="sd">      edge (Edge): the edge to rotate.</span>
</span><span id="L-1413"><a href="#L-1413"><span class="linenos">1413</span></a><span class="sd">      centre (str): centre of rotation which should be label of one of its</span>
</span><span id="L-1414"><a href="#L-1414"><span class="linenos">1414</span></a><span class="sd">        end point vertices or &quot;&quot; when rotation will be about the Edge centroid.</span>
</span><span id="L-1415"><a href="#L-1415"><span class="linenos">1415</span></a><span class="sd">        Defaults to &quot;&quot;.</span>
</span><span id="L-1416"><a href="#L-1416"><span class="linenos">1416</span></a><span class="sd">      angle (float): angle of rotation.</span>
</span><span id="L-1417"><a href="#L-1417"><span class="linenos">1417</span></a>
</span><span id="L-1418"><a href="#L-1418"><span class="linenos">1418</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-1419"><a href="#L-1419"><span class="linenos">1419</span></a>    <span class="n">v0</span><span class="p">,</span> <span class="n">v1</span> <span class="o">=</span> <span class="n">edge</span><span class="o">.</span><span class="n">vertices</span>
</span><span id="L-1420"><a href="#L-1420"><span class="linenos">1420</span></a>    <span class="n">ls</span> <span class="o">=</span> <span class="n">geom</span><span class="o">.</span><span class="n">LineString</span><span class="p">([</span><span class="n">v0</span><span class="o">.</span><span class="n">point</span><span class="p">,</span> <span class="n">v1</span><span class="o">.</span><span class="n">point</span><span class="p">])</span>
</span><span id="L-1421"><a href="#L-1421"><span class="linenos">1421</span></a>    <span class="k">if</span> <span class="n">v0</span><span class="o">.</span><span class="n">label</span> <span class="o">==</span> <span class="n">centre</span><span class="p">:</span>
</span><span id="L-1422"><a href="#L-1422"><span class="linenos">1422</span></a>      <span class="n">c</span> <span class="o">=</span> <span class="n">v0</span><span class="o">.</span><span class="n">point</span>
</span><span id="L-1423"><a href="#L-1423"><span class="linenos">1423</span></a>    <span class="k">elif</span> <span class="n">v1</span><span class="o">.</span><span class="n">label</span> <span class="o">==</span> <span class="n">centre</span><span class="p">:</span>
</span><span id="L-1424"><a href="#L-1424"><span class="linenos">1424</span></a>      <span class="n">c</span> <span class="o">=</span> <span class="n">v1</span><span class="o">.</span><span class="n">point</span>
</span><span id="L-1425"><a href="#L-1425"><span class="linenos">1425</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="L-1426"><a href="#L-1426"><span class="linenos">1426</span></a>      <span class="n">c</span> <span class="o">=</span> <span class="n">ls</span><span class="o">.</span><span class="n">centroid</span>
</span><span id="L-1427"><a href="#L-1427"><span class="linenos">1427</span></a>    <span class="n">ls</span> <span class="o">=</span> <span class="n">affine</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span><span class="n">ls</span><span class="p">,</span> <span class="n">angle</span><span class="p">,</span> <span class="n">origin</span> <span class="o">=</span> <span class="n">c</span><span class="p">)</span>
</span><span id="L-1428"><a href="#L-1428"><span class="linenos">1428</span></a>    <span class="n">v0</span><span class="o">.</span><span class="n">point</span><span class="p">,</span> <span class="n">v1</span><span class="o">.</span><span class="n">point</span> <span class="o">=</span> <span class="p">[</span><span class="n">geom</span><span class="o">.</span><span class="n">Point</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">ls</span><span class="o">.</span><span class="n">coords</span><span class="p">]</span>
</span><span id="L-1429"><a href="#L-1429"><span class="linenos">1429</span></a>
</span><span id="L-1430"><a href="#L-1430"><span class="linenos">1430</span></a>
</span><span id="L-1431"><a href="#L-1431"><span class="linenos">1431</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">scale_edge</span><span class="p">(</span>
</span><span id="L-1432"><a href="#L-1432"><span class="linenos">1432</span></a>      <span class="bp">self</span><span class="p">,</span>
</span><span id="L-1433"><a href="#L-1433"><span class="linenos">1433</span></a>      <span class="n">edge</span><span class="p">:</span><span class="n">Edge</span><span class="p">,</span>
</span><span id="L-1434"><a href="#L-1434"><span class="linenos">1434</span></a>      <span class="n">sf</span><span class="p">:</span><span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
</span><span id="L-1435"><a href="#L-1435"><span class="linenos">1435</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-1436"><a href="#L-1436"><span class="linenos">1436</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Scale edge.</span>
</span><span id="L-1437"><a href="#L-1437"><span class="linenos">1437</span></a>
</span><span id="L-1438"><a href="#L-1438"><span class="linenos">1438</span></a><span class="sd">    Args:</span>
</span><span id="L-1439"><a href="#L-1439"><span class="linenos">1439</span></a><span class="sd">      edge (Edge): the edge to scale.</span>
</span><span id="L-1440"><a href="#L-1440"><span class="linenos">1440</span></a><span class="sd">      sf (float): amount by which to scale the edge.</span>
</span><span id="L-1441"><a href="#L-1441"><span class="linenos">1441</span></a>
</span><span id="L-1442"><a href="#L-1442"><span class="linenos">1442</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-1443"><a href="#L-1443"><span class="linenos">1443</span></a>    <span class="n">v0</span><span class="p">,</span> <span class="n">v1</span> <span class="o">=</span> <span class="n">edge</span><span class="o">.</span><span class="n">vertices</span>
</span><span id="L-1444"><a href="#L-1444"><span class="linenos">1444</span></a>    <span class="n">ls</span> <span class="o">=</span> <span class="n">geom</span><span class="o">.</span><span class="n">LineString</span><span class="p">([</span><span class="n">v0</span><span class="o">.</span><span class="n">point</span><span class="p">,</span> <span class="n">v1</span><span class="o">.</span><span class="n">point</span><span class="p">])</span>
</span><span id="L-1445"><a href="#L-1445"><span class="linenos">1445</span></a>    <span class="n">ls</span> <span class="o">=</span> <span class="n">affine</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">ls</span><span class="p">,</span> <span class="n">xfact</span> <span class="o">=</span> <span class="n">sf</span><span class="p">,</span> <span class="n">yfact</span> <span class="o">=</span> <span class="n">sf</span><span class="p">,</span> <span class="n">origin</span> <span class="o">=</span> <span class="n">ls</span><span class="o">.</span><span class="n">centroid</span><span class="p">)</span>
</span><span id="L-1446"><a href="#L-1446"><span class="linenos">1446</span></a>    <span class="n">v0</span><span class="o">.</span><span class="n">point</span><span class="p">,</span> <span class="n">v1</span><span class="o">.</span><span class="n">point</span> <span class="o">=</span> <span class="p">[</span><span class="n">geom</span><span class="o">.</span><span class="n">Point</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">ls</span><span class="o">.</span><span class="n">coords</span><span class="p">]</span>
</span><span id="L-1447"><a href="#L-1447"><span class="linenos">1447</span></a>
</span><span id="L-1448"><a href="#L-1448"><span class="linenos">1448</span></a>
</span><span id="L-1449"><a href="#L-1449"><span class="linenos">1449</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">push_vertex</span><span class="p">(</span>
</span><span id="L-1450"><a href="#L-1450"><span class="linenos">1450</span></a>      <span class="bp">self</span><span class="p">,</span>
</span><span id="L-1451"><a href="#L-1451"><span class="linenos">1451</span></a>      <span class="n">vertex</span><span class="p">:</span><span class="n">Vertex</span><span class="p">,</span>
</span><span id="L-1452"><a href="#L-1452"><span class="linenos">1452</span></a>      <span class="n">push_d</span><span class="p">:</span><span class="nb">float</span><span class="p">,</span>
</span><span id="L-1453"><a href="#L-1453"><span class="linenos">1453</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">]:</span>
</span><span id="L-1454"><a href="#L-1454"><span class="linenos">1454</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return displacement vector to push a vertex based on incident edges.</span>
</span><span id="L-1455"><a href="#L-1455"><span class="linenos">1455</span></a>
</span><span id="L-1456"><a href="#L-1456"><span class="linenos">1456</span></a><span class="sd">    Args:</span>
</span><span id="L-1457"><a href="#L-1457"><span class="linenos">1457</span></a><span class="sd">      vertex (Vertex): the vertex to push.</span>
</span><span id="L-1458"><a href="#L-1458"><span class="linenos">1458</span></a><span class="sd">      push_d (float): the distance to push it.</span>
</span><span id="L-1459"><a href="#L-1459"><span class="linenos">1459</span></a>
</span><span id="L-1460"><a href="#L-1460"><span class="linenos">1460</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-1461"><a href="#L-1461"><span class="linenos">1461</span></a>    <span class="n">neighbours</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">points</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">vertex</span><span class="o">.</span><span class="n">neighbours</span><span class="p">]</span>
</span><span id="L-1462"><a href="#L-1462"><span class="linenos">1462</span></a>    <span class="n">dists</span> <span class="o">=</span> <span class="p">[</span><span class="n">vertex</span><span class="o">.</span><span class="n">point</span><span class="o">.</span><span class="n">distance</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">point</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">neighbours</span><span class="p">]</span>
</span><span id="L-1463"><a href="#L-1463"><span class="linenos">1463</span></a>    <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">vertex</span><span class="o">.</span><span class="n">point</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">vertex</span><span class="o">.</span><span class="n">point</span><span class="o">.</span><span class="n">y</span>
</span><span id="L-1464"><a href="#L-1464"><span class="linenos">1464</span></a>    <span class="n">unit_vectors</span> <span class="o">=</span> <span class="p">[((</span><span class="n">x</span> <span class="o">-</span> <span class="n">v</span><span class="o">.</span><span class="n">point</span><span class="o">.</span><span class="n">x</span><span class="p">)</span> <span class="o">/</span> <span class="n">d</span><span class="p">,</span> <span class="p">(</span><span class="n">y</span> <span class="o">-</span> <span class="n">v</span><span class="o">.</span><span class="n">point</span><span class="o">.</span><span class="n">y</span><span class="p">)</span> <span class="o">/</span> <span class="n">d</span><span class="p">)</span>
</span><span id="L-1465"><a href="#L-1465"><span class="linenos">1465</span></a>                    <span class="k">for</span> <span class="n">v</span><span class="p">,</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">neighbours</span><span class="p">,</span> <span class="n">dists</span><span class="p">,</span> <span class="n">strict</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)]</span>
</span><span id="L-1466"><a href="#L-1466"><span class="linenos">1466</span></a>    <span class="k">return</span>  <span class="p">(</span><span class="n">push_d</span> <span class="o">*</span> <span class="nb">sum</span><span class="p">([</span><span class="n">xy</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">xy</span> <span class="ow">in</span> <span class="n">unit_vectors</span><span class="p">]),</span>
</span><span id="L-1467"><a href="#L-1467"><span class="linenos">1467</span></a>             <span class="n">push_d</span> <span class="o">*</span> <span class="nb">sum</span><span class="p">([</span><span class="n">xy</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">xy</span> <span class="ow">in</span> <span class="n">unit_vectors</span><span class="p">]))</span>
</span><span id="L-1468"><a href="#L-1468"><span class="linenos">1468</span></a>
</span><span id="L-1469"><a href="#L-1469"><span class="linenos">1469</span></a>
</span><span id="L-1470"><a href="#L-1470"><span class="linenos">1470</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">nudge_vertex</span><span class="p">(</span>
</span><span id="L-1471"><a href="#L-1471"><span class="linenos">1471</span></a>      <span class="bp">self</span><span class="p">,</span>
</span><span id="L-1472"><a href="#L-1472"><span class="linenos">1472</span></a>      <span class="n">vertex</span><span class="p">:</span><span class="n">Vertex</span><span class="p">,</span>
</span><span id="L-1473"><a href="#L-1473"><span class="linenos">1473</span></a>      <span class="n">dx</span><span class="p">:</span><span class="nb">float</span><span class="p">,</span>
</span><span id="L-1474"><a href="#L-1474"><span class="linenos">1474</span></a>      <span class="n">dy</span><span class="p">:</span><span class="nb">float</span><span class="p">,</span>
</span><span id="L-1475"><a href="#L-1475"><span class="linenos">1475</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-1476"><a href="#L-1476"><span class="linenos">1476</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Nudge vertex by specified displacement.</span>
</span><span id="L-1477"><a href="#L-1477"><span class="linenos">1477</span></a>
</span><span id="L-1478"><a href="#L-1478"><span class="linenos">1478</span></a><span class="sd">    Args:</span>
</span><span id="L-1479"><a href="#L-1479"><span class="linenos">1479</span></a><span class="sd">      vertex (Vertex): the vertext to nudge.</span>
</span><span id="L-1480"><a href="#L-1480"><span class="linenos">1480</span></a><span class="sd">      dx (float): x displacement.</span>
</span><span id="L-1481"><a href="#L-1481"><span class="linenos">1481</span></a><span class="sd">      dy (float): y displacement.</span>
</span><span id="L-1482"><a href="#L-1482"><span class="linenos">1482</span></a>
</span><span id="L-1483"><a href="#L-1483"><span class="linenos">1483</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-1484"><a href="#L-1484"><span class="linenos">1484</span></a>    <span class="n">vertex</span><span class="o">.</span><span class="n">point</span> <span class="o">=</span> <span class="n">affine</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="n">vertex</span><span class="o">.</span><span class="n">point</span><span class="p">,</span> <span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="p">)</span>
</span><span id="L-1485"><a href="#L-1485"><span class="linenos">1485</span></a>
</span><span id="L-1486"><a href="#L-1486"><span class="linenos">1486</span></a>
</span><span id="L-1487"><a href="#L-1487"><span class="linenos">1487</span></a><span class="k">class</span><span class="w"> </span><span class="nc">Tile</span><span class="p">:</span>
</span><span id="L-1488"><a href="#L-1488"><span class="linenos">1488</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;Class to represent essential features of polygons in a tiling.&quot;&quot;&quot;</span>
</span><span id="L-1489"><a href="#L-1489"><span class="linenos">1489</span></a>
</span><span id="L-1490"><a href="#L-1490"><span class="linenos">1490</span></a>  <span class="n">ID</span><span class="p">:</span> <span class="nb">int</span>
</span><span id="L-1491"><a href="#L-1491"><span class="linenos">1491</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;integer ID number which indexes the Tile in the containing Topology tiles</span>
</span><span id="L-1492"><a href="#L-1492"><span class="linenos">1492</span></a><span class="sd">  list.&quot;&quot;&quot;</span>
</span><span id="L-1493"><a href="#L-1493"><span class="linenos">1493</span></a>  <span class="n">base_ID</span><span class="p">:</span> <span class="nb">int</span>
</span><span id="L-1494"><a href="#L-1494"><span class="linenos">1494</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;ID of corresponding Tile in the base tileable unit&quot;&quot;&quot;</span>
</span><span id="L-1495"><a href="#L-1495"><span class="linenos">1495</span></a>  <span class="n">corners</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Vertex</span><span class="p">]</span>
</span><span id="L-1496"><a href="#L-1496"><span class="linenos">1496</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;list of Vertex objects. This includes all corners of the original polygon</span>
</span><span id="L-1497"><a href="#L-1497"><span class="linenos">1497</span></a><span class="sd">  and any tiling vertices induced by (for example) a the corner of an adjacent</span>
</span><span id="L-1498"><a href="#L-1498"><span class="linenos">1498</span></a><span class="sd">  tile lying halfway along an edge of the original polygon on which this tile</span>
</span><span id="L-1499"><a href="#L-1499"><span class="linenos">1499</span></a><span class="sd">  is based. Vertex objects are stored in strictly clockwise sequence.&quot;&quot;&quot;</span>
</span><span id="L-1500"><a href="#L-1500"><span class="linenos">1500</span></a>  <span class="n">edges</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Edge</span><span class="p">]</span>
</span><span id="L-1501"><a href="#L-1501"><span class="linenos">1501</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;list of Edge objects that together compose the tile boundary.&quot;&quot;&quot;</span>
</span><span id="L-1502"><a href="#L-1502"><span class="linenos">1502</span></a>  <span class="n">edges_CW</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span>
</span><span id="L-1503"><a href="#L-1503"><span class="linenos">1503</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;list of Edge direction. Edges are stored only once in a Topology so some</span>
</span><span id="L-1504"><a href="#L-1504"><span class="linenos">1504</span></a><span class="sd">  edges are in clockwise order and others  are in counter-clockwise order.</span>
</span><span id="L-1505"><a href="#L-1505"><span class="linenos">1505</span></a><span class="sd">  These boolean flags are True if the corresponding Edge is clockwise, False if</span>
</span><span id="L-1506"><a href="#L-1506"><span class="linenos">1506</span></a><span class="sd">  counter-clockwise.&quot;&quot;&quot;</span>
</span><span id="L-1507"><a href="#L-1507"><span class="linenos">1507</span></a>  <span class="n">label</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="L-1508"><a href="#L-1508"><span class="linenos">1508</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;tile_id label from the tileable source&quot;&quot;&quot;</span>
</span><span id="L-1509"><a href="#L-1509"><span class="linenos">1509</span></a>  <span class="n">vertex_labels</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
</span><span id="L-1510"><a href="#L-1510"><span class="linenos">1510</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;list of (upper case) letter labels of the tile corners (i.e. all corners,</span>
</span><span id="L-1511"><a href="#L-1511"><span class="linenos">1511</span></a><span class="sd">  not only tiling vertices).&quot;&quot;&quot;</span>
</span><span id="L-1512"><a href="#L-1512"><span class="linenos">1512</span></a>  <span class="n">edge_labels</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
</span><span id="L-1513"><a href="#L-1513"><span class="linenos">1513</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;list of (lower case) letter labels of the tile edges (tiling edges, not</span>
</span><span id="L-1514"><a href="#L-1514"><span class="linenos">1514</span></a><span class="sd">  tile sides).&quot;&quot;&quot;</span>
</span><span id="L-1515"><a href="#L-1515"><span class="linenos">1515</span></a>  <span class="n">shape</span><span class="p">:</span> <span class="n">geom</span><span class="o">.</span><span class="n">Polygon</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-1516"><a href="#L-1516"><span class="linenos">1516</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;the tile geometry (which may include some redundant points along sides</span>
</span><span id="L-1517"><a href="#L-1517"><span class="linenos">1517</span></a><span class="sd">  where neighbouring tiles induce a tiling vertex). So for example a rectangle</span>
</span><span id="L-1518"><a href="#L-1518"><span class="linenos">1518</span></a><span class="sd">  might have additional points along its sides:</span>
</span><span id="L-1519"><a href="#L-1519"><span class="linenos">1519</span></a>
</span><span id="L-1520"><a href="#L-1520"><span class="linenos">1520</span></a><span class="sd">        +---+-------+</span>
</span><span id="L-1521"><a href="#L-1521"><span class="linenos">1521</span></a><span class="sd">        |   |   2   |</span>
</span><span id="L-1522"><a href="#L-1522"><span class="linenos">1522</span></a><span class="sd">        | 1 A---B---E---+</span>
</span><span id="L-1523"><a href="#L-1523"><span class="linenos">1523</span></a><span class="sd">        |   |   |   4   |</span>
</span><span id="L-1524"><a href="#L-1524"><span class="linenos">1524</span></a><span class="sd">        +---C 3 D-------+</span>
</span><span id="L-1525"><a href="#L-1525"><span class="linenos">1525</span></a><span class="sd">            |   |</span>
</span><span id="L-1526"><a href="#L-1526"><span class="linenos">1526</span></a><span class="sd">            +---+</span>
</span><span id="L-1527"><a href="#L-1527"><span class="linenos">1527</span></a>
</span><span id="L-1528"><a href="#L-1528"><span class="linenos">1528</span></a><span class="sd">  In the above Tile 1 has additional point A, 2 has B and 3 has C and D induced</span>
</span><span id="L-1529"><a href="#L-1529"><span class="linenos">1529</span></a><span class="sd">  by the corners of neighbouring tiles.&quot;&quot;&quot;</span>
</span><span id="L-1530"><a href="#L-1530"><span class="linenos">1530</span></a>  <span class="n">centre</span><span class="p">:</span> <span class="n">geom</span><span class="o">.</span><span class="n">Point</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-1531"><a href="#L-1531"><span class="linenos">1531</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;a point centre for the Tile (determined by weavingspace.tiling_utils.</span>
</span><span id="L-1532"><a href="#L-1532"><span class="linenos">1532</span></a><span class="sd">  incentre).&quot;&quot;&quot;</span>
</span><span id="L-1533"><a href="#L-1533"><span class="linenos">1533</span></a>  <span class="n">shape_group</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-1534"><a href="#L-1534"><span class="linenos">1534</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;the tile shape group of this tile in its containing Topology.&quot;&quot;&quot;</span>
</span><span id="L-1535"><a href="#L-1535"><span class="linenos">1535</span></a>  <span class="n">transitivity_class</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-1536"><a href="#L-1536"><span class="linenos">1536</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;the tile transitivity class of this tile its containing Topology&quot;&quot;&quot;</span>
</span><span id="L-1537"><a href="#L-1537"><span class="linenos">1537</span></a>
</span><span id="L-1538"><a href="#L-1538"><span class="linenos">1538</span></a>  <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="L-1539"><a href="#L-1539"><span class="linenos">1539</span></a>      <span class="bp">self</span><span class="p">,</span>
</span><span id="L-1540"><a href="#L-1540"><span class="linenos">1540</span></a>      <span class="n">ID</span><span class="p">:</span><span class="nb">int</span><span class="p">,</span>
</span><span id="L-1541"><a href="#L-1541"><span class="linenos">1541</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-1542"><a href="#L-1542"><span class="linenos">1542</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Class constructor.</span>
</span><span id="L-1543"><a href="#L-1543"><span class="linenos">1543</span></a>
</span><span id="L-1544"><a href="#L-1544"><span class="linenos">1544</span></a><span class="sd">    Args:</span>
</span><span id="L-1545"><a href="#L-1545"><span class="linenos">1545</span></a><span class="sd">      ID (int): sequence number ID of this vertex in the Topology.</span>
</span><span id="L-1546"><a href="#L-1546"><span class="linenos">1546</span></a>
</span><span id="L-1547"><a href="#L-1547"><span class="linenos">1547</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-1548"><a href="#L-1548"><span class="linenos">1548</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">ID</span> <span class="o">=</span> <span class="n">ID</span>
</span><span id="L-1549"><a href="#L-1549"><span class="linenos">1549</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">corners</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-1550"><a href="#L-1550"><span class="linenos">1550</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">edges</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-1551"><a href="#L-1551"><span class="linenos">1551</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">edges_CW</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-1552"><a href="#L-1552"><span class="linenos">1552</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">vertex_labels</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-1553"><a href="#L-1553"><span class="linenos">1553</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">edge_labels</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-1554"><a href="#L-1554"><span class="linenos">1554</span></a>
</span><span id="L-1555"><a href="#L-1555"><span class="linenos">1555</span></a>
</span><span id="L-1556"><a href="#L-1556"><span class="linenos">1556</span></a>  <span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="L-1557"><a href="#L-1557"><span class="linenos">1557</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return string representation of the Tile.</span>
</span><span id="L-1558"><a href="#L-1558"><span class="linenos">1558</span></a>
</span><span id="L-1559"><a href="#L-1559"><span class="linenos">1559</span></a><span class="sd">    Returns:</span>
</span><span id="L-1560"><a href="#L-1560"><span class="linenos">1560</span></a><span class="sd">      str: string including Tile ID, list of corner vertex IDs and list of</span>
</span><span id="L-1561"><a href="#L-1561"><span class="linenos">1561</span></a><span class="sd">        edge IDs.</span>
</span><span id="L-1562"><a href="#L-1562"><span class="linenos">1562</span></a>
</span><span id="L-1563"><a href="#L-1563"><span class="linenos">1563</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-1564"><a href="#L-1564"><span class="linenos">1564</span></a>    <span class="k">return</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Tile </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">ID</span><span class="si">}</span><span class="s2"> Corners: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">get_corner_IDs</span><span class="p">()</span><span class="si">}</span><span class="s2"> &quot;</span>
</span><span id="L-1565"><a href="#L-1565"><span class="linenos">1565</span></a>            <span class="sa">f</span><span class="s2">&quot;Edges: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">get_edge_IDs</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-1566"><a href="#L-1566"><span class="linenos">1566</span></a>
</span><span id="L-1567"><a href="#L-1567"><span class="linenos">1567</span></a>
</span><span id="L-1568"><a href="#L-1568"><span class="linenos">1568</span></a>  <span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="L-1569"><a href="#L-1569"><span class="linenos">1569</span></a>    <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="L-1570"><a href="#L-1570"><span class="linenos">1570</span></a>
</span><span id="L-1571"><a href="#L-1571"><span class="linenos">1571</span></a>
</span><span id="L-1572"><a href="#L-1572"><span class="linenos">1572</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">get_corner_IDs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
</span><span id="L-1573"><a href="#L-1573"><span class="linenos">1573</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return list of corner IDs (not Vertex objects).</span>
</span><span id="L-1574"><a href="#L-1574"><span class="linenos">1574</span></a>
</span><span id="L-1575"><a href="#L-1575"><span class="linenos">1575</span></a><span class="sd">    Returns:</span>
</span><span id="L-1576"><a href="#L-1576"><span class="linenos">1576</span></a><span class="sd">      list[int]: list of integer IDs of tile corners.</span>
</span><span id="L-1577"><a href="#L-1577"><span class="linenos">1577</span></a>
</span><span id="L-1578"><a href="#L-1578"><span class="linenos">1578</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-1579"><a href="#L-1579"><span class="linenos">1579</span></a>    <span class="k">return</span> <span class="p">[</span><span class="n">c</span><span class="o">.</span><span class="n">ID</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">corners</span><span class="p">]</span>
</span><span id="L-1580"><a href="#L-1580"><span class="linenos">1580</span></a>
</span><span id="L-1581"><a href="#L-1581"><span class="linenos">1581</span></a>
</span><span id="L-1582"><a href="#L-1582"><span class="linenos">1582</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">get_edge_IDs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span><span class="nb">int</span><span class="p">]]:</span>
</span><span id="L-1583"><a href="#L-1583"><span class="linenos">1583</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return list of edge IDs (not Edge objects).</span>
</span><span id="L-1584"><a href="#L-1584"><span class="linenos">1584</span></a>
</span><span id="L-1585"><a href="#L-1585"><span class="linenos">1585</span></a><span class="sd">    Returns:</span>
</span><span id="L-1586"><a href="#L-1586"><span class="linenos">1586</span></a><span class="sd">      list[tuple[int]]: list of 2-element tuples of the start and end Vertex IDs</span>
</span><span id="L-1587"><a href="#L-1587"><span class="linenos">1587</span></a><span class="sd">        of each edge.</span>
</span><span id="L-1588"><a href="#L-1588"><span class="linenos">1588</span></a>
</span><span id="L-1589"><a href="#L-1589"><span class="linenos">1589</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-1590"><a href="#L-1590"><span class="linenos">1590</span></a>    <span class="k">return</span> <span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">ID</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">]</span>
</span><span id="L-1591"><a href="#L-1591"><span class="linenos">1591</span></a>
</span><span id="L-1592"><a href="#L-1592"><span class="linenos">1592</span></a>
</span><span id="L-1593"><a href="#L-1593"><span class="linenos">1593</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">set_shape_from_corners</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-1594"><a href="#L-1594"><span class="linenos">1594</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Set the shape attribute based on corners, and associated tile centre.&quot;&quot;&quot;</span>
</span><span id="L-1595"><a href="#L-1595"><span class="linenos">1595</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">shape</span> <span class="o">=</span> <span class="n">geom</span><span class="o">.</span><span class="n">Polygon</span><span class="p">([</span><span class="n">c</span><span class="o">.</span><span class="n">point</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">corners</span><span class="p">])</span>
</span><span id="L-1596"><a href="#L-1596"><span class="linenos">1596</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">centre</span> <span class="o">=</span> <span class="n">tiling_utils</span><span class="o">.</span><span class="n">get_incentre</span><span class="p">(</span>
</span><span id="L-1597"><a href="#L-1597"><span class="linenos">1597</span></a>      <span class="n">tiling_utils</span><span class="o">.</span><span class="n">get_clean_polygon</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
</span><span id="L-1598"><a href="#L-1598"><span class="linenos">1598</span></a>
</span><span id="L-1599"><a href="#L-1599"><span class="linenos">1599</span></a>
</span><span id="L-1600"><a href="#L-1600"><span class="linenos">1600</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">set_corners_from_edges</span><span class="p">(</span>
</span><span id="L-1601"><a href="#L-1601"><span class="linenos">1601</span></a>      <span class="bp">self</span><span class="p">,</span>
</span><span id="L-1602"><a href="#L-1602"><span class="linenos">1602</span></a>      <span class="n">update_shape</span><span class="p">:</span><span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="L-1603"><a href="#L-1603"><span class="linenos">1603</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-1604"><a href="#L-1604"><span class="linenos">1604</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Set corners attribute from the edges attribute.</span>
</span><span id="L-1605"><a href="#L-1605"><span class="linenos">1605</span></a>
</span><span id="L-1606"><a href="#L-1606"><span class="linenos">1606</span></a><span class="sd">    Typically called after modification of topology edges. Optionally the shape</span>
</span><span id="L-1607"><a href="#L-1607"><span class="linenos">1607</span></a><span class="sd">    attribute is NOT updated, which may save time when multiple changes to the</span>
</span><span id="L-1608"><a href="#L-1608"><span class="linenos">1608</span></a><span class="sd">    edges of a tile are in process (i.e., only update the shape after all</span>
</span><span id="L-1609"><a href="#L-1609"><span class="linenos">1609</span></a><span class="sd">    changes are complete).</span>
</span><span id="L-1610"><a href="#L-1610"><span class="linenos">1610</span></a>
</span><span id="L-1611"><a href="#L-1611"><span class="linenos">1611</span></a><span class="sd">    Args:</span>
</span><span id="L-1612"><a href="#L-1612"><span class="linenos">1612</span></a><span class="sd">      update_shape (bool, optional): if True the shape attribute will be</span>
</span><span id="L-1613"><a href="#L-1613"><span class="linenos">1613</span></a><span class="sd">        updated, otherwise not. Defaults to True.</span>
</span><span id="L-1614"><a href="#L-1614"><span class="linenos">1614</span></a>
</span><span id="L-1615"><a href="#L-1615"><span class="linenos">1615</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-1616"><a href="#L-1616"><span class="linenos">1616</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">corners</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-1617"><a href="#L-1617"><span class="linenos">1617</span></a>    <span class="k">for</span> <span class="n">e</span><span class="p">,</span> <span class="n">cw</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges_CW</span><span class="p">,</span> <span class="n">strict</span> <span class="o">=</span> <span class="kc">True</span><span class="p">):</span>
</span><span id="L-1618"><a href="#L-1618"><span class="linenos">1618</span></a>      <span class="k">if</span> <span class="n">cw</span><span class="p">:</span> <span class="c1"># clockwise to extend by all but the first corner</span>
</span><span id="L-1619"><a href="#L-1619"><span class="linenos">1619</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">corners</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">corners</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</span><span id="L-1620"><a href="#L-1620"><span class="linenos">1620</span></a>      <span class="k">else</span><span class="p">:</span> <span class="c1"># counter-clockwise so extend in reverse</span>
</span><span id="L-1621"><a href="#L-1621"><span class="linenos">1621</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">corners</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">corners</span><span class="p">[</span><span class="mi">1</span><span class="p">:][::</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</span><span id="L-1622"><a href="#L-1622"><span class="linenos">1622</span></a>    <span class="k">if</span> <span class="n">update_shape</span><span class="p">:</span>
</span><span id="L-1623"><a href="#L-1623"><span class="linenos">1623</span></a>      <span class="bp">self</span><span class="o">.</span><span class="n">set_shape_from_corners</span><span class="p">()</span>
</span><span id="L-1624"><a href="#L-1624"><span class="linenos">1624</span></a>
</span><span id="L-1625"><a href="#L-1625"><span class="linenos">1625</span></a>
</span><span id="L-1626"><a href="#L-1626"><span class="linenos">1626</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">set_edge_directions</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-1627"><a href="#L-1627"><span class="linenos">1627</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Set up edges_CW attribute by inspection of the edges list.</span>
</span><span id="L-1628"><a href="#L-1628"><span class="linenos">1628</span></a>
</span><span id="L-1629"><a href="#L-1629"><span class="linenos">1629</span></a><span class="sd">    It is (frankly!) hard to keep track of the correct sequence of CW/CCW order</span>
</span><span id="L-1630"><a href="#L-1630"><span class="linenos">1630</span></a><span class="sd">    of edges as new ones are created or old ones merged. This method inspects</span>
</span><span id="L-1631"><a href="#L-1631"><span class="linenos">1631</span></a><span class="sd">    the &#39;tail-head&#39; relations between consecutive edges to set these flags</span>
</span><span id="L-1632"><a href="#L-1632"><span class="linenos">1632</span></a><span class="sd">    correctly.</span>
</span><span id="L-1633"><a href="#L-1633"><span class="linenos">1633</span></a>
</span><span id="L-1634"><a href="#L-1634"><span class="linenos">1634</span></a><span class="sd">    The test is simply to check if the &#39;tail&#39; Vertex ID in each edge appears</span>
</span><span id="L-1635"><a href="#L-1635"><span class="linenos">1635</span></a><span class="sd">    in the ID tuple of the following edge, i.e. if successive edge</span>
</span><span id="L-1636"><a href="#L-1636"><span class="linenos">1636</span></a><span class="sd">    IDs are (0, 1) (2, 1) or (0, 1) (1, 2), then edge (0, 1) is in clockwise</span>
</span><span id="L-1637"><a href="#L-1637"><span class="linenos">1637</span></a><span class="sd">    direction, but if we have (0, 1) (2, 3) then it is not.</span>
</span><span id="L-1638"><a href="#L-1638"><span class="linenos">1638</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-1639"><a href="#L-1639"><span class="linenos">1639</span></a>    <span class="n">edge_IDs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_edge_IDs</span><span class="p">()</span>
</span><span id="L-1640"><a href="#L-1640"><span class="linenos">1640</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">edges_CW</span> <span class="o">=</span> <span class="p">[</span><span class="n">e1</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="n">e2</span> <span class="k">for</span> <span class="n">e1</span><span class="p">,</span> <span class="n">e2</span> <span class="ow">in</span>
</span><span id="L-1641"><a href="#L-1641"><span class="linenos">1641</span></a>                     <span class="nb">zip</span><span class="p">(</span><span class="n">edge_IDs</span><span class="p">,</span> <span class="n">edge_IDs</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">+</span> <span class="n">edge_IDs</span><span class="p">[:</span><span class="mi">1</span><span class="p">],</span> <span class="n">strict</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)]</span>
</span><span id="L-1642"><a href="#L-1642"><span class="linenos">1642</span></a>
</span><span id="L-1643"><a href="#L-1643"><span class="linenos">1643</span></a>
</span><span id="L-1644"><a href="#L-1644"><span class="linenos">1644</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">insert_vertex_at</span><span class="p">(</span>
</span><span id="L-1645"><a href="#L-1645"><span class="linenos">1645</span></a>      <span class="bp">self</span><span class="p">,</span>
</span><span id="L-1646"><a href="#L-1646"><span class="linenos">1646</span></a>      <span class="n">v</span><span class="p">:</span><span class="n">Vertex</span><span class="p">,</span>
</span><span id="L-1647"><a href="#L-1647"><span class="linenos">1647</span></a>      <span class="n">i</span><span class="p">:</span><span class="nb">int</span><span class="p">,</span>
</span><span id="L-1648"><a href="#L-1648"><span class="linenos">1648</span></a>      <span class="n">update_shape</span><span class="p">:</span><span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="L-1649"><a href="#L-1649"><span class="linenos">1649</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span><span class="nb">int</span><span class="p">],</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span><span class="nb">int</span><span class="p">],</span><span class="o">...</span><span class="p">]]:</span>
</span><span id="L-1650"><a href="#L-1650"><span class="linenos">1650</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Insert the Vertex into tile at index position i.</span>
</span><span id="L-1651"><a href="#L-1651"><span class="linenos">1651</span></a>
</span><span id="L-1652"><a href="#L-1652"><span class="linenos">1652</span></a><span class="sd">    Both corners and edges attributes are updated, and the old edge IDs for</span>
</span><span id="L-1653"><a href="#L-1653"><span class="linenos">1653</span></a><span class="sd">    removal and the new edge itself are returned to the calling context (the</span>
</span><span id="L-1654"><a href="#L-1654"><span class="linenos">1654</span></a><span class="sd">    containing Topology) for update of its edges collection. Optionally update</span>
</span><span id="L-1655"><a href="#L-1655"><span class="linenos">1655</span></a><span class="sd">    the shape attribute.</span>
</span><span id="L-1656"><a href="#L-1656"><span class="linenos">1656</span></a>
</span><span id="L-1657"><a href="#L-1657"><span class="linenos">1657</span></a><span class="sd">    This is NOT a generic vertex insertion method: it is only for use during</span>
</span><span id="L-1658"><a href="#L-1658"><span class="linenos">1658</span></a><span class="sd">    Topology initialisation, and does not guarantee correct maintenance of</span>
</span><span id="L-1659"><a href="#L-1659"><span class="linenos">1659</span></a><span class="sd">    all tile, edge and vertex relations in the general case---at any rate it</span>
</span><span id="L-1660"><a href="#L-1660"><span class="linenos">1660</span></a><span class="sd">    has not been tested for this!</span>
</span><span id="L-1661"><a href="#L-1661"><span class="linenos">1661</span></a>
</span><span id="L-1662"><a href="#L-1662"><span class="linenos">1662</span></a><span class="sd">    Args:</span>
</span><span id="L-1663"><a href="#L-1663"><span class="linenos">1663</span></a><span class="sd">      v (Vertex): the Vertex to insert.</span>
</span><span id="L-1664"><a href="#L-1664"><span class="linenos">1664</span></a><span class="sd">      i (int): index position in current corners after which to insert</span>
</span><span id="L-1665"><a href="#L-1665"><span class="linenos">1665</span></a><span class="sd">        supplied Vertex.</span>
</span><span id="L-1666"><a href="#L-1666"><span class="linenos">1666</span></a><span class="sd">      update_shape (bool, optional): if True shape attribute is updated.</span>
</span><span id="L-1667"><a href="#L-1667"><span class="linenos">1667</span></a><span class="sd">        Defaults to False.</span>
</span><span id="L-1668"><a href="#L-1668"><span class="linenos">1668</span></a>
</span><span id="L-1669"><a href="#L-1669"><span class="linenos">1669</span></a><span class="sd">    Returns:</span>
</span><span id="L-1670"><a href="#L-1670"><span class="linenos">1670</span></a><span class="sd">      tuple: the (tuple) ID of the old edge which should be deleted, and</span>
</span><span id="L-1671"><a href="#L-1671"><span class="linenos">1671</span></a><span class="sd">        the new Edges arising from insertion of this Vertex.</span>
</span><span id="L-1672"><a href="#L-1672"><span class="linenos">1672</span></a>
</span><span id="L-1673"><a href="#L-1673"><span class="linenos">1673</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-1674"><a href="#L-1674"><span class="linenos">1674</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">corners</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">corners</span><span class="p">[:</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">corners</span><span class="p">[</span><span class="n">i</span><span class="p">:]</span>
</span><span id="L-1675"><a href="#L-1675"><span class="linenos">1675</span></a>    <span class="n">old_edge</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
</span><span id="L-1676"><a href="#L-1676"><span class="linenos">1676</span></a>    <span class="c1"># store current ID of the affected edge for return to calling context</span>
</span><span id="L-1677"><a href="#L-1677"><span class="linenos">1677</span></a>    <span class="n">old_edge_ID</span> <span class="o">=</span> <span class="n">old_edge</span><span class="o">.</span><span class="n">ID</span>
</span><span id="L-1678"><a href="#L-1678"><span class="linenos">1678</span></a>    <span class="n">new_edges</span> <span class="o">=</span> <span class="n">old_edge</span><span class="o">.</span><span class="n">insert_vertex</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">corners</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">])</span>
</span><span id="L-1679"><a href="#L-1679"><span class="linenos">1679</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">edges</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">[:(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)]</span> <span class="o">+</span> <span class="n">new_edges</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">i</span><span class="p">:]</span>
</span><span id="L-1680"><a href="#L-1680"><span class="linenos">1680</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">set_edge_directions</span><span class="p">()</span>
</span><span id="L-1681"><a href="#L-1681"><span class="linenos">1681</span></a>    <span class="k">if</span> <span class="n">update_shape</span><span class="p">:</span>
</span><span id="L-1682"><a href="#L-1682"><span class="linenos">1682</span></a>      <span class="bp">self</span><span class="o">.</span><span class="n">set_shape_from_corners</span><span class="p">()</span>
</span><span id="L-1683"><a href="#L-1683"><span class="linenos">1683</span></a>    <span class="k">return</span> <span class="n">old_edge_ID</span><span class="p">,</span> <span class="n">new_edges</span>
</span><span id="L-1684"><a href="#L-1684"><span class="linenos">1684</span></a>
</span><span id="L-1685"><a href="#L-1685"><span class="linenos">1685</span></a>
</span><span id="L-1686"><a href="#L-1686"><span class="linenos">1686</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">merge_edges_at_vertex</span><span class="p">(</span>
</span><span id="L-1687"><a href="#L-1687"><span class="linenos">1687</span></a>      <span class="bp">self</span><span class="p">,</span>
</span><span id="L-1688"><a href="#L-1688"><span class="linenos">1688</span></a>      <span class="n">v</span><span class="p">:</span><span class="n">Vertex</span><span class="p">,</span>
</span><span id="L-1689"><a href="#L-1689"><span class="linenos">1689</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
</span><span id="L-1690"><a href="#L-1690"><span class="linenos">1690</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Merge edges that meet at the supplied Vertex.</span>
</span><span id="L-1691"><a href="#L-1691"><span class="linenos">1691</span></a>
</span><span id="L-1692"><a href="#L-1692"><span class="linenos">1692</span></a><span class="sd">    It is assumed that only two tiles are impacted this one, and its neighbour</span>
</span><span id="L-1693"><a href="#L-1693"><span class="linenos">1693</span></a><span class="sd">    across the Edge on which v lies. Both are updated. For this reason the work</span>
</span><span id="L-1694"><a href="#L-1694"><span class="linenos">1694</span></a><span class="sd">    is delegated to `get_updated_edges_from_merge` which is run on both affected</span>
</span><span id="L-1695"><a href="#L-1695"><span class="linenos">1695</span></a><span class="sd">    tiles, but only determines the edges to remove and the new edge to be added</span>
</span><span id="L-1696"><a href="#L-1696"><span class="linenos">1696</span></a><span class="sd">    once. See that method for details.</span>
</span><span id="L-1697"><a href="#L-1697"><span class="linenos">1697</span></a>
</span><span id="L-1698"><a href="#L-1698"><span class="linenos">1698</span></a><span class="sd">    Args:</span>
</span><span id="L-1699"><a href="#L-1699"><span class="linenos">1699</span></a><span class="sd">      v (Vertex): Vertex at which to merge Edges. This should currently be an</span>
</span><span id="L-1700"><a href="#L-1700"><span class="linenos">1700</span></a><span class="sd">        end</span>
</span><span id="L-1701"><a href="#L-1701"><span class="linenos">1701</span></a>
</span><span id="L-1702"><a href="#L-1702"><span class="linenos">1702</span></a><span class="sd">    Returns:</span>
</span><span id="L-1703"><a href="#L-1703"><span class="linenos">1703</span></a><span class="sd">      tuple: 2 item list of the edge IDs to be removed and a new Edge object to</span>
</span><span id="L-1704"><a href="#L-1704"><span class="linenos">1704</span></a><span class="sd">        be added by the calling context (i.e. the containing Topology).</span>
</span><span id="L-1705"><a href="#L-1705"><span class="linenos">1705</span></a>
</span><span id="L-1706"><a href="#L-1706"><span class="linenos">1706</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-1707"><a href="#L-1707"><span class="linenos">1707</span></a>    <span class="n">to_remove</span><span class="p">,</span> <span class="n">new_edge</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_updated_edges_from_merge</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
</span><span id="L-1708"><a href="#L-1708"><span class="linenos">1708</span></a>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">tiles</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="L-1709"><a href="#L-1709"><span class="linenos">1709</span></a>      <span class="n">v</span><span class="o">.</span><span class="n">tiles</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">get_updated_edges_from_merge</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">new_edge</span><span class="p">)</span>
</span><span id="L-1710"><a href="#L-1710"><span class="linenos">1710</span></a>    <span class="k">return</span> <span class="n">to_remove</span><span class="p">,</span> <span class="n">new_edge</span>
</span><span id="L-1711"><a href="#L-1711"><span class="linenos">1711</span></a>
</span><span id="L-1712"><a href="#L-1712"><span class="linenos">1712</span></a>
</span><span id="L-1713"><a href="#L-1713"><span class="linenos">1713</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">get_updated_edges_from_merge</span><span class="p">(</span>
</span><span id="L-1714"><a href="#L-1714"><span class="linenos">1714</span></a>      <span class="bp">self</span><span class="p">,</span>
</span><span id="L-1715"><a href="#L-1715"><span class="linenos">1715</span></a>      <span class="n">v</span><span class="p">:</span><span class="n">Vertex</span><span class="p">,</span>
</span><span id="L-1716"><a href="#L-1716"><span class="linenos">1716</span></a>      <span class="n">new_edge</span><span class="p">:</span><span class="n">Edge</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-1717"><a href="#L-1717"><span class="linenos">1717</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="o">|</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span><span class="nb">int</span><span class="p">],</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span><span class="nb">int</span><span class="p">]],</span> <span class="n">Edge</span><span class="p">]:</span>
</span><span id="L-1718"><a href="#L-1718"><span class="linenos">1718</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Update edges and edges_CW attributes based on insertion of Vertex.</span>
</span><span id="L-1719"><a href="#L-1719"><span class="linenos">1719</span></a>
</span><span id="L-1720"><a href="#L-1720"><span class="linenos">1720</span></a><span class="sd">    If new_edge is supplied then the neighbour tile at v has already created</span>
</span><span id="L-1721"><a href="#L-1721"><span class="linenos">1721</span></a><span class="sd">    the needed new Edge and this Edge is the one that will be &#39;slotted in&#39; at</span>
</span><span id="L-1722"><a href="#L-1722"><span class="linenos">1722</span></a><span class="sd">    the appropriate spot in the edges list.</span>
</span><span id="L-1723"><a href="#L-1723"><span class="linenos">1723</span></a>
</span><span id="L-1724"><a href="#L-1724"><span class="linenos">1724</span></a><span class="sd">    The edges_CW is also updated to maintain correct directions of the edges.</span>
</span><span id="L-1725"><a href="#L-1725"><span class="linenos">1725</span></a><span class="sd">    The corners attribute is unaffected by these changes.</span>
</span><span id="L-1726"><a href="#L-1726"><span class="linenos">1726</span></a>
</span><span id="L-1727"><a href="#L-1727"><span class="linenos">1727</span></a><span class="sd">    Args:</span>
</span><span id="L-1728"><a href="#L-1728"><span class="linenos">1728</span></a><span class="sd">      v (Vertex): existing Vertex at which to carry out the merge.</span>
</span><span id="L-1729"><a href="#L-1729"><span class="linenos">1729</span></a><span class="sd">      new_edge (Edge, optional): if another Tile has already carried out this</span>
</span><span id="L-1730"><a href="#L-1730"><span class="linenos">1730</span></a><span class="sd">        merge this should be the resulting new Edge for insertion into this</span>
</span><span id="L-1731"><a href="#L-1731"><span class="linenos">1731</span></a><span class="sd">        Tile. Defaults to None (when the new Edge will be constructed).</span>
</span><span id="L-1732"><a href="#L-1732"><span class="linenos">1732</span></a>
</span><span id="L-1733"><a href="#L-1733"><span class="linenos">1733</span></a><span class="sd">    Returns:</span>
</span><span id="L-1734"><a href="#L-1734"><span class="linenos">1734</span></a><span class="sd">      None|tuple: either None (if a new edge was supplied) or a tuple</span>
</span><span id="L-1735"><a href="#L-1735"><span class="linenos">1735</span></a><span class="sd">        of the two edge IDs to be removed and the new edge added for return to</span>
</span><span id="L-1736"><a href="#L-1736"><span class="linenos">1736</span></a><span class="sd">        the calling context (i.e. the containing Topology).</span>
</span><span id="L-1737"><a href="#L-1737"><span class="linenos">1737</span></a>
</span><span id="L-1738"><a href="#L-1738"><span class="linenos">1738</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-1739"><a href="#L-1739"><span class="linenos">1739</span></a>    <span class="c1"># get the two edge list index positions in which Vertex v is found</span>
</span><span id="L-1740"><a href="#L-1740"><span class="linenos">1740</span></a>    <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_edge_IDs_including_vertex</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
</span><span id="L-1741"><a href="#L-1741"><span class="linenos">1741</span></a>    <span class="k">if</span> <span class="n">new_edge</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="c1"># then we must make a new one</span>
</span><span id="L-1742"><a href="#L-1742"><span class="linenos">1742</span></a>      <span class="c1"># also record existing edge IDs to be removed</span>
</span><span id="L-1743"><a href="#L-1743"><span class="linenos">1743</span></a>      <span class="n">to_remove</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">ID</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">ID</span><span class="p">]</span>
</span><span id="L-1744"><a href="#L-1744"><span class="linenos">1744</span></a>      <span class="n">new_edge</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_merged_edge</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span>
</span><span id="L-1745"><a href="#L-1745"><span class="linenos">1745</span></a>      <span class="n">return_edge_updates</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="L-1746"><a href="#L-1746"><span class="linenos">1746</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="L-1747"><a href="#L-1747"><span class="linenos">1747</span></a>      <span class="n">return_edge_updates</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-1748"><a href="#L-1748"><span class="linenos">1748</span></a>    <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">i</span> <span class="o">-</span> <span class="n">j</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="L-1749"><a href="#L-1749"><span class="linenos">1749</span></a>      <span class="c1"># edge indices &#39;wrap&#39; around from end of edge list to start so drop</span>
</span><span id="L-1750"><a href="#L-1750"><span class="linenos">1750</span></a>      <span class="c1"># first and last current edges and stick new one on at the end</span>
</span><span id="L-1751"><a href="#L-1751"><span class="linenos">1751</span></a>      <span class="bp">self</span><span class="o">.</span><span class="n">edges</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="n">new_edge</span><span class="p">]</span>
</span><span id="L-1752"><a href="#L-1752"><span class="linenos">1752</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="L-1753"><a href="#L-1753"><span class="linenos">1753</span></a>      <span class="c1"># insert new edge into list in place of the two old ones</span>
</span><span id="L-1754"><a href="#L-1754"><span class="linenos">1754</span></a>      <span class="bp">self</span><span class="o">.</span><span class="n">edges</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">[:</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="n">new_edge</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">:]</span>
</span><span id="L-1755"><a href="#L-1755"><span class="linenos">1755</span></a>    <span class="c1"># update the edge directions</span>
</span><span id="L-1756"><a href="#L-1756"><span class="linenos">1756</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">set_edge_directions</span><span class="p">()</span>
</span><span id="L-1757"><a href="#L-1757"><span class="linenos">1757</span></a>    <span class="k">if</span> <span class="n">return_edge_updates</span><span class="p">:</span>
</span><span id="L-1758"><a href="#L-1758"><span class="linenos">1758</span></a>      <span class="k">return</span> <span class="n">to_remove</span><span class="p">,</span> <span class="n">new_edge</span>
</span><span id="L-1759"><a href="#L-1759"><span class="linenos">1759</span></a>    <span class="k">return</span> <span class="kc">None</span>
</span><span id="L-1760"><a href="#L-1760"><span class="linenos">1760</span></a>
</span><span id="L-1761"><a href="#L-1761"><span class="linenos">1761</span></a>
</span><span id="L-1762"><a href="#L-1762"><span class="linenos">1762</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">get_edge_IDs_including_vertex</span><span class="p">(</span>
</span><span id="L-1763"><a href="#L-1763"><span class="linenos">1763</span></a>      <span class="bp">self</span><span class="p">,</span>
</span><span id="L-1764"><a href="#L-1764"><span class="linenos">1764</span></a>      <span class="n">v</span><span class="p">:</span><span class="n">Vertex</span><span class="p">,</span>
</span><span id="L-1765"><a href="#L-1765"><span class="linenos">1765</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
</span><span id="L-1766"><a href="#L-1766"><span class="linenos">1766</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the (two) index positions of the edges that include supplied Vertex.</span>
</span><span id="L-1767"><a href="#L-1767"><span class="linenos">1767</span></a>
</span><span id="L-1768"><a href="#L-1768"><span class="linenos">1768</span></a><span class="sd">    Args:</span>
</span><span id="L-1769"><a href="#L-1769"><span class="linenos">1769</span></a><span class="sd">        v (Vertex): Vertex of interest.</span>
</span><span id="L-1770"><a href="#L-1770"><span class="linenos">1770</span></a>
</span><span id="L-1771"><a href="#L-1771"><span class="linenos">1771</span></a><span class="sd">    Returns:</span>
</span><span id="L-1772"><a href="#L-1772"><span class="linenos">1772</span></a><span class="sd">      tuple[int]: two index positions of Edges in edges list that contain v.</span>
</span><span id="L-1773"><a href="#L-1773"><span class="linenos">1773</span></a>
</span><span id="L-1774"><a href="#L-1774"><span class="linenos">1774</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-1775"><a href="#L-1775"><span class="linenos">1775</span></a>    <span class="k">return</span> <span class="p">(</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">e</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">)</span> <span class="k">if</span> <span class="n">v</span><span class="o">.</span><span class="n">ID</span> <span class="ow">in</span> <span class="n">e</span><span class="o">.</span><span class="n">ID</span><span class="p">)</span>
</span><span id="L-1776"><a href="#L-1776"><span class="linenos">1776</span></a>
</span><span id="L-1777"><a href="#L-1777"><span class="linenos">1777</span></a>
</span><span id="L-1778"><a href="#L-1778"><span class="linenos">1778</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">get_merged_edge</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">:</span><span class="nb">int</span><span class="p">,</span> <span class="n">j</span><span class="p">:</span><span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Edge</span><span class="p">:</span>
</span><span id="L-1779"><a href="#L-1779"><span class="linenos">1779</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return edge made by merging existing edges at i and j in the edges list.</span>
</span><span id="L-1780"><a href="#L-1780"><span class="linenos">1780</span></a>
</span><span id="L-1781"><a href="#L-1781"><span class="linenos">1781</span></a><span class="sd">    For example, if the current list of edge IDs was</span>
</span><span id="L-1782"><a href="#L-1782"><span class="linenos">1782</span></a>
</span><span id="L-1783"><a href="#L-1783"><span class="linenos">1783</span></a><span class="sd">        (0 1 2) (4 2) (4 5) (5 0)</span>
</span><span id="L-1784"><a href="#L-1784"><span class="linenos">1784</span></a>
</span><span id="L-1785"><a href="#L-1785"><span class="linenos">1785</span></a><span class="sd">    and the merge requested is 0 and 1, the resulting new edge is constructed</span>
</span><span id="L-1786"><a href="#L-1786"><span class="linenos">1786</span></a><span class="sd">    from vertices (0 1 2 4).</span>
</span><span id="L-1787"><a href="#L-1787"><span class="linenos">1787</span></a>
</span><span id="L-1788"><a href="#L-1788"><span class="linenos">1788</span></a><span class="sd">    Returns:</span>
</span><span id="L-1789"><a href="#L-1789"><span class="linenos">1789</span></a><span class="sd">      Edge: the requested new Edge.</span>
</span><span id="L-1790"><a href="#L-1790"><span class="linenos">1790</span></a>
</span><span id="L-1791"><a href="#L-1791"><span class="linenos">1791</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-1792"><a href="#L-1792"><span class="linenos">1792</span></a>    <span class="c1"># if i and j are not consecutive, then j is predecessor edge</span>
</span><span id="L-1793"><a href="#L-1793"><span class="linenos">1793</span></a>    <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">i</span> <span class="o">-</span> <span class="n">j</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="L-1794"><a href="#L-1794"><span class="linenos">1794</span></a>      <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="n">j</span><span class="p">,</span> <span class="n">i</span>
</span><span id="L-1795"><a href="#L-1795"><span class="linenos">1795</span></a>    <span class="c1"># get edges and their directions</span>
</span><span id="L-1796"><a href="#L-1796"><span class="linenos">1796</span></a>    <span class="n">ei</span><span class="p">,</span> <span class="n">ej</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
</span><span id="L-1797"><a href="#L-1797"><span class="linenos">1797</span></a>    <span class="n">CWi</span><span class="p">,</span> <span class="n">CWj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges_CW</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges_CW</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
</span><span id="L-1798"><a href="#L-1798"><span class="linenos">1798</span></a>    <span class="c1"># DON&#39;T MESS WITH THIS!!!</span>
</span><span id="L-1799"><a href="#L-1799"><span class="linenos">1799</span></a>    <span class="c1"># for predecessors (the head) we want everything including the Vertex</span>
</span><span id="L-1800"><a href="#L-1800"><span class="linenos">1800</span></a>    <span class="c1"># where the merge is occurring; for successors (the tail) we want all but</span>
</span><span id="L-1801"><a href="#L-1801"><span class="linenos">1801</span></a>    <span class="c1"># the first Vertex (which is the one where the merge is occurring). In both</span>
</span><span id="L-1802"><a href="#L-1802"><span class="linenos">1802</span></a>    <span class="c1"># cases contingent on whether existing Edges are CW or CCW we may need to</span>
</span><span id="L-1803"><a href="#L-1803"><span class="linenos">1803</span></a>    <span class="c1"># flip the Vertex sequence to ensure that the merge Vertex is in the middle</span>
</span><span id="L-1804"><a href="#L-1804"><span class="linenos">1804</span></a>    <span class="c1"># of the new edge that will be created</span>
</span><span id="L-1805"><a href="#L-1805"><span class="linenos">1805</span></a>    <span class="n">head</span> <span class="o">=</span> <span class="n">ei</span><span class="o">.</span><span class="n">corners</span> <span class="k">if</span> <span class="n">CWi</span> <span class="k">else</span> <span class="n">ei</span><span class="o">.</span><span class="n">corners</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-1806"><a href="#L-1806"><span class="linenos">1806</span></a>    <span class="n">tail</span> <span class="o">=</span> <span class="n">ej</span><span class="o">.</span><span class="n">corners</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="k">if</span> <span class="n">CWj</span> <span class="k">else</span> <span class="n">ej</span><span class="o">.</span><span class="n">corners</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">:]</span>
</span><span id="L-1807"><a href="#L-1807"><span class="linenos">1807</span></a>    <span class="n">v_sequence</span> <span class="o">=</span> <span class="p">(</span><span class="n">head</span> <span class="k">if</span> <span class="n">CWi</span> <span class="k">else</span> <span class="n">head</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="p">(</span><span class="n">tail</span> <span class="k">if</span> <span class="n">CWj</span> <span class="k">else</span> <span class="n">tail</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</span><span id="L-1808"><a href="#L-1808"><span class="linenos">1808</span></a>    <span class="k">return</span> <span class="n">Edge</span><span class="p">(</span><span class="n">v_sequence</span><span class="p">)</span>
</span><span id="L-1809"><a href="#L-1809"><span class="linenos">1809</span></a>
</span><span id="L-1810"><a href="#L-1810"><span class="linenos">1810</span></a>
</span><span id="L-1811"><a href="#L-1811"><span class="linenos">1811</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">offset_corners</span><span class="p">(</span>
</span><span id="L-1812"><a href="#L-1812"><span class="linenos">1812</span></a>      <span class="bp">self</span><span class="p">,</span>
</span><span id="L-1813"><a href="#L-1813"><span class="linenos">1813</span></a>      <span class="n">offset</span><span class="p">:</span><span class="nb">int</span><span class="p">,</span>
</span><span id="L-1814"><a href="#L-1814"><span class="linenos">1814</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-1815"><a href="#L-1815"><span class="linenos">1815</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Shift shape, corners, edges, and edges_CW by an offset amount.</span>
</span><span id="L-1816"><a href="#L-1816"><span class="linenos">1816</span></a>
</span><span id="L-1817"><a href="#L-1817"><span class="linenos">1817</span></a><span class="sd">    This is used to align tiles that are similar, which is required for correct</span>
</span><span id="L-1818"><a href="#L-1818"><span class="linenos">1818</span></a><span class="sd">    transfer of &#39;base&#39; tile labelling on to &#39;radius 1&#39; tiles during Topology</span>
</span><span id="L-1819"><a href="#L-1819"><span class="linenos">1819</span></a><span class="sd">    construction.</span>
</span><span id="L-1820"><a href="#L-1820"><span class="linenos">1820</span></a>
</span><span id="L-1821"><a href="#L-1821"><span class="linenos">1821</span></a><span class="sd">    Args:</span>
</span><span id="L-1822"><a href="#L-1822"><span class="linenos">1822</span></a><span class="sd">      offset (int): the number of positions to shift the lists.</span>
</span><span id="L-1823"><a href="#L-1823"><span class="linenos">1823</span></a>
</span><span id="L-1824"><a href="#L-1824"><span class="linenos">1824</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-1825"><a href="#L-1825"><span class="linenos">1825</span></a>    <span class="k">if</span> <span class="n">offset</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">offset</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-1826"><a href="#L-1826"><span class="linenos">1826</span></a>      <span class="bp">self</span><span class="o">.</span><span class="n">corners</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">corners</span><span class="p">[</span><span class="n">offset</span><span class="p">:]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">corners</span><span class="p">[:</span><span class="n">offset</span><span class="p">]</span>
</span><span id="L-1827"><a href="#L-1827"><span class="linenos">1827</span></a>      <span class="bp">self</span><span class="o">.</span><span class="n">shape</span> <span class="o">=</span> <span class="n">geom</span><span class="o">.</span><span class="n">Polygon</span><span class="p">([</span><span class="n">c</span><span class="o">.</span><span class="n">point</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">corners</span><span class="p">])</span>
</span><span id="L-1828"><a href="#L-1828"><span class="linenos">1828</span></a>      <span class="bp">self</span><span class="o">.</span><span class="n">edges</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">offset</span><span class="p">:]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">[:</span><span class="n">offset</span><span class="p">]</span>
</span><span id="L-1829"><a href="#L-1829"><span class="linenos">1829</span></a>      <span class="bp">self</span><span class="o">.</span><span class="n">edges_CW</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges_CW</span><span class="p">[</span><span class="n">offset</span><span class="p">:]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges_CW</span><span class="p">[:</span><span class="n">offset</span><span class="p">]</span>
</span><span id="L-1830"><a href="#L-1830"><span class="linenos">1830</span></a>
</span><span id="L-1831"><a href="#L-1831"><span class="linenos">1831</span></a>
</span><span id="L-1832"><a href="#L-1832"><span class="linenos">1832</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">get_edge_label</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">e</span><span class="p">:</span><span class="n">Edge</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="L-1833"><a href="#L-1833"><span class="linenos">1833</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return edge label of specified edge.</span>
</span><span id="L-1834"><a href="#L-1834"><span class="linenos">1834</span></a>
</span><span id="L-1835"><a href="#L-1835"><span class="linenos">1835</span></a><span class="sd">    Args:</span>
</span><span id="L-1836"><a href="#L-1836"><span class="linenos">1836</span></a><span class="sd">        e (Edge): Edge whose label is required.</span>
</span><span id="L-1837"><a href="#L-1837"><span class="linenos">1837</span></a>
</span><span id="L-1838"><a href="#L-1838"><span class="linenos">1838</span></a><span class="sd">    Returns:</span>
</span><span id="L-1839"><a href="#L-1839"><span class="linenos">1839</span></a><span class="sd">        str: requested edge label.</span>
</span><span id="L-1840"><a href="#L-1840"><span class="linenos">1840</span></a>
</span><span id="L-1841"><a href="#L-1841"><span class="linenos">1841</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-1842"><a href="#L-1842"><span class="linenos">1842</span></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">edge_labels</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">get_edge_IDs</span><span class="p">()</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">ID</span><span class="p">)]</span>
</span><span id="L-1843"><a href="#L-1843"><span class="linenos">1843</span></a>
</span><span id="L-1844"><a href="#L-1844"><span class="linenos">1844</span></a>
</span><span id="L-1845"><a href="#L-1845"><span class="linenos">1845</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">get_corner_label</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">v</span><span class="p">:</span><span class="n">Vertex</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="L-1846"><a href="#L-1846"><span class="linenos">1846</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return corner label of specified corner.</span>
</span><span id="L-1847"><a href="#L-1847"><span class="linenos">1847</span></a>
</span><span id="L-1848"><a href="#L-1848"><span class="linenos">1848</span></a><span class="sd">    Args:</span>
</span><span id="L-1849"><a href="#L-1849"><span class="linenos">1849</span></a><span class="sd">        v (Vertex): corner whose label is required.</span>
</span><span id="L-1850"><a href="#L-1850"><span class="linenos">1850</span></a>
</span><span id="L-1851"><a href="#L-1851"><span class="linenos">1851</span></a><span class="sd">    Returns:</span>
</span><span id="L-1852"><a href="#L-1852"><span class="linenos">1852</span></a><span class="sd">        str: requested corner label.</span>
</span><span id="L-1853"><a href="#L-1853"><span class="linenos">1853</span></a>
</span><span id="L-1854"><a href="#L-1854"><span class="linenos">1854</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-1855"><a href="#L-1855"><span class="linenos">1855</span></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">edge_labels</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">get_corner_IDs</span><span class="p">()</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">ID</span><span class="p">)]</span>
</span><span id="L-1856"><a href="#L-1856"><span class="linenos">1856</span></a>
</span><span id="L-1857"><a href="#L-1857"><span class="linenos">1857</span></a>
</span><span id="L-1858"><a href="#L-1858"><span class="linenos">1858</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">angle_at</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">v</span><span class="p">:</span><span class="n">Vertex</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="L-1859"><a href="#L-1859"><span class="linenos">1859</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return interior angle at the specified corner (in degrees).</span>
</span><span id="L-1860"><a href="#L-1860"><span class="linenos">1860</span></a>
</span><span id="L-1861"><a href="#L-1861"><span class="linenos">1861</span></a><span class="sd">    Args:</span>
</span><span id="L-1862"><a href="#L-1862"><span class="linenos">1862</span></a><span class="sd">        v (Vertex): corner where angle is requested.</span>
</span><span id="L-1863"><a href="#L-1863"><span class="linenos">1863</span></a>
</span><span id="L-1864"><a href="#L-1864"><span class="linenos">1864</span></a><span class="sd">    Returns:</span>
</span><span id="L-1865"><a href="#L-1865"><span class="linenos">1865</span></a><span class="sd">        float: angle at corner v in degrees.</span>
</span><span id="L-1866"><a href="#L-1866"><span class="linenos">1866</span></a>
</span><span id="L-1867"><a href="#L-1867"><span class="linenos">1867</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-1868"><a href="#L-1868"><span class="linenos">1868</span></a>    <span class="n">i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">corners</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
</span><span id="L-1869"><a href="#L-1869"><span class="linenos">1869</span></a>    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">corners</span><span class="p">)</span>
</span><span id="L-1870"><a href="#L-1870"><span class="linenos">1870</span></a>    <span class="k">return</span> <span class="n">tiling_utils</span><span class="o">.</span><span class="n">get_inner_angle</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">corners</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">point</span><span class="p">,</span>
</span><span id="L-1871"><a href="#L-1871"><span class="linenos">1871</span></a>                                        <span class="bp">self</span><span class="o">.</span><span class="n">corners</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">point</span><span class="p">,</span>
</span><span id="L-1872"><a href="#L-1872"><span class="linenos">1872</span></a>                                        <span class="bp">self</span><span class="o">.</span><span class="n">corners</span><span class="p">[(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="n">n</span><span class="p">]</span><span class="o">.</span><span class="n">point</span><span class="p">)</span>
</span><span id="L-1873"><a href="#L-1873"><span class="linenos">1873</span></a>
</span><span id="L-1874"><a href="#L-1874"><span class="linenos">1874</span></a>
</span><span id="L-1875"><a href="#L-1875"><span class="linenos">1875</span></a><span class="k">class</span><span class="w"> </span><span class="nc">Vertex</span><span class="p">:</span>
</span><span id="L-1876"><a href="#L-1876"><span class="linenos">1876</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;Class to store attributes of a vertex in a tiling.&quot;&quot;&quot;</span>
</span><span id="L-1877"><a href="#L-1877"><span class="linenos">1877</span></a>
</span><span id="L-1878"><a href="#L-1878"><span class="linenos">1878</span></a>  <span class="n">point</span><span class="p">:</span> <span class="n">geom</span><span class="o">.</span><span class="n">Point</span>
</span><span id="L-1879"><a href="#L-1879"><span class="linenos">1879</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;point (geom.Point): point location of the vertex.&quot;&quot;&quot;</span>
</span><span id="L-1880"><a href="#L-1880"><span class="linenos">1880</span></a>  <span class="n">ID</span><span class="p">:</span> <span class="nb">int</span>
</span><span id="L-1881"><a href="#L-1881"><span class="linenos">1881</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;integer (mostly but not necessarily in sequence) of vertex keyed into the</span>
</span><span id="L-1882"><a href="#L-1882"><span class="linenos">1882</span></a><span class="sd">  points dictionary of the containing Topology.&quot;&quot;&quot;</span>
</span><span id="L-1883"><a href="#L-1883"><span class="linenos">1883</span></a>  <span class="n">tiles</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Tile</span><span class="p">]</span>
</span><span id="L-1884"><a href="#L-1884"><span class="linenos">1884</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;list of Tiles incident on this vertex.&quot;&quot;&quot;</span>
</span><span id="L-1885"><a href="#L-1885"><span class="linenos">1885</span></a>  <span class="n">neighbours</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span>
</span><span id="L-1886"><a href="#L-1886"><span class="linenos">1886</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;list of the immediately adjacent other corner IDs. Only required to</span>
</span><span id="L-1887"><a href="#L-1887"><span class="linenos">1887</span></a><span class="sd">  determine if a point is a tiling vertex (when it will have) three or more</span>
</span><span id="L-1888"><a href="#L-1888"><span class="linenos">1888</span></a><span class="sd">  neighbours, so only IDs are stored.&quot;&quot;&quot;</span>
</span><span id="L-1889"><a href="#L-1889"><span class="linenos">1889</span></a>  <span class="n">base_ID</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1_000_000</span>
</span><span id="L-1890"><a href="#L-1890"><span class="linenos">1890</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;ID of corresponding Vertex in the tileable base_unit&quot;&quot;&quot;</span>
</span><span id="L-1891"><a href="#L-1891"><span class="linenos">1891</span></a>  <span class="n">transitivity_class</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-1892"><a href="#L-1892"><span class="linenos">1892</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;transitivity class of the vertex under symmetries of the tiling&quot;&quot;&quot;</span>
</span><span id="L-1893"><a href="#L-1893"><span class="linenos">1893</span></a>  <span class="n">label</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="L-1894"><a href="#L-1894"><span class="linenos">1894</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;the (upper case letter) label of the vertex under the symmetries of the</span>
</span><span id="L-1895"><a href="#L-1895"><span class="linenos">1895</span></a><span class="sd">  tiling.&quot;&quot;&quot;</span>
</span><span id="L-1896"><a href="#L-1896"><span class="linenos">1896</span></a>  <span class="n">is_tiling_vertex</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="L-1897"><a href="#L-1897"><span class="linenos">1897</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;is_tiling_vertex (bool): True if this is a tiling vertex, rather than a</span>
</span><span id="L-1898"><a href="#L-1898"><span class="linenos">1898</span></a><span class="sd">  tile corner. E.g., A below is a corner, not a tiling vertex. B is a tiling</span>
</span><span id="L-1899"><a href="#L-1899"><span class="linenos">1899</span></a><span class="sd">  vertex:</span>
</span><span id="L-1900"><a href="#L-1900"><span class="linenos">1900</span></a>
</span><span id="L-1901"><a href="#L-1901"><span class="linenos">1901</span></a><span class="sd">      +-------+</span>
</span><span id="L-1902"><a href="#L-1902"><span class="linenos">1902</span></a><span class="sd">      | 1     |</span>
</span><span id="L-1903"><a href="#L-1903"><span class="linenos">1903</span></a><span class="sd">      |   A---B---+</span>
</span><span id="L-1904"><a href="#L-1904"><span class="linenos">1904</span></a><span class="sd">      |   | 2     |</span>
</span><span id="L-1905"><a href="#L-1905"><span class="linenos">1905</span></a><span class="sd">      +---C   +---+</span>
</span><span id="L-1906"><a href="#L-1906"><span class="linenos">1906</span></a><span class="sd">          |   |</span>
</span><span id="L-1907"><a href="#L-1907"><span class="linenos">1907</span></a><span class="sd">          +---+&quot;&quot;&quot;</span>
</span><span id="L-1908"><a href="#L-1908"><span class="linenos">1908</span></a>
</span><span id="L-1909"><a href="#L-1909"><span class="linenos">1909</span></a>
</span><span id="L-1910"><a href="#L-1910"><span class="linenos">1910</span></a>  <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="L-1911"><a href="#L-1911"><span class="linenos">1911</span></a>      <span class="bp">self</span><span class="p">,</span>
</span><span id="L-1912"><a href="#L-1912"><span class="linenos">1912</span></a>      <span class="n">point</span><span class="p">:</span><span class="n">geom</span><span class="o">.</span><span class="n">Point</span><span class="p">,</span>
</span><span id="L-1913"><a href="#L-1913"><span class="linenos">1913</span></a>      <span class="n">ID</span><span class="p">:</span><span class="nb">int</span><span class="p">,</span>
</span><span id="L-1914"><a href="#L-1914"><span class="linenos">1914</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-1915"><a href="#L-1915"><span class="linenos">1915</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Class constructor.</span>
</span><span id="L-1916"><a href="#L-1916"><span class="linenos">1916</span></a>
</span><span id="L-1917"><a href="#L-1917"><span class="linenos">1917</span></a><span class="sd">    Args:</span>
</span><span id="L-1918"><a href="#L-1918"><span class="linenos">1918</span></a><span class="sd">      point (geom.Point): point location of the vertex.</span>
</span><span id="L-1919"><a href="#L-1919"><span class="linenos">1919</span></a><span class="sd">      ID (int): a unique integer ID (which will be its key in the containing</span>
</span><span id="L-1920"><a href="#L-1920"><span class="linenos">1920</span></a><span class="sd">        Topology points dictionary).</span>
</span><span id="L-1921"><a href="#L-1921"><span class="linenos">1921</span></a>
</span><span id="L-1922"><a href="#L-1922"><span class="linenos">1922</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-1923"><a href="#L-1923"><span class="linenos">1923</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">point</span> <span class="o">=</span> <span class="n">point</span>
</span><span id="L-1924"><a href="#L-1924"><span class="linenos">1924</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">ID</span> <span class="o">=</span> <span class="n">ID</span>
</span><span id="L-1925"><a href="#L-1925"><span class="linenos">1925</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">base_ID</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ID</span>
</span><span id="L-1926"><a href="#L-1926"><span class="linenos">1926</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">tiles</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-1927"><a href="#L-1927"><span class="linenos">1927</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">neighbours</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-1928"><a href="#L-1928"><span class="linenos">1928</span></a>
</span><span id="L-1929"><a href="#L-1929"><span class="linenos">1929</span></a>
</span><span id="L-1930"><a href="#L-1930"><span class="linenos">1930</span></a>  <span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="L-1931"><a href="#L-1931"><span class="linenos">1931</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return string representation of Vertex.</span>
</span><span id="L-1932"><a href="#L-1932"><span class="linenos">1932</span></a>
</span><span id="L-1933"><a href="#L-1933"><span class="linenos">1933</span></a><span class="sd">    Returns:</span>
</span><span id="L-1934"><a href="#L-1934"><span class="linenos">1934</span></a><span class="sd">        str: string including ID, point and list of incident Tiles.</span>
</span><span id="L-1935"><a href="#L-1935"><span class="linenos">1935</span></a>
</span><span id="L-1936"><a href="#L-1936"><span class="linenos">1936</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-1937"><a href="#L-1937"><span class="linenos">1937</span></a>    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;Vertex </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">ID</span><span class="si">}</span><span class="s2"> at </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">point</span><span class="si">}</span><span class="s2"> Tiles: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">get_tile_IDs</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="L-1938"><a href="#L-1938"><span class="linenos">1938</span></a>
</span><span id="L-1939"><a href="#L-1939"><span class="linenos">1939</span></a>
</span><span id="L-1940"><a href="#L-1940"><span class="linenos">1940</span></a>  <span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="L-1941"><a href="#L-1941"><span class="linenos">1941</span></a>    <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="L-1942"><a href="#L-1942"><span class="linenos">1942</span></a>
</span><span id="L-1943"><a href="#L-1943"><span class="linenos">1943</span></a>
</span><span id="L-1944"><a href="#L-1944"><span class="linenos">1944</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">get_tile_IDs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
</span><span id="L-1945"><a href="#L-1945"><span class="linenos">1945</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return list of Tile IDs (not the Tiles themselves).</span>
</span><span id="L-1946"><a href="#L-1946"><span class="linenos">1946</span></a>
</span><span id="L-1947"><a href="#L-1947"><span class="linenos">1947</span></a><span class="sd">    Returns:</span>
</span><span id="L-1948"><a href="#L-1948"><span class="linenos">1948</span></a><span class="sd">        list[int]: list of Tile IDs</span>
</span><span id="L-1949"><a href="#L-1949"><span class="linenos">1949</span></a>
</span><span id="L-1950"><a href="#L-1950"><span class="linenos">1950</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-1951"><a href="#L-1951"><span class="linenos">1951</span></a>    <span class="k">return</span> <span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">ID</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tiles</span><span class="p">]</span>
</span><span id="L-1952"><a href="#L-1952"><span class="linenos">1952</span></a>
</span><span id="L-1953"><a href="#L-1953"><span class="linenos">1953</span></a>
</span><span id="L-1954"><a href="#L-1954"><span class="linenos">1954</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">add_tile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tile</span><span class="p">:</span><span class="n">Tile</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-1955"><a href="#L-1955"><span class="linenos">1955</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Add supplied Tile to the tiles list if it is not already present.</span>
</span><span id="L-1956"><a href="#L-1956"><span class="linenos">1956</span></a>
</span><span id="L-1957"><a href="#L-1957"><span class="linenos">1957</span></a><span class="sd">    Args:</span>
</span><span id="L-1958"><a href="#L-1958"><span class="linenos">1958</span></a><span class="sd">        tile (Tile): Tile to add.</span>
</span><span id="L-1959"><a href="#L-1959"><span class="linenos">1959</span></a>
</span><span id="L-1960"><a href="#L-1960"><span class="linenos">1960</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-1961"><a href="#L-1961"><span class="linenos">1961</span></a>    <span class="k">if</span> <span class="n">tile</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tiles</span><span class="p">:</span>
</span><span id="L-1962"><a href="#L-1962"><span class="linenos">1962</span></a>      <span class="bp">self</span><span class="o">.</span><span class="n">tiles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tile</span><span class="p">)</span>
</span><span id="L-1963"><a href="#L-1963"><span class="linenos">1963</span></a>
</span><span id="L-1964"><a href="#L-1964"><span class="linenos">1964</span></a>
</span><span id="L-1965"><a href="#L-1965"><span class="linenos">1965</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">add_neighbour</span><span class="p">(</span>
</span><span id="L-1966"><a href="#L-1966"><span class="linenos">1966</span></a>      <span class="bp">self</span><span class="p">,</span>
</span><span id="L-1967"><a href="#L-1967"><span class="linenos">1967</span></a>      <span class="n">vertex_id</span><span class="p">:</span><span class="nb">int</span><span class="p">,</span>
</span><span id="L-1968"><a href="#L-1968"><span class="linenos">1968</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-1969"><a href="#L-1969"><span class="linenos">1969</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Add supplied ID to the neighbours list if it is not already present.</span>
</span><span id="L-1970"><a href="#L-1970"><span class="linenos">1970</span></a>
</span><span id="L-1971"><a href="#L-1971"><span class="linenos">1971</span></a><span class="sd">    Args:</span>
</span><span id="L-1972"><a href="#L-1972"><span class="linenos">1972</span></a><span class="sd">      vertex_id (int): ID to add to the neighbours list.</span>
</span><span id="L-1973"><a href="#L-1973"><span class="linenos">1973</span></a>
</span><span id="L-1974"><a href="#L-1974"><span class="linenos">1974</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-1975"><a href="#L-1975"><span class="linenos">1975</span></a>    <span class="k">if</span> <span class="n">vertex_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">neighbours</span><span class="p">:</span>
</span><span id="L-1976"><a href="#L-1976"><span class="linenos">1976</span></a>      <span class="bp">self</span><span class="o">.</span><span class="n">neighbours</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">vertex_id</span><span class="p">)</span>
</span><span id="L-1977"><a href="#L-1977"><span class="linenos">1977</span></a>
</span><span id="L-1978"><a href="#L-1978"><span class="linenos">1978</span></a>
</span><span id="L-1979"><a href="#L-1979"><span class="linenos">1979</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">clockwise_order_incident_tiles</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-1980"><a href="#L-1980"><span class="linenos">1980</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Reorder tiles list clockwise (this is for dual tiling construction).&quot;&quot;&quot;</span>
</span><span id="L-1981"><a href="#L-1981"><span class="linenos">1981</span></a>    <span class="n">cw_order</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_order_of_pts_cw_around_centre</span><span class="p">(</span>
</span><span id="L-1982"><a href="#L-1982"><span class="linenos">1982</span></a>      <span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">centre</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tiles</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">point</span><span class="p">)</span>
</span><span id="L-1983"><a href="#L-1983"><span class="linenos">1983</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">tiles</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">tiles</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">cw_order</span><span class="p">]</span>
</span><span id="L-1984"><a href="#L-1984"><span class="linenos">1984</span></a>
</span><span id="L-1985"><a href="#L-1985"><span class="linenos">1985</span></a>
</span><span id="L-1986"><a href="#L-1986"><span class="linenos">1986</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">is_interior</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="L-1987"><a href="#L-1987"><span class="linenos">1987</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Test if vertex is completely enclosed by its incident Tiles.</span>
</span><span id="L-1988"><a href="#L-1988"><span class="linenos">1988</span></a>
</span><span id="L-1989"><a href="#L-1989"><span class="linenos">1989</span></a><span class="sd">    Based on summing the interior angles of the incident tiles at this vertex.</span>
</span><span id="L-1990"><a href="#L-1990"><span class="linenos">1990</span></a>
</span><span id="L-1991"><a href="#L-1991"><span class="linenos">1991</span></a><span class="sd">    Returns:</span>
</span><span id="L-1992"><a href="#L-1992"><span class="linenos">1992</span></a><span class="sd">        bool: True if vertex is completely enclosed by incident Tiles.</span>
</span><span id="L-1993"><a href="#L-1993"><span class="linenos">1993</span></a>
</span><span id="L-1994"><a href="#L-1994"><span class="linenos">1994</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-1995"><a href="#L-1995"><span class="linenos">1995</span></a>    <span class="k">return</span> <span class="nb">abs</span><span class="p">(</span><span class="mi">360</span> <span class="o">-</span> <span class="nb">sum</span><span class="p">([</span><span class="n">t</span><span class="o">.</span><span class="n">angle_at</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tiles</span><span class="p">]))</span> \
</span><span id="L-1996"><a href="#L-1996"><span class="linenos">1996</span></a>                     <span class="o">&lt;</span> <span class="n">tiling_utils</span><span class="o">.</span><span class="n">RESOLUTION</span>
</span><span id="L-1997"><a href="#L-1997"><span class="linenos">1997</span></a>
</span><span id="L-1998"><a href="#L-1998"><span class="linenos">1998</span></a>
</span><span id="L-1999"><a href="#L-1999"><span class="linenos">1999</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">_order_of_pts_cw_around_centre</span><span class="p">(</span>
</span><span id="L-2000"><a href="#L-2000"><span class="linenos">2000</span></a>      <span class="bp">self</span><span class="p">,</span>
</span><span id="L-2001"><a href="#L-2001"><span class="linenos">2001</span></a>      <span class="n">pts</span><span class="p">:</span><span class="nb">list</span><span class="p">[</span><span class="n">geom</span><span class="o">.</span><span class="n">Point</span><span class="p">],</span>
</span><span id="L-2002"><a href="#L-2002"><span class="linenos">2002</span></a>      <span class="n">centre</span><span class="p">:</span><span class="n">geom</span><span class="o">.</span><span class="n">Point</span><span class="p">,</span>
</span><span id="L-2003"><a href="#L-2003"><span class="linenos">2003</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
</span><span id="L-2004"><a href="#L-2004"><span class="linenos">2004</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return order of points clockwise relative to centre point.</span>
</span><span id="L-2005"><a href="#L-2005"><span class="linenos">2005</span></a>
</span><span id="L-2006"><a href="#L-2006"><span class="linenos">2006</span></a><span class="sd">    Args:</span>
</span><span id="L-2007"><a href="#L-2007"><span class="linenos">2007</span></a><span class="sd">      pts (list[geom.Point]): list of points to order.</span>
</span><span id="L-2008"><a href="#L-2008"><span class="linenos">2008</span></a><span class="sd">      centre (geom.Point): centre relative to which CW order is determined.</span>
</span><span id="L-2009"><a href="#L-2009"><span class="linenos">2009</span></a>
</span><span id="L-2010"><a href="#L-2010"><span class="linenos">2010</span></a><span class="sd">    Returns:</span>
</span><span id="L-2011"><a href="#L-2011"><span class="linenos">2011</span></a><span class="sd">      list[int]: list of indices of reordered points.</span>
</span><span id="L-2012"><a href="#L-2012"><span class="linenos">2012</span></a>
</span><span id="L-2013"><a href="#L-2013"><span class="linenos">2013</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-2014"><a href="#L-2014"><span class="linenos">2014</span></a>    <span class="n">dx</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span><span class="o">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">centre</span><span class="o">.</span><span class="n">x</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">pts</span><span class="p">]</span>
</span><span id="L-2015"><a href="#L-2015"><span class="linenos">2015</span></a>    <span class="n">dy</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span><span class="o">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">centre</span><span class="o">.</span><span class="n">y</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">pts</span><span class="p">]</span>
</span><span id="L-2016"><a href="#L-2016"><span class="linenos">2016</span></a>    <span class="n">angles</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">arctan2</span><span class="p">(</span><span class="n">dy</span><span class="p">,</span> <span class="n">dx</span><span class="p">)</span> <span class="k">for</span> <span class="n">dx</span><span class="p">,</span> <span class="n">dy</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="p">,</span> <span class="n">strict</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)]</span>
</span><span id="L-2017"><a href="#L-2017"><span class="linenos">2017</span></a>    <span class="n">d</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">angles</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">pts</span><span class="p">)),</span> <span class="n">strict</span> <span class="o">=</span> <span class="kc">True</span><span class="p">))</span>
</span><span id="L-2018"><a href="#L-2018"><span class="linenos">2018</span></a>    <span class="k">return</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">angle</span><span class="p">,</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)]</span>
</span><span id="L-2019"><a href="#L-2019"><span class="linenos">2019</span></a>
</span><span id="L-2020"><a href="#L-2020"><span class="linenos">2020</span></a>
</span><span id="L-2021"><a href="#L-2021"><span class="linenos">2021</span></a><span class="k">class</span><span class="w"> </span><span class="nc">Edge</span><span class="p">:</span>
</span><span id="L-2022"><a href="#L-2022"><span class="linenos">2022</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;Class to represent edges in a tiling (not tile sides).&quot;&quot;&quot;</span>
</span><span id="L-2023"><a href="#L-2023"><span class="linenos">2023</span></a>
</span><span id="L-2024"><a href="#L-2024"><span class="linenos">2024</span></a>  <span class="n">ID</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span>
</span><span id="L-2025"><a href="#L-2025"><span class="linenos">2025</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;IDs of the vertices at ends of the edge. Used as key in the containing</span>
</span><span id="L-2026"><a href="#L-2026"><span class="linenos">2026</span></a><span class="sd">  Topology&#39;s edges dictionary.&quot;&quot;&quot;</span>
</span><span id="L-2027"><a href="#L-2027"><span class="linenos">2027</span></a>  <span class="n">vertices</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Vertex</span><span class="p">]</span>
</span><span id="L-2028"><a href="#L-2028"><span class="linenos">2028</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;two item list of the end vertices.&quot;&quot;&quot;</span>
</span><span id="L-2029"><a href="#L-2029"><span class="linenos">2029</span></a>  <span class="n">corners</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Vertex</span><span class="p">]</span>
</span><span id="L-2030"><a href="#L-2030"><span class="linenos">2030</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;list of all the vertices in the edge (including its end vertices). In a</span>
</span><span id="L-2031"><a href="#L-2031"><span class="linenos">2031</span></a><span class="sd">  &#39;normal&#39; edge to edge tiling corners and vertices will be identical.&quot;&quot;&quot;</span>
</span><span id="L-2032"><a href="#L-2032"><span class="linenos">2032</span></a>  <span class="n">right_tile</span><span class="p">:</span> <span class="n">Tile</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-2033"><a href="#L-2033"><span class="linenos">2033</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;the tile to the right of the edge traversed from its first to its last</span>
</span><span id="L-2034"><a href="#L-2034"><span class="linenos">2034</span></a><span class="sd">  vertex. Given clockwise winding default, all edges will have a right_tile.&quot;&quot;&quot;</span>
</span><span id="L-2035"><a href="#L-2035"><span class="linenos">2035</span></a>  <span class="n">left_tile</span><span class="p">:</span> <span class="n">Tile</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-2036"><a href="#L-2036"><span class="linenos">2036</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;the tile to the left of the edge traversed from its first to its last</span>
</span><span id="L-2037"><a href="#L-2037"><span class="linenos">2037</span></a><span class="sd">  vertex. Exterior edges of the tiles in a Topology will not have a left_tile.</span>
</span><span id="L-2038"><a href="#L-2038"><span class="linenos">2038</span></a><span class="sd">  &quot;&quot;&quot;</span>
</span><span id="L-2039"><a href="#L-2039"><span class="linenos">2039</span></a>  <span class="n">base_ID</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1_000_000</span><span class="p">,</span> <span class="mi">1_000_000</span><span class="p">)</span>
</span><span id="L-2040"><a href="#L-2040"><span class="linenos">2040</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;ID of corresponding edge in the base tileable&quot;&quot;&quot;</span>
</span><span id="L-2041"><a href="#L-2041"><span class="linenos">2041</span></a>  <span class="n">transitivity_class</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-2042"><a href="#L-2042"><span class="linenos">2042</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;transitivity class of the edge under symmetries of the tiling&quot;&quot;&quot;</span>
</span><span id="L-2043"><a href="#L-2043"><span class="linenos">2043</span></a>  <span class="n">label</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="L-2044"><a href="#L-2044"><span class="linenos">2044</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;the (lower case letter) label of the edge under the symmetries of the</span>
</span><span id="L-2045"><a href="#L-2045"><span class="linenos">2045</span></a><span class="sd">  tiling.&quot;&quot;&quot;</span>
</span><span id="L-2046"><a href="#L-2046"><span class="linenos">2046</span></a>
</span><span id="L-2047"><a href="#L-2047"><span class="linenos">2047</span></a>  <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="L-2048"><a href="#L-2048"><span class="linenos">2048</span></a>      <span class="bp">self</span><span class="p">,</span>
</span><span id="L-2049"><a href="#L-2049"><span class="linenos">2049</span></a>      <span class="n">corners</span><span class="p">:</span><span class="nb">list</span><span class="p">[</span><span class="n">Vertex</span><span class="p">],</span>
</span><span id="L-2050"><a href="#L-2050"><span class="linenos">2050</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-2051"><a href="#L-2051"><span class="linenos">2051</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Class constructor.</span>
</span><span id="L-2052"><a href="#L-2052"><span class="linenos">2052</span></a>
</span><span id="L-2053"><a href="#L-2053"><span class="linenos">2053</span></a><span class="sd">    Initialises the corners and vertices lists and sets ID to (vertices[0].ID,</span>
</span><span id="L-2054"><a href="#L-2054"><span class="linenos">2054</span></a><span class="sd">    vertices[1].ID). The vertices list is all the corners with is_tiling_vertex</span>
</span><span id="L-2055"><a href="#L-2055"><span class="linenos">2055</span></a><span class="sd">    property True -- Note that during initialisation the default of this</span>
</span><span id="L-2056"><a href="#L-2056"><span class="linenos">2056</span></a><span class="sd">    property is True until after the relations between tiles and vertices have</span>
</span><span id="L-2057"><a href="#L-2057"><span class="linenos">2057</span></a><span class="sd">    been determined.</span>
</span><span id="L-2058"><a href="#L-2058"><span class="linenos">2058</span></a>
</span><span id="L-2059"><a href="#L-2059"><span class="linenos">2059</span></a><span class="sd">    Args:</span>
</span><span id="L-2060"><a href="#L-2060"><span class="linenos">2060</span></a><span class="sd">      corners (list[Vertex]): list of all corners along the edge.</span>
</span><span id="L-2061"><a href="#L-2061"><span class="linenos">2061</span></a>
</span><span id="L-2062"><a href="#L-2062"><span class="linenos">2062</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-2063"><a href="#L-2063"><span class="linenos">2063</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">corners</span> <span class="o">=</span> <span class="n">corners</span>
</span><span id="L-2064"><a href="#L-2064"><span class="linenos">2064</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">corners</span> <span class="k">if</span> <span class="n">v</span><span class="o">.</span><span class="n">is_tiling_vertex</span><span class="p">]</span>
</span><span id="L-2065"><a href="#L-2065"><span class="linenos">2065</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">ID</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">ID</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">)</span>
</span><span id="L-2066"><a href="#L-2066"><span class="linenos">2066</span></a>
</span><span id="L-2067"><a href="#L-2067"><span class="linenos">2067</span></a>
</span><span id="L-2068"><a href="#L-2068"><span class="linenos">2068</span></a>  <span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="L-2069"><a href="#L-2069"><span class="linenos">2069</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return a string representation of the Edge.</span>
</span><span id="L-2070"><a href="#L-2070"><span class="linenos">2070</span></a>
</span><span id="L-2071"><a href="#L-2071"><span class="linenos">2071</span></a><span class="sd">    Returns:</span>
</span><span id="L-2072"><a href="#L-2072"><span class="linenos">2072</span></a><span class="sd">      str: include ID and a list of corner vertex IDs.</span>
</span><span id="L-2073"><a href="#L-2073"><span class="linenos">2073</span></a>
</span><span id="L-2074"><a href="#L-2074"><span class="linenos">2074</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-2075"><a href="#L-2075"><span class="linenos">2075</span></a>    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;Edge </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">ID</span><span class="si">}</span><span class="s2"> Corners: </span><span class="si">{</span><span class="p">[</span><span class="n">c</span><span class="o">.</span><span class="n">ID</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">corners</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="L-2076"><a href="#L-2076"><span class="linenos">2076</span></a>
</span><span id="L-2077"><a href="#L-2077"><span class="linenos">2077</span></a>
</span><span id="L-2078"><a href="#L-2078"><span class="linenos">2078</span></a>  <span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="L-2079"><a href="#L-2079"><span class="linenos">2079</span></a>    <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="L-2080"><a href="#L-2080"><span class="linenos">2080</span></a>
</span><span id="L-2081"><a href="#L-2081"><span class="linenos">2081</span></a>
</span><span id="L-2082"><a href="#L-2082"><span class="linenos">2082</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">get_corner_IDs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
</span><span id="L-2083"><a href="#L-2083"><span class="linenos">2083</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the IDs of edge corners.</span>
</span><span id="L-2084"><a href="#L-2084"><span class="linenos">2084</span></a>
</span><span id="L-2085"><a href="#L-2085"><span class="linenos">2085</span></a><span class="sd">    Returns:</span>
</span><span id="L-2086"><a href="#L-2086"><span class="linenos">2086</span></a><span class="sd">      list[int]: IDs of all corners.</span>
</span><span id="L-2087"><a href="#L-2087"><span class="linenos">2087</span></a>
</span><span id="L-2088"><a href="#L-2088"><span class="linenos">2088</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-2089"><a href="#L-2089"><span class="linenos">2089</span></a>    <span class="k">return</span> <span class="p">[</span><span class="n">c</span><span class="o">.</span><span class="n">ID</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">corners</span><span class="p">]</span>
</span><span id="L-2090"><a href="#L-2090"><span class="linenos">2090</span></a>
</span><span id="L-2091"><a href="#L-2091"><span class="linenos">2091</span></a>
</span><span id="L-2092"><a href="#L-2092"><span class="linenos">2092</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">get_vertex_IDs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
</span><span id="L-2093"><a href="#L-2093"><span class="linenos">2093</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return IDs of edge vertices.</span>
</span><span id="L-2094"><a href="#L-2094"><span class="linenos">2094</span></a>
</span><span id="L-2095"><a href="#L-2095"><span class="linenos">2095</span></a><span class="sd">    Returns:</span>
</span><span id="L-2096"><a href="#L-2096"><span class="linenos">2096</span></a><span class="sd">      list[int]: list of IDs of the vertices.</span>
</span><span id="L-2097"><a href="#L-2097"><span class="linenos">2097</span></a>
</span><span id="L-2098"><a href="#L-2098"><span class="linenos">2098</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-2099"><a href="#L-2099"><span class="linenos">2099</span></a>    <span class="k">return</span> <span class="p">[</span><span class="n">v</span><span class="o">.</span><span class="n">ID</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">]</span>
</span><span id="L-2100"><a href="#L-2100"><span class="linenos">2100</span></a>
</span><span id="L-2101"><a href="#L-2101"><span class="linenos">2101</span></a>
</span><span id="L-2102"><a href="#L-2102"><span class="linenos">2102</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">insert_vertex</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">v</span><span class="p">:</span><span class="n">Vertex</span><span class="p">,</span> <span class="n">predecessor</span><span class="p">:</span><span class="n">Vertex</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Edge</span><span class="p">]:</span>
</span><span id="L-2103"><a href="#L-2103"><span class="linenos">2103</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Insert vertex after predecessor and return modified edge and new edge.</span>
</span><span id="L-2104"><a href="#L-2104"><span class="linenos">2104</span></a>
</span><span id="L-2105"><a href="#L-2105"><span class="linenos">2105</span></a><span class="sd">    If the initial edge was (say) (0 1 2 5) and the predecessor was set to 1</span>
</span><span id="L-2106"><a href="#L-2106"><span class="linenos">2106</span></a><span class="sd">    the returned edges would be (0 1 v) and (v 2 5).</span>
</span><span id="L-2107"><a href="#L-2107"><span class="linenos">2107</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-2108"><a href="#L-2108"><span class="linenos">2108</span></a>    <span class="n">i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">corners</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">predecessor</span><span class="p">)</span>
</span><span id="L-2109"><a href="#L-2109"><span class="linenos">2109</span></a>    <span class="n">new_edge</span> <span class="o">=</span> <span class="n">Edge</span><span class="p">([</span><span class="n">v</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">corners</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">):])</span>
</span><span id="L-2110"><a href="#L-2110"><span class="linenos">2110</span></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">right_tile</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-2111"><a href="#L-2111"><span class="linenos">2111</span></a>      <span class="n">new_edge</span><span class="o">.</span><span class="n">right_tile</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">right_tile</span>
</span><span id="L-2112"><a href="#L-2112"><span class="linenos">2112</span></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">left_tile</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-2113"><a href="#L-2113"><span class="linenos">2113</span></a>      <span class="n">new_edge</span><span class="o">.</span><span class="n">left_tile</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">left_tile</span>
</span><span id="L-2114"><a href="#L-2114"><span class="linenos">2114</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">corners</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">corners</span><span class="p">[:(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)]</span> <span class="o">+</span> <span class="p">[</span><span class="n">v</span><span class="p">]</span>
</span><span id="L-2115"><a href="#L-2115"><span class="linenos">2115</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">v</span><span class="p">]</span>
</span><span id="L-2116"><a href="#L-2116"><span class="linenos">2116</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">ID</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">ID</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">)</span>
</span><span id="L-2117"><a href="#L-2117"><span class="linenos">2117</span></a>    <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_edge</span><span class="p">]</span>
</span><span id="L-2118"><a href="#L-2118"><span class="linenos">2118</span></a>
</span><span id="L-2119"><a href="#L-2119"><span class="linenos">2119</span></a>
</span><span id="L-2120"><a href="#L-2120"><span class="linenos">2120</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">get_geometry</span><span class="p">(</span>
</span><span id="L-2121"><a href="#L-2121"><span class="linenos">2121</span></a>      <span class="bp">self</span><span class="p">,</span>
</span><span id="L-2122"><a href="#L-2122"><span class="linenos">2122</span></a>      <span class="n">forward</span><span class="p">:</span><span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="L-2123"><a href="#L-2123"><span class="linenos">2123</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">geom</span><span class="o">.</span><span class="n">LineString</span><span class="p">:</span>
</span><span id="L-2124"><a href="#L-2124"><span class="linenos">2124</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return geom.LineString representing geometry (including corners).</span>
</span><span id="L-2125"><a href="#L-2125"><span class="linenos">2125</span></a>
</span><span id="L-2126"><a href="#L-2126"><span class="linenos">2126</span></a><span class="sd">    Args:</span>
</span><span id="L-2127"><a href="#L-2127"><span class="linenos">2127</span></a><span class="sd">      forward (bool, optional): if True the returned LineString starts at</span>
</span><span id="L-2128"><a href="#L-2128"><span class="linenos">2128</span></a><span class="sd">        corners[0], else at corners[-1]. Defaults to True.</span>
</span><span id="L-2129"><a href="#L-2129"><span class="linenos">2129</span></a>
</span><span id="L-2130"><a href="#L-2130"><span class="linenos">2130</span></a><span class="sd">    Returns:</span>
</span><span id="L-2131"><a href="#L-2131"><span class="linenos">2131</span></a><span class="sd">      geom.LineString: the required LineString.</span>
</span><span id="L-2132"><a href="#L-2132"><span class="linenos">2132</span></a>
</span><span id="L-2133"><a href="#L-2133"><span class="linenos">2133</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-2134"><a href="#L-2134"><span class="linenos">2134</span></a>    <span class="k">if</span> <span class="n">forward</span><span class="p">:</span>
</span><span id="L-2135"><a href="#L-2135"><span class="linenos">2135</span></a>      <span class="k">return</span> <span class="n">geom</span><span class="o">.</span><span class="n">LineString</span><span class="p">([</span><span class="n">v</span><span class="o">.</span><span class="n">point</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">corners</span><span class="p">])</span>
</span><span id="L-2136"><a href="#L-2136"><span class="linenos">2136</span></a>    <span class="k">return</span> <span class="n">geom</span><span class="o">.</span><span class="n">LineString</span><span class="p">([</span><span class="n">v</span><span class="o">.</span><span class="n">point</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">corners</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]])</span>
</span><span id="L-2137"><a href="#L-2137"><span class="linenos">2137</span></a>
</span><span id="L-2138"><a href="#L-2138"><span class="linenos">2138</span></a>
</span><span id="L-2139"><a href="#L-2139"><span class="linenos">2139</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">get_topology</span><span class="p">(</span>
</span><span id="L-2140"><a href="#L-2140"><span class="linenos">2140</span></a>      <span class="bp">self</span><span class="p">,</span>
</span><span id="L-2141"><a href="#L-2141"><span class="linenos">2141</span></a>      <span class="n">forward</span><span class="p">:</span><span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="L-2142"><a href="#L-2142"><span class="linenos">2142</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">geom</span><span class="o">.</span><span class="n">LineString</span><span class="p">:</span>
</span><span id="L-2143"><a href="#L-2143"><span class="linenos">2143</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return LineString connecting vertices of this edge.</span>
</span><span id="L-2144"><a href="#L-2144"><span class="linenos">2144</span></a>
</span><span id="L-2145"><a href="#L-2145"><span class="linenos">2145</span></a><span class="sd">    Args:</span>
</span><span id="L-2146"><a href="#L-2146"><span class="linenos">2146</span></a><span class="sd">      forward (bool, optional): if True LineString starts at vertices[0],</span>
</span><span id="L-2147"><a href="#L-2147"><span class="linenos">2147</span></a><span class="sd">        else at vertices[1]. Defaults to True.</span>
</span><span id="L-2148"><a href="#L-2148"><span class="linenos">2148</span></a>
</span><span id="L-2149"><a href="#L-2149"><span class="linenos">2149</span></a><span class="sd">    Returns:</span>
</span><span id="L-2150"><a href="#L-2150"><span class="linenos">2150</span></a><span class="sd">        geom.LineString: the required LineString.</span>
</span><span id="L-2151"><a href="#L-2151"><span class="linenos">2151</span></a>
</span><span id="L-2152"><a href="#L-2152"><span class="linenos">2152</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-2153"><a href="#L-2153"><span class="linenos">2153</span></a>    <span class="k">if</span> <span class="n">forward</span><span class="p">:</span>
</span><span id="L-2154"><a href="#L-2154"><span class="linenos">2154</span></a>      <span class="k">return</span> <span class="n">geom</span><span class="o">.</span><span class="n">LineString</span><span class="p">([</span><span class="n">v</span><span class="o">.</span><span class="n">point</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">])</span>
</span><span id="L-2155"><a href="#L-2155"><span class="linenos">2155</span></a>    <span class="k">return</span> <span class="n">geom</span><span class="o">.</span><span class="n">LineString</span><span class="p">([</span><span class="n">v</span><span class="o">.</span><span class="n">point</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]])</span>
</span></pre></div>


            </section>
                <section id="LABELS">
                    <div class="attr variable">
            <span class="name">LABELS</span>        =
<input id="LABELS-view-value" class="view-value-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
            <label class="view-value-button pdoc-button" for="LABELS-view-value"></label><span class="default_value">[&#39;A&#39;, &#39;B&#39;, &#39;C&#39;, &#39;D&#39;, &#39;E&#39;, &#39;F&#39;, &#39;G&#39;, &#39;H&#39;, &#39;I&#39;, &#39;J&#39;, &#39;K&#39;, &#39;L&#39;, &#39;M&#39;, &#39;N&#39;, &#39;O&#39;, &#39;P&#39;, &#39;Q&#39;, &#39;R&#39;, &#39;S&#39;, &#39;T&#39;, &#39;U&#39;, &#39;V&#39;, &#39;W&#39;, &#39;X&#39;, &#39;Y&#39;, &#39;Z&#39;, &#39;A&#39;, &#39;B&#39;, &#39;C&#39;, &#39;D&#39;, &#39;E&#39;, &#39;F&#39;, &#39;G&#39;, &#39;H&#39;, &#39;I&#39;, &#39;J&#39;, &#39;K&#39;, &#39;L&#39;, &#39;M&#39;, &#39;N&#39;, &#39;O&#39;, &#39;P&#39;, &#39;Q&#39;, &#39;R&#39;, &#39;S&#39;, &#39;T&#39;, &#39;U&#39;, &#39;V&#39;, &#39;W&#39;, &#39;X&#39;, &#39;Y&#39;, &#39;Z&#39;, &#39;AB&#39;, &#39;AC&#39;, &#39;AD&#39;, &#39;AE&#39;, &#39;AF&#39;, &#39;AG&#39;, &#39;AH&#39;, &#39;AI&#39;, &#39;AJ&#39;, &#39;AK&#39;, &#39;AL&#39;, &#39;AM&#39;, &#39;AN&#39;, &#39;AO&#39;, &#39;AP&#39;, &#39;AQ&#39;, &#39;AR&#39;, &#39;AS&#39;, &#39;AT&#39;, &#39;AU&#39;, &#39;AV&#39;, &#39;AW&#39;, &#39;AX&#39;, &#39;AY&#39;, &#39;AZ&#39;, &#39;AA&#39;, &#39;AB&#39;, &#39;AC&#39;, &#39;AD&#39;, &#39;AE&#39;, &#39;AF&#39;, &#39;AG&#39;, &#39;AH&#39;, &#39;AI&#39;, &#39;AJ&#39;, &#39;AK&#39;, &#39;AL&#39;, &#39;AM&#39;, &#39;AN&#39;, &#39;AO&#39;, &#39;AP&#39;, &#39;AQ&#39;, &#39;AR&#39;, &#39;AS&#39;, &#39;AT&#39;, &#39;AU&#39;, &#39;AV&#39;, &#39;AW&#39;, &#39;AX&#39;, &#39;AY&#39;, &#39;AZ&#39;, &#39;BC&#39;, &#39;BD&#39;, &#39;BE&#39;, &#39;BF&#39;, &#39;BG&#39;, &#39;BH&#39;, &#39;BI&#39;, &#39;BJ&#39;, &#39;BK&#39;, &#39;BL&#39;, &#39;BM&#39;, &#39;BN&#39;, &#39;BO&#39;, &#39;BP&#39;, &#39;BQ&#39;, &#39;BR&#39;, &#39;BS&#39;, &#39;BT&#39;, &#39;BU&#39;, &#39;BV&#39;, &#39;BW&#39;, &#39;BX&#39;, &#39;BY&#39;, &#39;BZ&#39;, &#39;BA&#39;, &#39;BB&#39;, &#39;BC&#39;, &#39;BD&#39;, &#39;BE&#39;, &#39;BF&#39;, &#39;BG&#39;, &#39;BH&#39;, &#39;BI&#39;, &#39;BJ&#39;, &#39;BK&#39;, &#39;BL&#39;, &#39;BM&#39;, &#39;BN&#39;, &#39;BO&#39;, &#39;BP&#39;, &#39;BQ&#39;, &#39;BR&#39;, &#39;BS&#39;, &#39;BT&#39;, &#39;BU&#39;, &#39;BV&#39;, &#39;BW&#39;, &#39;BX&#39;, &#39;BY&#39;, &#39;BZ&#39;, &#39;CD&#39;, &#39;CE&#39;, &#39;CF&#39;, &#39;CG&#39;, &#39;CH&#39;, &#39;CI&#39;, &#39;CJ&#39;, &#39;CK&#39;, &#39;CL&#39;, &#39;CM&#39;, &#39;CN&#39;, &#39;CO&#39;, &#39;CP&#39;, &#39;CQ&#39;, &#39;CR&#39;, &#39;CS&#39;, &#39;CT&#39;, &#39;CU&#39;, &#39;CV&#39;, &#39;CW&#39;, &#39;CX&#39;, &#39;CY&#39;, &#39;CZ&#39;, &#39;CA&#39;, &#39;CB&#39;, &#39;CC&#39;, &#39;CD&#39;, &#39;CE&#39;, &#39;CF&#39;, &#39;CG&#39;, &#39;CH&#39;, &#39;CI&#39;, &#39;CJ&#39;, &#39;CK&#39;, &#39;CL&#39;, &#39;CM&#39;, &#39;CN&#39;, &#39;CO&#39;, &#39;CP&#39;, &#39;CQ&#39;, &#39;CR&#39;, &#39;CS&#39;, &#39;CT&#39;, &#39;CU&#39;, &#39;CV&#39;, &#39;CW&#39;, &#39;CX&#39;, &#39;CY&#39;, &#39;CZ&#39;, &#39;DE&#39;, &#39;DF&#39;, &#39;DG&#39;, &#39;DH&#39;, &#39;DI&#39;, &#39;DJ&#39;, &#39;DK&#39;, &#39;DL&#39;, &#39;DM&#39;, &#39;DN&#39;, &#39;DO&#39;, &#39;DP&#39;, &#39;DQ&#39;, &#39;DR&#39;, &#39;DS&#39;, &#39;DT&#39;, &#39;DU&#39;, &#39;DV&#39;, &#39;DW&#39;, &#39;DX&#39;, &#39;DY&#39;, &#39;DZ&#39;, &#39;DA&#39;, &#39;DB&#39;, &#39;DC&#39;, &#39;DD&#39;, &#39;DE&#39;, &#39;DF&#39;, &#39;DG&#39;, &#39;DH&#39;, &#39;DI&#39;, &#39;DJ&#39;, &#39;DK&#39;, &#39;DL&#39;, &#39;DM&#39;, &#39;DN&#39;, &#39;DO&#39;, &#39;DP&#39;, &#39;DQ&#39;, &#39;DR&#39;, &#39;DS&#39;, &#39;DT&#39;, &#39;DU&#39;, &#39;DV&#39;, &#39;DW&#39;, &#39;DX&#39;, &#39;DY&#39;, &#39;DZ&#39;, &#39;EF&#39;, &#39;EG&#39;, &#39;EH&#39;, &#39;EI&#39;, &#39;EJ&#39;, &#39;EK&#39;, &#39;EL&#39;, &#39;EM&#39;, &#39;EN&#39;, &#39;EO&#39;, &#39;EP&#39;, &#39;EQ&#39;, &#39;ER&#39;, &#39;ES&#39;, &#39;ET&#39;, &#39;EU&#39;, &#39;EV&#39;, &#39;EW&#39;, &#39;EX&#39;, &#39;EY&#39;, &#39;EZ&#39;, &#39;EA&#39;, &#39;EB&#39;, &#39;EC&#39;, &#39;ED&#39;, &#39;EE&#39;, &#39;EF&#39;, &#39;EG&#39;, &#39;EH&#39;, &#39;EI&#39;, &#39;EJ&#39;, &#39;EK&#39;, &#39;EL&#39;, &#39;EM&#39;, &#39;EN&#39;, &#39;EO&#39;, &#39;EP&#39;, &#39;EQ&#39;, &#39;ER&#39;, &#39;ES&#39;, &#39;ET&#39;, &#39;EU&#39;, &#39;EV&#39;, &#39;EW&#39;, &#39;EX&#39;, &#39;EY&#39;, &#39;EZ&#39;, &#39;FG&#39;, &#39;FH&#39;, &#39;FI&#39;, &#39;FJ&#39;, &#39;FK&#39;, &#39;FL&#39;, &#39;FM&#39;, &#39;FN&#39;, &#39;FO&#39;, &#39;FP&#39;, &#39;FQ&#39;, &#39;FR&#39;, &#39;FS&#39;, &#39;FT&#39;, &#39;FU&#39;, &#39;FV&#39;, &#39;FW&#39;, &#39;FX&#39;, &#39;FY&#39;, &#39;FZ&#39;, &#39;FA&#39;, &#39;FB&#39;, &#39;FC&#39;, &#39;FD&#39;, &#39;FE&#39;, &#39;FF&#39;, &#39;FG&#39;, &#39;FH&#39;, &#39;FI&#39;, &#39;FJ&#39;, &#39;FK&#39;, &#39;FL&#39;, &#39;FM&#39;, &#39;FN&#39;, &#39;FO&#39;, &#39;FP&#39;, &#39;FQ&#39;, &#39;FR&#39;, &#39;FS&#39;, &#39;FT&#39;, &#39;FU&#39;, &#39;FV&#39;, &#39;FW&#39;, &#39;FX&#39;, &#39;FY&#39;, &#39;FZ&#39;, &#39;GH&#39;, &#39;GI&#39;, &#39;GJ&#39;, &#39;GK&#39;, &#39;GL&#39;, &#39;GM&#39;, &#39;GN&#39;, &#39;GO&#39;, &#39;GP&#39;, &#39;GQ&#39;, &#39;GR&#39;, &#39;GS&#39;, &#39;GT&#39;, &#39;GU&#39;, &#39;GV&#39;, &#39;GW&#39;, &#39;GX&#39;, &#39;GY&#39;, &#39;GZ&#39;, &#39;GA&#39;, &#39;GB&#39;, &#39;GC&#39;, &#39;GD&#39;, &#39;GE&#39;, &#39;GF&#39;, &#39;GG&#39;, &#39;GH&#39;, &#39;GI&#39;, &#39;GJ&#39;, &#39;GK&#39;, &#39;GL&#39;, &#39;GM&#39;, &#39;GN&#39;, &#39;GO&#39;, &#39;GP&#39;, &#39;GQ&#39;, &#39;GR&#39;, &#39;GS&#39;, &#39;GT&#39;, &#39;GU&#39;, &#39;GV&#39;, &#39;GW&#39;, &#39;GX&#39;, &#39;GY&#39;, &#39;GZ&#39;, &#39;HI&#39;, &#39;HJ&#39;, &#39;HK&#39;, &#39;HL&#39;, &#39;HM&#39;, &#39;HN&#39;, &#39;HO&#39;, &#39;HP&#39;, &#39;HQ&#39;, &#39;HR&#39;, &#39;HS&#39;, &#39;HT&#39;, &#39;HU&#39;, &#39;HV&#39;, &#39;HW&#39;, &#39;HX&#39;, &#39;HY&#39;, &#39;HZ&#39;, &#39;HA&#39;, &#39;HB&#39;, &#39;HC&#39;, &#39;HD&#39;, &#39;HE&#39;, &#39;HF&#39;, &#39;HG&#39;, &#39;HH&#39;, &#39;HI&#39;, &#39;HJ&#39;, &#39;HK&#39;, &#39;HL&#39;, &#39;HM&#39;, &#39;HN&#39;, &#39;HO&#39;, &#39;HP&#39;, &#39;HQ&#39;, &#39;HR&#39;, &#39;HS&#39;, &#39;HT&#39;, &#39;HU&#39;, &#39;HV&#39;, &#39;HW&#39;, &#39;HX&#39;, &#39;HY&#39;, &#39;HZ&#39;, &#39;IJ&#39;, &#39;IK&#39;, &#39;IL&#39;, &#39;IM&#39;, &#39;IN&#39;, &#39;IO&#39;, &#39;IP&#39;, &#39;IQ&#39;, &#39;IR&#39;, &#39;IS&#39;, &#39;IT&#39;, &#39;IU&#39;, &#39;IV&#39;, &#39;IW&#39;, &#39;IX&#39;, &#39;IY&#39;, &#39;IZ&#39;, &#39;IA&#39;, &#39;IB&#39;, &#39;IC&#39;, &#39;ID&#39;, &#39;IE&#39;, &#39;IF&#39;, &#39;IG&#39;, &#39;IH&#39;, &#39;II&#39;, &#39;IJ&#39;, &#39;IK&#39;, &#39;IL&#39;, &#39;IM&#39;, &#39;IN&#39;, &#39;IO&#39;, &#39;IP&#39;, &#39;IQ&#39;, &#39;IR&#39;, &#39;IS&#39;, &#39;IT&#39;, &#39;IU&#39;, &#39;IV&#39;, &#39;IW&#39;, &#39;IX&#39;, &#39;IY&#39;, &#39;IZ&#39;, &#39;JK&#39;, &#39;JL&#39;, &#39;JM&#39;, &#39;JN&#39;, &#39;JO&#39;, &#39;JP&#39;, &#39;JQ&#39;, &#39;JR&#39;, &#39;JS&#39;, &#39;JT&#39;, &#39;JU&#39;, &#39;JV&#39;, &#39;JW&#39;, &#39;JX&#39;, &#39;JY&#39;, &#39;JZ&#39;, &#39;JA&#39;, &#39;JB&#39;, &#39;JC&#39;, &#39;JD&#39;, &#39;JE&#39;, &#39;JF&#39;, &#39;JG&#39;, &#39;JH&#39;, &#39;JI&#39;, &#39;JJ&#39;, &#39;JK&#39;, &#39;JL&#39;, &#39;JM&#39;, &#39;JN&#39;, &#39;JO&#39;, &#39;JP&#39;, &#39;JQ&#39;, &#39;JR&#39;, &#39;JS&#39;, &#39;JT&#39;, &#39;JU&#39;, &#39;JV&#39;, &#39;JW&#39;, &#39;JX&#39;, &#39;JY&#39;, &#39;JZ&#39;, &#39;KL&#39;, &#39;KM&#39;, &#39;KN&#39;, &#39;KO&#39;, &#39;KP&#39;, &#39;KQ&#39;, &#39;KR&#39;, &#39;KS&#39;, &#39;KT&#39;, &#39;KU&#39;, &#39;KV&#39;, &#39;KW&#39;, &#39;KX&#39;, &#39;KY&#39;, &#39;KZ&#39;, &#39;KA&#39;, &#39;KB&#39;, &#39;KC&#39;, &#39;KD&#39;, &#39;KE&#39;, &#39;KF&#39;, &#39;KG&#39;, &#39;KH&#39;, &#39;KI&#39;, &#39;KJ&#39;, &#39;KK&#39;, &#39;KL&#39;, &#39;KM&#39;, &#39;KN&#39;, &#39;KO&#39;, &#39;KP&#39;, &#39;KQ&#39;, &#39;KR&#39;, &#39;KS&#39;, &#39;KT&#39;, &#39;KU&#39;, &#39;KV&#39;, &#39;KW&#39;, &#39;KX&#39;, &#39;KY&#39;, &#39;KZ&#39;, &#39;LM&#39;, &#39;LN&#39;, &#39;LO&#39;, &#39;LP&#39;, &#39;LQ&#39;, &#39;LR&#39;, &#39;LS&#39;, &#39;LT&#39;, &#39;LU&#39;, &#39;LV&#39;, &#39;LW&#39;, &#39;LX&#39;, &#39;LY&#39;, &#39;LZ&#39;, &#39;LA&#39;, &#39;LB&#39;, &#39;LC&#39;, &#39;LD&#39;, &#39;LE&#39;, &#39;LF&#39;, &#39;LG&#39;, &#39;LH&#39;, &#39;LI&#39;, &#39;LJ&#39;, &#39;LK&#39;, &#39;LL&#39;, &#39;LM&#39;, &#39;LN&#39;, &#39;LO&#39;, &#39;LP&#39;, &#39;LQ&#39;, &#39;LR&#39;, &#39;LS&#39;, &#39;LT&#39;, &#39;LU&#39;, &#39;LV&#39;, &#39;LW&#39;, &#39;LX&#39;, &#39;LY&#39;, &#39;LZ&#39;, &#39;MN&#39;, &#39;MO&#39;, &#39;MP&#39;, &#39;MQ&#39;, &#39;MR&#39;, &#39;MS&#39;, &#39;MT&#39;, &#39;MU&#39;, &#39;MV&#39;, &#39;MW&#39;, &#39;MX&#39;, &#39;MY&#39;, &#39;MZ&#39;, &#39;MA&#39;, &#39;MB&#39;, &#39;MC&#39;, &#39;MD&#39;, &#39;ME&#39;, &#39;MF&#39;, &#39;MG&#39;, &#39;MH&#39;, &#39;MI&#39;, &#39;MJ&#39;, &#39;MK&#39;, &#39;ML&#39;, &#39;MM&#39;, &#39;MN&#39;, &#39;MO&#39;, &#39;MP&#39;, &#39;MQ&#39;, &#39;MR&#39;, &#39;MS&#39;, &#39;MT&#39;, &#39;MU&#39;, &#39;MV&#39;, &#39;MW&#39;, &#39;MX&#39;, &#39;MY&#39;, &#39;MZ&#39;, &#39;NO&#39;, &#39;NP&#39;, &#39;NQ&#39;, &#39;NR&#39;, &#39;NS&#39;, &#39;NT&#39;, &#39;NU&#39;, &#39;NV&#39;, &#39;NW&#39;, &#39;NX&#39;, &#39;NY&#39;, &#39;NZ&#39;, &#39;NA&#39;, &#39;NB&#39;, &#39;NC&#39;, &#39;ND&#39;, &#39;NE&#39;, &#39;NF&#39;, &#39;NG&#39;, &#39;NH&#39;, &#39;NI&#39;, &#39;NJ&#39;, &#39;NK&#39;, &#39;NL&#39;, &#39;NM&#39;, &#39;NN&#39;, &#39;NO&#39;, &#39;NP&#39;, &#39;NQ&#39;, &#39;NR&#39;, &#39;NS&#39;, &#39;NT&#39;, &#39;NU&#39;, &#39;NV&#39;, &#39;NW&#39;, &#39;NX&#39;, &#39;NY&#39;, &#39;NZ&#39;, &#39;OP&#39;, &#39;OQ&#39;, &#39;OR&#39;, &#39;OS&#39;, &#39;OT&#39;, &#39;OU&#39;, &#39;OV&#39;, &#39;OW&#39;, &#39;OX&#39;, &#39;OY&#39;, &#39;OZ&#39;, &#39;OA&#39;, &#39;OB&#39;, &#39;OC&#39;, &#39;OD&#39;, &#39;OE&#39;, &#39;OF&#39;, &#39;OG&#39;, &#39;OH&#39;, &#39;OI&#39;, &#39;OJ&#39;, &#39;OK&#39;, &#39;OL&#39;, &#39;OM&#39;, &#39;ON&#39;, &#39;OO&#39;, &#39;OP&#39;, &#39;OQ&#39;, &#39;OR&#39;, &#39;OS&#39;, &#39;OT&#39;, &#39;OU&#39;, &#39;OV&#39;, &#39;OW&#39;, &#39;OX&#39;, &#39;OY&#39;, &#39;OZ&#39;, &#39;PQ&#39;, &#39;PR&#39;, &#39;PS&#39;, &#39;PT&#39;, &#39;PU&#39;, &#39;PV&#39;, &#39;PW&#39;, &#39;PX&#39;, &#39;PY&#39;, &#39;PZ&#39;, &#39;PA&#39;, &#39;PB&#39;, &#39;PC&#39;, &#39;PD&#39;, &#39;PE&#39;, &#39;PF&#39;, &#39;PG&#39;, &#39;PH&#39;, &#39;PI&#39;, &#39;PJ&#39;, &#39;PK&#39;, &#39;PL&#39;, &#39;PM&#39;, &#39;PN&#39;, &#39;PO&#39;, &#39;PP&#39;, &#39;PQ&#39;, &#39;PR&#39;, &#39;PS&#39;, &#39;PT&#39;, &#39;PU&#39;, &#39;PV&#39;, &#39;PW&#39;, &#39;PX&#39;, &#39;PY&#39;, &#39;PZ&#39;, &#39;QR&#39;, &#39;QS&#39;, &#39;QT&#39;, &#39;QU&#39;, &#39;QV&#39;, &#39;QW&#39;, &#39;QX&#39;, &#39;QY&#39;, &#39;QZ&#39;, &#39;QA&#39;, &#39;QB&#39;, &#39;QC&#39;, &#39;QD&#39;, &#39;QE&#39;, &#39;QF&#39;, &#39;QG&#39;, &#39;QH&#39;, &#39;QI&#39;, &#39;QJ&#39;, &#39;QK&#39;, &#39;QL&#39;, &#39;QM&#39;, &#39;QN&#39;, &#39;QO&#39;, &#39;QP&#39;, &#39;QQ&#39;, &#39;QR&#39;, &#39;QS&#39;, &#39;QT&#39;, &#39;QU&#39;, &#39;QV&#39;, &#39;QW&#39;, &#39;QX&#39;, &#39;QY&#39;, &#39;QZ&#39;, &#39;RS&#39;, &#39;RT&#39;, &#39;RU&#39;, &#39;RV&#39;, &#39;RW&#39;, &#39;RX&#39;, &#39;RY&#39;, &#39;RZ&#39;, &#39;RA&#39;, &#39;RB&#39;, &#39;RC&#39;, &#39;RD&#39;, &#39;RE&#39;, &#39;RF&#39;, &#39;RG&#39;, &#39;RH&#39;, &#39;RI&#39;, &#39;RJ&#39;, &#39;RK&#39;, &#39;RL&#39;, &#39;RM&#39;, &#39;RN&#39;, &#39;RO&#39;, &#39;RP&#39;, &#39;RQ&#39;, &#39;RR&#39;, &#39;RS&#39;, &#39;RT&#39;, &#39;RU&#39;, &#39;RV&#39;, &#39;RW&#39;, &#39;RX&#39;, &#39;RY&#39;, &#39;RZ&#39;, &#39;ST&#39;, &#39;SU&#39;, &#39;SV&#39;, &#39;SW&#39;, &#39;SX&#39;, &#39;SY&#39;, &#39;SZ&#39;, &#39;SA&#39;, &#39;SB&#39;, &#39;SC&#39;, &#39;SD&#39;, &#39;SE&#39;, &#39;SF&#39;, &#39;SG&#39;, &#39;SH&#39;, &#39;SI&#39;, &#39;SJ&#39;, &#39;SK&#39;, &#39;SL&#39;, &#39;SM&#39;, &#39;SN&#39;, &#39;SO&#39;, &#39;SP&#39;, &#39;SQ&#39;, &#39;SR&#39;, &#39;SS&#39;, &#39;ST&#39;, &#39;SU&#39;, &#39;SV&#39;, &#39;SW&#39;, &#39;SX&#39;, &#39;SY&#39;, &#39;SZ&#39;, &#39;TU&#39;, &#39;TV&#39;, &#39;TW&#39;, &#39;TX&#39;, &#39;TY&#39;, &#39;TZ&#39;, &#39;TA&#39;, &#39;TB&#39;, &#39;TC&#39;, &#39;TD&#39;, &#39;TE&#39;, &#39;TF&#39;, &#39;TG&#39;, &#39;TH&#39;, &#39;TI&#39;, &#39;TJ&#39;, &#39;TK&#39;, &#39;TL&#39;, &#39;TM&#39;, &#39;TN&#39;, &#39;TO&#39;, &#39;TP&#39;, &#39;TQ&#39;, &#39;TR&#39;, &#39;TS&#39;, &#39;TT&#39;, &#39;TU&#39;, &#39;TV&#39;, &#39;TW&#39;, &#39;TX&#39;, &#39;TY&#39;, &#39;TZ&#39;, &#39;UV&#39;, &#39;UW&#39;, &#39;UX&#39;, &#39;UY&#39;, &#39;UZ&#39;, &#39;UA&#39;, &#39;UB&#39;, &#39;UC&#39;, &#39;UD&#39;, &#39;UE&#39;, &#39;UF&#39;, &#39;UG&#39;, &#39;UH&#39;, &#39;UI&#39;, &#39;UJ&#39;, &#39;UK&#39;, &#39;UL&#39;, &#39;UM&#39;, &#39;UN&#39;, &#39;UO&#39;, &#39;UP&#39;, &#39;UQ&#39;, &#39;UR&#39;, &#39;US&#39;, &#39;UT&#39;, &#39;UU&#39;, &#39;UV&#39;, &#39;UW&#39;, &#39;UX&#39;, &#39;UY&#39;, &#39;UZ&#39;, &#39;VW&#39;, &#39;VX&#39;, &#39;VY&#39;, &#39;VZ&#39;, &#39;VA&#39;, &#39;VB&#39;, &#39;VC&#39;, &#39;VD&#39;, &#39;VE&#39;, &#39;VF&#39;, &#39;VG&#39;, &#39;VH&#39;, &#39;VI&#39;, &#39;VJ&#39;, &#39;VK&#39;, &#39;VL&#39;, &#39;VM&#39;, &#39;VN&#39;, &#39;VO&#39;, &#39;VP&#39;, &#39;VQ&#39;, &#39;VR&#39;, &#39;VS&#39;, &#39;VT&#39;, &#39;VU&#39;, &#39;VV&#39;, &#39;VW&#39;, &#39;VX&#39;, &#39;VY&#39;, &#39;VZ&#39;, &#39;WX&#39;, &#39;WY&#39;, &#39;WZ&#39;, &#39;WA&#39;, &#39;WB&#39;, &#39;WC&#39;, &#39;WD&#39;, &#39;WE&#39;, &#39;WF&#39;, &#39;WG&#39;, &#39;WH&#39;, &#39;WI&#39;, &#39;WJ&#39;, &#39;WK&#39;, &#39;WL&#39;, &#39;WM&#39;, &#39;WN&#39;, &#39;WO&#39;, &#39;WP&#39;, &#39;WQ&#39;, &#39;WR&#39;, &#39;WS&#39;, &#39;WT&#39;, &#39;WU&#39;, &#39;WV&#39;, &#39;WW&#39;, &#39;WX&#39;, &#39;WY&#39;, &#39;WZ&#39;, &#39;XY&#39;, &#39;XZ&#39;, &#39;XA&#39;, &#39;XB&#39;, &#39;XC&#39;, &#39;XD&#39;, &#39;XE&#39;, &#39;XF&#39;, &#39;XG&#39;, &#39;XH&#39;, &#39;XI&#39;, &#39;XJ&#39;, &#39;XK&#39;, &#39;XL&#39;, &#39;XM&#39;, &#39;XN&#39;, &#39;XO&#39;, &#39;XP&#39;, &#39;XQ&#39;, &#39;XR&#39;, &#39;XS&#39;, &#39;XT&#39;, &#39;XU&#39;, &#39;XV&#39;, &#39;XW&#39;, &#39;XX&#39;, &#39;XY&#39;, &#39;XZ&#39;, &#39;YZ&#39;, &#39;YA&#39;, &#39;YB&#39;, &#39;YC&#39;, &#39;YD&#39;, &#39;YE&#39;, &#39;YF&#39;, &#39;YG&#39;, &#39;YH&#39;, &#39;YI&#39;, &#39;YJ&#39;, &#39;YK&#39;, &#39;YL&#39;, &#39;YM&#39;, &#39;YN&#39;, &#39;YO&#39;, &#39;YP&#39;, &#39;YQ&#39;, &#39;YR&#39;, &#39;YS&#39;, &#39;YT&#39;, &#39;YU&#39;, &#39;YV&#39;, &#39;YW&#39;, &#39;YX&#39;, &#39;YY&#39;, &#39;YZ&#39;, &#39;ZA&#39;, &#39;ZB&#39;, &#39;ZC&#39;, &#39;ZD&#39;, &#39;ZE&#39;, &#39;ZF&#39;, &#39;ZG&#39;, &#39;ZH&#39;, &#39;ZI&#39;, &#39;ZJ&#39;, &#39;ZK&#39;, &#39;ZL&#39;, &#39;ZM&#39;, &#39;ZN&#39;, &#39;ZO&#39;, &#39;ZP&#39;, &#39;ZQ&#39;, &#39;ZR&#39;, &#39;ZS&#39;, &#39;ZT&#39;, &#39;ZU&#39;, &#39;ZV&#39;, &#39;ZW&#39;, &#39;ZX&#39;, &#39;ZY&#39;, &#39;ZZ&#39;, &#39;AB&#39;, &#39;AC&#39;, &#39;AD&#39;, &#39;AE&#39;, &#39;AF&#39;, &#39;AG&#39;, &#39;AH&#39;, &#39;AI&#39;, &#39;AJ&#39;, &#39;AK&#39;, &#39;AL&#39;, &#39;AM&#39;, &#39;AN&#39;, &#39;AO&#39;, &#39;AP&#39;, &#39;AQ&#39;, &#39;AR&#39;, &#39;AS&#39;, &#39;AT&#39;, &#39;AU&#39;, &#39;AV&#39;, &#39;AW&#39;, &#39;AX&#39;, &#39;AY&#39;, &#39;AZ&#39;, &#39;BC&#39;, &#39;BD&#39;, &#39;BE&#39;, &#39;BF&#39;, &#39;BG&#39;, &#39;BH&#39;, &#39;BI&#39;, &#39;BJ&#39;, &#39;BK&#39;, &#39;BL&#39;, &#39;BM&#39;, &#39;BN&#39;, &#39;BO&#39;, &#39;BP&#39;, &#39;BQ&#39;, &#39;BR&#39;, &#39;BS&#39;, &#39;BT&#39;, &#39;BU&#39;, &#39;BV&#39;, &#39;BW&#39;, &#39;BX&#39;, &#39;BY&#39;, &#39;BZ&#39;, &#39;CD&#39;, &#39;CE&#39;, &#39;CF&#39;, &#39;CG&#39;, &#39;CH&#39;, &#39;CI&#39;, &#39;CJ&#39;, &#39;CK&#39;, &#39;CL&#39;, &#39;CM&#39;, &#39;CN&#39;, &#39;CO&#39;, &#39;CP&#39;, &#39;CQ&#39;, &#39;CR&#39;, &#39;CS&#39;, &#39;CT&#39;, &#39;CU&#39;, &#39;CV&#39;, &#39;CW&#39;, &#39;CX&#39;, &#39;CY&#39;, &#39;CZ&#39;, &#39;DE&#39;, &#39;DF&#39;, &#39;DG&#39;, &#39;DH&#39;, &#39;DI&#39;, &#39;DJ&#39;, &#39;DK&#39;, &#39;DL&#39;, &#39;DM&#39;, &#39;DN&#39;, &#39;DO&#39;, &#39;DP&#39;, &#39;DQ&#39;, &#39;DR&#39;, &#39;DS&#39;, &#39;DT&#39;, &#39;DU&#39;, &#39;DV&#39;, &#39;DW&#39;, &#39;DX&#39;, &#39;DY&#39;, &#39;DZ&#39;, &#39;EF&#39;, &#39;EG&#39;, &#39;EH&#39;, &#39;EI&#39;, &#39;EJ&#39;, &#39;EK&#39;, &#39;EL&#39;, &#39;EM&#39;, &#39;EN&#39;, &#39;EO&#39;, &#39;EP&#39;, &#39;EQ&#39;, &#39;ER&#39;, &#39;ES&#39;, &#39;ET&#39;, &#39;EU&#39;, &#39;EV&#39;, &#39;EW&#39;, &#39;EX&#39;, &#39;EY&#39;, &#39;EZ&#39;, &#39;FG&#39;, &#39;FH&#39;, &#39;FI&#39;, &#39;FJ&#39;, &#39;FK&#39;, &#39;FL&#39;, &#39;FM&#39;, &#39;FN&#39;, &#39;FO&#39;, &#39;FP&#39;, &#39;FQ&#39;, &#39;FR&#39;, &#39;FS&#39;, &#39;FT&#39;, &#39;FU&#39;, &#39;FV&#39;, &#39;FW&#39;, &#39;FX&#39;, &#39;FY&#39;, &#39;FZ&#39;, &#39;GH&#39;, &#39;GI&#39;, &#39;GJ&#39;, &#39;GK&#39;, &#39;GL&#39;, &#39;GM&#39;, &#39;GN&#39;, &#39;GO&#39;, &#39;GP&#39;, &#39;GQ&#39;, &#39;GR&#39;, &#39;GS&#39;, &#39;GT&#39;, &#39;GU&#39;, &#39;GV&#39;, &#39;GW&#39;, &#39;GX&#39;, &#39;GY&#39;, &#39;GZ&#39;, &#39;HI&#39;, &#39;HJ&#39;, &#39;HK&#39;, &#39;HL&#39;, &#39;HM&#39;, &#39;HN&#39;, &#39;HO&#39;, &#39;HP&#39;, &#39;HQ&#39;, &#39;HR&#39;, &#39;HS&#39;, &#39;HT&#39;, &#39;HU&#39;, &#39;HV&#39;, &#39;HW&#39;, &#39;HX&#39;, &#39;HY&#39;, &#39;HZ&#39;, &#39;IJ&#39;, &#39;IK&#39;, &#39;IL&#39;, &#39;IM&#39;, &#39;IN&#39;, &#39;IO&#39;, &#39;IP&#39;, &#39;IQ&#39;, &#39;IR&#39;, &#39;IS&#39;, &#39;IT&#39;, &#39;IU&#39;, &#39;IV&#39;, &#39;IW&#39;, &#39;IX&#39;, &#39;IY&#39;, &#39;IZ&#39;, &#39;JK&#39;, &#39;JL&#39;, &#39;JM&#39;, &#39;JN&#39;, &#39;JO&#39;, &#39;JP&#39;, &#39;JQ&#39;, &#39;JR&#39;, &#39;JS&#39;, &#39;JT&#39;, &#39;JU&#39;, &#39;JV&#39;, &#39;JW&#39;, &#39;JX&#39;, &#39;JY&#39;, &#39;JZ&#39;, &#39;KL&#39;, &#39;KM&#39;, &#39;KN&#39;, &#39;KO&#39;, &#39;KP&#39;, &#39;KQ&#39;, &#39;KR&#39;, &#39;KS&#39;, &#39;KT&#39;, &#39;KU&#39;, &#39;KV&#39;, &#39;KW&#39;, &#39;KX&#39;, &#39;KY&#39;, &#39;KZ&#39;, &#39;LM&#39;, &#39;LN&#39;, &#39;LO&#39;, &#39;LP&#39;, &#39;LQ&#39;, &#39;LR&#39;, &#39;LS&#39;, &#39;LT&#39;, &#39;LU&#39;, &#39;LV&#39;, &#39;LW&#39;, &#39;LX&#39;, &#39;LY&#39;, &#39;LZ&#39;, &#39;MN&#39;, &#39;MO&#39;, &#39;MP&#39;, &#39;MQ&#39;, &#39;MR&#39;, &#39;MS&#39;, &#39;MT&#39;, &#39;MU&#39;, &#39;MV&#39;, &#39;MW&#39;, &#39;MX&#39;, &#39;MY&#39;, &#39;MZ&#39;, &#39;NO&#39;, &#39;NP&#39;, &#39;NQ&#39;, &#39;NR&#39;, &#39;NS&#39;, &#39;NT&#39;, &#39;NU&#39;, &#39;NV&#39;, &#39;NW&#39;, &#39;NX&#39;, &#39;NY&#39;, &#39;NZ&#39;, &#39;OP&#39;, &#39;OQ&#39;, &#39;OR&#39;, &#39;OS&#39;, &#39;OT&#39;, &#39;OU&#39;, &#39;OV&#39;, &#39;OW&#39;, &#39;OX&#39;, &#39;OY&#39;, &#39;OZ&#39;, &#39;PQ&#39;, &#39;PR&#39;, &#39;PS&#39;, &#39;PT&#39;, &#39;PU&#39;, &#39;PV&#39;, &#39;PW&#39;, &#39;PX&#39;, &#39;PY&#39;, &#39;PZ&#39;, &#39;QR&#39;, &#39;QS&#39;, &#39;QT&#39;, &#39;QU&#39;, &#39;QV&#39;, &#39;QW&#39;, &#39;QX&#39;, &#39;QY&#39;, &#39;QZ&#39;, &#39;RS&#39;, &#39;RT&#39;, &#39;RU&#39;, &#39;RV&#39;, &#39;RW&#39;, &#39;RX&#39;, &#39;RY&#39;, &#39;RZ&#39;, &#39;ST&#39;, &#39;SU&#39;, &#39;SV&#39;, &#39;SW&#39;, &#39;SX&#39;, &#39;SY&#39;, &#39;SZ&#39;, &#39;TU&#39;, &#39;TV&#39;, &#39;TW&#39;, &#39;TX&#39;, &#39;TY&#39;, &#39;TZ&#39;, &#39;UV&#39;, &#39;UW&#39;, &#39;UX&#39;, &#39;UY&#39;, &#39;UZ&#39;, &#39;VW&#39;, &#39;VX&#39;, &#39;VY&#39;, &#39;VZ&#39;, &#39;WX&#39;, &#39;WY&#39;, &#39;WZ&#39;, &#39;XY&#39;, &#39;XZ&#39;, &#39;YZ&#39;]</span>

        
    </div>
    <a class="headerlink" href="#LABELS"></a>
    
    

                </section>
                <section id="labels">
                    <div class="attr variable">
            <span class="name">labels</span>        =
<input id="labels-view-value" class="view-value-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
            <label class="view-value-button pdoc-button" for="labels-view-value"></label><span class="default_value">[&#39;a&#39;, &#39;b&#39;, &#39;c&#39;, &#39;d&#39;, &#39;e&#39;, &#39;f&#39;, &#39;g&#39;, &#39;h&#39;, &#39;i&#39;, &#39;j&#39;, &#39;k&#39;, &#39;l&#39;, &#39;m&#39;, &#39;n&#39;, &#39;o&#39;, &#39;p&#39;, &#39;q&#39;, &#39;r&#39;, &#39;s&#39;, &#39;t&#39;, &#39;u&#39;, &#39;v&#39;, &#39;w&#39;, &#39;x&#39;, &#39;y&#39;, &#39;z&#39;, &#39;a&#39;, &#39;b&#39;, &#39;c&#39;, &#39;d&#39;, &#39;e&#39;, &#39;f&#39;, &#39;g&#39;, &#39;h&#39;, &#39;i&#39;, &#39;j&#39;, &#39;k&#39;, &#39;l&#39;, &#39;m&#39;, &#39;n&#39;, &#39;o&#39;, &#39;p&#39;, &#39;q&#39;, &#39;r&#39;, &#39;s&#39;, &#39;t&#39;, &#39;u&#39;, &#39;v&#39;, &#39;w&#39;, &#39;x&#39;, &#39;y&#39;, &#39;z&#39;, &#39;ab&#39;, &#39;ac&#39;, &#39;ad&#39;, &#39;ae&#39;, &#39;af&#39;, &#39;ag&#39;, &#39;ah&#39;, &#39;ai&#39;, &#39;aj&#39;, &#39;ak&#39;, &#39;al&#39;, &#39;am&#39;, &#39;an&#39;, &#39;ao&#39;, &#39;ap&#39;, &#39;aq&#39;, &#39;ar&#39;, &#39;as&#39;, &#39;at&#39;, &#39;au&#39;, &#39;av&#39;, &#39;aw&#39;, &#39;ax&#39;, &#39;ay&#39;, &#39;az&#39;, &#39;aa&#39;, &#39;ab&#39;, &#39;ac&#39;, &#39;ad&#39;, &#39;ae&#39;, &#39;af&#39;, &#39;ag&#39;, &#39;ah&#39;, &#39;ai&#39;, &#39;aj&#39;, &#39;ak&#39;, &#39;al&#39;, &#39;am&#39;, &#39;an&#39;, &#39;ao&#39;, &#39;ap&#39;, &#39;aq&#39;, &#39;ar&#39;, &#39;as&#39;, &#39;at&#39;, &#39;au&#39;, &#39;av&#39;, &#39;aw&#39;, &#39;ax&#39;, &#39;ay&#39;, &#39;az&#39;, &#39;bc&#39;, &#39;bd&#39;, &#39;be&#39;, &#39;bf&#39;, &#39;bg&#39;, &#39;bh&#39;, &#39;bi&#39;, &#39;bj&#39;, &#39;bk&#39;, &#39;bl&#39;, &#39;bm&#39;, &#39;bn&#39;, &#39;bo&#39;, &#39;bp&#39;, &#39;bq&#39;, &#39;br&#39;, &#39;bs&#39;, &#39;bt&#39;, &#39;bu&#39;, &#39;bv&#39;, &#39;bw&#39;, &#39;bx&#39;, &#39;by&#39;, &#39;bz&#39;, &#39;ba&#39;, &#39;bb&#39;, &#39;bc&#39;, &#39;bd&#39;, &#39;be&#39;, &#39;bf&#39;, &#39;bg&#39;, &#39;bh&#39;, &#39;bi&#39;, &#39;bj&#39;, &#39;bk&#39;, &#39;bl&#39;, &#39;bm&#39;, &#39;bn&#39;, &#39;bo&#39;, &#39;bp&#39;, &#39;bq&#39;, &#39;br&#39;, &#39;bs&#39;, &#39;bt&#39;, &#39;bu&#39;, &#39;bv&#39;, &#39;bw&#39;, &#39;bx&#39;, &#39;by&#39;, &#39;bz&#39;, &#39;cd&#39;, &#39;ce&#39;, &#39;cf&#39;, &#39;cg&#39;, &#39;ch&#39;, &#39;ci&#39;, &#39;cj&#39;, &#39;ck&#39;, &#39;cl&#39;, &#39;cm&#39;, &#39;cn&#39;, &#39;co&#39;, &#39;cp&#39;, &#39;cq&#39;, &#39;cr&#39;, &#39;cs&#39;, &#39;ct&#39;, &#39;cu&#39;, &#39;cv&#39;, &#39;cw&#39;, &#39;cx&#39;, &#39;cy&#39;, &#39;cz&#39;, &#39;ca&#39;, &#39;cb&#39;, &#39;cc&#39;, &#39;cd&#39;, &#39;ce&#39;, &#39;cf&#39;, &#39;cg&#39;, &#39;ch&#39;, &#39;ci&#39;, &#39;cj&#39;, &#39;ck&#39;, &#39;cl&#39;, &#39;cm&#39;, &#39;cn&#39;, &#39;co&#39;, &#39;cp&#39;, &#39;cq&#39;, &#39;cr&#39;, &#39;cs&#39;, &#39;ct&#39;, &#39;cu&#39;, &#39;cv&#39;, &#39;cw&#39;, &#39;cx&#39;, &#39;cy&#39;, &#39;cz&#39;, &#39;de&#39;, &#39;df&#39;, &#39;dg&#39;, &#39;dh&#39;, &#39;di&#39;, &#39;dj&#39;, &#39;dk&#39;, &#39;dl&#39;, &#39;dm&#39;, &#39;dn&#39;, &#39;do&#39;, &#39;dp&#39;, &#39;dq&#39;, &#39;dr&#39;, &#39;ds&#39;, &#39;dt&#39;, &#39;du&#39;, &#39;dv&#39;, &#39;dw&#39;, &#39;dx&#39;, &#39;dy&#39;, &#39;dz&#39;, &#39;da&#39;, &#39;db&#39;, &#39;dc&#39;, &#39;dd&#39;, &#39;de&#39;, &#39;df&#39;, &#39;dg&#39;, &#39;dh&#39;, &#39;di&#39;, &#39;dj&#39;, &#39;dk&#39;, &#39;dl&#39;, &#39;dm&#39;, &#39;dn&#39;, &#39;do&#39;, &#39;dp&#39;, &#39;dq&#39;, &#39;dr&#39;, &#39;ds&#39;, &#39;dt&#39;, &#39;du&#39;, &#39;dv&#39;, &#39;dw&#39;, &#39;dx&#39;, &#39;dy&#39;, &#39;dz&#39;, &#39;ef&#39;, &#39;eg&#39;, &#39;eh&#39;, &#39;ei&#39;, &#39;ej&#39;, &#39;ek&#39;, &#39;el&#39;, &#39;em&#39;, &#39;en&#39;, &#39;eo&#39;, &#39;ep&#39;, &#39;eq&#39;, &#39;er&#39;, &#39;es&#39;, &#39;et&#39;, &#39;eu&#39;, &#39;ev&#39;, &#39;ew&#39;, &#39;ex&#39;, &#39;ey&#39;, &#39;ez&#39;, &#39;ea&#39;, &#39;eb&#39;, &#39;ec&#39;, &#39;ed&#39;, &#39;ee&#39;, &#39;ef&#39;, &#39;eg&#39;, &#39;eh&#39;, &#39;ei&#39;, &#39;ej&#39;, &#39;ek&#39;, &#39;el&#39;, &#39;em&#39;, &#39;en&#39;, &#39;eo&#39;, &#39;ep&#39;, &#39;eq&#39;, &#39;er&#39;, &#39;es&#39;, &#39;et&#39;, &#39;eu&#39;, &#39;ev&#39;, &#39;ew&#39;, &#39;ex&#39;, &#39;ey&#39;, &#39;ez&#39;, &#39;fg&#39;, &#39;fh&#39;, &#39;fi&#39;, &#39;fj&#39;, &#39;fk&#39;, &#39;fl&#39;, &#39;fm&#39;, &#39;fn&#39;, &#39;fo&#39;, &#39;fp&#39;, &#39;fq&#39;, &#39;fr&#39;, &#39;fs&#39;, &#39;ft&#39;, &#39;fu&#39;, &#39;fv&#39;, &#39;fw&#39;, &#39;fx&#39;, &#39;fy&#39;, &#39;fz&#39;, &#39;fa&#39;, &#39;fb&#39;, &#39;fc&#39;, &#39;fd&#39;, &#39;fe&#39;, &#39;ff&#39;, &#39;fg&#39;, &#39;fh&#39;, &#39;fi&#39;, &#39;fj&#39;, &#39;fk&#39;, &#39;fl&#39;, &#39;fm&#39;, &#39;fn&#39;, &#39;fo&#39;, &#39;fp&#39;, &#39;fq&#39;, &#39;fr&#39;, &#39;fs&#39;, &#39;ft&#39;, &#39;fu&#39;, &#39;fv&#39;, &#39;fw&#39;, &#39;fx&#39;, &#39;fy&#39;, &#39;fz&#39;, &#39;gh&#39;, &#39;gi&#39;, &#39;gj&#39;, &#39;gk&#39;, &#39;gl&#39;, &#39;gm&#39;, &#39;gn&#39;, &#39;go&#39;, &#39;gp&#39;, &#39;gq&#39;, &#39;gr&#39;, &#39;gs&#39;, &#39;gt&#39;, &#39;gu&#39;, &#39;gv&#39;, &#39;gw&#39;, &#39;gx&#39;, &#39;gy&#39;, &#39;gz&#39;, &#39;ga&#39;, &#39;gb&#39;, &#39;gc&#39;, &#39;gd&#39;, &#39;ge&#39;, &#39;gf&#39;, &#39;gg&#39;, &#39;gh&#39;, &#39;gi&#39;, &#39;gj&#39;, &#39;gk&#39;, &#39;gl&#39;, &#39;gm&#39;, &#39;gn&#39;, &#39;go&#39;, &#39;gp&#39;, &#39;gq&#39;, &#39;gr&#39;, &#39;gs&#39;, &#39;gt&#39;, &#39;gu&#39;, &#39;gv&#39;, &#39;gw&#39;, &#39;gx&#39;, &#39;gy&#39;, &#39;gz&#39;, &#39;hi&#39;, &#39;hj&#39;, &#39;hk&#39;, &#39;hl&#39;, &#39;hm&#39;, &#39;hn&#39;, &#39;ho&#39;, &#39;hp&#39;, &#39;hq&#39;, &#39;hr&#39;, &#39;hs&#39;, &#39;ht&#39;, &#39;hu&#39;, &#39;hv&#39;, &#39;hw&#39;, &#39;hx&#39;, &#39;hy&#39;, &#39;hz&#39;, &#39;ha&#39;, &#39;hb&#39;, &#39;hc&#39;, &#39;hd&#39;, &#39;he&#39;, &#39;hf&#39;, &#39;hg&#39;, &#39;hh&#39;, &#39;hi&#39;, &#39;hj&#39;, &#39;hk&#39;, &#39;hl&#39;, &#39;hm&#39;, &#39;hn&#39;, &#39;ho&#39;, &#39;hp&#39;, &#39;hq&#39;, &#39;hr&#39;, &#39;hs&#39;, &#39;ht&#39;, &#39;hu&#39;, &#39;hv&#39;, &#39;hw&#39;, &#39;hx&#39;, &#39;hy&#39;, &#39;hz&#39;, &#39;ij&#39;, &#39;ik&#39;, &#39;il&#39;, &#39;im&#39;, &#39;in&#39;, &#39;io&#39;, &#39;ip&#39;, &#39;iq&#39;, &#39;ir&#39;, &#39;is&#39;, &#39;it&#39;, &#39;iu&#39;, &#39;iv&#39;, &#39;iw&#39;, &#39;ix&#39;, &#39;iy&#39;, &#39;iz&#39;, &#39;ia&#39;, &#39;ib&#39;, &#39;ic&#39;, &#39;id&#39;, &#39;ie&#39;, &#39;if&#39;, &#39;ig&#39;, &#39;ih&#39;, &#39;ii&#39;, &#39;ij&#39;, &#39;ik&#39;, &#39;il&#39;, &#39;im&#39;, &#39;in&#39;, &#39;io&#39;, &#39;ip&#39;, &#39;iq&#39;, &#39;ir&#39;, &#39;is&#39;, &#39;it&#39;, &#39;iu&#39;, &#39;iv&#39;, &#39;iw&#39;, &#39;ix&#39;, &#39;iy&#39;, &#39;iz&#39;, &#39;jk&#39;, &#39;jl&#39;, &#39;jm&#39;, &#39;jn&#39;, &#39;jo&#39;, &#39;jp&#39;, &#39;jq&#39;, &#39;jr&#39;, &#39;js&#39;, &#39;jt&#39;, &#39;ju&#39;, &#39;jv&#39;, &#39;jw&#39;, &#39;jx&#39;, &#39;jy&#39;, &#39;jz&#39;, &#39;ja&#39;, &#39;jb&#39;, &#39;jc&#39;, &#39;jd&#39;, &#39;je&#39;, &#39;jf&#39;, &#39;jg&#39;, &#39;jh&#39;, &#39;ji&#39;, &#39;jj&#39;, &#39;jk&#39;, &#39;jl&#39;, &#39;jm&#39;, &#39;jn&#39;, &#39;jo&#39;, &#39;jp&#39;, &#39;jq&#39;, &#39;jr&#39;, &#39;js&#39;, &#39;jt&#39;, &#39;ju&#39;, &#39;jv&#39;, &#39;jw&#39;, &#39;jx&#39;, &#39;jy&#39;, &#39;jz&#39;, &#39;kl&#39;, &#39;km&#39;, &#39;kn&#39;, &#39;ko&#39;, &#39;kp&#39;, &#39;kq&#39;, &#39;kr&#39;, &#39;ks&#39;, &#39;kt&#39;, &#39;ku&#39;, &#39;kv&#39;, &#39;kw&#39;, &#39;kx&#39;, &#39;ky&#39;, &#39;kz&#39;, &#39;ka&#39;, &#39;kb&#39;, &#39;kc&#39;, &#39;kd&#39;, &#39;ke&#39;, &#39;kf&#39;, &#39;kg&#39;, &#39;kh&#39;, &#39;ki&#39;, &#39;kj&#39;, &#39;kk&#39;, &#39;kl&#39;, &#39;km&#39;, &#39;kn&#39;, &#39;ko&#39;, &#39;kp&#39;, &#39;kq&#39;, &#39;kr&#39;, &#39;ks&#39;, &#39;kt&#39;, &#39;ku&#39;, &#39;kv&#39;, &#39;kw&#39;, &#39;kx&#39;, &#39;ky&#39;, &#39;kz&#39;, &#39;lm&#39;, &#39;ln&#39;, &#39;lo&#39;, &#39;lp&#39;, &#39;lq&#39;, &#39;lr&#39;, &#39;ls&#39;, &#39;lt&#39;, &#39;lu&#39;, &#39;lv&#39;, &#39;lw&#39;, &#39;lx&#39;, &#39;ly&#39;, &#39;lz&#39;, &#39;la&#39;, &#39;lb&#39;, &#39;lc&#39;, &#39;ld&#39;, &#39;le&#39;, &#39;lf&#39;, &#39;lg&#39;, &#39;lh&#39;, &#39;li&#39;, &#39;lj&#39;, &#39;lk&#39;, &#39;ll&#39;, &#39;lm&#39;, &#39;ln&#39;, &#39;lo&#39;, &#39;lp&#39;, &#39;lq&#39;, &#39;lr&#39;, &#39;ls&#39;, &#39;lt&#39;, &#39;lu&#39;, &#39;lv&#39;, &#39;lw&#39;, &#39;lx&#39;, &#39;ly&#39;, &#39;lz&#39;, &#39;mn&#39;, &#39;mo&#39;, &#39;mp&#39;, &#39;mq&#39;, &#39;mr&#39;, &#39;ms&#39;, &#39;mt&#39;, &#39;mu&#39;, &#39;mv&#39;, &#39;mw&#39;, &#39;mx&#39;, &#39;my&#39;, &#39;mz&#39;, &#39;ma&#39;, &#39;mb&#39;, &#39;mc&#39;, &#39;md&#39;, &#39;me&#39;, &#39;mf&#39;, &#39;mg&#39;, &#39;mh&#39;, &#39;mi&#39;, &#39;mj&#39;, &#39;mk&#39;, &#39;ml&#39;, &#39;mm&#39;, &#39;mn&#39;, &#39;mo&#39;, &#39;mp&#39;, &#39;mq&#39;, &#39;mr&#39;, &#39;ms&#39;, &#39;mt&#39;, &#39;mu&#39;, &#39;mv&#39;, &#39;mw&#39;, &#39;mx&#39;, &#39;my&#39;, &#39;mz&#39;, &#39;no&#39;, &#39;np&#39;, &#39;nq&#39;, &#39;nr&#39;, &#39;ns&#39;, &#39;nt&#39;, &#39;nu&#39;, &#39;nv&#39;, &#39;nw&#39;, &#39;nx&#39;, &#39;ny&#39;, &#39;nz&#39;, &#39;na&#39;, &#39;nb&#39;, &#39;nc&#39;, &#39;nd&#39;, &#39;ne&#39;, &#39;nf&#39;, &#39;ng&#39;, &#39;nh&#39;, &#39;ni&#39;, &#39;nj&#39;, &#39;nk&#39;, &#39;nl&#39;, &#39;nm&#39;, &#39;nn&#39;, &#39;no&#39;, &#39;np&#39;, &#39;nq&#39;, &#39;nr&#39;, &#39;ns&#39;, &#39;nt&#39;, &#39;nu&#39;, &#39;nv&#39;, &#39;nw&#39;, &#39;nx&#39;, &#39;ny&#39;, &#39;nz&#39;, &#39;op&#39;, &#39;oq&#39;, &#39;or&#39;, &#39;os&#39;, &#39;ot&#39;, &#39;ou&#39;, &#39;ov&#39;, &#39;ow&#39;, &#39;ox&#39;, &#39;oy&#39;, &#39;oz&#39;, &#39;oa&#39;, &#39;ob&#39;, &#39;oc&#39;, &#39;od&#39;, &#39;oe&#39;, &#39;of&#39;, &#39;og&#39;, &#39;oh&#39;, &#39;oi&#39;, &#39;oj&#39;, &#39;ok&#39;, &#39;ol&#39;, &#39;om&#39;, &#39;on&#39;, &#39;oo&#39;, &#39;op&#39;, &#39;oq&#39;, &#39;or&#39;, &#39;os&#39;, &#39;ot&#39;, &#39;ou&#39;, &#39;ov&#39;, &#39;ow&#39;, &#39;ox&#39;, &#39;oy&#39;, &#39;oz&#39;, &#39;pq&#39;, &#39;pr&#39;, &#39;ps&#39;, &#39;pt&#39;, &#39;pu&#39;, &#39;pv&#39;, &#39;pw&#39;, &#39;px&#39;, &#39;py&#39;, &#39;pz&#39;, &#39;pa&#39;, &#39;pb&#39;, &#39;pc&#39;, &#39;pd&#39;, &#39;pe&#39;, &#39;pf&#39;, &#39;pg&#39;, &#39;ph&#39;, &#39;pi&#39;, &#39;pj&#39;, &#39;pk&#39;, &#39;pl&#39;, &#39;pm&#39;, &#39;pn&#39;, &#39;po&#39;, &#39;pp&#39;, &#39;pq&#39;, &#39;pr&#39;, &#39;ps&#39;, &#39;pt&#39;, &#39;pu&#39;, &#39;pv&#39;, &#39;pw&#39;, &#39;px&#39;, &#39;py&#39;, &#39;pz&#39;, &#39;qr&#39;, &#39;qs&#39;, &#39;qt&#39;, &#39;qu&#39;, &#39;qv&#39;, &#39;qw&#39;, &#39;qx&#39;, &#39;qy&#39;, &#39;qz&#39;, &#39;qa&#39;, &#39;qb&#39;, &#39;qc&#39;, &#39;qd&#39;, &#39;qe&#39;, &#39;qf&#39;, &#39;qg&#39;, &#39;qh&#39;, &#39;qi&#39;, &#39;qj&#39;, &#39;qk&#39;, &#39;ql&#39;, &#39;qm&#39;, &#39;qn&#39;, &#39;qo&#39;, &#39;qp&#39;, &#39;qq&#39;, &#39;qr&#39;, &#39;qs&#39;, &#39;qt&#39;, &#39;qu&#39;, &#39;qv&#39;, &#39;qw&#39;, &#39;qx&#39;, &#39;qy&#39;, &#39;qz&#39;, &#39;rs&#39;, &#39;rt&#39;, &#39;ru&#39;, &#39;rv&#39;, &#39;rw&#39;, &#39;rx&#39;, &#39;ry&#39;, &#39;rz&#39;, &#39;ra&#39;, &#39;rb&#39;, &#39;rc&#39;, &#39;rd&#39;, &#39;re&#39;, &#39;rf&#39;, &#39;rg&#39;, &#39;rh&#39;, &#39;ri&#39;, &#39;rj&#39;, &#39;rk&#39;, &#39;rl&#39;, &#39;rm&#39;, &#39;rn&#39;, &#39;ro&#39;, &#39;rp&#39;, &#39;rq&#39;, &#39;rr&#39;, &#39;rs&#39;, &#39;rt&#39;, &#39;ru&#39;, &#39;rv&#39;, &#39;rw&#39;, &#39;rx&#39;, &#39;ry&#39;, &#39;rz&#39;, &#39;st&#39;, &#39;su&#39;, &#39;sv&#39;, &#39;sw&#39;, &#39;sx&#39;, &#39;sy&#39;, &#39;sz&#39;, &#39;sa&#39;, &#39;sb&#39;, &#39;sc&#39;, &#39;sd&#39;, &#39;se&#39;, &#39;sf&#39;, &#39;sg&#39;, &#39;sh&#39;, &#39;si&#39;, &#39;sj&#39;, &#39;sk&#39;, &#39;sl&#39;, &#39;sm&#39;, &#39;sn&#39;, &#39;so&#39;, &#39;sp&#39;, &#39;sq&#39;, &#39;sr&#39;, &#39;ss&#39;, &#39;st&#39;, &#39;su&#39;, &#39;sv&#39;, &#39;sw&#39;, &#39;sx&#39;, &#39;sy&#39;, &#39;sz&#39;, &#39;tu&#39;, &#39;tv&#39;, &#39;tw&#39;, &#39;tx&#39;, &#39;ty&#39;, &#39;tz&#39;, &#39;ta&#39;, &#39;tb&#39;, &#39;tc&#39;, &#39;td&#39;, &#39;te&#39;, &#39;tf&#39;, &#39;tg&#39;, &#39;th&#39;, &#39;ti&#39;, &#39;tj&#39;, &#39;tk&#39;, &#39;tl&#39;, &#39;tm&#39;, &#39;tn&#39;, &#39;to&#39;, &#39;tp&#39;, &#39;tq&#39;, &#39;tr&#39;, &#39;ts&#39;, &#39;tt&#39;, &#39;tu&#39;, &#39;tv&#39;, &#39;tw&#39;, &#39;tx&#39;, &#39;ty&#39;, &#39;tz&#39;, &#39;uv&#39;, &#39;uw&#39;, &#39;ux&#39;, &#39;uy&#39;, &#39;uz&#39;, &#39;ua&#39;, &#39;ub&#39;, &#39;uc&#39;, &#39;ud&#39;, &#39;ue&#39;, &#39;uf&#39;, &#39;ug&#39;, &#39;uh&#39;, &#39;ui&#39;, &#39;uj&#39;, &#39;uk&#39;, &#39;ul&#39;, &#39;um&#39;, &#39;un&#39;, &#39;uo&#39;, &#39;up&#39;, &#39;uq&#39;, &#39;ur&#39;, &#39;us&#39;, &#39;ut&#39;, &#39;uu&#39;, &#39;uv&#39;, &#39;uw&#39;, &#39;ux&#39;, &#39;uy&#39;, &#39;uz&#39;, &#39;vw&#39;, &#39;vx&#39;, &#39;vy&#39;, &#39;vz&#39;, &#39;va&#39;, &#39;vb&#39;, &#39;vc&#39;, &#39;vd&#39;, &#39;ve&#39;, &#39;vf&#39;, &#39;vg&#39;, &#39;vh&#39;, &#39;vi&#39;, &#39;vj&#39;, &#39;vk&#39;, &#39;vl&#39;, &#39;vm&#39;, &#39;vn&#39;, &#39;vo&#39;, &#39;vp&#39;, &#39;vq&#39;, &#39;vr&#39;, &#39;vs&#39;, &#39;vt&#39;, &#39;vu&#39;, &#39;vv&#39;, &#39;vw&#39;, &#39;vx&#39;, &#39;vy&#39;, &#39;vz&#39;, &#39;wx&#39;, &#39;wy&#39;, &#39;wz&#39;, &#39;wa&#39;, &#39;wb&#39;, &#39;wc&#39;, &#39;wd&#39;, &#39;we&#39;, &#39;wf&#39;, &#39;wg&#39;, &#39;wh&#39;, &#39;wi&#39;, &#39;wj&#39;, &#39;wk&#39;, &#39;wl&#39;, &#39;wm&#39;, &#39;wn&#39;, &#39;wo&#39;, &#39;wp&#39;, &#39;wq&#39;, &#39;wr&#39;, &#39;ws&#39;, &#39;wt&#39;, &#39;wu&#39;, &#39;wv&#39;, &#39;ww&#39;, &#39;wx&#39;, &#39;wy&#39;, &#39;wz&#39;, &#39;xy&#39;, &#39;xz&#39;, &#39;xa&#39;, &#39;xb&#39;, &#39;xc&#39;, &#39;xd&#39;, &#39;xe&#39;, &#39;xf&#39;, &#39;xg&#39;, &#39;xh&#39;, &#39;xi&#39;, &#39;xj&#39;, &#39;xk&#39;, &#39;xl&#39;, &#39;xm&#39;, &#39;xn&#39;, &#39;xo&#39;, &#39;xp&#39;, &#39;xq&#39;, &#39;xr&#39;, &#39;xs&#39;, &#39;xt&#39;, &#39;xu&#39;, &#39;xv&#39;, &#39;xw&#39;, &#39;xx&#39;, &#39;xy&#39;, &#39;xz&#39;, &#39;yz&#39;, &#39;ya&#39;, &#39;yb&#39;, &#39;yc&#39;, &#39;yd&#39;, &#39;ye&#39;, &#39;yf&#39;, &#39;yg&#39;, &#39;yh&#39;, &#39;yi&#39;, &#39;yj&#39;, &#39;yk&#39;, &#39;yl&#39;, &#39;ym&#39;, &#39;yn&#39;, &#39;yo&#39;, &#39;yp&#39;, &#39;yq&#39;, &#39;yr&#39;, &#39;ys&#39;, &#39;yt&#39;, &#39;yu&#39;, &#39;yv&#39;, &#39;yw&#39;, &#39;yx&#39;, &#39;yy&#39;, &#39;yz&#39;, &#39;za&#39;, &#39;zb&#39;, &#39;zc&#39;, &#39;zd&#39;, &#39;ze&#39;, &#39;zf&#39;, &#39;zg&#39;, &#39;zh&#39;, &#39;zi&#39;, &#39;zj&#39;, &#39;zk&#39;, &#39;zl&#39;, &#39;zm&#39;, &#39;zn&#39;, &#39;zo&#39;, &#39;zp&#39;, &#39;zq&#39;, &#39;zr&#39;, &#39;zs&#39;, &#39;zt&#39;, &#39;zu&#39;, &#39;zv&#39;, &#39;zw&#39;, &#39;zx&#39;, &#39;zy&#39;, &#39;zz&#39;, &#39;ab&#39;, &#39;ac&#39;, &#39;ad&#39;, &#39;ae&#39;, &#39;af&#39;, &#39;ag&#39;, &#39;ah&#39;, &#39;ai&#39;, &#39;aj&#39;, &#39;ak&#39;, &#39;al&#39;, &#39;am&#39;, &#39;an&#39;, &#39;ao&#39;, &#39;ap&#39;, &#39;aq&#39;, &#39;ar&#39;, &#39;as&#39;, &#39;at&#39;, &#39;au&#39;, &#39;av&#39;, &#39;aw&#39;, &#39;ax&#39;, &#39;ay&#39;, &#39;az&#39;, &#39;bc&#39;, &#39;bd&#39;, &#39;be&#39;, &#39;bf&#39;, &#39;bg&#39;, &#39;bh&#39;, &#39;bi&#39;, &#39;bj&#39;, &#39;bk&#39;, &#39;bl&#39;, &#39;bm&#39;, &#39;bn&#39;, &#39;bo&#39;, &#39;bp&#39;, &#39;bq&#39;, &#39;br&#39;, &#39;bs&#39;, &#39;bt&#39;, &#39;bu&#39;, &#39;bv&#39;, &#39;bw&#39;, &#39;bx&#39;, &#39;by&#39;, &#39;bz&#39;, &#39;cd&#39;, &#39;ce&#39;, &#39;cf&#39;, &#39;cg&#39;, &#39;ch&#39;, &#39;ci&#39;, &#39;cj&#39;, &#39;ck&#39;, &#39;cl&#39;, &#39;cm&#39;, &#39;cn&#39;, &#39;co&#39;, &#39;cp&#39;, &#39;cq&#39;, &#39;cr&#39;, &#39;cs&#39;, &#39;ct&#39;, &#39;cu&#39;, &#39;cv&#39;, &#39;cw&#39;, &#39;cx&#39;, &#39;cy&#39;, &#39;cz&#39;, &#39;de&#39;, &#39;df&#39;, &#39;dg&#39;, &#39;dh&#39;, &#39;di&#39;, &#39;dj&#39;, &#39;dk&#39;, &#39;dl&#39;, &#39;dm&#39;, &#39;dn&#39;, &#39;do&#39;, &#39;dp&#39;, &#39;dq&#39;, &#39;dr&#39;, &#39;ds&#39;, &#39;dt&#39;, &#39;du&#39;, &#39;dv&#39;, &#39;dw&#39;, &#39;dx&#39;, &#39;dy&#39;, &#39;dz&#39;, &#39;ef&#39;, &#39;eg&#39;, &#39;eh&#39;, &#39;ei&#39;, &#39;ej&#39;, &#39;ek&#39;, &#39;el&#39;, &#39;em&#39;, &#39;en&#39;, &#39;eo&#39;, &#39;ep&#39;, &#39;eq&#39;, &#39;er&#39;, &#39;es&#39;, &#39;et&#39;, &#39;eu&#39;, &#39;ev&#39;, &#39;ew&#39;, &#39;ex&#39;, &#39;ey&#39;, &#39;ez&#39;, &#39;fg&#39;, &#39;fh&#39;, &#39;fi&#39;, &#39;fj&#39;, &#39;fk&#39;, &#39;fl&#39;, &#39;fm&#39;, &#39;fn&#39;, &#39;fo&#39;, &#39;fp&#39;, &#39;fq&#39;, &#39;fr&#39;, &#39;fs&#39;, &#39;ft&#39;, &#39;fu&#39;, &#39;fv&#39;, &#39;fw&#39;, &#39;fx&#39;, &#39;fy&#39;, &#39;fz&#39;, &#39;gh&#39;, &#39;gi&#39;, &#39;gj&#39;, &#39;gk&#39;, &#39;gl&#39;, &#39;gm&#39;, &#39;gn&#39;, &#39;go&#39;, &#39;gp&#39;, &#39;gq&#39;, &#39;gr&#39;, &#39;gs&#39;, &#39;gt&#39;, &#39;gu&#39;, &#39;gv&#39;, &#39;gw&#39;, &#39;gx&#39;, &#39;gy&#39;, &#39;gz&#39;, &#39;hi&#39;, &#39;hj&#39;, &#39;hk&#39;, &#39;hl&#39;, &#39;hm&#39;, &#39;hn&#39;, &#39;ho&#39;, &#39;hp&#39;, &#39;hq&#39;, &#39;hr&#39;, &#39;hs&#39;, &#39;ht&#39;, &#39;hu&#39;, &#39;hv&#39;, &#39;hw&#39;, &#39;hx&#39;, &#39;hy&#39;, &#39;hz&#39;, &#39;ij&#39;, &#39;ik&#39;, &#39;il&#39;, &#39;im&#39;, &#39;in&#39;, &#39;io&#39;, &#39;ip&#39;, &#39;iq&#39;, &#39;ir&#39;, &#39;is&#39;, &#39;it&#39;, &#39;iu&#39;, &#39;iv&#39;, &#39;iw&#39;, &#39;ix&#39;, &#39;iy&#39;, &#39;iz&#39;, &#39;jk&#39;, &#39;jl&#39;, &#39;jm&#39;, &#39;jn&#39;, &#39;jo&#39;, &#39;jp&#39;, &#39;jq&#39;, &#39;jr&#39;, &#39;js&#39;, &#39;jt&#39;, &#39;ju&#39;, &#39;jv&#39;, &#39;jw&#39;, &#39;jx&#39;, &#39;jy&#39;, &#39;jz&#39;, &#39;kl&#39;, &#39;km&#39;, &#39;kn&#39;, &#39;ko&#39;, &#39;kp&#39;, &#39;kq&#39;, &#39;kr&#39;, &#39;ks&#39;, &#39;kt&#39;, &#39;ku&#39;, &#39;kv&#39;, &#39;kw&#39;, &#39;kx&#39;, &#39;ky&#39;, &#39;kz&#39;, &#39;lm&#39;, &#39;ln&#39;, &#39;lo&#39;, &#39;lp&#39;, &#39;lq&#39;, &#39;lr&#39;, &#39;ls&#39;, &#39;lt&#39;, &#39;lu&#39;, &#39;lv&#39;, &#39;lw&#39;, &#39;lx&#39;, &#39;ly&#39;, &#39;lz&#39;, &#39;mn&#39;, &#39;mo&#39;, &#39;mp&#39;, &#39;mq&#39;, &#39;mr&#39;, &#39;ms&#39;, &#39;mt&#39;, &#39;mu&#39;, &#39;mv&#39;, &#39;mw&#39;, &#39;mx&#39;, &#39;my&#39;, &#39;mz&#39;, &#39;no&#39;, &#39;np&#39;, &#39;nq&#39;, &#39;nr&#39;, &#39;ns&#39;, &#39;nt&#39;, &#39;nu&#39;, &#39;nv&#39;, &#39;nw&#39;, &#39;nx&#39;, &#39;ny&#39;, &#39;nz&#39;, &#39;op&#39;, &#39;oq&#39;, &#39;or&#39;, &#39;os&#39;, &#39;ot&#39;, &#39;ou&#39;, &#39;ov&#39;, &#39;ow&#39;, &#39;ox&#39;, &#39;oy&#39;, &#39;oz&#39;, &#39;pq&#39;, &#39;pr&#39;, &#39;ps&#39;, &#39;pt&#39;, &#39;pu&#39;, &#39;pv&#39;, &#39;pw&#39;, &#39;px&#39;, &#39;py&#39;, &#39;pz&#39;, &#39;qr&#39;, &#39;qs&#39;, &#39;qt&#39;, &#39;qu&#39;, &#39;qv&#39;, &#39;qw&#39;, &#39;qx&#39;, &#39;qy&#39;, &#39;qz&#39;, &#39;rs&#39;, &#39;rt&#39;, &#39;ru&#39;, &#39;rv&#39;, &#39;rw&#39;, &#39;rx&#39;, &#39;ry&#39;, &#39;rz&#39;, &#39;st&#39;, &#39;su&#39;, &#39;sv&#39;, &#39;sw&#39;, &#39;sx&#39;, &#39;sy&#39;, &#39;sz&#39;, &#39;tu&#39;, &#39;tv&#39;, &#39;tw&#39;, &#39;tx&#39;, &#39;ty&#39;, &#39;tz&#39;, &#39;uv&#39;, &#39;uw&#39;, &#39;ux&#39;, &#39;uy&#39;, &#39;uz&#39;, &#39;vw&#39;, &#39;vx&#39;, &#39;vy&#39;, &#39;vz&#39;, &#39;wx&#39;, &#39;wy&#39;, &#39;wz&#39;, &#39;xy&#39;, &#39;xz&#39;, &#39;yz&#39;]</span>

        
    </div>
    <a class="headerlink" href="#labels"></a>
    
    

                </section>
                <section id="Topology">
                            <input id="Topology-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">Topology</span>:

                <label class="view-source-button" for="Topology-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Topology"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Topology-67"><a href="#Topology-67"><span class="linenos">  67</span></a><span class="k">class</span><span class="w"> </span><span class="nc">Topology</span><span class="p">:</span>
</span><span id="Topology-68"><a href="#Topology-68"><span class="linenos">  68</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;Class to represent topology of a Tileable object.</span>
</span><span id="Topology-69"><a href="#Topology-69"><span class="linenos">  69</span></a>
</span><span id="Topology-70"><a href="#Topology-70"><span class="linenos">  70</span></a><span class="sd">  NOTE: It is important that get_local_patch return the tileable elements and</span>
</span><span id="Topology-71"><a href="#Topology-71"><span class="linenos">  71</span></a><span class="sd">  the translated copies in consistent sequence, i.e. if there are (say) four</span>
</span><span id="Topology-72"><a href="#Topology-72"><span class="linenos">  72</span></a><span class="sd">  tiles in the unit, the local patch should be 1 2 3 4 1 2 3 4 1 2 3 4 ... and</span>
</span><span id="Topology-73"><a href="#Topology-73"><span class="linenos">  73</span></a><span class="sd">  so on. This is because self.tiles[i % n_tiles] is frequently used to</span>
</span><span id="Topology-74"><a href="#Topology-74"><span class="linenos">  74</span></a><span class="sd">  reference the base unit Tile which corresponds to self.tiles[i].</span>
</span><span id="Topology-75"><a href="#Topology-75"><span class="linenos">  75</span></a><span class="sd">  &quot;&quot;&quot;</span>
</span><span id="Topology-76"><a href="#Topology-76"><span class="linenos">  76</span></a>
</span><span id="Topology-77"><a href="#Topology-77"><span class="linenos">  77</span></a>  <span class="n">tileable</span><span class="p">:</span> <span class="n">Tileable</span>
</span><span id="Topology-78"><a href="#Topology-78"><span class="linenos">  78</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;the Tileable on which the topology will be based.&quot;&quot;&quot;</span>
</span><span id="Topology-79"><a href="#Topology-79"><span class="linenos">  79</span></a>  <span class="n">tiles</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Tile</span><span class="p">]</span>
</span><span id="Topology-80"><a href="#Topology-80"><span class="linenos">  80</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;list of the Tiles in the topology. We use polygons returned by the</span>
</span><span id="Topology-81"><a href="#Topology-81"><span class="linenos">  81</span></a><span class="sd">  tileable.get_local_patch method for these. That is the base tiles and 8</span>
</span><span id="Topology-82"><a href="#Topology-82"><span class="linenos">  82</span></a><span class="sd">  adjacent copies (for a rectangular tiling), or 6 adjacent copies (for a</span>
</span><span id="Topology-83"><a href="#Topology-83"><span class="linenos">  83</span></a><span class="sd">  hexagonal tiling).&quot;&quot;&quot;</span>
</span><span id="Topology-84"><a href="#Topology-84"><span class="linenos">  84</span></a>  <span class="n">points</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">Vertex</span><span class="p">]</span>
</span><span id="Topology-85"><a href="#Topology-85"><span class="linenos">  85</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;dictionary of all points (vertices and corners) in the tiling, keyed by</span>
</span><span id="Topology-86"><a href="#Topology-86"><span class="linenos">  86</span></a><span class="sd">  Vertex ID.&quot;&quot;&quot;</span>
</span><span id="Topology-87"><a href="#Topology-87"><span class="linenos">  87</span></a>  <span class="n">edges</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span><span class="nb">int</span><span class="p">],</span> <span class="n">Edge</span><span class="p">]</span>
</span><span id="Topology-88"><a href="#Topology-88"><span class="linenos">  88</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;dictionary of the tiling edges, keyed by Edge ID.&quot;&quot;&quot;</span>
</span><span id="Topology-89"><a href="#Topology-89"><span class="linenos">  89</span></a>  <span class="n">unique_tile_shapes</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">geom</span><span class="o">.</span><span class="n">Polygon</span><span class="p">]</span>
</span><span id="Topology-90"><a href="#Topology-90"><span class="linenos">  90</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;a &#39;reference&#39; tile shape one per tile shape (up to vertices, so two tiles</span>
</span><span id="Topology-91"><a href="#Topology-91"><span class="linenos">  91</span></a><span class="sd">  might be the same shape, but one might have extra vertices induced by the</span>
</span><span id="Topology-92"><a href="#Topology-92"><span class="linenos">  92</span></a><span class="sd">  tiling and hence is a different shape under this definition).&quot;&quot;&quot;</span>
</span><span id="Topology-93"><a href="#Topology-93"><span class="linenos">  93</span></a>  <span class="n">dual_tiles</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">geom</span><span class="o">.</span><span class="n">Polygon</span><span class="p">]</span>
</span><span id="Topology-94"><a href="#Topology-94"><span class="linenos">  94</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;list of geom.Polygons from which a dual tiling might be constructed.&quot;&quot;&quot;</span>
</span><span id="Topology-95"><a href="#Topology-95"><span class="linenos">  95</span></a>  <span class="n">n_tiles</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Topology-96"><a href="#Topology-96"><span class="linenos">  96</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;number of tiles in the base Tileable (retained for convenience).&quot;&quot;&quot;</span>
</span><span id="Topology-97"><a href="#Topology-97"><span class="linenos">  97</span></a>  <span class="n">shape_groups</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]]</span>
</span><span id="Topology-98"><a href="#Topology-98"><span class="linenos">  98</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;list of lists of tile IDs distinguished by shape and optionally tile_id&quot;&quot;&quot;</span>
</span><span id="Topology-99"><a href="#Topology-99"><span class="linenos">  99</span></a>  <span class="n">tile_matching_transforms</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span>
</span><span id="Topology-100"><a href="#Topology-100"><span class="linenos"> 100</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;shapely transform tuples that map tiles onto other tiles&quot;&quot;&quot;</span>
</span><span id="Topology-101"><a href="#Topology-101"><span class="linenos"> 101</span></a>  <span class="n">tile_transitivity_classes</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">]]</span>
</span><span id="Topology-102"><a href="#Topology-102"><span class="linenos"> 102</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;list of lists of tile IDs in each transitivity class&quot;&quot;&quot;</span>
</span><span id="Topology-103"><a href="#Topology-103"><span class="linenos"> 103</span></a>  <span class="n">vertex_transitivity_classes</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]]</span>
</span><span id="Topology-104"><a href="#Topology-104"><span class="linenos"> 104</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;list of lists of vertex IDs in each transitivity class&quot;&quot;&quot;</span>
</span><span id="Topology-105"><a href="#Topology-105"><span class="linenos"> 105</span></a>  <span class="n">edge_transitivity_classes</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">]]]</span>
</span><span id="Topology-106"><a href="#Topology-106"><span class="linenos"> 106</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;list of lists of edge IDs in each transitivity class&quot;&quot;&quot;</span>
</span><span id="Topology-107"><a href="#Topology-107"><span class="linenos"> 107</span></a>
</span><span id="Topology-108"><a href="#Topology-108"><span class="linenos"> 108</span></a>  <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="Topology-109"><a href="#Topology-109"><span class="linenos"> 109</span></a>      <span class="bp">self</span><span class="p">,</span>
</span><span id="Topology-110"><a href="#Topology-110"><span class="linenos"> 110</span></a>      <span class="n">unit</span><span class="p">:</span> <span class="n">Tileable</span><span class="p">,</span>
</span><span id="Topology-111"><a href="#Topology-111"><span class="linenos"> 111</span></a>      <span class="n">ignore_tile_ids</span><span class="p">:</span><span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="Topology-112"><a href="#Topology-112"><span class="linenos"> 112</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Topology-113"><a href="#Topology-113"><span class="linenos"> 113</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Class constructor.</span>
</span><span id="Topology-114"><a href="#Topology-114"><span class="linenos"> 114</span></a>
</span><span id="Topology-115"><a href="#Topology-115"><span class="linenos"> 115</span></a><span class="sd">    Args:</span>
</span><span id="Topology-116"><a href="#Topology-116"><span class="linenos"> 116</span></a><span class="sd">      unit (Tileable): the Tileable whose topology is required.</span>
</span><span id="Topology-117"><a href="#Topology-117"><span class="linenos"> 117</span></a><span class="sd">      ignore_tile_ids (bool): (EXPERIMENTAL) if True then only consider the tile</span>
</span><span id="Topology-118"><a href="#Topology-118"><span class="linenos"> 118</span></a><span class="sd">        shapes, not labels. If False consider any labels. Defaults to True.</span>
</span><span id="Topology-119"><a href="#Topology-119"><span class="linenos"> 119</span></a>
</span><span id="Topology-120"><a href="#Topology-120"><span class="linenos"> 120</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Topology-121"><a href="#Topology-121"><span class="linenos"> 121</span></a>    <span class="c1"># Note that the order of these setup steps is fragile sometimes</span>
</span><span id="Topology-122"><a href="#Topology-122"><span class="linenos"> 122</span></a>    <span class="c1"># not obviously so.</span>
</span><span id="Topology-123"><a href="#Topology-123"><span class="linenos"> 123</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">tileable</span> <span class="o">=</span> <span class="n">unit</span> <span class="c1"># keep this for reference</span>
</span><span id="Topology-124"><a href="#Topology-124"><span class="linenos"> 124</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">n_tiles</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tileable</span><span class="o">.</span><span class="n">tiles</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="Topology-125"><a href="#Topology-125"><span class="linenos"> 125</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_initialise_points_into_tiles</span><span class="p">()</span>
</span><span id="Topology-126"><a href="#Topology-126"><span class="linenos"> 126</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_setup_vertex_tile_relations</span><span class="p">()</span>
</span><span id="Topology-127"><a href="#Topology-127"><span class="linenos"> 127</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_setup_edges</span><span class="p">()</span>
</span><span id="Topology-128"><a href="#Topology-128"><span class="linenos"> 128</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_copy_base_tiles_to_patch</span><span class="p">()</span>
</span><span id="Topology-129"><a href="#Topology-129"><span class="linenos"> 129</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_assign_vertex_and_edge_base_IDs</span><span class="p">()</span>
</span><span id="Topology-130"><a href="#Topology-130"><span class="linenos"> 130</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_identify_distinct_tile_shapes</span><span class="p">(</span><span class="n">ignore_tile_ids</span><span class="p">)</span>
</span><span id="Topology-131"><a href="#Topology-131"><span class="linenos"> 131</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_find_tile_transitivity_classes</span><span class="p">(</span><span class="n">ignore_tile_ids</span><span class="p">)</span>
</span><span id="Topology-132"><a href="#Topology-132"><span class="linenos"> 132</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_find_vertex_transitivity_classes</span><span class="p">(</span><span class="n">ignore_tile_ids</span><span class="p">)</span>
</span><span id="Topology-133"><a href="#Topology-133"><span class="linenos"> 133</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_find_edge_transitivity_classes</span><span class="p">(</span><span class="n">ignore_tile_ids</span><span class="p">)</span>
</span><span id="Topology-134"><a href="#Topology-134"><span class="linenos"> 134</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">generate_dual</span><span class="p">()</span>
</span><span id="Topology-135"><a href="#Topology-135"><span class="linenos"> 135</span></a>
</span><span id="Topology-136"><a href="#Topology-136"><span class="linenos"> 136</span></a>
</span><span id="Topology-137"><a href="#Topology-137"><span class="linenos"> 137</span></a>  <span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="Topology-138"><a href="#Topology-138"><span class="linenos"> 138</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return string representation of this Topology.</span>
</span><span id="Topology-139"><a href="#Topology-139"><span class="linenos"> 139</span></a>
</span><span id="Topology-140"><a href="#Topology-140"><span class="linenos"> 140</span></a><span class="sd">    Returns:</span>
</span><span id="Topology-141"><a href="#Topology-141"><span class="linenos"> 141</span></a><span class="sd">      str: a message that recommends examining the tiles, points and edges</span>
</span><span id="Topology-142"><a href="#Topology-142"><span class="linenos"> 142</span></a><span class="sd">        attributes.</span>
</span><span id="Topology-143"><a href="#Topology-143"><span class="linenos"> 143</span></a>
</span><span id="Topology-144"><a href="#Topology-144"><span class="linenos"> 144</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Topology-145"><a href="#Topology-145"><span class="linenos"> 145</span></a>    <span class="k">return</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&quot;&quot;Topology of Tileable with </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">n_tiles</span><span class="si">}</span><span class="s2"> tiles.</span><span class="se">\n</span>
</span><span id="Topology-146"><a href="#Topology-146"><span class="linenos"> 146</span></a><span class="s2">            Examine .tiles, .points and .edges for more details.&quot;&quot;&quot;</span><span class="p">)</span>
</span><span id="Topology-147"><a href="#Topology-147"><span class="linenos"> 147</span></a>
</span><span id="Topology-148"><a href="#Topology-148"><span class="linenos"> 148</span></a>
</span><span id="Topology-149"><a href="#Topology-149"><span class="linenos"> 149</span></a>  <span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="Topology-150"><a href="#Topology-150"><span class="linenos"> 150</span></a>    <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="Topology-151"><a href="#Topology-151"><span class="linenos"> 151</span></a>
</span><span id="Topology-152"><a href="#Topology-152"><span class="linenos"> 152</span></a>
</span><span id="Topology-153"><a href="#Topology-153"><span class="linenos"> 153</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">_initialise_points_into_tiles</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">debug</span><span class="p">:</span><span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Topology-154"><a href="#Topology-154"><span class="linenos"> 154</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Set up dictionary of unique point locations and assign them to Tiles.</span>
</span><span id="Topology-155"><a href="#Topology-155"><span class="linenos"> 155</span></a>
</span><span id="Topology-156"><a href="#Topology-156"><span class="linenos"> 156</span></a><span class="sd">    Args:</span>
</span><span id="Topology-157"><a href="#Topology-157"><span class="linenos"> 157</span></a><span class="sd">      debug (bool): if True prints useful debugging information.</span>
</span><span id="Topology-158"><a href="#Topology-158"><span class="linenos"> 158</span></a>
</span><span id="Topology-159"><a href="#Topology-159"><span class="linenos"> 159</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Topology-160"><a href="#Topology-160"><span class="linenos"> 160</span></a>    <span class="n">shapes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tileable</span><span class="o">.</span><span class="n">get_local_patch</span><span class="p">(</span><span class="n">r</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">include_0</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">geometry</span>
</span><span id="Topology-161"><a href="#Topology-161"><span class="linenos"> 161</span></a>    <span class="n">shapes</span> <span class="o">=</span> <span class="p">[</span><span class="n">tiling_utils</span><span class="o">.</span><span class="n">get_clean_polygon</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">shapes</span><span class="p">]</span>
</span><span id="Topology-162"><a href="#Topology-162"><span class="linenos"> 162</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">n_1_order_patch</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">shapes</span><span class="p">)</span>
</span><span id="Topology-163"><a href="#Topology-163"><span class="linenos"> 163</span></a>    <span class="n">labels</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tileable</span><span class="o">.</span><span class="n">tiles</span><span class="o">.</span><span class="n">tile_id</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">shapes</span><span class="p">)</span> <span class="o">//</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_tiles</span><span class="p">)</span>
</span><span id="Topology-164"><a href="#Topology-164"><span class="linenos"> 164</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">tiles</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Topology-165"><a href="#Topology-165"><span class="linenos"> 165</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">points</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="Topology-166"><a href="#Topology-166"><span class="linenos"> 166</span></a>    <span class="k">for</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">shape</span><span class="p">),</span> <span class="n">label</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="nb">enumerate</span><span class="p">(</span><span class="n">shapes</span><span class="p">),</span> <span class="n">labels</span><span class="p">,</span> <span class="n">strict</span> <span class="o">=</span> <span class="kc">True</span><span class="p">):</span>
</span><span id="Topology-167"><a href="#Topology-167"><span class="linenos"> 167</span></a>      <span class="n">tile</span> <span class="o">=</span> <span class="n">Tile</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</span><span id="Topology-168"><a href="#Topology-168"><span class="linenos"> 168</span></a>      <span class="n">tile</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="n">label</span>
</span><span id="Topology-169"><a href="#Topology-169"><span class="linenos"> 169</span></a>      <span class="n">tile</span><span class="o">.</span><span class="n">base_ID</span> <span class="o">=</span> <span class="n">tile</span><span class="o">.</span><span class="n">ID</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_tiles</span>
</span><span id="Topology-170"><a href="#Topology-170"><span class="linenos"> 170</span></a>      <span class="bp">self</span><span class="o">.</span><span class="n">tiles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tile</span><span class="p">)</span>
</span><span id="Topology-171"><a href="#Topology-171"><span class="linenos"> 171</span></a>      <span class="n">tile</span><span class="o">.</span><span class="n">corners</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Topology-172"><a href="#Topology-172"><span class="linenos"> 172</span></a>      <span class="n">corners</span> <span class="o">=</span> <span class="n">tiling_utils</span><span class="o">.</span><span class="n">get_corners</span><span class="p">(</span><span class="n">shape</span><span class="p">,</span> <span class="n">repeat_first</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
</span><span id="Topology-173"><a href="#Topology-173"><span class="linenos"> 173</span></a>      <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">corners</span><span class="p">:</span>
</span><span id="Topology-174"><a href="#Topology-174"><span class="linenos"> 174</span></a>        <span class="n">prev_vertex</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Topology-175"><a href="#Topology-175"><span class="linenos"> 175</span></a>        <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">points</span><span class="o">.</span><span class="n">values</span><span class="p">()):</span>
</span><span id="Topology-176"><a href="#Topology-176"><span class="linenos"> 176</span></a>          <span class="k">if</span> <span class="n">c</span><span class="o">.</span><span class="n">distance</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">point</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">tiling_utils</span><span class="o">.</span><span class="n">RESOLUTION</span><span class="p">:</span>
</span><span id="Topology-177"><a href="#Topology-177"><span class="linenos"> 177</span></a>            <span class="c1"># found an already existing vertex, so add to the tile and break</span>
</span><span id="Topology-178"><a href="#Topology-178"><span class="linenos"> 178</span></a>            <span class="n">prev_vertex</span> <span class="o">=</span> <span class="n">p</span>
</span><span id="Topology-179"><a href="#Topology-179"><span class="linenos"> 179</span></a>            <span class="n">tile</span><span class="o">.</span><span class="n">corners</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">prev_vertex</span><span class="p">)</span>
</span><span id="Topology-180"><a href="#Topology-180"><span class="linenos"> 180</span></a>            <span class="k">break</span>
</span><span id="Topology-181"><a href="#Topology-181"><span class="linenos"> 181</span></a>        <span class="k">if</span> <span class="n">prev_vertex</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Topology-182"><a href="#Topology-182"><span class="linenos"> 182</span></a>          <span class="c1"># new vertex, add it to the topology dictionary and to the tile</span>
</span><span id="Topology-183"><a href="#Topology-183"><span class="linenos"> 183</span></a>          <span class="n">v</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_vertex</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
</span><span id="Topology-184"><a href="#Topology-184"><span class="linenos"> 184</span></a>          <span class="n">tile</span><span class="o">.</span><span class="n">corners</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
</span><span id="Topology-185"><a href="#Topology-185"><span class="linenos"> 185</span></a>          <span class="k">if</span> <span class="n">debug</span><span class="p">:</span>
</span><span id="Topology-186"><a href="#Topology-186"><span class="linenos"> 186</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Added new Vertex </span><span class="si">{</span><span class="n">v</span><span class="si">}</span><span class="s2"> to Tile </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="Topology-187"><a href="#Topology-187"><span class="linenos"> 187</span></a>
</span><span id="Topology-188"><a href="#Topology-188"><span class="linenos"> 188</span></a>
</span><span id="Topology-189"><a href="#Topology-189"><span class="linenos"> 189</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">_setup_vertex_tile_relations</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">debug</span><span class="p">:</span><span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Topology-190"><a href="#Topology-190"><span class="linenos"> 190</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Determine relations between vertices and tiles.</span>
</span><span id="Topology-191"><a href="#Topology-191"><span class="linenos"> 191</span></a>
</span><span id="Topology-192"><a href="#Topology-192"><span class="linenos"> 192</span></a><span class="sd">    In particular vertices along tile edges that are not yet included in their</span>
</span><span id="Topology-193"><a href="#Topology-193"><span class="linenos"> 193</span></a><span class="sd">    list of vertices are added. Meanwhile vertex lists of incident tiles and</span>
</span><span id="Topology-194"><a href="#Topology-194"><span class="linenos"> 194</span></a><span class="sd">    neighbours are set up.</span>
</span><span id="Topology-195"><a href="#Topology-195"><span class="linenos"> 195</span></a>
</span><span id="Topology-196"><a href="#Topology-196"><span class="linenos"> 196</span></a><span class="sd">    Args:</span>
</span><span id="Topology-197"><a href="#Topology-197"><span class="linenos"> 197</span></a><span class="sd">      debug (bool): if True prints debugging information.</span>
</span><span id="Topology-198"><a href="#Topology-198"><span class="linenos"> 198</span></a>
</span><span id="Topology-199"><a href="#Topology-199"><span class="linenos"> 199</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Topology-200"><a href="#Topology-200"><span class="linenos"> 200</span></a>    <span class="c1"># we do this for all tiles in the radius-1 local patch</span>
</span><span id="Topology-201"><a href="#Topology-201"><span class="linenos"> 201</span></a>    <span class="k">for</span> <span class="n">tile</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tiles</span><span class="p">:</span>
</span><span id="Topology-202"><a href="#Topology-202"><span class="linenos"> 202</span></a>      <span class="k">if</span> <span class="n">debug</span><span class="p">:</span>
</span><span id="Topology-203"><a href="#Topology-203"><span class="linenos"> 203</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Checking for vertices incident on Tile </span><span class="si">{</span><span class="n">tile</span><span class="o">.</span><span class="n">ID</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="Topology-204"><a href="#Topology-204"><span class="linenos"> 204</span></a>      <span class="n">corners</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Topology-205"><a href="#Topology-205"><span class="linenos"> 205</span></a>      <span class="c1"># performance is much improved using the vertex IDs</span>
</span><span id="Topology-206"><a href="#Topology-206"><span class="linenos"> 206</span></a>      <span class="n">initial_corner_IDs</span> <span class="o">=</span> <span class="n">tile</span><span class="o">.</span><span class="n">get_corner_IDs</span><span class="p">()</span>
</span><span id="Topology-207"><a href="#Topology-207"><span class="linenos"> 207</span></a>      <span class="c1"># we need the current shape (not yet set) to check for incident vertices</span>
</span><span id="Topology-208"><a href="#Topology-208"><span class="linenos"> 208</span></a>      <span class="n">shape</span> <span class="o">=</span> <span class="n">geom</span><span class="o">.</span><span class="n">Polygon</span><span class="p">([</span><span class="n">c</span><span class="o">.</span><span class="n">point</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">tile</span><span class="o">.</span><span class="n">corners</span><span class="p">])</span>
</span><span id="Topology-209"><a href="#Topology-209"><span class="linenos"> 209</span></a>      <span class="c1"># get points incident on tile boundary, not already in the tile corners</span>
</span><span id="Topology-210"><a href="#Topology-210"><span class="linenos"> 210</span></a>      <span class="n">new_points</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">points</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
</span><span id="Topology-211"><a href="#Topology-211"><span class="linenos"> 211</span></a>                    <span class="k">if</span> <span class="n">v</span><span class="o">.</span><span class="n">ID</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">initial_corner_IDs</span> <span class="ow">and</span>
</span><span id="Topology-212"><a href="#Topology-212"><span class="linenos"> 212</span></a>                    <span class="n">v</span><span class="o">.</span><span class="n">point</span><span class="o">.</span><span class="n">distance</span><span class="p">(</span><span class="n">shape</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">tiling_utils</span><span class="o">.</span><span class="n">RESOLUTION</span><span class="p">]</span>
</span><span id="Topology-213"><a href="#Topology-213"><span class="linenos"> 213</span></a>      <span class="c1"># iterate over sides of the tile to see which the vertex is incident on</span>
</span><span id="Topology-214"><a href="#Topology-214"><span class="linenos"> 214</span></a>      <span class="k">for</span> <span class="n">c1</span><span class="p">,</span> <span class="n">c2</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">tile</span><span class="o">.</span><span class="n">corners</span><span class="p">,</span> <span class="n">tile</span><span class="o">.</span><span class="n">corners</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">+</span> <span class="n">tile</span><span class="o">.</span><span class="n">corners</span><span class="p">[:</span><span class="mi">1</span><span class="p">],</span>
</span><span id="Topology-215"><a href="#Topology-215"><span class="linenos"> 215</span></a>                        <span class="n">strict</span> <span class="o">=</span> <span class="kc">True</span><span class="p">):</span>
</span><span id="Topology-216"><a href="#Topology-216"><span class="linenos"> 216</span></a>        <span class="n">all_points</span> <span class="o">=</span> <span class="p">[</span><span class="n">c1</span><span class="p">,</span> <span class="n">c2</span><span class="p">]</span>
</span><span id="Topology-217"><a href="#Topology-217"><span class="linenos"> 217</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_points</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Topology-218"><a href="#Topology-218"><span class="linenos"> 218</span></a>          <span class="k">if</span> <span class="n">debug</span><span class="p">:</span>
</span><span id="Topology-219"><a href="#Topology-219"><span class="linenos"> 219</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="p">[</span><span class="n">v</span><span class="o">.</span><span class="n">ID</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">v</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">new_points</span><span class="p">]</span><span class="si">}</span><span class="s2"> incident on tile&quot;</span><span class="p">)</span>
</span><span id="Topology-220"><a href="#Topology-220"><span class="linenos"> 220</span></a>          <span class="n">ls</span> <span class="o">=</span> <span class="n">geom</span><span class="o">.</span><span class="n">LineString</span><span class="p">([</span><span class="n">c1</span><span class="o">.</span><span class="n">point</span><span class="p">,</span> <span class="n">c2</span><span class="o">.</span><span class="n">point</span><span class="p">])</span>
</span><span id="Topology-221"><a href="#Topology-221"><span class="linenos"> 221</span></a>          <span class="n">to_insert</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">new_points</span>
</span><span id="Topology-222"><a href="#Topology-222"><span class="linenos"> 222</span></a>                       <span class="k">if</span> <span class="n">v</span><span class="o">.</span><span class="n">point</span><span class="o">.</span><span class="n">distance</span><span class="p">(</span><span class="n">ls</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">tiling_utils</span><span class="o">.</span><span class="n">RESOLUTION</span><span class="p">]</span>
</span><span id="Topology-223"><a href="#Topology-223"><span class="linenos"> 223</span></a>          <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">to_insert</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Topology-224"><a href="#Topology-224"><span class="linenos"> 224</span></a>            <span class="c1"># sort by distance along the side</span>
</span><span id="Topology-225"><a href="#Topology-225"><span class="linenos"> 225</span></a>            <span class="n">d_along</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">([(</span><span class="n">ls</span><span class="o">.</span><span class="n">line_locate_point</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">point</span><span class="p">),</span> <span class="n">v</span><span class="p">)</span>
</span><span id="Topology-226"><a href="#Topology-226"><span class="linenos"> 226</span></a>                              <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">to_insert</span><span class="p">],</span> <span class="n">key</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="Topology-227"><a href="#Topology-227"><span class="linenos"> 227</span></a>            <span class="n">to_insert</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span> <span class="k">for</span> <span class="n">d</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">d_along</span><span class="p">]</span>
</span><span id="Topology-228"><a href="#Topology-228"><span class="linenos"> 228</span></a>            <span class="n">all_points</span> <span class="o">=</span> <span class="n">all_points</span><span class="p">[:</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">to_insert</span> <span class="o">+</span> <span class="n">all_points</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
</span><span id="Topology-229"><a href="#Topology-229"><span class="linenos"> 229</span></a>        <span class="n">corners</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">all_points</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</span><span id="Topology-230"><a href="#Topology-230"><span class="linenos"> 230</span></a>        <span class="k">for</span> <span class="n">x1</span><span class="p">,</span> <span class="n">x2</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">all_points</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">all_points</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">strict</span> <span class="o">=</span> <span class="kc">True</span><span class="p">):</span>
</span><span id="Topology-231"><a href="#Topology-231"><span class="linenos"> 231</span></a>          <span class="c1"># x2 will add the tile and neigbour when we get to the next side</span>
</span><span id="Topology-232"><a href="#Topology-232"><span class="linenos"> 232</span></a>          <span class="c1"># every vertex gets a turn!</span>
</span><span id="Topology-233"><a href="#Topology-233"><span class="linenos"> 233</span></a>          <span class="n">x1</span><span class="o">.</span><span class="n">add_tile</span><span class="p">(</span><span class="n">tile</span><span class="p">)</span>
</span><span id="Topology-234"><a href="#Topology-234"><span class="linenos"> 234</span></a>          <span class="n">x1</span><span class="o">.</span><span class="n">add_neighbour</span><span class="p">(</span><span class="n">x2</span><span class="o">.</span><span class="n">ID</span><span class="p">)</span>
</span><span id="Topology-235"><a href="#Topology-235"><span class="linenos"> 235</span></a>      <span class="n">tile</span><span class="o">.</span><span class="n">corners</span> <span class="o">=</span> <span class="n">corners</span>
</span><span id="Topology-236"><a href="#Topology-236"><span class="linenos"> 236</span></a>      <span class="n">tile</span><span class="o">.</span><span class="n">set_shape_from_corners</span><span class="p">()</span>
</span><span id="Topology-237"><a href="#Topology-237"><span class="linenos"> 237</span></a>
</span><span id="Topology-238"><a href="#Topology-238"><span class="linenos"> 238</span></a>
</span><span id="Topology-239"><a href="#Topology-239"><span class="linenos"> 239</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">_setup_edges</span><span class="p">(</span>
</span><span id="Topology-240"><a href="#Topology-240"><span class="linenos"> 240</span></a>      <span class="bp">self</span><span class="p">,</span>
</span><span id="Topology-241"><a href="#Topology-241"><span class="linenos"> 241</span></a>      <span class="n">debug</span><span class="p">:</span><span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="Topology-242"><a href="#Topology-242"><span class="linenos"> 242</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Topology-243"><a href="#Topology-243"><span class="linenos"> 243</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Set up the tiling edges.</span>
</span><span id="Topology-244"><a href="#Topology-244"><span class="linenos"> 244</span></a>
</span><span id="Topology-245"><a href="#Topology-245"><span class="linenos"> 245</span></a><span class="sd">    First vertices in the base tiles are classified as tiling vertices or not -</span>
</span><span id="Topology-246"><a href="#Topology-246"><span class="linenos"> 246</span></a><span class="sd">    only these can be classified reliably (e.g vertices on the perimeter are</span>
</span><span id="Topology-247"><a href="#Topology-247"><span class="linenos"> 247</span></a><span class="sd">    tricky).. Up to here all vertices have been considered tiling vertices.</span>
</span><span id="Topology-248"><a href="#Topology-248"><span class="linenos"> 248</span></a>
</span><span id="Topology-249"><a href="#Topology-249"><span class="linenos"> 249</span></a><span class="sd">    Second edges are created by traversing tile corner lists. Edges are stored</span>
</span><span id="Topology-250"><a href="#Topology-250"><span class="linenos"> 250</span></a><span class="sd">    once only by checking for edges in the reverse direction already in the</span>
</span><span id="Topology-251"><a href="#Topology-251"><span class="linenos"> 251</span></a><span class="sd">    edges dictionary. Edge right and left tiles are initialised.</span>
</span><span id="Topology-252"><a href="#Topology-252"><span class="linenos"> 252</span></a>
</span><span id="Topology-253"><a href="#Topology-253"><span class="linenos"> 253</span></a><span class="sd">    Third tile edge direction lists are initialised.</span>
</span><span id="Topology-254"><a href="#Topology-254"><span class="linenos"> 254</span></a>
</span><span id="Topology-255"><a href="#Topology-255"><span class="linenos"> 255</span></a><span class="sd">    Args:</span>
</span><span id="Topology-256"><a href="#Topology-256"><span class="linenos"> 256</span></a><span class="sd">      debug (bool): if True print debug messages. Defaults to False.</span>
</span><span id="Topology-257"><a href="#Topology-257"><span class="linenos"> 257</span></a>
</span><span id="Topology-258"><a href="#Topology-258"><span class="linenos"> 258</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Topology-259"><a href="#Topology-259"><span class="linenos"> 259</span></a>    <span class="c1"># classify vertices in the base tiles</span>
</span><span id="Topology-260"><a href="#Topology-260"><span class="linenos"> 260</span></a>    <span class="k">for</span> <span class="n">tile</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tiles</span><span class="p">[:</span><span class="bp">self</span><span class="o">.</span><span class="n">n_tiles</span><span class="p">]:</span>
</span><span id="Topology-261"><a href="#Topology-261"><span class="linenos"> 261</span></a>      <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">tile</span><span class="o">.</span><span class="n">corners</span><span class="p">:</span>
</span><span id="Topology-262"><a href="#Topology-262"><span class="linenos"> 262</span></a>        <span class="n">v</span><span class="o">.</span><span class="n">is_tiling_vertex</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">neighbours</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span>
</span><span id="Topology-263"><a href="#Topology-263"><span class="linenos"> 263</span></a>    <span class="k">if</span> <span class="n">debug</span><span class="p">:</span>
</span><span id="Topology-264"><a href="#Topology-264"><span class="linenos"> 264</span></a>      <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Classified base tile vertices&quot;</span><span class="p">)</span>
</span><span id="Topology-265"><a href="#Topology-265"><span class="linenos"> 265</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">edges</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="Topology-266"><a href="#Topology-266"><span class="linenos"> 266</span></a>    <span class="k">for</span> <span class="n">tile</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tiles</span><span class="p">:</span>
</span><span id="Topology-267"><a href="#Topology-267"><span class="linenos"> 267</span></a>      <span class="k">if</span> <span class="n">debug</span><span class="p">:</span>
</span><span id="Topology-268"><a href="#Topology-268"><span class="linenos"> 268</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Adding edges from Tile </span><span class="si">{</span><span class="n">tile</span><span class="o">.</span><span class="n">ID</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="Topology-269"><a href="#Topology-269"><span class="linenos"> 269</span></a>      <span class="n">tile</span><span class="o">.</span><span class="n">edges</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Topology-270"><a href="#Topology-270"><span class="linenos"> 270</span></a>      <span class="n">vertices</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">tile</span><span class="o">.</span><span class="n">corners</span> <span class="k">if</span> <span class="n">v</span><span class="o">.</span><span class="n">is_tiling_vertex</span><span class="p">]</span>
</span><span id="Topology-271"><a href="#Topology-271"><span class="linenos"> 271</span></a>      <span class="c1"># note that through here finding ints in lists is much faster than</span>
</span><span id="Topology-272"><a href="#Topology-272"><span class="linenos"> 272</span></a>      <span class="c1"># finding Vertex objects, hence we use lists of IDs not Vertex objects</span>
</span><span id="Topology-273"><a href="#Topology-273"><span class="linenos"> 273</span></a>      <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">vertices</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="Topology-274"><a href="#Topology-274"><span class="linenos"> 274</span></a>        <span class="k">for</span> <span class="n">v1</span><span class="p">,</span> <span class="n">v2</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">vertices</span><span class="p">,</span> <span class="n">vertices</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">+</span> <span class="n">vertices</span><span class="p">[:</span><span class="mi">1</span><span class="p">],</span> <span class="n">strict</span> <span class="o">=</span> <span class="kc">True</span><span class="p">):</span>
</span><span id="Topology-275"><a href="#Topology-275"><span class="linenos"> 275</span></a>          <span class="n">corner_IDs</span> <span class="o">=</span> <span class="n">tile</span><span class="o">.</span><span class="n">get_corner_IDs</span><span class="p">()</span>
</span><span id="Topology-276"><a href="#Topology-276"><span class="linenos"> 276</span></a>          <span class="n">idx1</span> <span class="o">=</span> <span class="n">corner_IDs</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">v1</span><span class="o">.</span><span class="n">ID</span><span class="p">)</span>
</span><span id="Topology-277"><a href="#Topology-277"><span class="linenos"> 277</span></a>          <span class="n">idx2</span> <span class="o">=</span> <span class="n">corner_IDs</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">v2</span><span class="o">.</span><span class="n">ID</span><span class="p">)</span>
</span><span id="Topology-278"><a href="#Topology-278"><span class="linenos"> 278</span></a>          <span class="k">if</span> <span class="n">idx1</span> <span class="o">&lt;</span> <span class="n">idx2</span><span class="p">:</span>
</span><span id="Topology-279"><a href="#Topology-279"><span class="linenos"> 279</span></a>            <span class="n">corners</span> <span class="o">=</span> <span class="n">corner_IDs</span><span class="p">[</span><span class="n">idx1</span><span class="p">:(</span><span class="n">idx2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span>
</span><span id="Topology-280"><a href="#Topology-280"><span class="linenos"> 280</span></a>          <span class="k">else</span><span class="p">:</span>
</span><span id="Topology-281"><a href="#Topology-281"><span class="linenos"> 281</span></a>            <span class="n">corners</span> <span class="o">=</span> <span class="n">corner_IDs</span><span class="p">[</span><span class="n">idx1</span><span class="p">:]</span> <span class="o">+</span> <span class="n">corner_IDs</span><span class="p">[:(</span><span class="n">idx2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span>
</span><span id="Topology-282"><a href="#Topology-282"><span class="linenos"> 282</span></a>          <span class="n">ID</span> <span class="o">=</span> <span class="p">(</span><span class="n">corners</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">corners</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</span><span id="Topology-283"><a href="#Topology-283"><span class="linenos"> 283</span></a>          <span class="k">if</span> <span class="n">ID</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">:</span>
</span><span id="Topology-284"><a href="#Topology-284"><span class="linenos"> 284</span></a>            <span class="c1"># check that reverse direction edge is not present first</span>
</span><span id="Topology-285"><a href="#Topology-285"><span class="linenos"> 285</span></a>            <span class="n">r_ID</span> <span class="o">=</span> <span class="n">ID</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="Topology-286"><a href="#Topology-286"><span class="linenos"> 286</span></a>            <span class="k">if</span> <span class="n">r_ID</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">:</span>
</span><span id="Topology-287"><a href="#Topology-287"><span class="linenos"> 287</span></a>              <span class="c1"># if it is, then add it and set left_tile</span>
</span><span id="Topology-288"><a href="#Topology-288"><span class="linenos"> 288</span></a>              <span class="k">if</span> <span class="n">debug</span><span class="p">:</span>
</span><span id="Topology-289"><a href="#Topology-289"><span class="linenos"> 289</span></a>                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;reverse edge </span><span class="si">{</span><span class="n">r_ID</span><span class="si">}</span><span class="s2"> found&quot;</span><span class="p">)</span>
</span><span id="Topology-290"><a href="#Topology-290"><span class="linenos"> 290</span></a>              <span class="n">e</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">r_ID</span><span class="p">]</span>
</span><span id="Topology-291"><a href="#Topology-291"><span class="linenos"> 291</span></a>              <span class="n">e</span><span class="o">.</span><span class="n">left_tile</span> <span class="o">=</span> <span class="n">tile</span>
</span><span id="Topology-292"><a href="#Topology-292"><span class="linenos"> 292</span></a>              <span class="n">tile</span><span class="o">.</span><span class="n">edges</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</span><span id="Topology-293"><a href="#Topology-293"><span class="linenos"> 293</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Topology-294"><a href="#Topology-294"><span class="linenos"> 294</span></a>              <span class="c1"># we&#39;ve found a new edge so make and add it</span>
</span><span id="Topology-295"><a href="#Topology-295"><span class="linenos"> 295</span></a>              <span class="k">if</span> <span class="n">debug</span><span class="p">:</span>
</span><span id="Topology-296"><a href="#Topology-296"><span class="linenos"> 296</span></a>                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;adding new edge </span><span class="si">{</span><span class="n">corners</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="Topology-297"><a href="#Topology-297"><span class="linenos"> 297</span></a>              <span class="n">e</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_edge</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">points</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">corners</span><span class="p">])</span>
</span><span id="Topology-298"><a href="#Topology-298"><span class="linenos"> 298</span></a>              <span class="n">e</span><span class="o">.</span><span class="n">right_tile</span> <span class="o">=</span> <span class="n">tile</span>
</span><span id="Topology-299"><a href="#Topology-299"><span class="linenos"> 299</span></a>              <span class="n">tile</span><span class="o">.</span><span class="n">edges</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</span><span id="Topology-300"><a href="#Topology-300"><span class="linenos"> 300</span></a>      <span class="c1"># initialise the edge direction information in the tile</span>
</span><span id="Topology-301"><a href="#Topology-301"><span class="linenos"> 301</span></a>      <span class="n">tile</span><span class="o">.</span><span class="n">set_edge_directions</span><span class="p">()</span>
</span><span id="Topology-302"><a href="#Topology-302"><span class="linenos"> 302</span></a>
</span><span id="Topology-303"><a href="#Topology-303"><span class="linenos"> 303</span></a>
</span><span id="Topology-304"><a href="#Topology-304"><span class="linenos"> 304</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">_assign_vertex_and_edge_base_IDs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Topology-305"><a href="#Topology-305"><span class="linenos"> 305</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Assign the base_ID attributes of vertices and edges.</span>
</span><span id="Topology-306"><a href="#Topology-306"><span class="linenos"> 306</span></a>
</span><span id="Topology-307"><a href="#Topology-307"><span class="linenos"> 307</span></a><span class="sd">    These allow us to determine corrspondences between vertices and edges in</span>
</span><span id="Topology-308"><a href="#Topology-308"><span class="linenos"> 308</span></a><span class="sd">    the &#39;base&#39; tiles in the Topology tileable, and those we have added at</span>
</span><span id="Topology-309"><a href="#Topology-309"><span class="linenos"> 309</span></a><span class="sd">    radius 1 for labelling and visualisation.</span>
</span><span id="Topology-310"><a href="#Topology-310"><span class="linenos"> 310</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Topology-311"><a href="#Topology-311"><span class="linenos"> 311</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_assign_vertex_base_IDs</span><span class="p">()</span>
</span><span id="Topology-312"><a href="#Topology-312"><span class="linenos"> 312</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_assign_edge_base_IDs</span><span class="p">()</span>
</span><span id="Topology-313"><a href="#Topology-313"><span class="linenos"> 313</span></a>
</span><span id="Topology-314"><a href="#Topology-314"><span class="linenos"> 314</span></a>
</span><span id="Topology-315"><a href="#Topology-315"><span class="linenos"> 315</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">_assign_vertex_base_IDs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Topology-316"><a href="#Topology-316"><span class="linenos"> 316</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Assign base_ID attribute of vertices.&quot;&quot;&quot;</span>
</span><span id="Topology-317"><a href="#Topology-317"><span class="linenos"> 317</span></a>    <span class="c1"># assign vertex base_ID frome the core tiles</span>
</span><span id="Topology-318"><a href="#Topology-318"><span class="linenos"> 318</span></a>    <span class="k">for</span> <span class="n">tile0</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tiles</span><span class="p">[:</span><span class="bp">self</span><span class="o">.</span><span class="n">n_tiles</span><span class="p">]:</span>
</span><span id="Topology-319"><a href="#Topology-319"><span class="linenos"> 319</span></a>      <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">tile0</span><span class="o">.</span><span class="n">get_corner_IDs</span><span class="p">():</span>
</span><span id="Topology-320"><a href="#Topology-320"><span class="linenos"> 320</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">points</span><span class="p">[</span><span class="n">v</span><span class="p">]</span><span class="o">.</span><span class="n">base_ID</span> <span class="o">=</span> <span class="n">v</span>
</span><span id="Topology-321"><a href="#Topology-321"><span class="linenos"> 321</span></a>    <span class="c1"># assign others from their corresponding vertex in the core</span>
</span><span id="Topology-322"><a href="#Topology-322"><span class="linenos"> 322</span></a>    <span class="k">for</span> <span class="n">t0</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tiles</span><span class="p">[:</span><span class="bp">self</span><span class="o">.</span><span class="n">n_tiles</span><span class="p">]:</span>
</span><span id="Topology-323"><a href="#Topology-323"><span class="linenos"> 323</span></a>      <span class="k">for</span> <span class="n">t1</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tiles</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">n_tiles</span><span class="p">:]:</span>
</span><span id="Topology-324"><a href="#Topology-324"><span class="linenos"> 324</span></a>        <span class="k">if</span> <span class="n">t1</span><span class="o">.</span><span class="n">base_ID</span> <span class="o">==</span> <span class="n">t0</span><span class="o">.</span><span class="n">base_ID</span><span class="p">:</span>
</span><span id="Topology-325"><a href="#Topology-325"><span class="linenos"> 325</span></a>          <span class="k">for</span> <span class="n">v0</span><span class="p">,</span> <span class="n">v1</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">t0</span><span class="o">.</span><span class="n">corners</span><span class="p">,</span> <span class="n">t1</span><span class="o">.</span><span class="n">corners</span><span class="p">,</span> <span class="n">strict</span> <span class="o">=</span> <span class="kc">True</span><span class="p">):</span>
</span><span id="Topology-326"><a href="#Topology-326"><span class="linenos"> 326</span></a>            <span class="n">v1</span><span class="o">.</span><span class="n">base_ID</span> <span class="o">=</span> <span class="n">v0</span><span class="o">.</span><span class="n">base_ID</span>
</span><span id="Topology-327"><a href="#Topology-327"><span class="linenos"> 327</span></a>
</span><span id="Topology-328"><a href="#Topology-328"><span class="linenos"> 328</span></a>
</span><span id="Topology-329"><a href="#Topology-329"><span class="linenos"> 329</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">_assign_edge_base_IDs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Topology-330"><a href="#Topology-330"><span class="linenos"> 330</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Assign base_ID attribute of edges, based on base_IDs of vertices.&quot;&quot;&quot;</span>
</span><span id="Topology-331"><a href="#Topology-331"><span class="linenos"> 331</span></a>    <span class="k">for</span> <span class="n">tile0</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tiles</span><span class="p">[:</span><span class="bp">self</span><span class="o">.</span><span class="n">n_tiles</span><span class="p">]:</span>
</span><span id="Topology-332"><a href="#Topology-332"><span class="linenos"> 332</span></a>      <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">tile0</span><span class="o">.</span><span class="n">get_edge_IDs</span><span class="p">():</span>
</span><span id="Topology-333"><a href="#Topology-333"><span class="linenos"> 333</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">e</span><span class="p">]</span><span class="o">.</span><span class="n">base_ID</span> <span class="o">=</span> <span class="n">e</span>
</span><span id="Topology-334"><a href="#Topology-334"><span class="linenos"> 334</span></a>    <span class="k">for</span> <span class="n">t0</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tiles</span><span class="p">[:</span><span class="bp">self</span><span class="o">.</span><span class="n">n_tiles</span><span class="p">]:</span>
</span><span id="Topology-335"><a href="#Topology-335"><span class="linenos"> 335</span></a>      <span class="k">for</span> <span class="n">t1</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tiles</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">n_tiles</span><span class="p">:]:</span>
</span><span id="Topology-336"><a href="#Topology-336"><span class="linenos"> 336</span></a>        <span class="k">if</span> <span class="n">t1</span><span class="o">.</span><span class="n">base_ID</span> <span class="o">==</span> <span class="n">t0</span><span class="o">.</span><span class="n">base_ID</span><span class="p">:</span>
</span><span id="Topology-337"><a href="#Topology-337"><span class="linenos"> 337</span></a>          <span class="k">for</span> <span class="n">e0</span><span class="p">,</span> <span class="n">e1</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">t0</span><span class="o">.</span><span class="n">edges</span><span class="p">,</span> <span class="n">t1</span><span class="o">.</span><span class="n">edges</span><span class="p">,</span> <span class="n">strict</span> <span class="o">=</span> <span class="kc">True</span><span class="p">):</span>
</span><span id="Topology-338"><a href="#Topology-338"><span class="linenos"> 338</span></a>            <span class="n">e1</span><span class="o">.</span><span class="n">base_ID</span> <span class="o">=</span> <span class="n">e0</span><span class="o">.</span><span class="n">base_ID</span>
</span><span id="Topology-339"><a href="#Topology-339"><span class="linenos"> 339</span></a>
</span><span id="Topology-340"><a href="#Topology-340"><span class="linenos"> 340</span></a>
</span><span id="Topology-341"><a href="#Topology-341"><span class="linenos"> 341</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">_copy_base_tiles_to_patch</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Topology-342"><a href="#Topology-342"><span class="linenos"> 342</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Copy attributes of base tiles to corresponding tiles in radius-1 patch.</span>
</span><span id="Topology-343"><a href="#Topology-343"><span class="linenos"> 343</span></a>
</span><span id="Topology-344"><a href="#Topology-344"><span class="linenos"> 344</span></a><span class="sd">    This requires:</span>
</span><span id="Topology-345"><a href="#Topology-345"><span class="linenos"> 345</span></a>
</span><span id="Topology-346"><a href="#Topology-346"><span class="linenos"> 346</span></a><span class="sd">    First, inserting any additional corners in the base tiles not found in the</span>
</span><span id="Topology-347"><a href="#Topology-347"><span class="linenos"> 347</span></a><span class="sd">    radius-1 tiles.</span>
</span><span id="Topology-348"><a href="#Topology-348"><span class="linenos"> 348</span></a>
</span><span id="Topology-349"><a href="#Topology-349"><span class="linenos"> 349</span></a><span class="sd">    Second, any vertices in the base tiles that are NOT tiling vertices are</span>
</span><span id="Topology-350"><a href="#Topology-350"><span class="linenos"> 350</span></a><span class="sd">    applied to radius-1 tiles leading to merging of some edges.</span>
</span><span id="Topology-351"><a href="#Topology-351"><span class="linenos"> 351</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Topology-352"><a href="#Topology-352"><span class="linenos"> 352</span></a>    <span class="c1"># the number of tiles in the base + radius-1</span>
</span><span id="Topology-353"><a href="#Topology-353"><span class="linenos"> 353</span></a>    <span class="n">n_r1</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tiles</span><span class="p">)</span>
</span><span id="Topology-354"><a href="#Topology-354"><span class="linenos"> 354</span></a>    <span class="c1"># first add any missing vertices to the non-base tiles</span>
</span><span id="Topology-355"><a href="#Topology-355"><span class="linenos"> 355</span></a>    <span class="c1"># we add all the missing vertices before doing any merges</span>
</span><span id="Topology-356"><a href="#Topology-356"><span class="linenos"> 356</span></a>    <span class="k">for</span> <span class="n">base</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tiles</span><span class="p">[:</span><span class="bp">self</span><span class="o">.</span><span class="n">n_tiles</span><span class="p">]:</span>
</span><span id="Topology-357"><a href="#Topology-357"><span class="linenos"> 357</span></a>      <span class="k">for</span> <span class="n">other</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tiles</span><span class="p">[</span><span class="n">base</span><span class="o">.</span><span class="n">ID</span><span class="p">:</span><span class="n">n_r1</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">n_tiles</span><span class="p">]:</span>
</span><span id="Topology-358"><a href="#Topology-358"><span class="linenos"> 358</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_match_reference_tile_vertices</span><span class="p">(</span><span class="n">base</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span>
</span><span id="Topology-359"><a href="#Topology-359"><span class="linenos"> 359</span></a>    <span class="c1"># then merge any edges that meet at a corner</span>
</span><span id="Topology-360"><a href="#Topology-360"><span class="linenos"> 360</span></a>    <span class="k">for</span> <span class="n">base</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tiles</span><span class="p">[:</span><span class="bp">self</span><span class="o">.</span><span class="n">n_tiles</span><span class="p">]:</span>
</span><span id="Topology-361"><a href="#Topology-361"><span class="linenos"> 361</span></a>      <span class="k">for</span> <span class="n">other</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tiles</span><span class="p">[</span><span class="n">base</span><span class="o">.</span><span class="n">ID</span><span class="p">:</span><span class="n">n_r1</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">n_tiles</span><span class="p">]:</span>
</span><span id="Topology-362"><a href="#Topology-362"><span class="linenos"> 362</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_match_reference_tile_corners</span><span class="p">(</span><span class="n">base</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span>
</span><span id="Topology-363"><a href="#Topology-363"><span class="linenos"> 363</span></a>
</span><span id="Topology-364"><a href="#Topology-364"><span class="linenos"> 364</span></a>
</span><span id="Topology-365"><a href="#Topology-365"><span class="linenos"> 365</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">_match_reference_tile_vertices</span><span class="p">(</span>
</span><span id="Topology-366"><a href="#Topology-366"><span class="linenos"> 366</span></a>      <span class="bp">self</span><span class="p">,</span>
</span><span id="Topology-367"><a href="#Topology-367"><span class="linenos"> 367</span></a>      <span class="n">tile1</span><span class="p">:</span><span class="n">Tile</span><span class="p">,</span>
</span><span id="Topology-368"><a href="#Topology-368"><span class="linenos"> 368</span></a>      <span class="n">tile2</span><span class="p">:</span><span class="n">Tile</span><span class="p">,</span>
</span><span id="Topology-369"><a href="#Topology-369"><span class="linenos"> 369</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Topology-370"><a href="#Topology-370"><span class="linenos"> 370</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Add vertices to tile2 so it matches tile1 adjusting edges as required.</span>
</span><span id="Topology-371"><a href="#Topology-371"><span class="linenos"> 371</span></a>
</span><span id="Topology-372"><a href="#Topology-372"><span class="linenos"> 372</span></a><span class="sd">    This assumes the tiles are the same shape, but that tile2 may be missing</span>
</span><span id="Topology-373"><a href="#Topology-373"><span class="linenos"> 373</span></a><span class="sd">    some tiling vertices along some edges.</span>
</span><span id="Topology-374"><a href="#Topology-374"><span class="linenos"> 374</span></a>
</span><span id="Topology-375"><a href="#Topology-375"><span class="linenos"> 375</span></a><span class="sd">    Args:</span>
</span><span id="Topology-376"><a href="#Topology-376"><span class="linenos"> 376</span></a><span class="sd">      tile1 (Tile): reference tile.</span>
</span><span id="Topology-377"><a href="#Topology-377"><span class="linenos"> 377</span></a><span class="sd">      tile2 (Tile): tile to change.</span>
</span><span id="Topology-378"><a href="#Topology-378"><span class="linenos"> 378</span></a>
</span><span id="Topology-379"><a href="#Topology-379"><span class="linenos"> 379</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Topology-380"><a href="#Topology-380"><span class="linenos"> 380</span></a>    <span class="n">to_add</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">tile1</span><span class="o">.</span><span class="n">corners</span><span class="p">)</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">tile2</span><span class="o">.</span><span class="n">corners</span><span class="p">)</span>
</span><span id="Topology-381"><a href="#Topology-381"><span class="linenos"> 381</span></a>    <span class="k">while</span> <span class="n">to_add</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Topology-382"><a href="#Topology-382"><span class="linenos"> 382</span></a>      <span class="c1"># find the reference x-y offset</span>
</span><span id="Topology-383"><a href="#Topology-383"><span class="linenos"> 383</span></a>      <span class="n">dxy</span> <span class="o">=</span> <span class="p">(</span><span class="n">tile2</span><span class="o">.</span><span class="n">centre</span><span class="o">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">tile1</span><span class="o">.</span><span class="n">centre</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">tile2</span><span class="o">.</span><span class="n">centre</span><span class="o">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">tile1</span><span class="o">.</span><span class="n">centre</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
</span><span id="Topology-384"><a href="#Topology-384"><span class="linenos"> 384</span></a>      <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">t1c</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">([</span><span class="n">c</span><span class="o">.</span><span class="n">point</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">tile1</span><span class="o">.</span><span class="n">corners</span><span class="p">]):</span>
</span><span id="Topology-385"><a href="#Topology-385"><span class="linenos"> 385</span></a>        <span class="n">t2c</span> <span class="o">=</span> <span class="n">tile2</span><span class="o">.</span><span class="n">corners</span><span class="p">[</span><span class="n">i</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">tile2</span><span class="o">.</span><span class="n">corners</span><span class="p">)]</span><span class="o">.</span><span class="n">point</span>
</span><span id="Topology-386"><a href="#Topology-386"><span class="linenos"> 386</span></a>        <span class="k">if</span> <span class="nb">abs</span><span class="p">((</span><span class="n">t2c</span><span class="o">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">t1c</span><span class="o">.</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="n">dxy</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">tiling_utils</span><span class="o">.</span><span class="n">RESOLUTION</span> <span class="ow">or</span> \
</span><span id="Topology-387"><a href="#Topology-387"><span class="linenos"> 387</span></a>           <span class="nb">abs</span><span class="p">((</span><span class="n">t2c</span><span class="o">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">t1c</span><span class="o">.</span><span class="n">y</span><span class="p">)</span> <span class="o">-</span> <span class="n">dxy</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">tiling_utils</span><span class="o">.</span><span class="n">RESOLUTION</span><span class="p">:</span>
</span><span id="Topology-388"><a href="#Topology-388"><span class="linenos"> 388</span></a>          <span class="c1"># add vertex to t2 by copying the t1 vertex appropriately offset</span>
</span><span id="Topology-389"><a href="#Topology-389"><span class="linenos"> 389</span></a>          <span class="c1"># note that this might alter the length of t2.corners</span>
</span><span id="Topology-390"><a href="#Topology-390"><span class="linenos"> 390</span></a>          <span class="n">v</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_vertex</span><span class="p">(</span><span class="n">geom</span><span class="o">.</span><span class="n">Point</span><span class="p">(</span><span class="n">t1c</span><span class="o">.</span><span class="n">x</span> <span class="o">+</span> <span class="n">dxy</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">t1c</span><span class="o">.</span><span class="n">y</span> <span class="o">+</span> <span class="n">dxy</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
</span><span id="Topology-391"><a href="#Topology-391"><span class="linenos"> 391</span></a>          <span class="n">v</span><span class="o">.</span><span class="n">is_tiling_vertex</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="Topology-392"><a href="#Topology-392"><span class="linenos"> 392</span></a>          <span class="n">old_edge</span><span class="p">,</span> <span class="n">new_edges</span> <span class="o">=</span> <span class="n">tile2</span><span class="o">.</span><span class="n">insert_vertex_at</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
</span><span id="Topology-393"><a href="#Topology-393"><span class="linenos"> 393</span></a>          <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">old_edge</span><span class="p">]</span>
</span><span id="Topology-394"><a href="#Topology-394"><span class="linenos"> 394</span></a>          <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">new_edges</span><span class="p">:</span>
</span><span id="Topology-395"><a href="#Topology-395"><span class="linenos"> 395</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">ID</span><span class="p">]</span> <span class="o">=</span> <span class="n">e</span>
</span><span id="Topology-396"><a href="#Topology-396"><span class="linenos"> 396</span></a>          <span class="n">to_add</span> <span class="o">=</span> <span class="n">to_add</span> <span class="o">-</span> <span class="mi">1</span>
</span><span id="Topology-397"><a href="#Topology-397"><span class="linenos"> 397</span></a>
</span><span id="Topology-398"><a href="#Topology-398"><span class="linenos"> 398</span></a>
</span><span id="Topology-399"><a href="#Topology-399"><span class="linenos"> 399</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">_match_reference_tile_corners</span><span class="p">(</span>
</span><span id="Topology-400"><a href="#Topology-400"><span class="linenos"> 400</span></a>      <span class="bp">self</span><span class="p">,</span>
</span><span id="Topology-401"><a href="#Topology-401"><span class="linenos"> 401</span></a>      <span class="n">tile1</span><span class="p">:</span><span class="n">Tile</span><span class="p">,</span>
</span><span id="Topology-402"><a href="#Topology-402"><span class="linenos"> 402</span></a>      <span class="n">tile2</span><span class="p">:</span><span class="n">Tile</span><span class="p">,</span>
</span><span id="Topology-403"><a href="#Topology-403"><span class="linenos"> 403</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Topology-404"><a href="#Topology-404"><span class="linenos"> 404</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Make vertices that are corners in tile1 corners in tile2.</span>
</span><span id="Topology-405"><a href="#Topology-405"><span class="linenos"> 405</span></a>
</span><span id="Topology-406"><a href="#Topology-406"><span class="linenos"> 406</span></a><span class="sd">    Edges are merged as required.</span>
</span><span id="Topology-407"><a href="#Topology-407"><span class="linenos"> 407</span></a>
</span><span id="Topology-408"><a href="#Topology-408"><span class="linenos"> 408</span></a><span class="sd">    Args:</span>
</span><span id="Topology-409"><a href="#Topology-409"><span class="linenos"> 409</span></a><span class="sd">        tile1 (Tile): reference tile.</span>
</span><span id="Topology-410"><a href="#Topology-410"><span class="linenos"> 410</span></a><span class="sd">        tile2 (Tile): tile to make match.</span>
</span><span id="Topology-411"><a href="#Topology-411"><span class="linenos"> 411</span></a>
</span><span id="Topology-412"><a href="#Topology-412"><span class="linenos"> 412</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Topology-413"><a href="#Topology-413"><span class="linenos"> 413</span></a>    <span class="n">vs_to_change</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="Topology-414"><a href="#Topology-414"><span class="linenos"> 414</span></a>      <span class="n">vj</span> <span class="k">for</span> <span class="n">vi</span><span class="p">,</span> <span class="n">vj</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">tile1</span><span class="o">.</span><span class="n">corners</span><span class="p">,</span> <span class="n">tile2</span><span class="o">.</span><span class="n">corners</span><span class="p">,</span> <span class="n">strict</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</span><span id="Topology-415"><a href="#Topology-415"><span class="linenos"> 415</span></a>      <span class="k">if</span> <span class="ow">not</span> <span class="n">vi</span><span class="o">.</span><span class="n">is_tiling_vertex</span> <span class="ow">and</span> <span class="n">vj</span><span class="o">.</span><span class="n">is_tiling_vertex</span><span class="p">]</span>
</span><span id="Topology-416"><a href="#Topology-416"><span class="linenos"> 416</span></a>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">vs_to_change</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Topology-417"><a href="#Topology-417"><span class="linenos"> 417</span></a>      <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">vs_to_change</span><span class="p">:</span>
</span><span id="Topology-418"><a href="#Topology-418"><span class="linenos"> 418</span></a>        <span class="n">v</span><span class="o">.</span><span class="n">is_tiling_vertex</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="Topology-419"><a href="#Topology-419"><span class="linenos"> 419</span></a>        <span class="c1"># it&#39;s a corner not an edge so will have no more than 2 v.tiles</span>
</span><span id="Topology-420"><a href="#Topology-420"><span class="linenos"> 420</span></a>        <span class="n">old_edges</span><span class="p">,</span> <span class="n">new_edge</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">tiles</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">merge_edges_at_vertex</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
</span><span id="Topology-421"><a href="#Topology-421"><span class="linenos"> 421</span></a>        <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">old_edges</span><span class="p">:</span>
</span><span id="Topology-422"><a href="#Topology-422"><span class="linenos"> 422</span></a>          <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">e</span><span class="p">]</span>
</span><span id="Topology-423"><a href="#Topology-423"><span class="linenos"> 423</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">new_edge</span><span class="o">.</span><span class="n">ID</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_edge</span>
</span><span id="Topology-424"><a href="#Topology-424"><span class="linenos"> 424</span></a>
</span><span id="Topology-425"><a href="#Topology-425"><span class="linenos"> 425</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">_identify_distinct_tile_shapes</span><span class="p">(</span>
</span><span id="Topology-426"><a href="#Topology-426"><span class="linenos"> 426</span></a>      <span class="bp">self</span><span class="p">,</span>
</span><span id="Topology-427"><a href="#Topology-427"><span class="linenos"> 427</span></a>      <span class="n">ignore_tile_id_labels</span><span class="p">:</span><span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="Topology-428"><a href="#Topology-428"><span class="linenos"> 428</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Topology-429"><a href="#Topology-429"><span class="linenos"> 429</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Identify unique tiles based on their symmetries and shapes.</span>
</span><span id="Topology-430"><a href="#Topology-430"><span class="linenos"> 430</span></a>
</span><span id="Topology-431"><a href="#Topology-431"><span class="linenos"> 431</span></a><span class="sd">    At the same time assembles a list of the affine transforms under which</span>
</span><span id="Topology-432"><a href="#Topology-432"><span class="linenos"> 432</span></a><span class="sd">    matches occurs since these are potential symmetries of the tiling.</span>
</span><span id="Topology-433"><a href="#Topology-433"><span class="linenos"> 433</span></a>
</span><span id="Topology-434"><a href="#Topology-434"><span class="linenos"> 434</span></a><span class="sd">    TODO: reimplement consideration of tile_id</span>
</span><span id="Topology-435"><a href="#Topology-435"><span class="linenos"> 435</span></a>
</span><span id="Topology-436"><a href="#Topology-436"><span class="linenos"> 436</span></a><span class="sd">    Args:</span>
</span><span id="Topology-437"><a href="#Topology-437"><span class="linenos"> 437</span></a><span class="sd">      ignore_tile_id_labels (bool): if True only the shape of tiles matters; if</span>
</span><span id="Topology-438"><a href="#Topology-438"><span class="linenos"> 438</span></a><span class="sd">        False the tile_id label is also considered. Defaults to True.</span>
</span><span id="Topology-439"><a href="#Topology-439"><span class="linenos"> 439</span></a>
</span><span id="Topology-440"><a href="#Topology-440"><span class="linenos"> 440</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Topology-441"><a href="#Topology-441"><span class="linenos"> 441</span></a>    <span class="k">if</span> <span class="n">ignore_tile_id_labels</span><span class="p">:</span>
</span><span id="Topology-442"><a href="#Topology-442"><span class="linenos"> 442</span></a>      <span class="n">matches</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="Topology-443"><a href="#Topology-443"><span class="linenos"> 443</span></a>      <span class="n">offsets</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="Topology-444"><a href="#Topology-444"><span class="linenos"> 444</span></a>      <span class="k">for</span> <span class="n">tile</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tiles</span><span class="p">[:</span><span class="bp">self</span><span class="o">.</span><span class="n">n_tiles</span><span class="p">]:</span>
</span><span id="Topology-445"><a href="#Topology-445"><span class="linenos"> 445</span></a>        <span class="n">matches</span><span class="p">[</span><span class="n">tile</span><span class="o">.</span><span class="n">base_ID</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">tile</span><span class="o">.</span><span class="n">base_ID</span><span class="p">]</span>
</span><span id="Topology-446"><a href="#Topology-446"><span class="linenos"> 446</span></a>        <span class="n">matched</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="Topology-447"><a href="#Topology-447"><span class="linenos"> 447</span></a>        <span class="n">s</span> <span class="o">=</span> <span class="n">Symmetries</span><span class="p">(</span><span class="n">tile</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</span><span id="Topology-448"><a href="#Topology-448"><span class="linenos"> 448</span></a>        <span class="k">for</span> <span class="n">other</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tiles</span><span class="p">[:</span><span class="bp">self</span><span class="o">.</span><span class="n">n_tiles</span><span class="p">]:</span>
</span><span id="Topology-449"><a href="#Topology-449"><span class="linenos"> 449</span></a>          <span class="k">if</span> <span class="n">other</span><span class="o">.</span><span class="n">ID</span> <span class="o">&gt;</span> <span class="n">tile</span><span class="o">.</span><span class="n">ID</span><span class="p">:</span>
</span><span id="Topology-450"><a href="#Topology-450"><span class="linenos"> 450</span></a>            <span class="n">offset</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">get_corner_offset</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</span><span id="Topology-451"><a href="#Topology-451"><span class="linenos"> 451</span></a>            <span class="k">if</span> <span class="n">offset</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Topology-452"><a href="#Topology-452"><span class="linenos"> 452</span></a>              <span class="n">offsets</span><span class="p">[</span><span class="n">tile</span><span class="o">.</span><span class="n">base_ID</span><span class="p">]</span> <span class="o">=</span> <span class="n">offset</span>
</span><span id="Topology-453"><a href="#Topology-453"><span class="linenos"> 453</span></a>              <span class="n">matches</span><span class="p">[</span><span class="n">tile</span><span class="o">.</span><span class="n">base_ID</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">base_ID</span><span class="p">)</span>
</span><span id="Topology-454"><a href="#Topology-454"><span class="linenos"> 454</span></a>              <span class="n">matched</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="Topology-455"><a href="#Topology-455"><span class="linenos"> 455</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">matched</span><span class="p">:</span>
</span><span id="Topology-456"><a href="#Topology-456"><span class="linenos"> 456</span></a>          <span class="n">offsets</span><span class="p">[</span><span class="n">tile</span><span class="o">.</span><span class="n">base_ID</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Topology-457"><a href="#Topology-457"><span class="linenos"> 457</span></a>      <span class="n">base_groups</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span>
</span><span id="Topology-458"><a href="#Topology-458"><span class="linenos"> 458</span></a>        <span class="n">nx</span><span class="o">.</span><span class="n">connected_components</span><span class="p">(</span><span class="n">nx</span><span class="o">.</span><span class="n">from_dict_of_lists</span><span class="p">(</span><span class="n">matches</span><span class="p">)))</span>
</span><span id="Topology-459"><a href="#Topology-459"><span class="linenos"> 459</span></a>      <span class="bp">self</span><span class="o">.</span><span class="n">shape_groups</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Topology-460"><a href="#Topology-460"><span class="linenos"> 460</span></a>      <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">group</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">base_groups</span><span class="p">):</span>
</span><span id="Topology-461"><a href="#Topology-461"><span class="linenos"> 461</span></a>        <span class="n">full_group</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Topology-462"><a href="#Topology-462"><span class="linenos"> 462</span></a>        <span class="k">for</span> <span class="n">tile</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tiles</span><span class="p">:</span>
</span><span id="Topology-463"><a href="#Topology-463"><span class="linenos"> 463</span></a>          <span class="k">if</span> <span class="n">tile</span><span class="o">.</span><span class="n">base_ID</span> <span class="ow">in</span> <span class="n">group</span><span class="p">:</span>
</span><span id="Topology-464"><a href="#Topology-464"><span class="linenos"> 464</span></a>            <span class="n">tile</span><span class="o">.</span><span class="n">shape_group</span> <span class="o">=</span> <span class="n">i</span>
</span><span id="Topology-465"><a href="#Topology-465"><span class="linenos"> 465</span></a>            <span class="n">tile</span><span class="o">.</span><span class="n">offset_corners</span><span class="p">(</span><span class="n">offsets</span><span class="p">[</span><span class="n">tile</span><span class="o">.</span><span class="n">base_ID</span><span class="p">])</span>
</span><span id="Topology-466"><a href="#Topology-466"><span class="linenos"> 466</span></a>            <span class="n">full_group</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tile</span><span class="o">.</span><span class="n">ID</span><span class="p">)</span>
</span><span id="Topology-467"><a href="#Topology-467"><span class="linenos"> 467</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">shape_groups</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">full_group</span><span class="p">)</span>
</span><span id="Topology-468"><a href="#Topology-468"><span class="linenos"> 468</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="Topology-469"><a href="#Topology-469"><span class="linenos"> 469</span></a>      <span class="bp">self</span><span class="o">.</span><span class="n">shape_groups</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Topology-470"><a href="#Topology-470"><span class="linenos"> 470</span></a>      <span class="k">for</span> <span class="n">ti</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tiles</span><span class="p">[:</span><span class="bp">self</span><span class="o">.</span><span class="n">n_tiles</span><span class="p">]:</span>
</span><span id="Topology-471"><a href="#Topology-471"><span class="linenos"> 471</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">shape_groups</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
</span><span id="Topology-472"><a href="#Topology-472"><span class="linenos"> 472</span></a>          <span class="p">[</span><span class="n">tj</span><span class="o">.</span><span class="n">ID</span> <span class="k">for</span> <span class="n">tj</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tiles</span> <span class="k">if</span> <span class="n">tj</span><span class="o">.</span><span class="n">base_ID</span> <span class="o">==</span> <span class="n">ti</span><span class="o">.</span><span class="n">base_ID</span><span class="p">])</span>
</span><span id="Topology-473"><a href="#Topology-473"><span class="linenos"> 473</span></a>      <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">group</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">shape_groups</span><span class="p">):</span>
</span><span id="Topology-474"><a href="#Topology-474"><span class="linenos"> 474</span></a>        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">group</span><span class="p">:</span>
</span><span id="Topology-475"><a href="#Topology-475"><span class="linenos"> 475</span></a>          <span class="bp">self</span><span class="o">.</span><span class="n">tiles</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">shape_group</span> <span class="o">=</span> <span class="n">i</span>
</span><span id="Topology-476"><a href="#Topology-476"><span class="linenos"> 476</span></a>
</span><span id="Topology-477"><a href="#Topology-477"><span class="linenos"> 477</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">_find_tile_transitivity_classes</span><span class="p">(</span>
</span><span id="Topology-478"><a href="#Topology-478"><span class="linenos"> 478</span></a>      <span class="bp">self</span><span class="p">,</span>
</span><span id="Topology-479"><a href="#Topology-479"><span class="linenos"> 479</span></a>      <span class="n">ignore_tile_id_labels</span><span class="p">:</span><span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="Topology-480"><a href="#Topology-480"><span class="linenos"> 480</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Topology-481"><a href="#Topology-481"><span class="linenos"> 481</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Find tiles equivalent under symmetries.</span>
</span><span id="Topology-482"><a href="#Topology-482"><span class="linenos"> 482</span></a>
</span><span id="Topology-483"><a href="#Topology-483"><span class="linenos"> 483</span></a><span class="sd">    Also update the tile_matching_transforms attribute to contain only those</span>
</span><span id="Topology-484"><a href="#Topology-484"><span class="linenos"> 484</span></a><span class="sd">    transforms that pass this test.</span>
</span><span id="Topology-485"><a href="#Topology-485"><span class="linenos"> 485</span></a>
</span><span id="Topology-486"><a href="#Topology-486"><span class="linenos"> 486</span></a><span class="sd">    Args:</span>
</span><span id="Topology-487"><a href="#Topology-487"><span class="linenos"> 487</span></a><span class="sd">      ignore_tile_id_labels (bool): if True then consider only shapes; if False</span>
</span><span id="Topology-488"><a href="#Topology-488"><span class="linenos"> 488</span></a><span class="sd">        also consider labels of tiles. Defaults to True.</span>
</span><span id="Topology-489"><a href="#Topology-489"><span class="linenos"> 489</span></a>
</span><span id="Topology-490"><a href="#Topology-490"><span class="linenos"> 490</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Topology-491"><a href="#Topology-491"><span class="linenos"> 491</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">tile_matching_transforms</span> <span class="o">=</span> \
</span><span id="Topology-492"><a href="#Topology-492"><span class="linenos"> 492</span></a>      <span class="bp">self</span><span class="o">.</span><span class="n">get_potential_symmetries</span><span class="p">(</span><span class="n">ignore_tile_id_labels</span><span class="p">)</span>
</span><span id="Topology-493"><a href="#Topology-493"><span class="linenos"> 493</span></a>    <span class="k">if</span> <span class="n">ignore_tile_id_labels</span><span class="p">:</span>
</span><span id="Topology-494"><a href="#Topology-494"><span class="linenos"> 494</span></a>      <span class="n">base_tiles</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tiles</span><span class="p">[:</span><span class="bp">self</span><span class="o">.</span><span class="n">n_tiles</span><span class="p">]</span>
</span><span id="Topology-495"><a href="#Topology-495"><span class="linenos"> 495</span></a>      <span class="c1"># it is quicker (should be!) to only do within shape group tests</span>
</span><span id="Topology-496"><a href="#Topology-496"><span class="linenos"> 496</span></a>      <span class="c1"># often there is only one when it will make no difference</span>
</span><span id="Topology-497"><a href="#Topology-497"><span class="linenos"> 497</span></a>      <span class="n">by_group_equivalent_tiles</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Topology-498"><a href="#Topology-498"><span class="linenos"> 498</span></a>      <span class="c1"># maintain a set of transforms still potentially tiling symmetries</span>
</span><span id="Topology-499"><a href="#Topology-499"><span class="linenos"> 499</span></a>      <span class="n">poss_transforms</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tile_matching_transforms</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
</span><span id="Topology-500"><a href="#Topology-500"><span class="linenos"> 500</span></a>      <span class="c1"># and a dictionary of booleans tracking which transforms are still valid</span>
</span><span id="Topology-501"><a href="#Topology-501"><span class="linenos"> 501</span></a>      <span class="n">eq_under_transform</span> <span class="o">=</span> <span class="nb">dict</span><span class="o">.</span><span class="n">fromkeys</span><span class="p">(</span><span class="n">poss_transforms</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
</span><span id="Topology-502"><a href="#Topology-502"><span class="linenos"> 502</span></a>      <span class="k">for</span> <span class="n">g</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">shape_groups</span><span class="p">):</span>
</span><span id="Topology-503"><a href="#Topology-503"><span class="linenos"> 503</span></a>        <span class="n">by_group_equivalent_tiles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">set</span><span class="p">())</span>
</span><span id="Topology-504"><a href="#Topology-504"><span class="linenos"> 504</span></a>        <span class="n">source_tiles</span> <span class="o">=</span> <span class="p">[</span><span class="n">tile</span> <span class="k">for</span> <span class="n">tile</span> <span class="ow">in</span> <span class="n">base_tiles</span> <span class="k">if</span> <span class="n">tile</span><span class="o">.</span><span class="n">shape_group</span> <span class="o">==</span> <span class="n">g</span><span class="p">]</span>
</span><span id="Topology-505"><a href="#Topology-505"><span class="linenos"> 505</span></a>        <span class="n">target_tiles</span> <span class="o">=</span> <span class="p">[</span><span class="n">tile</span> <span class="k">for</span> <span class="n">tile</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tiles</span> <span class="k">if</span> <span class="n">tile</span><span class="o">.</span><span class="n">shape_group</span> <span class="o">==</span> <span class="n">g</span><span class="p">]</span>
</span><span id="Topology-506"><a href="#Topology-506"><span class="linenos"> 506</span></a>        <span class="k">for</span> <span class="n">tr</span> <span class="ow">in</span> <span class="n">poss_transforms</span><span class="p">:</span>
</span><span id="Topology-507"><a href="#Topology-507"><span class="linenos"> 507</span></a>          <span class="n">transform</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tile_matching_transforms</span><span class="p">[</span><span class="n">tr</span><span class="p">]</span><span class="o">.</span><span class="n">transform</span>
</span><span id="Topology-508"><a href="#Topology-508"><span class="linenos"> 508</span></a>          <span class="n">matched_tiles</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="Topology-509"><a href="#Topology-509"><span class="linenos"> 509</span></a>          <span class="n">eq_under_transform</span><span class="p">[</span><span class="n">tr</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="Topology-510"><a href="#Topology-510"><span class="linenos"> 510</span></a>          <span class="k">for</span> <span class="n">source_tile</span> <span class="ow">in</span> <span class="n">source_tiles</span><span class="p">:</span>
</span><span id="Topology-511"><a href="#Topology-511"><span class="linenos"> 511</span></a>            <span class="n">matched_tile_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_match_geoms_under_transform</span><span class="p">(</span>
</span><span id="Topology-512"><a href="#Topology-512"><span class="linenos"> 512</span></a>              <span class="n">source_tile</span><span class="p">,</span> <span class="n">target_tiles</span><span class="p">,</span> <span class="n">transform</span><span class="p">)</span>
</span><span id="Topology-513"><a href="#Topology-513"><span class="linenos"> 513</span></a>            <span class="k">if</span> <span class="n">matched_tile_id</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
</span><span id="Topology-514"><a href="#Topology-514"><span class="linenos"> 514</span></a>              <span class="n">eq_under_transform</span><span class="p">[</span><span class="n">tr</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="Topology-515"><a href="#Topology-515"><span class="linenos"> 515</span></a>              <span class="k">break</span>
</span><span id="Topology-516"><a href="#Topology-516"><span class="linenos"> 516</span></a>            <span class="n">matched_tiles</span><span class="p">[</span><span class="n">source_tile</span><span class="o">.</span><span class="n">ID</span><span class="p">]</span> <span class="o">=</span> <span class="n">matched_tile_id</span> <span class="c1"># actually a base_ID</span>
</span><span id="Topology-517"><a href="#Topology-517"><span class="linenos"> 517</span></a>          <span class="k">if</span> <span class="n">eq_under_transform</span><span class="p">[</span><span class="n">tr</span><span class="p">]:</span>
</span><span id="Topology-518"><a href="#Topology-518"><span class="linenos"> 518</span></a>            <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">matched_tiles</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="Topology-519"><a href="#Topology-519"><span class="linenos"> 519</span></a>              <span class="c1"># here we record the transform, in case it is later invalidated</span>
</span><span id="Topology-520"><a href="#Topology-520"><span class="linenos"> 520</span></a>              <span class="n">by_group_equivalent_tiles</span><span class="p">[</span><span class="n">g</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">((</span><span class="n">tr</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">))</span>
</span><span id="Topology-521"><a href="#Topology-521"><span class="linenos"> 521</span></a>        <span class="c1"># remove valid transforms that didn&#39;t make it through this group</span>
</span><span id="Topology-522"><a href="#Topology-522"><span class="linenos"> 522</span></a>        <span class="n">poss_transforms</span> <span class="o">=</span> <span class="p">{</span><span class="n">t</span> <span class="k">for</span> <span class="n">t</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">eq_under_transform</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">x</span><span class="p">}</span>
</span><span id="Topology-523"><a href="#Topology-523"><span class="linenos"> 523</span></a>      <span class="c1"># compile equivalences from all groups made under still valid transforms</span>
</span><span id="Topology-524"><a href="#Topology-524"><span class="linenos"> 524</span></a>      <span class="c1"># a dict of sets so singletons aren&#39;t lost in finding connected components</span>
</span><span id="Topology-525"><a href="#Topology-525"><span class="linenos"> 525</span></a>      <span class="n">equivalents</span> <span class="o">=</span> <span class="p">{</span><span class="n">i</span><span class="p">:</span> <span class="nb">set</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_tiles</span><span class="p">)}</span>
</span><span id="Topology-526"><a href="#Topology-526"><span class="linenos"> 526</span></a>      <span class="k">for</span> <span class="n">group_equivalents</span> <span class="ow">in</span> <span class="n">by_group_equivalent_tiles</span><span class="p">:</span>
</span><span id="Topology-527"><a href="#Topology-527"><span class="linenos"> 527</span></a>        <span class="k">for</span> <span class="p">(</span><span class="n">tr</span><span class="p">,</span> <span class="n">tile_i</span><span class="p">,</span> <span class="n">tile_j</span><span class="p">)</span> <span class="ow">in</span> <span class="n">group_equivalents</span><span class="p">:</span>
</span><span id="Topology-528"><a href="#Topology-528"><span class="linenos"> 528</span></a>          <span class="k">if</span> <span class="n">tr</span> <span class="ow">in</span> <span class="n">poss_transforms</span><span class="p">:</span>
</span><span id="Topology-529"><a href="#Topology-529"><span class="linenos"> 529</span></a>            <span class="n">equivalents</span><span class="p">[</span><span class="n">tile_i</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">tile_j</span><span class="p">)</span>
</span><span id="Topology-530"><a href="#Topology-530"><span class="linenos"> 530</span></a>      <span class="bp">self</span><span class="o">.</span><span class="n">tile_matching_transforms</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="Topology-531"><a href="#Topology-531"><span class="linenos"> 531</span></a>        <span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tile_matching_transforms</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
</span><span id="Topology-532"><a href="#Topology-532"><span class="linenos"> 532</span></a>        <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">poss_transforms</span><span class="p">}</span>
</span><span id="Topology-533"><a href="#Topology-533"><span class="linenos"> 533</span></a>      <span class="bp">self</span><span class="o">.</span><span class="n">tile_transitivity_classes</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Topology-534"><a href="#Topology-534"><span class="linenos"> 534</span></a>      <span class="n">equivalents</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">connected_components</span><span class="p">(</span><span class="n">nx</span><span class="o">.</span><span class="n">from_dict_of_lists</span><span class="p">(</span><span class="n">equivalents</span><span class="p">))</span>
</span><span id="Topology-535"><a href="#Topology-535"><span class="linenos"> 535</span></a>      <span class="k">for</span> <span class="n">c</span><span class="p">,</span> <span class="n">base_IDs</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">equivalents</span><span class="p">):</span>
</span><span id="Topology-536"><a href="#Topology-536"><span class="linenos"> 536</span></a>        <span class="n">transitivity_class</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Topology-537"><a href="#Topology-537"><span class="linenos"> 537</span></a>        <span class="k">for</span> <span class="n">tile</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tiles</span><span class="p">:</span>
</span><span id="Topology-538"><a href="#Topology-538"><span class="linenos"> 538</span></a>          <span class="k">if</span> <span class="n">tile</span><span class="o">.</span><span class="n">base_ID</span> <span class="ow">in</span> <span class="n">base_IDs</span><span class="p">:</span>
</span><span id="Topology-539"><a href="#Topology-539"><span class="linenos"> 539</span></a>            <span class="n">transitivity_class</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tile</span><span class="o">.</span><span class="n">ID</span><span class="p">)</span>
</span><span id="Topology-540"><a href="#Topology-540"><span class="linenos"> 540</span></a>            <span class="n">tile</span><span class="o">.</span><span class="n">transitivity_class</span> <span class="o">=</span> <span class="n">c</span>
</span><span id="Topology-541"><a href="#Topology-541"><span class="linenos"> 541</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">tile_transitivity_classes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">transitivity_class</span><span class="p">)</span>
</span><span id="Topology-542"><a href="#Topology-542"><span class="linenos"> 542</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="Topology-543"><a href="#Topology-543"><span class="linenos"> 543</span></a>      <span class="c1"># transitivity classes are just the individual tiles</span>
</span><span id="Topology-544"><a href="#Topology-544"><span class="linenos"> 544</span></a>      <span class="bp">self</span><span class="o">.</span><span class="n">tile_transitivity_classes</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Topology-545"><a href="#Topology-545"><span class="linenos"> 545</span></a>      <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">tile</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tiles</span><span class="p">):</span>
</span><span id="Topology-546"><a href="#Topology-546"><span class="linenos"> 546</span></a>        <span class="n">tile</span><span class="o">.</span><span class="n">transitivity_class</span> <span class="o">=</span> <span class="n">tile</span><span class="o">.</span><span class="n">base_ID</span>
</span><span id="Topology-547"><a href="#Topology-547"><span class="linenos"> 547</span></a>        <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_tiles</span><span class="p">:</span>
</span><span id="Topology-548"><a href="#Topology-548"><span class="linenos"> 548</span></a>          <span class="bp">self</span><span class="o">.</span><span class="n">tile_transitivity_classes</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">tile</span><span class="o">.</span><span class="n">ID</span><span class="p">])</span>
</span><span id="Topology-549"><a href="#Topology-549"><span class="linenos"> 549</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Topology-550"><a href="#Topology-550"><span class="linenos"> 550</span></a>          <span class="bp">self</span><span class="o">.</span><span class="n">tile_transitivity_classes</span><span class="p">[</span><span class="n">tile</span><span class="o">.</span><span class="n">base_ID</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tile</span><span class="o">.</span><span class="n">ID</span><span class="p">)</span>
</span><span id="Topology-551"><a href="#Topology-551"><span class="linenos"> 551</span></a>
</span><span id="Topology-552"><a href="#Topology-552"><span class="linenos"> 552</span></a>
</span><span id="Topology-553"><a href="#Topology-553"><span class="linenos"> 553</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">get_potential_symmetries</span><span class="p">(</span>
</span><span id="Topology-554"><a href="#Topology-554"><span class="linenos"> 554</span></a>      <span class="bp">self</span><span class="p">,</span>
</span><span id="Topology-555"><a href="#Topology-555"><span class="linenos"> 555</span></a>      <span class="n">ignore_tile_id_labels</span><span class="p">:</span><span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="Topology-556"><a href="#Topology-556"><span class="linenos"> 556</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">Transform</span><span class="p">]:</span>
</span><span id="Topology-557"><a href="#Topology-557"><span class="linenos"> 557</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Assemble potential symmetries from symmetries of prototile and tiles.</span>
</span><span id="Topology-558"><a href="#Topology-558"><span class="linenos"> 558</span></a>
</span><span id="Topology-559"><a href="#Topology-559"><span class="linenos"> 559</span></a><span class="sd">    Also remove any duplicates that result. The result is assigned to the</span>
</span><span id="Topology-560"><a href="#Topology-560"><span class="linenos"> 560</span></a><span class="sd">    tile_matching_transforms attribute.</span>
</span><span id="Topology-561"><a href="#Topology-561"><span class="linenos"> 561</span></a>
</span><span id="Topology-562"><a href="#Topology-562"><span class="linenos"> 562</span></a><span class="sd">    TODO: consider retaining the Symmetry objects as these carry additional</span>
</span><span id="Topology-563"><a href="#Topology-563"><span class="linenos"> 563</span></a><span class="sd">    information that might facilitate labelling under a limited number of the</span>
</span><span id="Topology-564"><a href="#Topology-564"><span class="linenos"> 564</span></a><span class="sd">    symmetries not all of them.</span>
</span><span id="Topology-565"><a href="#Topology-565"><span class="linenos"> 565</span></a>
</span><span id="Topology-566"><a href="#Topology-566"><span class="linenos"> 566</span></a><span class="sd">    Returns:</span>
</span><span id="Topology-567"><a href="#Topology-567"><span class="linenos"> 567</span></a><span class="sd">      dict[int, tuple[float]]: dictionary of the symmetries (transforms</span>
</span><span id="Topology-568"><a href="#Topology-568"><span class="linenos"> 568</span></a><span class="sd">        actually) in shapely affine transform 6-tuple format.</span>
</span><span id="Topology-569"><a href="#Topology-569"><span class="linenos"> 569</span></a>
</span><span id="Topology-570"><a href="#Topology-570"><span class="linenos"> 570</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Topology-571"><a href="#Topology-571"><span class="linenos"> 571</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">tile_matching_transforms</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="Topology-572"><a href="#Topology-572"><span class="linenos"> 572</span></a>      <span class="n">k</span><span class="p">:</span> <span class="n">Transform</span><span class="p">(</span><span class="s2">&quot;translation&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">geom</span><span class="o">.</span><span class="n">Point</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">v</span><span class="p">,</span>
</span><span id="Topology-573"><a href="#Topology-573"><span class="linenos"> 573</span></a>                   <span class="n">tiling_utils</span><span class="o">.</span><span class="n">get_translation_transform</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
</span><span id="Topology-574"><a href="#Topology-574"><span class="linenos"> 574</span></a>      <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tileable</span><span class="o">.</span><span class="n">get_vectors</span><span class="p">())}</span>
</span><span id="Topology-575"><a href="#Topology-575"><span class="linenos"> 575</span></a>    <span class="k">if</span> <span class="n">ignore_tile_id_labels</span><span class="p">:</span>
</span><span id="Topology-576"><a href="#Topology-576"><span class="linenos"> 576</span></a>      <span class="n">n_symmetries</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tile_matching_transforms</span><span class="p">)</span>
</span><span id="Topology-577"><a href="#Topology-577"><span class="linenos"> 577</span></a>      <span class="n">ptile</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tileable</span><span class="o">.</span><span class="n">prototile</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;geometry&quot;</span><span class="p">]</span>
</span><span id="Topology-578"><a href="#Topology-578"><span class="linenos"> 578</span></a>      <span class="k">for</span> <span class="n">tr</span> <span class="ow">in</span> <span class="n">ShapeMatcher</span><span class="p">(</span><span class="n">ptile</span><span class="p">)</span><span class="o">.</span><span class="n">get_polygon_matches</span><span class="p">(</span><span class="n">ptile</span><span class="p">):</span>
</span><span id="Topology-579"><a href="#Topology-579"><span class="linenos"> 579</span></a>        <span class="k">if</span> <span class="n">tr</span><span class="o">.</span><span class="n">transform_type</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;identity&quot;</span><span class="p">,</span> <span class="s2">&quot;translation&quot;</span><span class="p">]:</span>
</span><span id="Topology-580"><a href="#Topology-580"><span class="linenos"> 580</span></a>          <span class="bp">self</span><span class="o">.</span><span class="n">tile_matching_transforms</span><span class="p">[</span><span class="n">n_symmetries</span><span class="p">]</span> <span class="o">=</span> <span class="n">tr</span>
</span><span id="Topology-581"><a href="#Topology-581"><span class="linenos"> 581</span></a>          <span class="n">n_symmetries</span> <span class="o">=</span> <span class="n">n_symmetries</span> <span class="o">+</span> <span class="mi">1</span>
</span><span id="Topology-582"><a href="#Topology-582"><span class="linenos"> 582</span></a>      <span class="k">for</span> <span class="n">tile</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tiles</span><span class="p">[:</span><span class="bp">self</span><span class="o">.</span><span class="n">n_tiles</span><span class="p">]:</span>
</span><span id="Topology-583"><a href="#Topology-583"><span class="linenos"> 583</span></a>        <span class="k">for</span> <span class="n">tr</span> <span class="ow">in</span> <span class="n">ShapeMatcher</span><span class="p">(</span><span class="n">tile</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span><span class="o">.</span><span class="n">get_polygon_matches</span><span class="p">(</span><span class="n">tile</span><span class="o">.</span><span class="n">shape</span><span class="p">):</span>
</span><span id="Topology-584"><a href="#Topology-584"><span class="linenos"> 584</span></a>          <span class="k">if</span> <span class="n">tr</span><span class="o">.</span><span class="n">transform_type</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;identity&quot;</span><span class="p">,</span> <span class="s2">&quot;translation&quot;</span><span class="p">]:</span>
</span><span id="Topology-585"><a href="#Topology-585"><span class="linenos"> 585</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">tile_matching_transforms</span><span class="p">[</span><span class="n">n_symmetries</span><span class="p">]</span> <span class="o">=</span> <span class="n">tr</span>
</span><span id="Topology-586"><a href="#Topology-586"><span class="linenos"> 586</span></a>            <span class="n">n_symmetries</span> <span class="o">=</span> <span class="n">n_symmetries</span> <span class="o">+</span> <span class="mi">1</span>
</span><span id="Topology-587"><a href="#Topology-587"><span class="linenos"> 587</span></a>      <span class="k">for</span> <span class="n">tile</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tiles</span><span class="p">[:</span><span class="bp">self</span><span class="o">.</span><span class="n">n_tiles</span><span class="p">]:</span>
</span><span id="Topology-588"><a href="#Topology-588"><span class="linenos"> 588</span></a>        <span class="n">sm</span> <span class="o">=</span> <span class="n">ShapeMatcher</span><span class="p">(</span><span class="n">tile</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</span><span id="Topology-589"><a href="#Topology-589"><span class="linenos"> 589</span></a>        <span class="n">transforms</span> <span class="o">=</span> <span class="p">[</span><span class="n">sm</span><span class="o">.</span><span class="n">get_polygon_matches</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tiles</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</span><span id="Topology-590"><a href="#Topology-590"><span class="linenos"> 590</span></a>          <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">shape_groups</span><span class="p">[</span><span class="n">tile</span><span class="o">.</span><span class="n">shape_group</span><span class="p">]</span> <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_tiles</span><span class="p">]</span>
</span><span id="Topology-591"><a href="#Topology-591"><span class="linenos"> 591</span></a>        <span class="k">for</span> <span class="n">tr</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="p">(</span><span class="o">*</span><span class="n">transforms</span><span class="p">):</span>
</span><span id="Topology-592"><a href="#Topology-592"><span class="linenos"> 592</span></a>          <span class="k">if</span> <span class="n">tr</span><span class="o">.</span><span class="n">transform_type</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;identity&quot;</span><span class="p">,</span> <span class="s2">&quot;translation&quot;</span><span class="p">]:</span>
</span><span id="Topology-593"><a href="#Topology-593"><span class="linenos"> 593</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">tile_matching_transforms</span><span class="p">[</span><span class="n">n_symmetries</span><span class="p">]</span> <span class="o">=</span> <span class="n">tr</span>
</span><span id="Topology-594"><a href="#Topology-594"><span class="linenos"> 594</span></a>            <span class="n">n_symmetries</span> <span class="o">=</span> <span class="n">n_symmetries</span> <span class="o">+</span> <span class="mi">1</span>
</span><span id="Topology-595"><a href="#Topology-595"><span class="linenos"> 595</span></a>      <span class="bp">self</span><span class="o">.</span><span class="n">tile_matching_transforms</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_remove_duplicate_symmetries</span><span class="p">(</span>
</span><span id="Topology-596"><a href="#Topology-596"><span class="linenos"> 596</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">tile_matching_transforms</span><span class="p">)</span>
</span><span id="Topology-597"><a href="#Topology-597"><span class="linenos"> 597</span></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">tile_matching_transforms</span>
</span><span id="Topology-598"><a href="#Topology-598"><span class="linenos"> 598</span></a>
</span><span id="Topology-599"><a href="#Topology-599"><span class="linenos"> 599</span></a>
</span><span id="Topology-600"><a href="#Topology-600"><span class="linenos"> 600</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">_remove_duplicate_symmetries</span><span class="p">(</span>
</span><span id="Topology-601"><a href="#Topology-601"><span class="linenos"> 601</span></a>      <span class="bp">self</span><span class="p">,</span>
</span><span id="Topology-602"><a href="#Topology-602"><span class="linenos"> 602</span></a>      <span class="n">transforms</span><span class="p">:</span><span class="nb">dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span><span class="n">Transform</span><span class="p">],</span>
</span><span id="Topology-603"><a href="#Topology-603"><span class="linenos"> 603</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span><span class="n">Transform</span><span class="p">]:</span>
</span><span id="Topology-604"><a href="#Topology-604"><span class="linenos"> 604</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Filter list of shapely affine transforms to remove duplicates.</span>
</span><span id="Topology-605"><a href="#Topology-605"><span class="linenos"> 605</span></a>
</span><span id="Topology-606"><a href="#Topology-606"><span class="linenos"> 606</span></a><span class="sd">    Args:</span>
</span><span id="Topology-607"><a href="#Topology-607"><span class="linenos"> 607</span></a><span class="sd">      transforms (dict[int,Transform]): dictionary of Transforms to filter.</span>
</span><span id="Topology-608"><a href="#Topology-608"><span class="linenos"> 608</span></a>
</span><span id="Topology-609"><a href="#Topology-609"><span class="linenos"> 609</span></a><span class="sd">    Returns:</span>
</span><span id="Topology-610"><a href="#Topology-610"><span class="linenos"> 610</span></a><span class="sd">      dict[int,Transform]: the filtered dictionary with duplicates removed.</span>
</span><span id="Topology-611"><a href="#Topology-611"><span class="linenos"> 611</span></a>
</span><span id="Topology-612"><a href="#Topology-612"><span class="linenos"> 612</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Topology-613"><a href="#Topology-613"><span class="linenos"> 613</span></a>    <span class="n">uniques</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="Topology-614"><a href="#Topology-614"><span class="linenos"> 614</span></a>    <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">transforms</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="Topology-615"><a href="#Topology-615"><span class="linenos"> 615</span></a>      <span class="n">already_exists</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="Topology-616"><a href="#Topology-616"><span class="linenos"> 616</span></a>      <span class="k">for</span> <span class="n">u</span> <span class="ow">in</span> <span class="n">uniques</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
</span><span id="Topology-617"><a href="#Topology-617"><span class="linenos"> 617</span></a>        <span class="n">already_exists</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span>
</span><span id="Topology-618"><a href="#Topology-618"><span class="linenos"> 618</span></a>          <span class="n">v</span><span class="o">.</span><span class="n">transform</span><span class="p">,</span> <span class="n">u</span><span class="o">.</span><span class="n">transform</span><span class="p">,</span> <span class="n">atol</span> <span class="o">=</span> <span class="mf">1e-4</span><span class="p">,</span> <span class="n">rtol</span> <span class="o">=</span> <span class="mf">1e-4</span><span class="p">)</span>
</span><span id="Topology-619"><a href="#Topology-619"><span class="linenos"> 619</span></a>        <span class="k">if</span> <span class="n">already_exists</span><span class="p">:</span>
</span><span id="Topology-620"><a href="#Topology-620"><span class="linenos"> 620</span></a>          <span class="k">break</span>
</span><span id="Topology-621"><a href="#Topology-621"><span class="linenos"> 621</span></a>      <span class="k">if</span> <span class="ow">not</span> <span class="n">already_exists</span><span class="p">:</span>
</span><span id="Topology-622"><a href="#Topology-622"><span class="linenos"> 622</span></a>        <span class="n">uniques</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>
</span><span id="Topology-623"><a href="#Topology-623"><span class="linenos"> 623</span></a>    <span class="k">return</span> <span class="n">uniques</span>
</span><span id="Topology-624"><a href="#Topology-624"><span class="linenos"> 624</span></a>
</span><span id="Topology-625"><a href="#Topology-625"><span class="linenos"> 625</span></a>
</span><span id="Topology-626"><a href="#Topology-626"><span class="linenos"> 626</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">_find_vertex_transitivity_classes</span><span class="p">(</span>
</span><span id="Topology-627"><a href="#Topology-627"><span class="linenos"> 627</span></a>      <span class="bp">self</span><span class="p">,</span>
</span><span id="Topology-628"><a href="#Topology-628"><span class="linenos"> 628</span></a>      <span class="n">ignore_tile_id_labels</span><span class="p">:</span><span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="Topology-629"><a href="#Topology-629"><span class="linenos"> 629</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Topology-630"><a href="#Topology-630"><span class="linenos"> 630</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Find vertex transitivity classes.</span>
</span><span id="Topology-631"><a href="#Topology-631"><span class="linenos"> 631</span></a>
</span><span id="Topology-632"><a href="#Topology-632"><span class="linenos"> 632</span></a><span class="sd">    This function checks which vertices align with which others under transforms</span>
</span><span id="Topology-633"><a href="#Topology-633"><span class="linenos"> 633</span></a><span class="sd">    in the tile_matching_transforms attribute. The process need only determine</span>
</span><span id="Topology-634"><a href="#Topology-634"><span class="linenos"> 634</span></a><span class="sd">    the classes for vertices in the core tileable.tiles, then assign those to</span>
</span><span id="Topology-635"><a href="#Topology-635"><span class="linenos"> 635</span></a><span class="sd">    all vertices by matched base_ID.</span>
</span><span id="Topology-636"><a href="#Topology-636"><span class="linenos"> 636</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Topology-637"><a href="#Topology-637"><span class="linenos"> 637</span></a>    <span class="k">if</span> <span class="n">ignore_tile_id_labels</span><span class="p">:</span>
</span><span id="Topology-638"><a href="#Topology-638"><span class="linenos"> 638</span></a>      <span class="n">equivalent_vertices</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">set</span><span class="p">)</span>
</span><span id="Topology-639"><a href="#Topology-639"><span class="linenos"> 639</span></a>      <span class="n">base_vertices</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span>
</span><span id="Topology-640"><a href="#Topology-640"><span class="linenos"> 640</span></a>                      <span class="bp">self</span><span class="o">.</span><span class="n">vertices_in_tiles</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tiles</span><span class="p">[:</span><span class="bp">self</span><span class="o">.</span><span class="n">n_tiles</span><span class="p">])</span>
</span><span id="Topology-641"><a href="#Topology-641"><span class="linenos"> 641</span></a>                      <span class="k">if</span> <span class="n">v</span><span class="o">.</span><span class="n">is_tiling_vertex</span><span class="p">]</span>
</span><span id="Topology-642"><a href="#Topology-642"><span class="linenos"> 642</span></a>      <span class="k">for</span> <span class="n">transform</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tile_matching_transforms</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
</span><span id="Topology-643"><a href="#Topology-643"><span class="linenos"> 643</span></a>        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">base_vertices</span><span class="p">:</span>
</span><span id="Topology-644"><a href="#Topology-644"><span class="linenos"> 644</span></a>          <span class="n">equivalent_vertices</span><span class="p">[</span><span class="n">v</span><span class="o">.</span><span class="n">ID</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">ID</span><span class="p">)</span>
</span><span id="Topology-645"><a href="#Topology-645"><span class="linenos"> 645</span></a>          <span class="n">match_ID</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_match_geoms_under_transform</span><span class="p">(</span>
</span><span id="Topology-646"><a href="#Topology-646"><span class="linenos"> 646</span></a>            <span class="n">v</span><span class="p">,</span> <span class="n">base_vertices</span><span class="p">,</span> <span class="n">transform</span><span class="o">.</span><span class="n">transform</span><span class="p">)</span>
</span><span id="Topology-647"><a href="#Topology-647"><span class="linenos"> 647</span></a>          <span class="k">if</span> <span class="n">match_ID</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
</span><span id="Topology-648"><a href="#Topology-648"><span class="linenos"> 648</span></a>            <span class="n">equivalent_vertices</span><span class="p">[</span><span class="n">v</span><span class="o">.</span><span class="n">ID</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">match_ID</span><span class="p">)</span>
</span><span id="Topology-649"><a href="#Topology-649"><span class="linenos"> 649</span></a>      <span class="n">equivalent_vertices</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_exclusive_supersets</span><span class="p">(</span>
</span><span id="Topology-650"><a href="#Topology-650"><span class="linenos"> 650</span></a>        <span class="p">[</span><span class="nb">tuple</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">s</span><span class="p">))</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">equivalent_vertices</span><span class="o">.</span><span class="n">values</span><span class="p">()])</span>
</span><span id="Topology-651"><a href="#Topology-651"><span class="linenos"> 651</span></a>      <span class="bp">self</span><span class="o">.</span><span class="n">vertex_transitivity_classes</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
</span><span id="Topology-652"><a href="#Topology-652"><span class="linenos"> 652</span></a>      <span class="k">for</span> <span class="n">c</span><span class="p">,</span> <span class="n">vclass</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">equivalent_vertices</span><span class="p">):</span>
</span><span id="Topology-653"><a href="#Topology-653"><span class="linenos"> 653</span></a>        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">points</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
</span><span id="Topology-654"><a href="#Topology-654"><span class="linenos"> 654</span></a>          <span class="k">if</span> <span class="n">v</span><span class="o">.</span><span class="n">base_ID</span> <span class="ow">in</span> <span class="n">vclass</span><span class="p">:</span>
</span><span id="Topology-655"><a href="#Topology-655"><span class="linenos"> 655</span></a>            <span class="n">v</span><span class="o">.</span><span class="n">transitivity_class</span> <span class="o">=</span> <span class="n">c</span>
</span><span id="Topology-656"><a href="#Topology-656"><span class="linenos"> 656</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">vertex_transitivity_classes</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">ID</span><span class="p">)</span>
</span><span id="Topology-657"><a href="#Topology-657"><span class="linenos"> 657</span></a>      <span class="bp">self</span><span class="o">.</span><span class="n">vertex_transitivity_classes</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span>
</span><span id="Topology-658"><a href="#Topology-658"><span class="linenos"> 658</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">vertex_transitivity_classes</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
</span><span id="Topology-659"><a href="#Topology-659"><span class="linenos"> 659</span></a>      <span class="c1"># label vertices based on their transitivity class</span>
</span><span id="Topology-660"><a href="#Topology-660"><span class="linenos"> 660</span></a>      <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">points</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
</span><span id="Topology-661"><a href="#Topology-661"><span class="linenos"> 661</span></a>        <span class="k">if</span> <span class="n">v</span><span class="o">.</span><span class="n">is_tiling_vertex</span><span class="p">:</span>
</span><span id="Topology-662"><a href="#Topology-662"><span class="linenos"> 662</span></a>          <span class="n">v</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="n">LABELS</span><span class="p">[</span><span class="n">v</span><span class="o">.</span><span class="n">transitivity_class</span><span class="p">]</span>
</span><span id="Topology-663"><a href="#Topology-663"><span class="linenos"> 663</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="Topology-664"><a href="#Topology-664"><span class="linenos"> 664</span></a>      <span class="bp">self</span><span class="o">.</span><span class="n">vertex_transitivity_classes</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
</span><span id="Topology-665"><a href="#Topology-665"><span class="linenos"> 665</span></a>      <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">points</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
</span><span id="Topology-666"><a href="#Topology-666"><span class="linenos"> 666</span></a>        <span class="k">if</span> <span class="n">v</span><span class="o">.</span><span class="n">is_tiling_vertex</span><span class="p">:</span>
</span><span id="Topology-667"><a href="#Topology-667"><span class="linenos"> 667</span></a>          <span class="bp">self</span><span class="o">.</span><span class="n">vertex_transitivity_classes</span><span class="p">[</span><span class="n">v</span><span class="o">.</span><span class="n">base_ID</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">ID</span><span class="p">)</span>
</span><span id="Topology-668"><a href="#Topology-668"><span class="linenos"> 668</span></a>          <span class="n">v</span><span class="o">.</span><span class="n">transitivity_class</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">base_ID</span>
</span><span id="Topology-669"><a href="#Topology-669"><span class="linenos"> 669</span></a>      <span class="bp">self</span><span class="o">.</span><span class="n">vertex_transitivity_classes</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span>
</span><span id="Topology-670"><a href="#Topology-670"><span class="linenos"> 670</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">vertex_transitivity_classes</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
</span><span id="Topology-671"><a href="#Topology-671"><span class="linenos"> 671</span></a>      <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">points</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
</span><span id="Topology-672"><a href="#Topology-672"><span class="linenos"> 672</span></a>        <span class="k">if</span> <span class="n">v</span><span class="o">.</span><span class="n">is_tiling_vertex</span><span class="p">:</span>
</span><span id="Topology-673"><a href="#Topology-673"><span class="linenos"> 673</span></a>          <span class="n">v</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="n">LABELS</span><span class="p">[</span><span class="n">v</span><span class="o">.</span><span class="n">transitivity_class</span><span class="p">]</span>
</span><span id="Topology-674"><a href="#Topology-674"><span class="linenos"> 674</span></a>
</span><span id="Topology-675"><a href="#Topology-675"><span class="linenos"> 675</span></a>
</span><span id="Topology-676"><a href="#Topology-676"><span class="linenos"> 676</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">_find_edge_transitivity_classes</span><span class="p">(</span>
</span><span id="Topology-677"><a href="#Topology-677"><span class="linenos"> 677</span></a>      <span class="bp">self</span><span class="p">,</span>
</span><span id="Topology-678"><a href="#Topology-678"><span class="linenos"> 678</span></a>      <span class="n">ignore_tile_id_labels</span><span class="p">:</span><span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="Topology-679"><a href="#Topology-679"><span class="linenos"> 679</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Topology-680"><a href="#Topology-680"><span class="linenos"> 680</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Find edge transitivity classes.</span>
</span><span id="Topology-681"><a href="#Topology-681"><span class="linenos"> 681</span></a>
</span><span id="Topology-682"><a href="#Topology-682"><span class="linenos"> 682</span></a><span class="sd">    This function works by checking which edges align with which others under</span>
</span><span id="Topology-683"><a href="#Topology-683"><span class="linenos"> 683</span></a><span class="sd">    transforms in the tile_matching_transforms attribute. The process need only</span>
</span><span id="Topology-684"><a href="#Topology-684"><span class="linenos"> 684</span></a><span class="sd">    determine the classes for edges in the core tileable.tiles, then assign</span>
</span><span id="Topology-685"><a href="#Topology-685"><span class="linenos"> 685</span></a><span class="sd">    those to all edges by matched base_ID.</span>
</span><span id="Topology-686"><a href="#Topology-686"><span class="linenos"> 686</span></a>
</span><span id="Topology-687"><a href="#Topology-687"><span class="linenos"> 687</span></a><span class="sd">    TODO: Note that this code is identical to the vertex transitivity code</span>
</span><span id="Topology-688"><a href="#Topology-688"><span class="linenos"> 688</span></a><span class="sd">    so it might make sense to merge.</span>
</span><span id="Topology-689"><a href="#Topology-689"><span class="linenos"> 689</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Topology-690"><a href="#Topology-690"><span class="linenos"> 690</span></a>    <span class="k">if</span> <span class="n">ignore_tile_id_labels</span><span class="p">:</span>
</span><span id="Topology-691"><a href="#Topology-691"><span class="linenos"> 691</span></a>      <span class="n">equivalent_edges</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">set</span><span class="p">)</span>
</span><span id="Topology-692"><a href="#Topology-692"><span class="linenos"> 692</span></a>      <span class="n">base_edges</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges_in_tiles</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tiles</span><span class="p">[:</span><span class="bp">self</span><span class="o">.</span><span class="n">n_tiles</span><span class="p">])</span>
</span><span id="Topology-693"><a href="#Topology-693"><span class="linenos"> 693</span></a>      <span class="k">for</span> <span class="n">transform</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tile_matching_transforms</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
</span><span id="Topology-694"><a href="#Topology-694"><span class="linenos"> 694</span></a>        <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">base_edges</span><span class="p">:</span>
</span><span id="Topology-695"><a href="#Topology-695"><span class="linenos"> 695</span></a>          <span class="n">equivalent_edges</span><span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">ID</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">ID</span><span class="p">)</span>
</span><span id="Topology-696"><a href="#Topology-696"><span class="linenos"> 696</span></a>          <span class="n">match_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_match_geoms_under_transform</span><span class="p">(</span>
</span><span id="Topology-697"><a href="#Topology-697"><span class="linenos"> 697</span></a>            <span class="n">e</span><span class="p">,</span> <span class="n">base_edges</span><span class="p">,</span> <span class="n">transform</span><span class="o">.</span><span class="n">transform</span><span class="p">)</span>
</span><span id="Topology-698"><a href="#Topology-698"><span class="linenos"> 698</span></a>          <span class="k">if</span> <span class="n">match_id</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
</span><span id="Topology-699"><a href="#Topology-699"><span class="linenos"> 699</span></a>            <span class="n">equivalent_edges</span><span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">ID</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">match_id</span><span class="p">)</span>
</span><span id="Topology-700"><a href="#Topology-700"><span class="linenos"> 700</span></a>      <span class="n">equivalent_edges</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_exclusive_supersets</span><span class="p">(</span>
</span><span id="Topology-701"><a href="#Topology-701"><span class="linenos"> 701</span></a>        <span class="p">[</span><span class="nb">tuple</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">s</span><span class="p">))</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">equivalent_edges</span><span class="o">.</span><span class="n">values</span><span class="p">()])</span>
</span><span id="Topology-702"><a href="#Topology-702"><span class="linenos"> 702</span></a>      <span class="bp">self</span><span class="o">.</span><span class="n">edge_transitivity_classes</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
</span><span id="Topology-703"><a href="#Topology-703"><span class="linenos"> 703</span></a>      <span class="k">for</span> <span class="n">c</span><span class="p">,</span> <span class="n">eclass</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">equivalent_edges</span><span class="p">):</span>
</span><span id="Topology-704"><a href="#Topology-704"><span class="linenos"> 704</span></a>        <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
</span><span id="Topology-705"><a href="#Topology-705"><span class="linenos"> 705</span></a>          <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">base_ID</span> <span class="ow">in</span> <span class="n">eclass</span><span class="p">:</span>
</span><span id="Topology-706"><a href="#Topology-706"><span class="linenos"> 706</span></a>            <span class="n">e</span><span class="o">.</span><span class="n">transitivity_class</span> <span class="o">=</span> <span class="n">c</span>
</span><span id="Topology-707"><a href="#Topology-707"><span class="linenos"> 707</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">edge_transitivity_classes</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">ID</span><span class="p">)</span>
</span><span id="Topology-708"><a href="#Topology-708"><span class="linenos"> 708</span></a>      <span class="bp">self</span><span class="o">.</span><span class="n">edge_transitivity_classes</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span>
</span><span id="Topology-709"><a href="#Topology-709"><span class="linenos"> 709</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">edge_transitivity_classes</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
</span><span id="Topology-710"><a href="#Topology-710"><span class="linenos"> 710</span></a>      <span class="c1"># label edges based on their transitivity class</span>
</span><span id="Topology-711"><a href="#Topology-711"><span class="linenos"> 711</span></a>      <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
</span><span id="Topology-712"><a href="#Topology-712"><span class="linenos"> 712</span></a>        <span class="n">e</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="n">labels</span><span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">transitivity_class</span><span class="p">]</span>
</span><span id="Topology-713"><a href="#Topology-713"><span class="linenos"> 713</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="Topology-714"><a href="#Topology-714"><span class="linenos"> 714</span></a>      <span class="bp">self</span><span class="o">.</span><span class="n">edge_transitivity_classes</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
</span><span id="Topology-715"><a href="#Topology-715"><span class="linenos"> 715</span></a>      <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
</span><span id="Topology-716"><a href="#Topology-716"><span class="linenos"> 716</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">edge_transitivity_classes</span><span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">base_ID</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">ID</span><span class="p">)</span>
</span><span id="Topology-717"><a href="#Topology-717"><span class="linenos"> 717</span></a>      <span class="bp">self</span><span class="o">.</span><span class="n">edge_transitivity_classes</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span>
</span><span id="Topology-718"><a href="#Topology-718"><span class="linenos"> 718</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">edge_transitivity_classes</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
</span><span id="Topology-719"><a href="#Topology-719"><span class="linenos"> 719</span></a>      <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">eclass</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">edge_transitivity_classes</span><span class="p">):</span>
</span><span id="Topology-720"><a href="#Topology-720"><span class="linenos"> 720</span></a>        <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">eclass</span><span class="p">:</span>
</span><span id="Topology-721"><a href="#Topology-721"><span class="linenos"> 721</span></a>          <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">e</span><span class="p">]</span><span class="o">.</span><span class="n">transitivity_class</span> <span class="o">=</span> <span class="n">i</span>
</span><span id="Topology-722"><a href="#Topology-722"><span class="linenos"> 722</span></a>          <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">e</span><span class="p">]</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="n">labels</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span><span id="Topology-723"><a href="#Topology-723"><span class="linenos"> 723</span></a>
</span><span id="Topology-724"><a href="#Topology-724"><span class="linenos"> 724</span></a>
</span><span id="Topology-725"><a href="#Topology-725"><span class="linenos"> 725</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">_match_geoms_under_transform</span><span class="p">(</span>
</span><span id="Topology-726"><a href="#Topology-726"><span class="linenos"> 726</span></a>      <span class="bp">self</span><span class="p">,</span>
</span><span id="Topology-727"><a href="#Topology-727"><span class="linenos"> 727</span></a>      <span class="n">geom1</span><span class="p">:</span><span class="n">Tile</span><span class="o">|</span><span class="n">Vertex</span><span class="o">|</span><span class="n">Edge</span><span class="p">,</span>
</span><span id="Topology-728"><a href="#Topology-728"><span class="linenos"> 728</span></a>      <span class="n">geoms2</span><span class="p">:</span><span class="nb">list</span><span class="p">[</span><span class="n">Tile</span><span class="o">|</span><span class="n">Vertex</span><span class="o">|</span><span class="n">Edge</span><span class="p">],</span>
</span><span id="Topology-729"><a href="#Topology-729"><span class="linenos"> 729</span></a>      <span class="n">transform</span><span class="p">:</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span><span class="o">...</span><span class="p">],</span>
</span><span id="Topology-730"><a href="#Topology-730"><span class="linenos"> 730</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="o">|</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
</span><span id="Topology-731"><a href="#Topology-731"><span class="linenos"> 731</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Determine if a geometry maps onto any in a patch under supplied symmetry.</span>
</span><span id="Topology-732"><a href="#Topology-732"><span class="linenos"> 732</span></a>
</span><span id="Topology-733"><a href="#Topology-733"><span class="linenos"> 733</span></a><span class="sd">    Args:</span>
</span><span id="Topology-734"><a href="#Topology-734"><span class="linenos"> 734</span></a><span class="sd">      geom1 (Tile|Vertex|Edge): element whose geometry we want to match.</span>
</span><span id="Topology-735"><a href="#Topology-735"><span class="linenos"> 735</span></a><span class="sd">      geoms2 (list[Tile|Vertex|Edge]): set of elements among which a</span>
</span><span id="Topology-736"><a href="#Topology-736"><span class="linenos"> 736</span></a><span class="sd">        match is sought.</span>
</span><span id="Topology-737"><a href="#Topology-737"><span class="linenos"> 737</span></a><span class="sd">      transform (tuple[float]): shapely affine transform 6-tuple to apply.</span>
</span><span id="Topology-738"><a href="#Topology-738"><span class="linenos"> 738</span></a>
</span><span id="Topology-739"><a href="#Topology-739"><span class="linenos"> 739</span></a><span class="sd">    Returns:</span>
</span><span id="Topology-740"><a href="#Topology-740"><span class="linenos"> 740</span></a><span class="sd">      int|tuple[int,int]: ID of the element in patch that matches the geom1</span>
</span><span id="Topology-741"><a href="#Topology-741"><span class="linenos"> 741</span></a><span class="sd">        element under the transform if one exists, otherwise returns -1. For</span>
</span><span id="Topology-742"><a href="#Topology-742"><span class="linenos"> 742</span></a><span class="sd">        edges note that the ID is a tuple.</span>
</span><span id="Topology-743"><a href="#Topology-743"><span class="linenos"> 743</span></a>
</span><span id="Topology-744"><a href="#Topology-744"><span class="linenos"> 744</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Topology-745"><a href="#Topology-745"><span class="linenos"> 745</span></a>    <span class="n">match_id</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
</span><span id="Topology-746"><a href="#Topology-746"><span class="linenos"> 746</span></a>    <span class="k">for</span> <span class="n">geom2</span> <span class="ow">in</span> <span class="n">geoms2</span><span class="p">:</span>
</span><span id="Topology-747"><a href="#Topology-747"><span class="linenos"> 747</span></a>      <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">geom1</span><span class="p">,</span> <span class="n">Tile</span><span class="p">):</span>
</span><span id="Topology-748"><a href="#Topology-748"><span class="linenos"> 748</span></a>        <span class="c1"># an area of intersection based test</span>
</span><span id="Topology-749"><a href="#Topology-749"><span class="linenos"> 749</span></a>        <span class="n">match</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">polygon_matches</span><span class="p">(</span>
</span><span id="Topology-750"><a href="#Topology-750"><span class="linenos"> 750</span></a>          <span class="n">affine</span><span class="o">.</span><span class="n">affine_transform</span><span class="p">(</span><span class="n">geom1</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">transform</span><span class="p">),</span> <span class="n">geom2</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</span><span id="Topology-751"><a href="#Topology-751"><span class="linenos"> 751</span></a>      <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">geom1</span><span class="p">,</span> <span class="n">Vertex</span><span class="p">):</span>
</span><span id="Topology-752"><a href="#Topology-752"><span class="linenos"> 752</span></a>        <span class="c1"># distance test</span>
</span><span id="Topology-753"><a href="#Topology-753"><span class="linenos"> 753</span></a>        <span class="n">match</span> <span class="o">=</span> <span class="n">affine</span><span class="o">.</span><span class="n">affine_transform</span><span class="p">(</span><span class="n">geom1</span><span class="o">.</span><span class="n">point</span><span class="p">,</span> <span class="n">transform</span><span class="p">)</span><span class="o">.</span><span class="n">distance</span><span class="p">(</span>
</span><span id="Topology-754"><a href="#Topology-754"><span class="linenos"> 754</span></a>          <span class="n">geom2</span><span class="o">.</span><span class="n">point</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">tiling_utils</span><span class="o">.</span><span class="n">RESOLUTION</span>
</span><span id="Topology-755"><a href="#Topology-755"><span class="linenos"> 755</span></a>      <span class="k">else</span><span class="p">:</span> <span class="c1"># must be an Edge</span>
</span><span id="Topology-756"><a href="#Topology-756"><span class="linenos"> 756</span></a>        <span class="c1"># since edges _should not_ intersect this test should work in</span>
</span><span id="Topology-757"><a href="#Topology-757"><span class="linenos"> 757</span></a>        <span class="c1"># lieu of a more complete point by point comparison</span>
</span><span id="Topology-758"><a href="#Topology-758"><span class="linenos"> 758</span></a>        <span class="n">c1</span> <span class="o">=</span> <span class="n">geom1</span><span class="o">.</span><span class="n">get_geometry</span><span class="p">()</span><span class="o">.</span><span class="n">centroid</span>
</span><span id="Topology-759"><a href="#Topology-759"><span class="linenos"> 759</span></a>        <span class="n">c2</span> <span class="o">=</span> <span class="n">geom2</span><span class="o">.</span><span class="n">get_geometry</span><span class="p">()</span><span class="o">.</span><span class="n">centroid</span>
</span><span id="Topology-760"><a href="#Topology-760"><span class="linenos"> 760</span></a>        <span class="n">match</span> <span class="o">=</span> <span class="n">affine</span><span class="o">.</span><span class="n">affine_transform</span><span class="p">(</span><span class="n">c1</span><span class="p">,</span> <span class="n">transform</span><span class="p">)</span> \
</span><span id="Topology-761"><a href="#Topology-761"><span class="linenos"> 761</span></a>          <span class="o">.</span><span class="n">distance</span><span class="p">(</span><span class="n">c2</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">10</span> <span class="o">*</span><span class="n">tiling_utils</span><span class="o">.</span><span class="n">RESOLUTION</span>
</span><span id="Topology-762"><a href="#Topology-762"><span class="linenos"> 762</span></a>      <span class="k">if</span> <span class="n">match</span><span class="p">:</span>
</span><span id="Topology-763"><a href="#Topology-763"><span class="linenos"> 763</span></a>        <span class="k">return</span> <span class="n">geom2</span><span class="o">.</span><span class="n">base_ID</span>
</span><span id="Topology-764"><a href="#Topology-764"><span class="linenos"> 764</span></a>    <span class="k">return</span> <span class="n">match_id</span>
</span><span id="Topology-765"><a href="#Topology-765"><span class="linenos"> 765</span></a>
</span><span id="Topology-766"><a href="#Topology-766"><span class="linenos"> 766</span></a>
</span><span id="Topology-767"><a href="#Topology-767"><span class="linenos"> 767</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">_get_exclusive_supersets</span><span class="p">(</span>
</span><span id="Topology-768"><a href="#Topology-768"><span class="linenos"> 768</span></a>      <span class="bp">self</span><span class="p">,</span> <span class="n">sets</span><span class="p">:</span><span class="nb">list</span><span class="p">[</span><span class="n">Iterable</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Iterable</span><span class="p">]:</span>
</span><span id="Topology-769"><a href="#Topology-769"><span class="linenos"> 769</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return sets of elements not found in the same set among those supplied.</span>
</span><span id="Topology-770"><a href="#Topology-770"><span class="linenos"> 770</span></a>
</span><span id="Topology-771"><a href="#Topology-771"><span class="linenos"> 771</span></a><span class="sd">    The supplied sets share elements, i.e., they are non-exclusives sets. The</span>
</span><span id="Topology-772"><a href="#Topology-772"><span class="linenos"> 772</span></a><span class="sd">    returned sets are exclusive: each element will only appear in one of the</span>
</span><span id="Topology-773"><a href="#Topology-773"><span class="linenos"> 773</span></a><span class="sd">    sets in the returned list. This is accomplished using networkx&#39;s</span>
</span><span id="Topology-774"><a href="#Topology-774"><span class="linenos"> 774</span></a><span class="sd">    connected components applied to a graph where each intersection between two</span>
</span><span id="Topology-775"><a href="#Topology-775"><span class="linenos"> 775</span></a><span class="sd">    sets is an edge.</span>
</span><span id="Topology-776"><a href="#Topology-776"><span class="linenos"> 776</span></a>
</span><span id="Topology-777"><a href="#Topology-777"><span class="linenos"> 777</span></a><span class="sd">    Args:</span>
</span><span id="Topology-778"><a href="#Topology-778"><span class="linenos"> 778</span></a><span class="sd">        sets (list[Iterable]): list of lists of possibly overlapping sets.</span>
</span><span id="Topology-779"><a href="#Topology-779"><span class="linenos"> 779</span></a>
</span><span id="Topology-780"><a href="#Topology-780"><span class="linenos"> 780</span></a><span class="sd">    Returns:</span>
</span><span id="Topology-781"><a href="#Topology-781"><span class="linenos"> 781</span></a><span class="sd">      list[Iterable]: list of lists that include all the original</span>
</span><span id="Topology-782"><a href="#Topology-782"><span class="linenos"> 782</span></a><span class="sd">        elements without overlaps.</span>
</span><span id="Topology-783"><a href="#Topology-783"><span class="linenos"> 783</span></a>
</span><span id="Topology-784"><a href="#Topology-784"><span class="linenos"> 784</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Topology-785"><a href="#Topology-785"><span class="linenos"> 785</span></a>    <span class="n">overlaps</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Topology-786"><a href="#Topology-786"><span class="linenos"> 786</span></a>    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">si</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">sets</span><span class="p">):</span>
</span><span id="Topology-787"><a href="#Topology-787"><span class="linenos"> 787</span></a>      <span class="n">s1</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">si</span><span class="p">)</span>
</span><span id="Topology-788"><a href="#Topology-788"><span class="linenos"> 788</span></a>      <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">sj</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">sets</span><span class="p">):</span>
</span><span id="Topology-789"><a href="#Topology-789"><span class="linenos"> 789</span></a>        <span class="n">s2</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">sj</span><span class="p">)</span>
</span><span id="Topology-790"><a href="#Topology-790"><span class="linenos"> 790</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">s1</span> <span class="o">&amp;</span> <span class="n">s2</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Topology-791"><a href="#Topology-791"><span class="linenos"> 791</span></a>          <span class="n">overlaps</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>
</span><span id="Topology-792"><a href="#Topology-792"><span class="linenos"> 792</span></a>    <span class="n">G</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">from_edgelist</span><span class="p">(</span><span class="n">overlaps</span><span class="p">)</span>
</span><span id="Topology-793"><a href="#Topology-793"><span class="linenos"> 793</span></a>    <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Topology-794"><a href="#Topology-794"><span class="linenos"> 794</span></a>    <span class="k">for</span> <span class="n">component</span> <span class="ow">in</span> <span class="n">nx</span><span class="o">.</span><span class="n">connected_components</span><span class="p">(</span><span class="n">G</span><span class="p">):</span>
</span><span id="Topology-795"><a href="#Topology-795"><span class="linenos"> 795</span></a>      <span class="n">s</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
</span><span id="Topology-796"><a href="#Topology-796"><span class="linenos"> 796</span></a>      <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">component</span><span class="p">:</span>
</span><span id="Topology-797"><a href="#Topology-797"><span class="linenos"> 797</span></a>        <span class="n">s</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">sets</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span><span id="Topology-798"><a href="#Topology-798"><span class="linenos"> 798</span></a>      <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">s</span><span class="p">))</span>
</span><span id="Topology-799"><a href="#Topology-799"><span class="linenos"> 799</span></a>    <span class="k">return</span> <span class="n">result</span>
</span><span id="Topology-800"><a href="#Topology-800"><span class="linenos"> 800</span></a>
</span><span id="Topology-801"><a href="#Topology-801"><span class="linenos"> 801</span></a>
</span><span id="Topology-802"><a href="#Topology-802"><span class="linenos"> 802</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">vertices_in_tiles</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tiles</span><span class="p">:</span><span class="nb">list</span><span class="p">[</span><span class="n">Tile</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Vertex</span><span class="p">]:</span>
</span><span id="Topology-803"><a href="#Topology-803"><span class="linenos"> 803</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get vertices incident on tiles in supplied list.</span>
</span><span id="Topology-804"><a href="#Topology-804"><span class="linenos"> 804</span></a>
</span><span id="Topology-805"><a href="#Topology-805"><span class="linenos"> 805</span></a><span class="sd">    Args:</span>
</span><span id="Topology-806"><a href="#Topology-806"><span class="linenos"> 806</span></a><span class="sd">      tiles (list[Tile]): tiles whose vertices are required.</span>
</span><span id="Topology-807"><a href="#Topology-807"><span class="linenos"> 807</span></a>
</span><span id="Topology-808"><a href="#Topology-808"><span class="linenos"> 808</span></a><span class="sd">    Returns:</span>
</span><span id="Topology-809"><a href="#Topology-809"><span class="linenos"> 809</span></a><span class="sd">      list[Vertex]: the required vertices.</span>
</span><span id="Topology-810"><a href="#Topology-810"><span class="linenos"> 810</span></a>
</span><span id="Topology-811"><a href="#Topology-811"><span class="linenos"> 811</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Topology-812"><a href="#Topology-812"><span class="linenos"> 812</span></a>    <span class="n">vs</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
</span><span id="Topology-813"><a href="#Topology-813"><span class="linenos"> 813</span></a>    <span class="k">for</span> <span class="n">tile</span> <span class="ow">in</span> <span class="n">tiles</span><span class="p">:</span>
</span><span id="Topology-814"><a href="#Topology-814"><span class="linenos"> 814</span></a>      <span class="n">vs</span> <span class="o">=</span> <span class="n">vs</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">tile</span><span class="o">.</span><span class="n">get_corner_IDs</span><span class="p">())</span>
</span><span id="Topology-815"><a href="#Topology-815"><span class="linenos"> 815</span></a>    <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">points</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">vs</span><span class="p">]</span>
</span><span id="Topology-816"><a href="#Topology-816"><span class="linenos"> 816</span></a>
</span><span id="Topology-817"><a href="#Topology-817"><span class="linenos"> 817</span></a>
</span><span id="Topology-818"><a href="#Topology-818"><span class="linenos"> 818</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">edges_in_tiles</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tiles</span><span class="p">:</span><span class="nb">list</span><span class="p">[</span><span class="n">Tile</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Edge</span><span class="p">]:</span>
</span><span id="Topology-819"><a href="#Topology-819"><span class="linenos"> 819</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get edges that are part of the boundary of tiles in supplied list.</span>
</span><span id="Topology-820"><a href="#Topology-820"><span class="linenos"> 820</span></a>
</span><span id="Topology-821"><a href="#Topology-821"><span class="linenos"> 821</span></a><span class="sd">    Args:</span>
</span><span id="Topology-822"><a href="#Topology-822"><span class="linenos"> 822</span></a><span class="sd">      tiles (list[Tile]): tiles whose edges are required.</span>
</span><span id="Topology-823"><a href="#Topology-823"><span class="linenos"> 823</span></a>
</span><span id="Topology-824"><a href="#Topology-824"><span class="linenos"> 824</span></a><span class="sd">    Returns:</span>
</span><span id="Topology-825"><a href="#Topology-825"><span class="linenos"> 825</span></a><span class="sd">      list[Edge]: the required edges.</span>
</span><span id="Topology-826"><a href="#Topology-826"><span class="linenos"> 826</span></a>
</span><span id="Topology-827"><a href="#Topology-827"><span class="linenos"> 827</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Topology-828"><a href="#Topology-828"><span class="linenos"> 828</span></a>    <span class="n">es</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
</span><span id="Topology-829"><a href="#Topology-829"><span class="linenos"> 829</span></a>    <span class="k">for</span> <span class="n">tile</span> <span class="ow">in</span> <span class="n">tiles</span><span class="p">:</span>
</span><span id="Topology-830"><a href="#Topology-830"><span class="linenos"> 830</span></a>      <span class="n">es</span> <span class="o">=</span> <span class="n">es</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">tile</span><span class="o">.</span><span class="n">get_edge_IDs</span><span class="p">())</span>
</span><span id="Topology-831"><a href="#Topology-831"><span class="linenos"> 831</span></a>    <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">e</span><span class="p">]</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">es</span><span class="p">]</span>
</span><span id="Topology-832"><a href="#Topology-832"><span class="linenos"> 832</span></a>
</span><span id="Topology-833"><a href="#Topology-833"><span class="linenos"> 833</span></a>
</span><span id="Topology-834"><a href="#Topology-834"><span class="linenos"> 834</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">generate_dual</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">geom</span><span class="o">.</span><span class="n">Polygon</span><span class="p">]:</span>
</span><span id="Topology-835"><a href="#Topology-835"><span class="linenos"> 835</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Create the dual tiiing for the tiling of this Topology.</span>
</span><span id="Topology-836"><a href="#Topology-836"><span class="linenos"> 836</span></a>
</span><span id="Topology-837"><a href="#Topology-837"><span class="linenos"> 837</span></a><span class="sd">    TODO: make this a viable replacement for the existing dual tiling</span>
</span><span id="Topology-838"><a href="#Topology-838"><span class="linenos"> 838</span></a><span class="sd">    generation.</span>
</span><span id="Topology-839"><a href="#Topology-839"><span class="linenos"> 839</span></a>
</span><span id="Topology-840"><a href="#Topology-840"><span class="linenos"> 840</span></a><span class="sd">    TODO: also need to ensure that this finds a set of dual tiles that exhaust</span>
</span><span id="Topology-841"><a href="#Topology-841"><span class="linenos"> 841</span></a><span class="sd">    the plane...</span>
</span><span id="Topology-842"><a href="#Topology-842"><span class="linenos"> 842</span></a>
</span><span id="Topology-843"><a href="#Topology-843"><span class="linenos"> 843</span></a><span class="sd">    Returns:</span>
</span><span id="Topology-844"><a href="#Topology-844"><span class="linenos"> 844</span></a><span class="sd">      list[geom.Polygon]: a list of polygon objects.</span>
</span><span id="Topology-845"><a href="#Topology-845"><span class="linenos"> 845</span></a>
</span><span id="Topology-846"><a href="#Topology-846"><span class="linenos"> 846</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Topology-847"><a href="#Topology-847"><span class="linenos"> 847</span></a>    <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">points</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
</span><span id="Topology-848"><a href="#Topology-848"><span class="linenos"> 848</span></a>      <span class="n">v</span><span class="o">.</span><span class="n">clockwise_order_incident_tiles</span><span class="p">()</span>
</span><span id="Topology-849"><a href="#Topology-849"><span class="linenos"> 849</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">dual_tiles</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="Topology-850"><a href="#Topology-850"><span class="linenos"> 850</span></a>    <span class="n">base_id_sets</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
</span><span id="Topology-851"><a href="#Topology-851"><span class="linenos"> 851</span></a>    <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">points</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
</span><span id="Topology-852"><a href="#Topology-852"><span class="linenos"> 852</span></a>      <span class="n">base_id_sets</span><span class="p">[</span><span class="n">v</span><span class="o">.</span><span class="n">base_ID</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">ID</span><span class="p">)</span>
</span><span id="Topology-853"><a href="#Topology-853"><span class="linenos"> 853</span></a>    <span class="n">minimal_set</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">points</span><span class="p">[</span><span class="nb">min</span><span class="p">(</span><span class="n">s</span><span class="p">)]</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">base_id_sets</span><span class="o">.</span><span class="n">values</span><span class="p">()]</span>
</span><span id="Topology-854"><a href="#Topology-854"><span class="linenos"> 854</span></a>    <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">minimal_set</span><span class="p">:</span>
</span><span id="Topology-855"><a href="#Topology-855"><span class="linenos"> 855</span></a>    <span class="c1"># for v in self.points.values():</span>
</span><span id="Topology-856"><a href="#Topology-856"><span class="linenos"> 856</span></a>      <span class="k">if</span> <span class="n">v</span><span class="o">.</span><span class="n">is_interior</span><span class="p">()</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">tiles</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="Topology-857"><a href="#Topology-857"><span class="linenos"> 857</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">dual_tiles</span><span class="p">[</span><span class="n">v</span><span class="o">.</span><span class="n">ID</span><span class="p">]</span> <span class="o">=</span> \
</span><span id="Topology-858"><a href="#Topology-858"><span class="linenos"> 858</span></a>          <span class="n">geom</span><span class="o">.</span><span class="n">Polygon</span><span class="p">([</span><span class="n">t</span><span class="o">.</span><span class="n">centre</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">v</span><span class="o">.</span><span class="n">tiles</span><span class="p">])</span>
</span><span id="Topology-859"><a href="#Topology-859"><span class="linenos"> 859</span></a>
</span><span id="Topology-860"><a href="#Topology-860"><span class="linenos"> 860</span></a>
</span><span id="Topology-861"><a href="#Topology-861"><span class="linenos"> 861</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">get_dual_tiles</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">:</span>
</span><span id="Topology-862"><a href="#Topology-862"><span class="linenos"> 862</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return dual tiles as GeoDataFrame.&quot;&quot;&quot;</span>
</span><span id="Topology-863"><a href="#Topology-863"><span class="linenos"> 863</span></a>    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dual_tiles</span><span class="p">)</span>
</span><span id="Topology-864"><a href="#Topology-864"><span class="linenos"> 864</span></a>    <span class="k">return</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">(</span>
</span><span id="Topology-865"><a href="#Topology-865"><span class="linenos"> 865</span></a>      <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;tile_id&quot;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tileable</span><span class="o">.</span><span class="n">tiles</span><span class="o">.</span><span class="n">tile_id</span><span class="p">)[:</span><span class="n">n</span><span class="p">]},</span>
</span><span id="Topology-866"><a href="#Topology-866"><span class="linenos"> 866</span></a>      <span class="n">geometry</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoSeries</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dual_tiles</span><span class="o">.</span><span class="n">values</span><span class="p">()),</span>
</span><span id="Topology-867"><a href="#Topology-867"><span class="linenos"> 867</span></a>      <span class="n">crs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tileable</span><span class="o">.</span><span class="n">crs</span><span class="p">)</span>
</span><span id="Topology-868"><a href="#Topology-868"><span class="linenos"> 868</span></a>
</span><span id="Topology-869"><a href="#Topology-869"><span class="linenos"> 869</span></a>
</span><span id="Topology-870"><a href="#Topology-870"><span class="linenos"> 870</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">add_vertex</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pt</span><span class="p">:</span><span class="n">geom</span><span class="o">.</span><span class="n">Point</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Vertex</span><span class="p">:</span>
</span><span id="Topology-871"><a href="#Topology-871"><span class="linenos"> 871</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Add and return Vertex at the specified point location.</span>
</span><span id="Topology-872"><a href="#Topology-872"><span class="linenos"> 872</span></a>
</span><span id="Topology-873"><a href="#Topology-873"><span class="linenos"> 873</span></a><span class="sd">    No attempt is made to ensure Vertex IDs are an unbroken sequence: a new ID</span>
</span><span id="Topology-874"><a href="#Topology-874"><span class="linenos"> 874</span></a><span class="sd">    is generated one greater than the existing highest ID. IDs will usually be</span>
</span><span id="Topology-875"><a href="#Topology-875"><span class="linenos"> 875</span></a><span class="sd">    an unbroken sequence up to removals when geometry transformations are</span>
</span><span id="Topology-876"><a href="#Topology-876"><span class="linenos"> 876</span></a><span class="sd">    applied.</span>
</span><span id="Topology-877"><a href="#Topology-877"><span class="linenos"> 877</span></a>
</span><span id="Topology-878"><a href="#Topology-878"><span class="linenos"> 878</span></a><span class="sd">    Args:</span>
</span><span id="Topology-879"><a href="#Topology-879"><span class="linenos"> 879</span></a><span class="sd">      pt (geom.Point): point location of the Vertex.</span>
</span><span id="Topology-880"><a href="#Topology-880"><span class="linenos"> 880</span></a>
</span><span id="Topology-881"><a href="#Topology-881"><span class="linenos"> 881</span></a><span class="sd">    Returns:</span>
</span><span id="Topology-882"><a href="#Topology-882"><span class="linenos"> 882</span></a><span class="sd">      Vertex: the added Vertex object.</span>
</span><span id="Topology-883"><a href="#Topology-883"><span class="linenos"> 883</span></a>
</span><span id="Topology-884"><a href="#Topology-884"><span class="linenos"> 884</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Topology-885"><a href="#Topology-885"><span class="linenos"> 885</span></a>    <span class="n">n</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">points</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">points</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="o">+</span> <span class="mi">1</span>
</span><span id="Topology-886"><a href="#Topology-886"><span class="linenos"> 886</span></a>    <span class="n">v</span> <span class="o">=</span> <span class="n">Vertex</span><span class="p">(</span><span class="n">pt</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
</span><span id="Topology-887"><a href="#Topology-887"><span class="linenos"> 887</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">points</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>
</span><span id="Topology-888"><a href="#Topology-888"><span class="linenos"> 888</span></a>    <span class="k">return</span> <span class="n">v</span>
</span><span id="Topology-889"><a href="#Topology-889"><span class="linenos"> 889</span></a>
</span><span id="Topology-890"><a href="#Topology-890"><span class="linenos"> 890</span></a>
</span><span id="Topology-891"><a href="#Topology-891"><span class="linenos"> 891</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">add_edge</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vs</span><span class="p">:</span><span class="nb">list</span><span class="p">[</span><span class="n">Vertex</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Edge</span><span class="p">:</span>
</span><span id="Topology-892"><a href="#Topology-892"><span class="linenos"> 892</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Create an Edge from the suppled vertices and return it.</span>
</span><span id="Topology-893"><a href="#Topology-893"><span class="linenos"> 893</span></a>
</span><span id="Topology-894"><a href="#Topology-894"><span class="linenos"> 894</span></a><span class="sd">    The new Edge is added to the edges dictionary. Edges are self indexing by</span>
</span><span id="Topology-895"><a href="#Topology-895"><span class="linenos"> 895</span></a><span class="sd">    the IDs of their end Vertices.</span>
</span><span id="Topology-896"><a href="#Topology-896"><span class="linenos"> 896</span></a>
</span><span id="Topology-897"><a href="#Topology-897"><span class="linenos"> 897</span></a><span class="sd">    Args:</span>
</span><span id="Topology-898"><a href="#Topology-898"><span class="linenos"> 898</span></a><span class="sd">      vs (list[Vertex]): list of Vertices in the Edge to be created.</span>
</span><span id="Topology-899"><a href="#Topology-899"><span class="linenos"> 899</span></a>
</span><span id="Topology-900"><a href="#Topology-900"><span class="linenos"> 900</span></a><span class="sd">    Returns:</span>
</span><span id="Topology-901"><a href="#Topology-901"><span class="linenos"> 901</span></a><span class="sd">        Edge: the added Edge.</span>
</span><span id="Topology-902"><a href="#Topology-902"><span class="linenos"> 902</span></a>
</span><span id="Topology-903"><a href="#Topology-903"><span class="linenos"> 903</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Topology-904"><a href="#Topology-904"><span class="linenos"> 904</span></a>    <span class="n">e</span> <span class="o">=</span> <span class="n">Edge</span><span class="p">(</span><span class="n">vs</span><span class="p">)</span>
</span><span id="Topology-905"><a href="#Topology-905"><span class="linenos"> 905</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">ID</span><span class="p">]</span> <span class="o">=</span> <span class="n">e</span>
</span><span id="Topology-906"><a href="#Topology-906"><span class="linenos"> 906</span></a>    <span class="k">return</span> <span class="n">e</span>
</span><span id="Topology-907"><a href="#Topology-907"><span class="linenos"> 907</span></a>
</span><span id="Topology-908"><a href="#Topology-908"><span class="linenos"> 908</span></a>
</span><span id="Topology-909"><a href="#Topology-909"><span class="linenos"> 909</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">polygon_matches</span><span class="p">(</span>
</span><span id="Topology-910"><a href="#Topology-910"><span class="linenos"> 910</span></a>      <span class="bp">self</span><span class="p">,</span>
</span><span id="Topology-911"><a href="#Topology-911"><span class="linenos"> 911</span></a>      <span class="n">geom1</span><span class="p">:</span><span class="n">geom</span><span class="o">.</span><span class="n">Polygon</span><span class="p">,</span>
</span><span id="Topology-912"><a href="#Topology-912"><span class="linenos"> 912</span></a>      <span class="n">geom2</span><span class="p">:</span><span class="n">geom</span><span class="o">.</span><span class="n">Polygon</span><span class="p">,</span>
</span><span id="Topology-913"><a href="#Topology-913"><span class="linenos"> 913</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="Topology-914"><a href="#Topology-914"><span class="linenos"> 914</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Test if supplied polygons match geometrically.</span>
</span><span id="Topology-915"><a href="#Topology-915"><span class="linenos"> 915</span></a>
</span><span id="Topology-916"><a href="#Topology-916"><span class="linenos"> 916</span></a><span class="sd">    Tests for equality of area, and equality of their area of overlap to their</span>
</span><span id="Topology-917"><a href="#Topology-917"><span class="linenos"> 917</span></a><span class="sd">    shared area, i.e. Area1 == Area2 == (Area 1 intersection 2).</span>
</span><span id="Topology-918"><a href="#Topology-918"><span class="linenos"> 918</span></a>
</span><span id="Topology-919"><a href="#Topology-919"><span class="linenos"> 919</span></a><span class="sd">    Args:</span>
</span><span id="Topology-920"><a href="#Topology-920"><span class="linenos"> 920</span></a><span class="sd">      geom1 (geom.Polygon): first polygon.</span>
</span><span id="Topology-921"><a href="#Topology-921"><span class="linenos"> 921</span></a><span class="sd">      geom2 (geom.Polygon): second polygon.</span>
</span><span id="Topology-922"><a href="#Topology-922"><span class="linenos"> 922</span></a>
</span><span id="Topology-923"><a href="#Topology-923"><span class="linenos"> 923</span></a><span class="sd">    Returns:</span>
</span><span id="Topology-924"><a href="#Topology-924"><span class="linenos"> 924</span></a><span class="sd">      bool: True if the polygons are the same, False otherwise.</span>
</span><span id="Topology-925"><a href="#Topology-925"><span class="linenos"> 925</span></a>
</span><span id="Topology-926"><a href="#Topology-926"><span class="linenos"> 926</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Topology-927"><a href="#Topology-927"><span class="linenos"> 927</span></a>    <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">geom1</span><span class="o">.</span><span class="n">area</span><span class="p">,</span> <span class="n">geom2</span><span class="o">.</span><span class="n">area</span>
</span><span id="Topology-928"><a href="#Topology-928"><span class="linenos"> 928</span></a>    <span class="k">return</span> <span class="nb">bool</span><span class="p">(</span>
</span><span id="Topology-929"><a href="#Topology-929"><span class="linenos"> 929</span></a>      <span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span>
</span><span id="Topology-930"><a href="#Topology-930"><span class="linenos"> 930</span></a>                 <span class="n">rtol</span> <span class="o">=</span> <span class="n">tiling_utils</span><span class="o">.</span><span class="n">RESOLUTION</span> <span class="o">*</span> <span class="mi">100</span><span class="p">,</span>
</span><span id="Topology-931"><a href="#Topology-931"><span class="linenos"> 931</span></a>                 <span class="n">atol</span> <span class="o">=</span> <span class="n">tiling_utils</span><span class="o">.</span><span class="n">RESOLUTION</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span> <span class="ow">and</span>
</span><span id="Topology-932"><a href="#Topology-932"><span class="linenos"> 932</span></a>      <span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">geom1</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">geom2</span><span class="p">)</span><span class="o">.</span><span class="n">area</span><span class="p">,</span>
</span><span id="Topology-933"><a href="#Topology-933"><span class="linenos"> 933</span></a>                 <span class="n">rtol</span> <span class="o">=</span> <span class="n">tiling_utils</span><span class="o">.</span><span class="n">RESOLUTION</span> <span class="o">*</span> <span class="mi">100</span><span class="p">,</span>
</span><span id="Topology-934"><a href="#Topology-934"><span class="linenos"> 934</span></a>                 <span class="n">atol</span> <span class="o">=</span> <span class="n">tiling_utils</span><span class="o">.</span><span class="n">RESOLUTION</span> <span class="o">*</span> <span class="mi">100</span><span class="p">))</span>
</span><span id="Topology-935"><a href="#Topology-935"><span class="linenos"> 935</span></a>
</span><span id="Topology-936"><a href="#Topology-936"><span class="linenos"> 936</span></a>
</span><span id="Topology-937"><a href="#Topology-937"><span class="linenos"> 937</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">_get_tile_geoms</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">:</span>
</span><span id="Topology-938"><a href="#Topology-938"><span class="linenos"> 938</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return GeoDataFrame of the tiles.</span>
</span><span id="Topology-939"><a href="#Topology-939"><span class="linenos"> 939</span></a>
</span><span id="Topology-940"><a href="#Topology-940"><span class="linenos"> 940</span></a><span class="sd">    Returns:</span>
</span><span id="Topology-941"><a href="#Topology-941"><span class="linenos"> 941</span></a><span class="sd">      gpd.GeoDataFrame: the tiles as a GeoDataFrame.</span>
</span><span id="Topology-942"><a href="#Topology-942"><span class="linenos"> 942</span></a>
</span><span id="Topology-943"><a href="#Topology-943"><span class="linenos"> 943</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Topology-944"><a href="#Topology-944"><span class="linenos"> 944</span></a>    <span class="k">return</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">(</span>
</span><span id="Topology-945"><a href="#Topology-945"><span class="linenos"> 945</span></a>      <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;transitivity_class&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">transitivity_class</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tiles</span><span class="p">]},</span>
</span><span id="Topology-946"><a href="#Topology-946"><span class="linenos"> 946</span></a>      <span class="n">geometry</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoSeries</span><span class="p">([</span><span class="n">t</span><span class="o">.</span><span class="n">shape</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tiles</span><span class="p">]))</span>
</span><span id="Topology-947"><a href="#Topology-947"><span class="linenos"> 947</span></a>
</span><span id="Topology-948"><a href="#Topology-948"><span class="linenos"> 948</span></a>
</span><span id="Topology-949"><a href="#Topology-949"><span class="linenos"> 949</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">_get_tile_centre_geoms</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoSeries</span><span class="p">:</span>
</span><span id="Topology-950"><a href="#Topology-950"><span class="linenos"> 950</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the centre of tiles as a GeoDataFrame.</span>
</span><span id="Topology-951"><a href="#Topology-951"><span class="linenos"> 951</span></a>
</span><span id="Topology-952"><a href="#Topology-952"><span class="linenos"> 952</span></a><span class="sd">    Returns:</span>
</span><span id="Topology-953"><a href="#Topology-953"><span class="linenos"> 953</span></a><span class="sd">      gpd.GeoDataFrame: the tiles centres.</span>
</span><span id="Topology-954"><a href="#Topology-954"><span class="linenos"> 954</span></a>
</span><span id="Topology-955"><a href="#Topology-955"><span class="linenos"> 955</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Topology-956"><a href="#Topology-956"><span class="linenos"> 956</span></a>    <span class="k">return</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoSeries</span><span class="p">([</span><span class="n">t</span><span class="o">.</span><span class="n">centre</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tiles</span><span class="p">])</span>
</span><span id="Topology-957"><a href="#Topology-957"><span class="linenos"> 957</span></a>
</span><span id="Topology-958"><a href="#Topology-958"><span class="linenos"> 958</span></a>
</span><span id="Topology-959"><a href="#Topology-959"><span class="linenos"> 959</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">_get_point_geoms</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoSeries</span><span class="p">:</span>
</span><span id="Topology-960"><a href="#Topology-960"><span class="linenos"> 960</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return tiling vertices and tile corners as a GeoDataFrame of Points.</span>
</span><span id="Topology-961"><a href="#Topology-961"><span class="linenos"> 961</span></a>
</span><span id="Topology-962"><a href="#Topology-962"><span class="linenos"> 962</span></a><span class="sd">    Returns:</span>
</span><span id="Topology-963"><a href="#Topology-963"><span class="linenos"> 963</span></a><span class="sd">      gpd.GeoDataFrame: corners and vertices of the tiling.</span>
</span><span id="Topology-964"><a href="#Topology-964"><span class="linenos"> 964</span></a>
</span><span id="Topology-965"><a href="#Topology-965"><span class="linenos"> 965</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Topology-966"><a href="#Topology-966"><span class="linenos"> 966</span></a>    <span class="k">return</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoSeries</span><span class="p">([</span><span class="n">v</span><span class="o">.</span><span class="n">point</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">points</span><span class="o">.</span><span class="n">values</span><span class="p">()])</span>
</span><span id="Topology-967"><a href="#Topology-967"><span class="linenos"> 967</span></a>
</span><span id="Topology-968"><a href="#Topology-968"><span class="linenos"> 968</span></a>
</span><span id="Topology-969"><a href="#Topology-969"><span class="linenos"> 969</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">_get_vertex_geoms</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoSeries</span><span class="p">:</span>
</span><span id="Topology-970"><a href="#Topology-970"><span class="linenos"> 970</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return tiling vertices (not corners) as a GeoDataFrame of Points.</span>
</span><span id="Topology-971"><a href="#Topology-971"><span class="linenos"> 971</span></a>
</span><span id="Topology-972"><a href="#Topology-972"><span class="linenos"> 972</span></a><span class="sd">    Returns:</span>
</span><span id="Topology-973"><a href="#Topology-973"><span class="linenos"> 973</span></a><span class="sd">      gpd.GeoDataFrame: vertices of the tiling.</span>
</span><span id="Topology-974"><a href="#Topology-974"><span class="linenos"> 974</span></a>
</span><span id="Topology-975"><a href="#Topology-975"><span class="linenos"> 975</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Topology-976"><a href="#Topology-976"><span class="linenos"> 976</span></a>    <span class="k">return</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoSeries</span><span class="p">([</span><span class="n">v</span><span class="o">.</span><span class="n">point</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">points</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
</span><span id="Topology-977"><a href="#Topology-977"><span class="linenos"> 977</span></a>                          <span class="k">if</span> <span class="n">v</span><span class="o">.</span><span class="n">is_tiling_vertex</span><span class="p">])</span>
</span><span id="Topology-978"><a href="#Topology-978"><span class="linenos"> 978</span></a>
</span><span id="Topology-979"><a href="#Topology-979"><span class="linenos"> 979</span></a>
</span><span id="Topology-980"><a href="#Topology-980"><span class="linenos"> 980</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">_get_edge_geoms</span><span class="p">(</span>
</span><span id="Topology-981"><a href="#Topology-981"><span class="linenos"> 981</span></a>      <span class="bp">self</span><span class="p">,</span>
</span><span id="Topology-982"><a href="#Topology-982"><span class="linenos"> 982</span></a>      <span class="n">offset</span><span class="p">:</span><span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
</span><span id="Topology-983"><a href="#Topology-983"><span class="linenos"> 983</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoSeries</span><span class="p">:</span>
</span><span id="Topology-984"><a href="#Topology-984"><span class="linenos"> 984</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return tiling edges a GeoSeries of LineStrings optionally offset.</span>
</span><span id="Topology-985"><a href="#Topology-985"><span class="linenos"> 985</span></a>
</span><span id="Topology-986"><a href="#Topology-986"><span class="linenos"> 986</span></a><span class="sd">    Offsetting the edges allows their direction to be seen when visualised.</span>
</span><span id="Topology-987"><a href="#Topology-987"><span class="linenos"> 987</span></a>
</span><span id="Topology-988"><a href="#Topology-988"><span class="linenos"> 988</span></a><span class="sd">    Returns:</span>
</span><span id="Topology-989"><a href="#Topology-989"><span class="linenos"> 989</span></a><span class="sd">      gpd.GeoDataFrame: edges of the tiling.</span>
</span><span id="Topology-990"><a href="#Topology-990"><span class="linenos"> 990</span></a>
</span><span id="Topology-991"><a href="#Topology-991"><span class="linenos"> 991</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Topology-992"><a href="#Topology-992"><span class="linenos"> 992</span></a>    <span class="k">return</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoSeries</span><span class="p">([</span><span class="n">e</span><span class="o">.</span><span class="n">get_topology</span><span class="p">()</span><span class="o">.</span><span class="n">parallel_offset</span><span class="p">(</span><span class="n">offset</span><span class="p">)</span>
</span><span id="Topology-993"><a href="#Topology-993"><span class="linenos"> 993</span></a>                          <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="o">.</span><span class="n">values</span><span class="p">()])</span>
</span><span id="Topology-994"><a href="#Topology-994"><span class="linenos"> 994</span></a>
</span><span id="Topology-995"><a href="#Topology-995"><span class="linenos"> 995</span></a>
</span><span id="Topology-996"><a href="#Topology-996"><span class="linenos"> 996</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">plot</span><span class="p">(</span>
</span><span id="Topology-997"><a href="#Topology-997"><span class="linenos"> 997</span></a>      <span class="bp">self</span><span class="p">,</span>
</span><span id="Topology-998"><a href="#Topology-998"><span class="linenos"> 998</span></a>      <span class="n">show_original_tiles</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="Topology-999"><a href="#Topology-999"><span class="linenos"> 999</span></a>      <span class="n">show_tile_centres</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="Topology-1000"><a href="#Topology-1000"><span class="linenos">1000</span></a>      <span class="n">show_vertex_labels</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="Topology-1001"><a href="#Topology-1001"><span class="linenos">1001</span></a>      <span class="n">show_vertex_ids</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="Topology-1002"><a href="#Topology-1002"><span class="linenos">1002</span></a>      <span class="n">show_edges</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="Topology-1003"><a href="#Topology-1003"><span class="linenos">1003</span></a>      <span class="n">offset_edges</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="Topology-1004"><a href="#Topology-1004"><span class="linenos">1004</span></a>      <span class="n">show_edge_labels</span><span class="p">:</span><span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="Topology-1005"><a href="#Topology-1005"><span class="linenos">1005</span></a>      <span class="n">show_dual_tiles</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="Topology-1006"><a href="#Topology-1006"><span class="linenos">1006</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">plt</span><span class="o">.</span><span class="n">Axes</span><span class="p">:</span>
</span><span id="Topology-1007"><a href="#Topology-1007"><span class="linenos">1007</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Delegate plotting of requested elements and return plt.Axes.</span>
</span><span id="Topology-1008"><a href="#Topology-1008"><span class="linenos">1008</span></a>
</span><span id="Topology-1009"><a href="#Topology-1009"><span class="linenos">1009</span></a><span class="sd">    Args:</span>
</span><span id="Topology-1010"><a href="#Topology-1010"><span class="linenos">1010</span></a><span class="sd">      show_original_tiles (bool, optional): if True show the tiles. Defaults to</span>
</span><span id="Topology-1011"><a href="#Topology-1011"><span class="linenos">1011</span></a><span class="sd">        True.</span>
</span><span id="Topology-1012"><a href="#Topology-1012"><span class="linenos">1012</span></a><span class="sd">      show_tile_centres (bool, optional): if True show tile centres with upper</span>
</span><span id="Topology-1013"><a href="#Topology-1013"><span class="linenos">1013</span></a><span class="sd">        case alphabetical labels. Defaults to False.</span>
</span><span id="Topology-1014"><a href="#Topology-1014"><span class="linenos">1014</span></a><span class="sd">      show_vertex_labels (bool, optional): if True show tiling vertices labelled</span>
</span><span id="Topology-1015"><a href="#Topology-1015"><span class="linenos">1015</span></a><span class="sd">        to show their equivalence classes. Defaults to True.</span>
</span><span id="Topology-1016"><a href="#Topology-1016"><span class="linenos">1016</span></a><span class="sd">      show_vertex_ids (bool, optional): if True show vertex IDs (i.e., sequence</span>
</span><span id="Topology-1017"><a href="#Topology-1017"><span class="linenos">1017</span></a><span class="sd">        numbers) which is useful for debugging. Defaults to False.</span>
</span><span id="Topology-1018"><a href="#Topology-1018"><span class="linenos">1018</span></a><span class="sd">      show_edges (bool, optional): if True show tiling edges (not tile sides).</span>
</span><span id="Topology-1019"><a href="#Topology-1019"><span class="linenos">1019</span></a><span class="sd">        Defaults to True.</span>
</span><span id="Topology-1020"><a href="#Topology-1020"><span class="linenos">1020</span></a><span class="sd">      offset_edges (bool, optional): if True offset edges a little from and</span>
</span><span id="Topology-1021"><a href="#Topology-1021"><span class="linenos">1021</span></a><span class="sd">        parallel to their geometric position. Defaults to True.</span>
</span><span id="Topology-1022"><a href="#Topology-1022"><span class="linenos">1022</span></a><span class="sd">      show_edge_labels (bool, optional): if true show lower case alphabetical</span>
</span><span id="Topology-1023"><a href="#Topology-1023"><span class="linenos">1023</span></a><span class="sd">        labels identifying edge equivalence classes. Defaults to False.</span>
</span><span id="Topology-1024"><a href="#Topology-1024"><span class="linenos">1024</span></a><span class="sd">      show_dual_tiles (bool, optional): if True show a candidate set of dual</span>
</span><span id="Topology-1025"><a href="#Topology-1025"><span class="linenos">1025</span></a><span class="sd">        tiles as an overlay. Defaults to False.</span>
</span><span id="Topology-1026"><a href="#Topology-1026"><span class="linenos">1026</span></a>
</span><span id="Topology-1027"><a href="#Topology-1027"><span class="linenos">1027</span></a><span class="sd">    Returns:</span>
</span><span id="Topology-1028"><a href="#Topology-1028"><span class="linenos">1028</span></a><span class="sd">      plt.Axes: a plot of the Topology as requested.</span>
</span><span id="Topology-1029"><a href="#Topology-1029"><span class="linenos">1029</span></a>
</span><span id="Topology-1030"><a href="#Topology-1030"><span class="linenos">1030</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Topology-1031"><a href="#Topology-1031"><span class="linenos">1031</span></a>    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
</span><span id="Topology-1032"><a href="#Topology-1032"><span class="linenos">1032</span></a>    <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
</span><span id="Topology-1033"><a href="#Topology-1033"><span class="linenos">1033</span></a>    <span class="n">extent</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoSeries</span><span class="p">([</span><span class="n">t</span><span class="o">.</span><span class="n">shape</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tiles</span><span class="p">])</span><span class="o">.</span><span class="n">total_bounds</span>
</span><span id="Topology-1034"><a href="#Topology-1034"><span class="linenos">1034</span></a>    <span class="n">dist</span> <span class="o">=</span> <span class="nb">max</span><span class="p">([</span><span class="n">extent</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="n">extent</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">extent</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">-</span> <span class="n">extent</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span> <span class="o">/</span> <span class="mi">100</span>
</span><span id="Topology-1035"><a href="#Topology-1035"><span class="linenos">1035</span></a>    <span class="k">if</span> <span class="n">show_original_tiles</span><span class="p">:</span>
</span><span id="Topology-1036"><a href="#Topology-1036"><span class="linenos">1036</span></a>      <span class="bp">self</span><span class="o">.</span><span class="n">_plot_tiles</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
</span><span id="Topology-1037"><a href="#Topology-1037"><span class="linenos">1037</span></a>    <span class="k">if</span> <span class="n">show_tile_centres</span><span class="p">:</span>
</span><span id="Topology-1038"><a href="#Topology-1038"><span class="linenos">1038</span></a>      <span class="bp">self</span><span class="o">.</span><span class="n">_plot_tile_centres</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
</span><span id="Topology-1039"><a href="#Topology-1039"><span class="linenos">1039</span></a>    <span class="k">if</span> <span class="n">show_vertex_labels</span><span class="p">:</span>
</span><span id="Topology-1040"><a href="#Topology-1040"><span class="linenos">1040</span></a>      <span class="bp">self</span><span class="o">.</span><span class="n">_plot_vertex_labels</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">show_vertex_ids</span><span class="p">)</span>
</span><span id="Topology-1041"><a href="#Topology-1041"><span class="linenos">1041</span></a>    <span class="k">if</span> <span class="n">show_edge_labels</span> <span class="ow">or</span> <span class="n">show_edges</span><span class="p">:</span>
</span><span id="Topology-1042"><a href="#Topology-1042"><span class="linenos">1042</span></a>      <span class="bp">self</span><span class="o">.</span><span class="n">_plot_edges</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">show_edges</span><span class="p">,</span> <span class="n">show_edge_labels</span><span class="p">,</span> <span class="n">dist</span><span class="p">,</span> <span class="n">offset_edges</span><span class="p">)</span>
</span><span id="Topology-1043"><a href="#Topology-1043"><span class="linenos">1043</span></a>    <span class="k">if</span> <span class="n">show_dual_tiles</span><span class="p">:</span>
</span><span id="Topology-1044"><a href="#Topology-1044"><span class="linenos">1044</span></a>      <span class="bp">self</span><span class="o">.</span><span class="n">_plot_dual_tiles</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">dist</span><span class="p">)</span>
</span><span id="Topology-1045"><a href="#Topology-1045"><span class="linenos">1045</span></a>    <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>
</span><span id="Topology-1046"><a href="#Topology-1046"><span class="linenos">1046</span></a>    <span class="k">return</span> <span class="n">ax</span>
</span><span id="Topology-1047"><a href="#Topology-1047"><span class="linenos">1047</span></a>
</span><span id="Topology-1048"><a href="#Topology-1048"><span class="linenos">1048</span></a>
</span><span id="Topology-1049"><a href="#Topology-1049"><span class="linenos">1049</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">_plot_tiles</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">:</span><span class="n">plt</span><span class="o">.</span><span class="n">Axes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">plt</span><span class="o">.</span><span class="n">Axes</span><span class="p">:</span>
</span><span id="Topology-1050"><a href="#Topology-1050"><span class="linenos">1050</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Plot Topology&#39;s tiles on supplied Axes.</span>
</span><span id="Topology-1051"><a href="#Topology-1051"><span class="linenos">1051</span></a>
</span><span id="Topology-1052"><a href="#Topology-1052"><span class="linenos">1052</span></a><span class="sd">    Tiles are coloured by equivalence class.</span>
</span><span id="Topology-1053"><a href="#Topology-1053"><span class="linenos">1053</span></a>
</span><span id="Topology-1054"><a href="#Topology-1054"><span class="linenos">1054</span></a><span class="sd">    Args:</span>
</span><span id="Topology-1055"><a href="#Topology-1055"><span class="linenos">1055</span></a><span class="sd">      ax (plt.Axes): Axes on which to plot.</span>
</span><span id="Topology-1056"><a href="#Topology-1056"><span class="linenos">1056</span></a>
</span><span id="Topology-1057"><a href="#Topology-1057"><span class="linenos">1057</span></a><span class="sd">    Returns:</span>
</span><span id="Topology-1058"><a href="#Topology-1058"><span class="linenos">1058</span></a><span class="sd">      plt.Axes: the Axes.</span>
</span><span id="Topology-1059"><a href="#Topology-1059"><span class="linenos">1059</span></a>
</span><span id="Topology-1060"><a href="#Topology-1060"><span class="linenos">1060</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Topology-1061"><a href="#Topology-1061"><span class="linenos">1061</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_get_tile_geoms</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">column</span> <span class="o">=</span> <span class="s2">&quot;transitivity_class&quot;</span><span class="p">,</span>
</span><span id="Topology-1062"><a href="#Topology-1062"><span class="linenos">1062</span></a>      <span class="n">ax</span> <span class="o">=</span> <span class="n">ax</span><span class="p">,</span> <span class="n">ec</span> <span class="o">=</span> <span class="s2">&quot;#444444&quot;</span><span class="p">,</span> <span class="n">lw</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.25</span><span class="p">,</span> <span class="n">cmap</span> <span class="o">=</span> <span class="s2">&quot;Greys&quot;</span><span class="p">)</span>
</span><span id="Topology-1063"><a href="#Topology-1063"><span class="linenos">1063</span></a>    <span class="k">return</span> <span class="n">ax</span>
</span><span id="Topology-1064"><a href="#Topology-1064"><span class="linenos">1064</span></a>
</span><span id="Topology-1065"><a href="#Topology-1065"><span class="linenos">1065</span></a>
</span><span id="Topology-1066"><a href="#Topology-1066"><span class="linenos">1066</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">_plot_tile_centres</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">:</span><span class="n">plt</span><span class="o">.</span><span class="n">Axes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">plt</span><span class="o">.</span><span class="n">Axes</span><span class="p">:</span>
</span><span id="Topology-1067"><a href="#Topology-1067"><span class="linenos">1067</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Print tile transitivity class at each tile centroid.</span>
</span><span id="Topology-1068"><a href="#Topology-1068"><span class="linenos">1068</span></a>
</span><span id="Topology-1069"><a href="#Topology-1069"><span class="linenos">1069</span></a><span class="sd">    Args:</span>
</span><span id="Topology-1070"><a href="#Topology-1070"><span class="linenos">1070</span></a><span class="sd">      ax (plt.Axes): Axes on which to plot.</span>
</span><span id="Topology-1071"><a href="#Topology-1071"><span class="linenos">1071</span></a>
</span><span id="Topology-1072"><a href="#Topology-1072"><span class="linenos">1072</span></a><span class="sd">    Returns:</span>
</span><span id="Topology-1073"><a href="#Topology-1073"><span class="linenos">1073</span></a><span class="sd">      plt.Axes: the Axes.</span>
</span><span id="Topology-1074"><a href="#Topology-1074"><span class="linenos">1074</span></a>
</span><span id="Topology-1075"><a href="#Topology-1075"><span class="linenos">1075</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Topology-1076"><a href="#Topology-1076"><span class="linenos">1076</span></a>    <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">tile</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tiles</span><span class="p">):</span>
</span><span id="Topology-1077"><a href="#Topology-1077"><span class="linenos">1077</span></a>      <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">tile</span><span class="o">.</span><span class="n">transitivity_class</span><span class="p">,</span> <span class="n">xy</span> <span class="o">=</span> <span class="p">(</span><span class="n">tile</span><span class="o">.</span><span class="n">centre</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">tile</span><span class="o">.</span><span class="n">centre</span><span class="o">.</span><span class="n">y</span><span class="p">),</span>
</span><span id="Topology-1078"><a href="#Topology-1078"><span class="linenos">1078</span></a>                  <span class="n">ha</span> <span class="o">=</span> <span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">va</span> <span class="o">=</span> <span class="s2">&quot;center&quot;</span><span class="p">)</span>
</span><span id="Topology-1079"><a href="#Topology-1079"><span class="linenos">1079</span></a>    <span class="k">return</span> <span class="n">ax</span>
</span><span id="Topology-1080"><a href="#Topology-1080"><span class="linenos">1080</span></a>
</span><span id="Topology-1081"><a href="#Topology-1081"><span class="linenos">1081</span></a>
</span><span id="Topology-1082"><a href="#Topology-1082"><span class="linenos">1082</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">_plot_vertex_labels</span><span class="p">(</span>
</span><span id="Topology-1083"><a href="#Topology-1083"><span class="linenos">1083</span></a>      <span class="bp">self</span><span class="p">,</span>
</span><span id="Topology-1084"><a href="#Topology-1084"><span class="linenos">1084</span></a>      <span class="n">ax</span><span class="p">:</span><span class="n">plt</span><span class="o">.</span><span class="n">Axes</span><span class="p">,</span>
</span><span id="Topology-1085"><a href="#Topology-1085"><span class="linenos">1085</span></a>      <span class="n">show_vertex_ids</span><span class="p">:</span><span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="Topology-1086"><a href="#Topology-1086"><span class="linenos">1086</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">plt</span><span class="o">.</span><span class="n">Axes</span><span class="p">:</span>
</span><span id="Topology-1087"><a href="#Topology-1087"><span class="linenos">1087</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Plot either the Vertex transitivity class label or its sequential ID.</span>
</span><span id="Topology-1088"><a href="#Topology-1088"><span class="linenos">1088</span></a>
</span><span id="Topology-1089"><a href="#Topology-1089"><span class="linenos">1089</span></a><span class="sd">    Args:</span>
</span><span id="Topology-1090"><a href="#Topology-1090"><span class="linenos">1090</span></a><span class="sd">      ax (plt.Axes): Axes on which to plot.</span>
</span><span id="Topology-1091"><a href="#Topology-1091"><span class="linenos">1091</span></a><span class="sd">      show_vertex_ids (bool, optional): If True plots the ID, else plots the</span>
</span><span id="Topology-1092"><a href="#Topology-1092"><span class="linenos">1092</span></a><span class="sd">        transitivity class. Defaults to False.</span>
</span><span id="Topology-1093"><a href="#Topology-1093"><span class="linenos">1093</span></a>
</span><span id="Topology-1094"><a href="#Topology-1094"><span class="linenos">1094</span></a><span class="sd">    Returns:</span>
</span><span id="Topology-1095"><a href="#Topology-1095"><span class="linenos">1095</span></a><span class="sd">      plt.Axes: the Axes.</span>
</span><span id="Topology-1096"><a href="#Topology-1096"><span class="linenos">1096</span></a>
</span><span id="Topology-1097"><a href="#Topology-1097"><span class="linenos">1097</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Topology-1098"><a href="#Topology-1098"><span class="linenos">1098</span></a>    <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">points</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
</span><span id="Topology-1099"><a href="#Topology-1099"><span class="linenos">1099</span></a>      <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">ID</span> <span class="k">if</span> <span class="n">show_vertex_ids</span> <span class="k">else</span> <span class="n">v</span><span class="o">.</span><span class="n">label</span><span class="p">,</span>
</span><span id="Topology-1100"><a href="#Topology-1100"><span class="linenos">1100</span></a>                  <span class="n">xy</span> <span class="o">=</span> <span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">point</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">v</span><span class="o">.</span><span class="n">point</span><span class="o">.</span><span class="n">y</span><span class="p">),</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;k&quot;</span><span class="p">,</span>
</span><span id="Topology-1101"><a href="#Topology-1101"><span class="linenos">1101</span></a>                  <span class="n">ha</span> <span class="o">=</span> <span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">va</span> <span class="o">=</span> <span class="s2">&quot;center&quot;</span><span class="p">)</span>
</span><span id="Topology-1102"><a href="#Topology-1102"><span class="linenos">1102</span></a>    <span class="k">return</span> <span class="n">ax</span>
</span><span id="Topology-1103"><a href="#Topology-1103"><span class="linenos">1103</span></a>
</span><span id="Topology-1104"><a href="#Topology-1104"><span class="linenos">1104</span></a>
</span><span id="Topology-1105"><a href="#Topology-1105"><span class="linenos">1105</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">_plot_edges</span><span class="p">(</span>
</span><span id="Topology-1106"><a href="#Topology-1106"><span class="linenos">1106</span></a>      <span class="bp">self</span><span class="p">,</span>
</span><span id="Topology-1107"><a href="#Topology-1107"><span class="linenos">1107</span></a>      <span class="n">ax</span><span class="p">:</span><span class="n">plt</span><span class="o">.</span><span class="n">Axes</span><span class="p">,</span>
</span><span id="Topology-1108"><a href="#Topology-1108"><span class="linenos">1108</span></a>      <span class="n">show_edges</span><span class="p">:</span><span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="Topology-1109"><a href="#Topology-1109"><span class="linenos">1109</span></a>      <span class="n">show_edge_labels</span><span class="p">:</span><span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="Topology-1110"><a href="#Topology-1110"><span class="linenos">1110</span></a>      <span class="n">dist</span><span class="p">:</span><span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
</span><span id="Topology-1111"><a href="#Topology-1111"><span class="linenos">1111</span></a>      <span class="n">offset_edges</span><span class="p">:</span><span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="Topology-1112"><a href="#Topology-1112"><span class="linenos">1112</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">plt</span><span class="o">.</span><span class="n">Axes</span><span class="p">:</span>
</span><span id="Topology-1113"><a href="#Topology-1113"><span class="linenos">1113</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Plot edges, including an offset if specified and labels if requested.</span>
</span><span id="Topology-1114"><a href="#Topology-1114"><span class="linenos">1114</span></a>
</span><span id="Topology-1115"><a href="#Topology-1115"><span class="linenos">1115</span></a><span class="sd">    Can also be called to only plot the labels.</span>
</span><span id="Topology-1116"><a href="#Topology-1116"><span class="linenos">1116</span></a>
</span><span id="Topology-1117"><a href="#Topology-1117"><span class="linenos">1117</span></a><span class="sd">    Args:</span>
</span><span id="Topology-1118"><a href="#Topology-1118"><span class="linenos">1118</span></a><span class="sd">      ax (plt.Axes): Axes on which to plot.</span>
</span><span id="Topology-1119"><a href="#Topology-1119"><span class="linenos">1119</span></a><span class="sd">      show_edges (bool, optional): if True includes the edges as. a dotted blue</span>
</span><span id="Topology-1120"><a href="#Topology-1120"><span class="linenos">1120</span></a><span class="sd">        line, optionally offset (for clarity) from the tile boundary. Defaults</span>
</span><span id="Topology-1121"><a href="#Topology-1121"><span class="linenos">1121</span></a><span class="sd">        to False.</span>
</span><span id="Topology-1122"><a href="#Topology-1122"><span class="linenos">1122</span></a><span class="sd">      show_edge_labels (bool, optional): if True shows an edge label. Defaults</span>
</span><span id="Topology-1123"><a href="#Topology-1123"><span class="linenos">1123</span></a><span class="sd">        to False.</span>
</span><span id="Topology-1124"><a href="#Topology-1124"><span class="linenos">1124</span></a><span class="sd">      dist (float, optional): a distance by which to offset the dotted line for</span>
</span><span id="Topology-1125"><a href="#Topology-1125"><span class="linenos">1125</span></a><span class="sd">        the edge from the tile boundary. Defaults to 0.0.</span>
</span><span id="Topology-1126"><a href="#Topology-1126"><span class="linenos">1126</span></a><span class="sd">      offset_edges (bool, optional): if True applies the edge drawing offset,</span>
</span><span id="Topology-1127"><a href="#Topology-1127"><span class="linenos">1127</span></a><span class="sd">        if False the edge is drawn as a single line segment between its end</span>
</span><span id="Topology-1128"><a href="#Topology-1128"><span class="linenos">1128</span></a><span class="sd">        vertices (and may not align with the sides of tiles. Defaults to True.</span>
</span><span id="Topology-1129"><a href="#Topology-1129"><span class="linenos">1129</span></a>
</span><span id="Topology-1130"><a href="#Topology-1130"><span class="linenos">1130</span></a><span class="sd">    Returns:</span>
</span><span id="Topology-1131"><a href="#Topology-1131"><span class="linenos">1131</span></a><span class="sd">      plt.Axes: the Axes.</span>
</span><span id="Topology-1132"><a href="#Topology-1132"><span class="linenos">1132</span></a>
</span><span id="Topology-1133"><a href="#Topology-1133"><span class="linenos">1133</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Topology-1134"><a href="#Topology-1134"><span class="linenos">1134</span></a>    <span class="k">if</span> <span class="n">show_edges</span><span class="p">:</span>
</span><span id="Topology-1135"><a href="#Topology-1135"><span class="linenos">1135</span></a>      <span class="n">edges</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_edge_geoms</span><span class="p">(</span><span class="n">dist</span> <span class="k">if</span> <span class="n">offset_edges</span> <span class="k">else</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="Topology-1136"><a href="#Topology-1136"><span class="linenos">1136</span></a>      <span class="n">edges</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span> <span class="o">=</span> <span class="n">ax</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;dodgerblue&quot;</span><span class="p">,</span> <span class="n">ls</span> <span class="o">=</span> <span class="s2">&quot;:&quot;</span><span class="p">)</span>
</span><span id="Topology-1137"><a href="#Topology-1137"><span class="linenos">1137</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="Topology-1138"><a href="#Topology-1138"><span class="linenos">1138</span></a>      <span class="n">edges</span> <span class="o">=</span> <span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">get_geometry</span><span class="p">()</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="o">.</span><span class="n">values</span><span class="p">()]</span>
</span><span id="Topology-1139"><a href="#Topology-1139"><span class="linenos">1139</span></a>    <span class="k">if</span> <span class="n">show_edge_labels</span><span class="p">:</span>
</span><span id="Topology-1140"><a href="#Topology-1140"><span class="linenos">1140</span></a>      <span class="k">for</span> <span class="n">ls</span><span class="p">,</span> <span class="n">e</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">edges</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="o">.</span><span class="n">values</span><span class="p">(),</span> <span class="n">strict</span> <span class="o">=</span> <span class="kc">True</span><span class="p">):</span>
</span><span id="Topology-1141"><a href="#Topology-1141"><span class="linenos">1141</span></a>        <span class="n">c</span> <span class="o">=</span> <span class="n">ls</span><span class="o">.</span><span class="n">centroid</span>
</span><span id="Topology-1142"><a href="#Topology-1142"><span class="linenos">1142</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">label</span><span class="p">,</span> <span class="n">xy</span> <span class="o">=</span> <span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">y</span><span class="p">),</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;k&quot;</span><span class="p">,</span>
</span><span id="Topology-1143"><a href="#Topology-1143"><span class="linenos">1143</span></a>                    <span class="n">ha</span> <span class="o">=</span> <span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">va</span> <span class="o">=</span> <span class="s2">&quot;center&quot;</span><span class="p">)</span>
</span><span id="Topology-1144"><a href="#Topology-1144"><span class="linenos">1144</span></a>    <span class="k">return</span> <span class="n">ax</span>
</span><span id="Topology-1145"><a href="#Topology-1145"><span class="linenos">1145</span></a>
</span><span id="Topology-1146"><a href="#Topology-1146"><span class="linenos">1146</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">_plot_dual_tiles</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">:</span><span class="n">plt</span><span class="o">.</span><span class="n">Axes</span><span class="p">,</span>
</span><span id="Topology-1147"><a href="#Topology-1147"><span class="linenos">1147</span></a>                       <span class="n">dist</span><span class="p">:</span><span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">plt</span><span class="o">.</span><span class="n">Axes</span><span class="p">:</span>
</span><span id="Topology-1148"><a href="#Topology-1148"><span class="linenos">1148</span></a>    <span class="n">gpd</span><span class="o">.</span><span class="n">GeoSeries</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dual_tiles</span><span class="p">)</span><span class="o">.</span><span class="n">buffer</span><span class="p">(</span>
</span><span id="Topology-1149"><a href="#Topology-1149"><span class="linenos">1149</span></a>      <span class="o">-</span><span class="n">dist</span> <span class="o">/</span> <span class="mi">4</span><span class="p">,</span> <span class="n">join_style</span> <span class="o">=</span> <span class="s2">&quot;mitre&quot;</span><span class="p">,</span> <span class="n">cap_style</span> <span class="o">=</span> <span class="s2">&quot;square&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
</span><span id="Topology-1150"><a href="#Topology-1150"><span class="linenos">1150</span></a>        <span class="n">ax</span> <span class="o">=</span> <span class="n">ax</span><span class="p">,</span> <span class="n">fc</span> <span class="o">=</span> <span class="s2">&quot;g&quot;</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.25</span><span class="p">)</span>
</span><span id="Topology-1151"><a href="#Topology-1151"><span class="linenos">1151</span></a>    <span class="k">return</span> <span class="n">ax</span>
</span><span id="Topology-1152"><a href="#Topology-1152"><span class="linenos">1152</span></a>
</span><span id="Topology-1153"><a href="#Topology-1153"><span class="linenos">1153</span></a>
</span><span id="Topology-1154"><a href="#Topology-1154"><span class="linenos">1154</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">plot_tiling_symmetries</span><span class="p">(</span>
</span><span id="Topology-1155"><a href="#Topology-1155"><span class="linenos">1155</span></a>      <span class="bp">self</span><span class="p">,</span>
</span><span id="Topology-1156"><a href="#Topology-1156"><span class="linenos">1156</span></a>      <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span><span class="nb">float</span><span class="p">,</span>
</span><span id="Topology-1157"><a href="#Topology-1157"><span class="linenos">1157</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Topology-1158"><a href="#Topology-1158"><span class="linenos">1158</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Plot the symmetries of Topology&#39;s tiling.</span>
</span><span id="Topology-1159"><a href="#Topology-1159"><span class="linenos">1159</span></a>
</span><span id="Topology-1160"><a href="#Topology-1160"><span class="linenos">1160</span></a><span class="sd">    Most of the work here is delegated to `_plot_tiling_symmetry` which is run</span>
</span><span id="Topology-1161"><a href="#Topology-1161"><span class="linenos">1161</span></a><span class="sd">    once per symmetry on a grid of plt.Axes built by this function.</span>
</span><span id="Topology-1162"><a href="#Topology-1162"><span class="linenos">1162</span></a>
</span><span id="Topology-1163"><a href="#Topology-1163"><span class="linenos">1163</span></a><span class="sd">    Args:</span>
</span><span id="Topology-1164"><a href="#Topology-1164"><span class="linenos">1164</span></a><span class="sd">      kwargs: passed through to `_plot_tiling_symmetry`</span>
</span><span id="Topology-1165"><a href="#Topology-1165"><span class="linenos">1165</span></a>
</span><span id="Topology-1166"><a href="#Topology-1166"><span class="linenos">1166</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Topology-1167"><a href="#Topology-1167"><span class="linenos">1167</span></a>    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tile_matching_transforms</span><span class="p">)</span>
</span><span id="Topology-1168"><a href="#Topology-1168"><span class="linenos">1168</span></a>    <span class="n">nc</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">n</span><span class="p">)))</span>
</span><span id="Topology-1169"><a href="#Topology-1169"><span class="linenos">1169</span></a>    <span class="n">nr</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">n</span> <span class="o">/</span> <span class="n">nc</span><span class="p">))</span>
</span><span id="Topology-1170"><a href="#Topology-1170"><span class="linenos">1170</span></a>    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">12</span> <span class="o">*</span> <span class="n">nr</span> <span class="o">/</span> <span class="n">nc</span><span class="p">))</span>
</span><span id="Topology-1171"><a href="#Topology-1171"><span class="linenos">1171</span></a>    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">tr</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tile_matching_transforms</span><span class="o">.</span><span class="n">values</span><span class="p">()):</span>
</span><span id="Topology-1172"><a href="#Topology-1172"><span class="linenos">1172</span></a>      <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">nr</span><span class="p">,</span> <span class="n">nc</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="Topology-1173"><a href="#Topology-1173"><span class="linenos">1173</span></a>      <span class="bp">self</span><span class="o">.</span><span class="n">_plot_tiling_symmetry</span><span class="p">(</span><span class="n">tr</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Topology-1174"><a href="#Topology-1174"><span class="linenos">1174</span></a>
</span><span id="Topology-1175"><a href="#Topology-1175"><span class="linenos">1175</span></a>
</span><span id="Topology-1176"><a href="#Topology-1176"><span class="linenos">1176</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">_plot_tiling_symmetry</span><span class="p">(</span>
</span><span id="Topology-1177"><a href="#Topology-1177"><span class="linenos">1177</span></a>      <span class="bp">self</span><span class="p">,</span>
</span><span id="Topology-1178"><a href="#Topology-1178"><span class="linenos">1178</span></a>      <span class="n">transform</span><span class="p">:</span><span class="n">Transform</span><span class="p">,</span>
</span><span id="Topology-1179"><a href="#Topology-1179"><span class="linenos">1179</span></a>      <span class="n">ax</span><span class="p">:</span><span class="n">plt</span><span class="o">.</span><span class="n">Axes</span><span class="p">,</span>
</span><span id="Topology-1180"><a href="#Topology-1180"><span class="linenos">1180</span></a>      <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span><span class="nb">float</span><span class="p">,</span>
</span><span id="Topology-1181"><a href="#Topology-1181"><span class="linenos">1181</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Topology-1182"><a href="#Topology-1182"><span class="linenos">1182</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Plot the supplied Transform on the supplied plt.Axes.</span>
</span><span id="Topology-1183"><a href="#Topology-1183"><span class="linenos">1183</span></a>
</span><span id="Topology-1184"><a href="#Topology-1184"><span class="linenos">1184</span></a><span class="sd">    Args:</span>
</span><span id="Topology-1185"><a href="#Topology-1185"><span class="linenos">1185</span></a><span class="sd">        transform (Transform): the Transform to plot.</span>
</span><span id="Topology-1186"><a href="#Topology-1186"><span class="linenos">1186</span></a><span class="sd">        ax (plt.Axes): the Axes on which to plot.</span>
</span><span id="Topology-1187"><a href="#Topology-1187"><span class="linenos">1187</span></a><span class="sd">        kwargs: passed through to plt.plot functions.</span>
</span><span id="Topology-1188"><a href="#Topology-1188"><span class="linenos">1188</span></a>
</span><span id="Topology-1189"><a href="#Topology-1189"><span class="linenos">1189</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Topology-1190"><a href="#Topology-1190"><span class="linenos">1190</span></a>    <span class="n">tiles</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoSeries</span><span class="p">([</span><span class="n">t</span><span class="o">.</span><span class="n">shape</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tiles</span><span class="p">])</span>
</span><span id="Topology-1191"><a href="#Topology-1191"><span class="linenos">1191</span></a>    <span class="n">base_tiles</span> <span class="o">=</span> <span class="n">tiles</span><span class="p">[:</span><span class="bp">self</span><span class="o">.</span><span class="n">n_tiles</span><span class="p">]</span>
</span><span id="Topology-1192"><a href="#Topology-1192"><span class="linenos">1192</span></a>    <span class="n">tiles</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span> <span class="o">=</span> <span class="n">ax</span><span class="p">,</span> <span class="n">fc</span> <span class="o">=</span> <span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">.15</span><span class="p">,</span> <span class="n">ec</span> <span class="o">=</span> <span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="n">lw</span> <span class="o">=</span> <span class="mf">.5</span><span class="p">)</span>
</span><span id="Topology-1193"><a href="#Topology-1193"><span class="linenos">1193</span></a>    <span class="n">base_tiles</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span> <span class="o">=</span> <span class="n">ax</span><span class="p">,</span> <span class="n">fc</span> <span class="o">=</span> <span class="s2">&quot;#00000000&quot;</span><span class="p">,</span> <span class="n">ec</span> <span class="o">=</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="n">lw</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">zorder</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="Topology-1194"><a href="#Topology-1194"><span class="linenos">1194</span></a>    <span class="n">transformed_base_tiles</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoSeries</span><span class="p">(</span>
</span><span id="Topology-1195"><a href="#Topology-1195"><span class="linenos">1195</span></a>      <span class="p">[</span><span class="n">transform</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">g</span><span class="p">)</span> <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">base_tiles</span><span class="p">])</span>
</span><span id="Topology-1196"><a href="#Topology-1196"><span class="linenos">1196</span></a>    <span class="n">transformed_base_tiles</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span> <span class="o">=</span> <span class="n">ax</span><span class="p">,</span> <span class="n">fc</span> <span class="o">=</span> <span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">.2</span><span class="p">,</span> <span class="n">lw</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">ec</span> <span class="o">=</span> <span class="s2">&quot;k&quot;</span><span class="p">)</span>
</span><span id="Topology-1197"><a href="#Topology-1197"><span class="linenos">1197</span></a>    <span class="n">transform</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="c1"># delegate to Transform.draw</span>
</span><span id="Topology-1198"><a href="#Topology-1198"><span class="linenos">1198</span></a>    <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>
</span><span id="Topology-1199"><a href="#Topology-1199"><span class="linenos">1199</span></a>
</span><span id="Topology-1200"><a href="#Topology-1200"><span class="linenos">1200</span></a>
</span><span id="Topology-1201"><a href="#Topology-1201"><span class="linenos">1201</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">transform_geometry</span><span class="p">(</span>
</span><span id="Topology-1202"><a href="#Topology-1202"><span class="linenos">1202</span></a>      <span class="bp">self</span><span class="p">,</span>
</span><span id="Topology-1203"><a href="#Topology-1203"><span class="linenos">1203</span></a>      <span class="n">new_topology</span><span class="p">:</span><span class="nb">bool</span><span class="p">,</span>
</span><span id="Topology-1204"><a href="#Topology-1204"><span class="linenos">1204</span></a>      <span class="n">apply_to_tiles</span><span class="p">:</span><span class="nb">bool</span><span class="p">,</span>
</span><span id="Topology-1205"><a href="#Topology-1205"><span class="linenos">1205</span></a>      <span class="n">selector</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span>
</span><span id="Topology-1206"><a href="#Topology-1206"><span class="linenos">1206</span></a>      <span class="n">transform_type</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span>
</span><span id="Topology-1207"><a href="#Topology-1207"><span class="linenos">1207</span></a>      <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span><span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Topology</span><span class="p">:</span>
</span><span id="Topology-1208"><a href="#Topology-1208"><span class="linenos">1208</span></a><span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Get a new Topology by applying specified transformation.</span>
</span><span id="Topology-1209"><a href="#Topology-1209"><span class="linenos">1209</span></a>
</span><span id="Topology-1210"><a href="#Topology-1210"><span class="linenos">1210</span></a><span class="sd">    A transformation specified by `transform_type` and keyword arguments is</span>
</span><span id="Topology-1211"><a href="#Topology-1211"><span class="linenos">1211</span></a><span class="sd">    applied to elements in the Topology whose labels match the selector</span>
</span><span id="Topology-1212"><a href="#Topology-1212"><span class="linenos">1212</span></a><span class="sd">    parameter. The transform is optionally applied to update tiles and</span>
</span><span id="Topology-1213"><a href="#Topology-1213"><span class="linenos">1213</span></a><span class="sd">    optionally requests a new Topology object.</span>
</span><span id="Topology-1214"><a href="#Topology-1214"><span class="linenos">1214</span></a>
</span><span id="Topology-1215"><a href="#Topology-1215"><span class="linenos">1215</span></a><span class="sd">    Implemented in this way so that transformations can be applied one at a time</span>
</span><span id="Topology-1216"><a href="#Topology-1216"><span class="linenos">1216</span></a><span class="sd">    without creating an intermediate set of new tiles, which may be invalid and</span>
</span><span id="Topology-1217"><a href="#Topology-1217"><span class="linenos">1217</span></a><span class="sd">    fail. So, if you wish to apply (say) 3 transforms and generate a new</span>
</span><span id="Topology-1218"><a href="#Topology-1218"><span class="linenos">1218</span></a><span class="sd">    Topology leaving the existing one intact:</span>
</span><span id="Topology-1219"><a href="#Topology-1219"><span class="linenos">1219</span></a>
</span><span id="Topology-1220"><a href="#Topology-1220"><span class="linenos">1220</span></a><span class="sd">        new_topo = old_topo.transform_geometry(True,  False, &quot;a&quot;, ...) \</span>
</span><span id="Topology-1221"><a href="#Topology-1221"><span class="linenos">1221</span></a><span class="sd">                           .transform_geometry(False, False, &quot;B&quot;, ...) \</span>
</span><span id="Topology-1222"><a href="#Topology-1222"><span class="linenos">1222</span></a><span class="sd">                           .transform_geometry(False, True,  &quot;C&quot;, ...)</span>
</span><span id="Topology-1223"><a href="#Topology-1223"><span class="linenos">1223</span></a>
</span><span id="Topology-1224"><a href="#Topology-1224"><span class="linenos">1224</span></a><span class="sd">    The first transform requests a new Topology, subsequent steps do not, and it</span>
</span><span id="Topology-1225"><a href="#Topology-1225"><span class="linenos">1225</span></a><span class="sd">    is only the last step which attempts to create the new tile polygons.</span>
</span><span id="Topology-1226"><a href="#Topology-1226"><span class="linenos">1226</span></a>
</span><span id="Topology-1227"><a href="#Topology-1227"><span class="linenos">1227</span></a><span class="sd">    **kwargs supply named parameters for the requested transformation.</span>
</span><span id="Topology-1228"><a href="#Topology-1228"><span class="linenos">1228</span></a>
</span><span id="Topology-1229"><a href="#Topology-1229"><span class="linenos">1229</span></a><span class="sd">    Args:</span>
</span><span id="Topology-1230"><a href="#Topology-1230"><span class="linenos">1230</span></a><span class="sd">      new_topology (bool): if True returns a new Topology object, else returns</span>
</span><span id="Topology-1231"><a href="#Topology-1231"><span class="linenos">1231</span></a><span class="sd">        the current Topology modified.</span>
</span><span id="Topology-1232"><a href="#Topology-1232"><span class="linenos">1232</span></a><span class="sd">      apply_to_tiles (bool): if True attempts to create new Tiles after the</span>
</span><span id="Topology-1233"><a href="#Topology-1233"><span class="linenos">1233</span></a><span class="sd">        transformation has been applied. Usually set to False, unless the last</span>
</span><span id="Topology-1234"><a href="#Topology-1234"><span class="linenos">1234</span></a><span class="sd">        transformation in a pipeline, to avoid problems of topologically invalid</span>
</span><span id="Topology-1235"><a href="#Topology-1235"><span class="linenos">1235</span></a><span class="sd">        tiles at intermediate steps.</span>
</span><span id="Topology-1236"><a href="#Topology-1236"><span class="linenos">1236</span></a><span class="sd">      selector (str): label of elements to which to apply the transformation.</span>
</span><span id="Topology-1237"><a href="#Topology-1237"><span class="linenos">1237</span></a><span class="sd">        Note that all letters in the supplied string are checked, so you can</span>
</span><span id="Topology-1238"><a href="#Topology-1238"><span class="linenos">1238</span></a><span class="sd">        use e.g. &quot;abc&quot; to apply a transformation to edges labelled &quot;a&quot;, &quot;b&quot; or</span>
</span><span id="Topology-1239"><a href="#Topology-1239"><span class="linenos">1239</span></a><span class="sd">        &quot;c&quot;, or &quot;AB&quot; for vertices labelled &quot;A&quot; or &quot;B&quot;.</span>
</span><span id="Topology-1240"><a href="#Topology-1240"><span class="linenos">1240</span></a><span class="sd">      transform_type (str): name of the type of transformation requested.</span>
</span><span id="Topology-1241"><a href="#Topology-1241"><span class="linenos">1241</span></a><span class="sd">        Currently supported are `zigzag_edge`, `rotate_edge`, `scale_edge`,</span>
</span><span id="Topology-1242"><a href="#Topology-1242"><span class="linenos">1242</span></a><span class="sd">        `push_vertex`, and `nudge_vertex`. Keyword arguments for each are</span>
</span><span id="Topology-1243"><a href="#Topology-1243"><span class="linenos">1243</span></a><span class="sd">        documented in the corresponding methods.</span>
</span><span id="Topology-1244"><a href="#Topology-1244"><span class="linenos">1244</span></a><span class="sd">      kwargs: contains any needed arguments of the requested transform_type.</span>
</span><span id="Topology-1245"><a href="#Topology-1245"><span class="linenos">1245</span></a>
</span><span id="Topology-1246"><a href="#Topology-1246"><span class="linenos">1246</span></a><span class="sd">    Returns:</span>
</span><span id="Topology-1247"><a href="#Topology-1247"><span class="linenos">1247</span></a><span class="sd">      Topology: if new_topology is True a new Topology based on this one with</span>
</span><span id="Topology-1248"><a href="#Topology-1248"><span class="linenos">1248</span></a><span class="sd">        after transformation, if False this Topology is returned after the</span>
</span><span id="Topology-1249"><a href="#Topology-1249"><span class="linenos">1249</span></a><span class="sd">        transformation.</span>
</span><span id="Topology-1250"><a href="#Topology-1250"><span class="linenos">1250</span></a>
</span><span id="Topology-1251"><a href="#Topology-1251"><span class="linenos">1251</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Topology-1252"><a href="#Topology-1252"><span class="linenos">1252</span></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;CAUTION: new Topology will probably not be correctly labelled. &quot;</span>
</span><span id="Topology-1253"><a href="#Topology-1253"><span class="linenos">1253</span></a>          <span class="s2">&quot;To build a correct Topology, extract the tileable attribute and &quot;</span>
</span><span id="Topology-1254"><a href="#Topology-1254"><span class="linenos">1254</span></a>          <span class="s2">&quot;rebuild Topology from that.&quot;</span><span class="p">)</span>
</span><span id="Topology-1255"><a href="#Topology-1255"><span class="linenos">1255</span></a>    <span class="c1"># pickle seems to be more reliable than copy.deepcopy here</span>
</span><span id="Topology-1256"><a href="#Topology-1256"><span class="linenos">1256</span></a>    <span class="n">topo</span> <span class="o">=</span> <span class="p">(</span><span class="n">pickle</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">pickle</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>   <span class="c1"># noqa: S301</span>
</span><span id="Topology-1257"><a href="#Topology-1257"><span class="linenos">1257</span></a>            <span class="k">if</span> <span class="n">new_topology</span>
</span><span id="Topology-1258"><a href="#Topology-1258"><span class="linenos">1258</span></a>            <span class="k">else</span> <span class="bp">self</span><span class="p">)</span>
</span><span id="Topology-1259"><a href="#Topology-1259"><span class="linenos">1259</span></a>    <span class="n">transform_args</span> <span class="o">=</span> <span class="n">topo</span><span class="o">.</span><span class="n">get_kwargs</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">topo</span><span class="p">,</span> <span class="n">transform_type</span><span class="p">),</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Topology-1260"><a href="#Topology-1260"><span class="linenos">1260</span></a>    <span class="k">match</span> <span class="n">transform_type</span><span class="p">:</span>
</span><span id="Topology-1261"><a href="#Topology-1261"><span class="linenos">1261</span></a>      <span class="k">case</span> <span class="s2">&quot;zigzag_edge&quot;</span><span class="p">:</span>
</span><span id="Topology-1262"><a href="#Topology-1262"><span class="linenos">1262</span></a>        <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">topo</span><span class="o">.</span><span class="n">edges</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
</span><span id="Topology-1263"><a href="#Topology-1263"><span class="linenos">1263</span></a>          <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">label</span> <span class="ow">in</span> <span class="n">selector</span><span class="p">:</span>
</span><span id="Topology-1264"><a href="#Topology-1264"><span class="linenos">1264</span></a>            <span class="n">topo</span><span class="o">.</span><span class="n">zigzag_edge</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="o">**</span><span class="n">transform_args</span><span class="p">)</span>
</span><span id="Topology-1265"><a href="#Topology-1265"><span class="linenos">1265</span></a>      <span class="k">case</span> <span class="s2">&quot;rotate_edge&quot;</span><span class="p">:</span>
</span><span id="Topology-1266"><a href="#Topology-1266"><span class="linenos">1266</span></a>        <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">topo</span><span class="o">.</span><span class="n">edges</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
</span><span id="Topology-1267"><a href="#Topology-1267"><span class="linenos">1267</span></a>          <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">label</span> <span class="ow">in</span> <span class="n">selector</span><span class="p">:</span>
</span><span id="Topology-1268"><a href="#Topology-1268"><span class="linenos">1268</span></a>            <span class="n">topo</span><span class="o">.</span><span class="n">rotate_edge</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="o">**</span><span class="n">transform_args</span><span class="p">)</span>
</span><span id="Topology-1269"><a href="#Topology-1269"><span class="linenos">1269</span></a>      <span class="k">case</span> <span class="s2">&quot;scale_edge&quot;</span><span class="p">:</span>
</span><span id="Topology-1270"><a href="#Topology-1270"><span class="linenos">1270</span></a>        <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">topo</span><span class="o">.</span><span class="n">edges</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
</span><span id="Topology-1271"><a href="#Topology-1271"><span class="linenos">1271</span></a>          <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">label</span> <span class="ow">in</span> <span class="n">selector</span><span class="p">:</span>
</span><span id="Topology-1272"><a href="#Topology-1272"><span class="linenos">1272</span></a>            <span class="n">topo</span><span class="o">.</span><span class="n">scale_edge</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="o">**</span><span class="n">transform_args</span><span class="p">)</span>
</span><span id="Topology-1273"><a href="#Topology-1273"><span class="linenos">1273</span></a>      <span class="k">case</span> <span class="s2">&quot;push_vertex&quot;</span><span class="p">:</span>
</span><span id="Topology-1274"><a href="#Topology-1274"><span class="linenos">1274</span></a>        <span class="n">pushes</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="Topology-1275"><a href="#Topology-1275"><span class="linenos">1275</span></a>        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">topo</span><span class="o">.</span><span class="n">vertices_in_tiles</span><span class="p">(</span><span class="n">topo</span><span class="o">.</span><span class="n">tiles</span><span class="p">[:</span><span class="n">topo</span><span class="o">.</span><span class="n">n_tiles</span><span class="p">]):</span>
</span><span id="Topology-1276"><a href="#Topology-1276"><span class="linenos">1276</span></a>          <span class="k">if</span> <span class="n">v</span><span class="o">.</span><span class="n">label</span> <span class="ow">in</span> <span class="n">selector</span><span class="p">:</span>
</span><span id="Topology-1277"><a href="#Topology-1277"><span class="linenos">1277</span></a>            <span class="n">pushes</span><span class="p">[</span><span class="n">v</span><span class="o">.</span><span class="n">base_ID</span><span class="p">]</span> <span class="o">=</span> <span class="n">topo</span><span class="o">.</span><span class="n">push_vertex</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="o">**</span><span class="n">transform_args</span><span class="p">)</span>
</span><span id="Topology-1278"><a href="#Topology-1278"><span class="linenos">1278</span></a>        <span class="k">for</span> <span class="n">base_ID</span><span class="p">,</span> <span class="p">(</span><span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="p">)</span> <span class="ow">in</span> <span class="n">pushes</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="Topology-1279"><a href="#Topology-1279"><span class="linenos">1279</span></a>          <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="p">[</span><span class="n">v</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">topo</span><span class="o">.</span><span class="n">points</span><span class="o">.</span><span class="n">values</span><span class="p">()</span> <span class="k">if</span> <span class="n">v</span><span class="o">.</span><span class="n">base_ID</span> <span class="o">==</span> <span class="n">base_ID</span><span class="p">]:</span>
</span><span id="Topology-1280"><a href="#Topology-1280"><span class="linenos">1280</span></a>            <span class="n">v</span><span class="o">.</span><span class="n">point</span> <span class="o">=</span> <span class="n">affine</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">point</span><span class="p">,</span> <span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="p">)</span>
</span><span id="Topology-1281"><a href="#Topology-1281"><span class="linenos">1281</span></a>      <span class="k">case</span> <span class="s2">&quot;nudge_vertex&quot;</span><span class="p">:</span>
</span><span id="Topology-1282"><a href="#Topology-1282"><span class="linenos">1282</span></a>         <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">topo</span><span class="o">.</span><span class="n">points</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
</span><span id="Topology-1283"><a href="#Topology-1283"><span class="linenos">1283</span></a>          <span class="k">if</span> <span class="n">v</span><span class="o">.</span><span class="n">label</span> <span class="ow">in</span> <span class="n">selector</span><span class="p">:</span>
</span><span id="Topology-1284"><a href="#Topology-1284"><span class="linenos">1284</span></a>            <span class="n">topo</span><span class="o">.</span><span class="n">nudge_vertex</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="o">**</span><span class="n">transform_args</span><span class="p">)</span>
</span><span id="Topology-1285"><a href="#Topology-1285"><span class="linenos">1285</span></a>    <span class="k">if</span> <span class="n">apply_to_tiles</span><span class="p">:</span>
</span><span id="Topology-1286"><a href="#Topology-1286"><span class="linenos">1286</span></a>      <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">topo</span><span class="o">.</span><span class="n">tiles</span><span class="p">:</span>
</span><span id="Topology-1287"><a href="#Topology-1287"><span class="linenos">1287</span></a>        <span class="n">t</span><span class="o">.</span><span class="n">set_corners_from_edges</span><span class="p">()</span>
</span><span id="Topology-1288"><a href="#Topology-1288"><span class="linenos">1288</span></a>    <span class="n">topo</span><span class="o">.</span><span class="n">tileable</span><span class="o">.</span><span class="n">tiles</span><span class="o">.</span><span class="n">geometry</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoSeries</span><span class="p">(</span>
</span><span id="Topology-1289"><a href="#Topology-1289"><span class="linenos">1289</span></a>      <span class="p">[</span><span class="n">topo</span><span class="o">.</span><span class="n">tiles</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">topo</span><span class="o">.</span><span class="n">n_tiles</span><span class="p">)])</span>
</span><span id="Topology-1290"><a href="#Topology-1290"><span class="linenos">1290</span></a>    <span class="n">topo</span><span class="o">.</span><span class="n">tileable</span><span class="o">.</span><span class="n">_setup_regularised_prototile</span><span class="p">()</span>
</span><span id="Topology-1291"><a href="#Topology-1291"><span class="linenos">1291</span></a>    <span class="k">return</span> <span class="n">topo</span>
</span><span id="Topology-1292"><a href="#Topology-1292"><span class="linenos">1292</span></a>
</span><span id="Topology-1293"><a href="#Topology-1293"><span class="linenos">1293</span></a>
</span><span id="Topology-1294"><a href="#Topology-1294"><span class="linenos">1294</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">get_kwargs</span><span class="p">(</span>
</span><span id="Topology-1295"><a href="#Topology-1295"><span class="linenos">1295</span></a>      <span class="bp">self</span><span class="p">,</span>
</span><span id="Topology-1296"><a href="#Topology-1296"><span class="linenos">1296</span></a>      <span class="n">fn</span><span class="p">:</span><span class="n">Callable</span><span class="p">,</span>
</span><span id="Topology-1297"><a href="#Topology-1297"><span class="linenos">1297</span></a>      <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span><span class="nb">str</span><span class="o">|</span><span class="nb">float</span><span class="p">,</span>
</span><span id="Topology-1298"><a href="#Topology-1298"><span class="linenos">1298</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
</span><span id="Topology-1299"><a href="#Topology-1299"><span class="linenos">1299</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Filter the supplied kwargs to only contain arguments required by fn.</span>
</span><span id="Topology-1300"><a href="#Topology-1300"><span class="linenos">1300</span></a>
</span><span id="Topology-1301"><a href="#Topology-1301"><span class="linenos">1301</span></a><span class="sd">    Args:</span>
</span><span id="Topology-1302"><a href="#Topology-1302"><span class="linenos">1302</span></a><span class="sd">      fn (Callable): the function that is to be inspected.</span>
</span><span id="Topology-1303"><a href="#Topology-1303"><span class="linenos">1303</span></a><span class="sd">      **kwargs (str|float): kwargs to be filtered.</span>
</span><span id="Topology-1304"><a href="#Topology-1304"><span class="linenos">1304</span></a>
</span><span id="Topology-1305"><a href="#Topology-1305"><span class="linenos">1305</span></a><span class="sd">    Returns:</span>
</span><span id="Topology-1306"><a href="#Topology-1306"><span class="linenos">1306</span></a><span class="sd">      str|float: filtered dictionary of kwargs.</span>
</span><span id="Topology-1307"><a href="#Topology-1307"><span class="linenos">1307</span></a>
</span><span id="Topology-1308"><a href="#Topology-1308"><span class="linenos">1308</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Topology-1309"><a href="#Topology-1309"><span class="linenos">1309</span></a>    <span class="n">args</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">signature</span><span class="p">(</span><span class="n">fn</span><span class="p">)</span><span class="o">.</span><span class="n">parameters</span>
</span><span id="Topology-1310"><a href="#Topology-1310"><span class="linenos">1310</span></a>    <span class="k">return</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">dict</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span> <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">args</span><span class="p">}</span>
</span><span id="Topology-1311"><a href="#Topology-1311"><span class="linenos">1311</span></a>
</span><span id="Topology-1312"><a href="#Topology-1312"><span class="linenos">1312</span></a>
</span><span id="Topology-1313"><a href="#Topology-1313"><span class="linenos">1313</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">zigzag_edge</span><span class="p">(</span>
</span><span id="Topology-1314"><a href="#Topology-1314"><span class="linenos">1314</span></a>      <span class="bp">self</span><span class="p">,</span>
</span><span id="Topology-1315"><a href="#Topology-1315"><span class="linenos">1315</span></a>      <span class="n">edge</span><span class="p">:</span><span class="n">Edge</span><span class="p">,</span>
</span><span id="Topology-1316"><a href="#Topology-1316"><span class="linenos">1316</span></a>      <span class="n">start</span><span class="p">:</span><span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;A&quot;</span><span class="p">,</span>
</span><span id="Topology-1317"><a href="#Topology-1317"><span class="linenos">1317</span></a>      <span class="n">n</span><span class="p">:</span><span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
</span><span id="Topology-1318"><a href="#Topology-1318"><span class="linenos">1318</span></a>      <span class="n">h</span><span class="p">:</span><span class="nb">float</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span>
</span><span id="Topology-1319"><a href="#Topology-1319"><span class="linenos">1319</span></a>      <span class="n">smoothness</span><span class="p">:</span><span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
</span><span id="Topology-1320"><a href="#Topology-1320"><span class="linenos">1320</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Topology-1321"><a href="#Topology-1321"><span class="linenos">1321</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Apply zigzag transformation to supplied Edge.</span>
</span><span id="Topology-1322"><a href="#Topology-1322"><span class="linenos">1322</span></a>
</span><span id="Topology-1323"><a href="#Topology-1323"><span class="linenos">1323</span></a><span class="sd">    Currently this will only work correctly if h is even.</span>
</span><span id="Topology-1324"><a href="#Topology-1324"><span class="linenos">1324</span></a>
</span><span id="Topology-1325"><a href="#Topology-1325"><span class="linenos">1325</span></a><span class="sd">    TODO: make it possible for odd numbers of &#39;peaks&#39; to work (this may require</span>
</span><span id="Topology-1326"><a href="#Topology-1326"><span class="linenos">1326</span></a><span class="sd">    allowing bidirectional Edges, i.e. storing Edges in both directions so that</span>
</span><span id="Topology-1327"><a href="#Topology-1327"><span class="linenos">1327</span></a><span class="sd">    all Tile edges are drawn CW). The `start` parameter is a temporary hack for</span>
</span><span id="Topology-1328"><a href="#Topology-1328"><span class="linenos">1328</span></a><span class="sd">    this.</span>
</span><span id="Topology-1329"><a href="#Topology-1329"><span class="linenos">1329</span></a>
</span><span id="Topology-1330"><a href="#Topology-1330"><span class="linenos">1330</span></a><span class="sd">    Args:</span>
</span><span id="Topology-1331"><a href="#Topology-1331"><span class="linenos">1331</span></a><span class="sd">      edge (Edge): Edge to transform</span>
</span><span id="Topology-1332"><a href="#Topology-1332"><span class="linenos">1332</span></a><span class="sd">      start (str, optional): label at one end of edge which is used to determine</span>
</span><span id="Topology-1333"><a href="#Topology-1333"><span class="linenos">1333</span></a><span class="sd">        the sense of h, enabling C-curves with an odd number n of zigs and zags</span>
</span><span id="Topology-1334"><a href="#Topology-1334"><span class="linenos">1334</span></a><span class="sd">        to be applied. Defaults to &#39;A&#39;.</span>
</span><span id="Topology-1335"><a href="#Topology-1335"><span class="linenos">1335</span></a><span class="sd">      n (int, optional): number of zigs and zags in the edge. Defaults to 2.</span>
</span><span id="Topology-1336"><a href="#Topology-1336"><span class="linenos">1336</span></a><span class="sd">      h (float, optional): width of the zig zags relative to edge length.</span>
</span><span id="Topology-1337"><a href="#Topology-1337"><span class="linenos">1337</span></a><span class="sd">        Defaults to 0.5.</span>
</span><span id="Topology-1338"><a href="#Topology-1338"><span class="linenos">1338</span></a><span class="sd">      smoothness (int, optional): spline smoothness. 0 gives a zig zag proper,</span>
</span><span id="Topology-1339"><a href="#Topology-1339"><span class="linenos">1339</span></a><span class="sd">        higher values will produce a sinusoid. Defaults to 0.</span>
</span><span id="Topology-1340"><a href="#Topology-1340"><span class="linenos">1340</span></a>
</span><span id="Topology-1341"><a href="#Topology-1341"><span class="linenos">1341</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Topology-1342"><a href="#Topology-1342"><span class="linenos">1342</span></a>    <span class="n">v0</span><span class="p">,</span> <span class="n">v1</span> <span class="o">=</span> <span class="n">edge</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">edge</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="Topology-1343"><a href="#Topology-1343"><span class="linenos">1343</span></a>    <span class="k">if</span> <span class="n">n</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">v0</span><span class="o">.</span><span class="n">label</span> <span class="o">!=</span> <span class="n">start</span><span class="p">:</span>
</span><span id="Topology-1344"><a href="#Topology-1344"><span class="linenos">1344</span></a>      <span class="n">h</span> <span class="o">=</span> <span class="o">-</span><span class="n">h</span>
</span><span id="Topology-1345"><a href="#Topology-1345"><span class="linenos">1345</span></a>    <span class="n">ls</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">zigzag_between_points</span><span class="p">(</span><span class="n">v0</span><span class="o">.</span><span class="n">point</span><span class="p">,</span> <span class="n">v1</span><span class="o">.</span><span class="n">point</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">smoothness</span><span class="p">)</span>
</span><span id="Topology-1346"><a href="#Topology-1346"><span class="linenos">1346</span></a>    <span class="c1"># remove current corners</span>
</span><span id="Topology-1347"><a href="#Topology-1347"><span class="linenos">1347</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">points</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">points</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
</span><span id="Topology-1348"><a href="#Topology-1348"><span class="linenos">1348</span></a>                   <span class="k">if</span> <span class="n">k</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">edge</span><span class="o">.</span><span class="n">get_corner_IDs</span><span class="p">()[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]}</span>
</span><span id="Topology-1349"><a href="#Topology-1349"><span class="linenos">1349</span></a>    <span class="c1"># add the new ones</span>
</span><span id="Topology-1350"><a href="#Topology-1350"><span class="linenos">1350</span></a>    <span class="n">new_corners</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">add_vertex</span><span class="p">(</span><span class="n">geom</span><span class="o">.</span><span class="n">Point</span><span class="p">(</span><span class="n">xy</span><span class="p">))</span> <span class="k">for</span> <span class="n">xy</span> <span class="ow">in</span> <span class="n">ls</span><span class="o">.</span><span class="n">coords</span><span class="p">]</span>
</span><span id="Topology-1351"><a href="#Topology-1351"><span class="linenos">1351</span></a>    <span class="n">edge</span><span class="o">.</span><span class="n">corners</span> <span class="o">=</span> <span class="n">edge</span><span class="o">.</span><span class="n">vertices</span><span class="p">[:</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">new_corners</span> <span class="o">+</span> <span class="n">edge</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">:]</span>
</span><span id="Topology-1352"><a href="#Topology-1352"><span class="linenos">1352</span></a>    <span class="k">if</span> <span class="n">edge</span><span class="o">.</span><span class="n">right_tile</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Topology-1353"><a href="#Topology-1353"><span class="linenos">1353</span></a>      <span class="n">edge</span><span class="o">.</span><span class="n">right_tile</span><span class="o">.</span><span class="n">set_corners_from_edges</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
</span><span id="Topology-1354"><a href="#Topology-1354"><span class="linenos">1354</span></a>    <span class="k">if</span> <span class="n">edge</span><span class="o">.</span><span class="n">left_tile</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Topology-1355"><a href="#Topology-1355"><span class="linenos">1355</span></a>      <span class="n">edge</span><span class="o">.</span><span class="n">left_tile</span><span class="o">.</span><span class="n">set_corners_from_edges</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
</span><span id="Topology-1356"><a href="#Topology-1356"><span class="linenos">1356</span></a>
</span><span id="Topology-1357"><a href="#Topology-1357"><span class="linenos">1357</span></a>
</span><span id="Topology-1358"><a href="#Topology-1358"><span class="linenos">1358</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">zigzag_between_points</span><span class="p">(</span>
</span><span id="Topology-1359"><a href="#Topology-1359"><span class="linenos">1359</span></a>      <span class="bp">self</span><span class="p">,</span>
</span><span id="Topology-1360"><a href="#Topology-1360"><span class="linenos">1360</span></a>      <span class="n">p0</span><span class="p">:</span><span class="n">geom</span><span class="o">.</span><span class="n">Point</span><span class="p">,</span>
</span><span id="Topology-1361"><a href="#Topology-1361"><span class="linenos">1361</span></a>      <span class="n">p1</span><span class="p">:</span><span class="n">geom</span><span class="o">.</span><span class="n">Point</span><span class="p">,</span>
</span><span id="Topology-1362"><a href="#Topology-1362"><span class="linenos">1362</span></a>      <span class="n">n</span><span class="p">:</span><span class="nb">int</span><span class="p">,</span>
</span><span id="Topology-1363"><a href="#Topology-1363"><span class="linenos">1363</span></a>      <span class="n">h</span><span class="p">:</span><span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
</span><span id="Topology-1364"><a href="#Topology-1364"><span class="linenos">1364</span></a>      <span class="n">smoothness</span><span class="p">:</span><span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
</span><span id="Topology-1365"><a href="#Topology-1365"><span class="linenos">1365</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">geom</span><span class="o">.</span><span class="n">LineString</span><span class="p">:</span>
</span><span id="Topology-1366"><a href="#Topology-1366"><span class="linenos">1366</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return a zig zag line optionally smoothed as a spline between two points.</span>
</span><span id="Topology-1367"><a href="#Topology-1367"><span class="linenos">1367</span></a>
</span><span id="Topology-1368"><a href="#Topology-1368"><span class="linenos">1368</span></a><span class="sd">    Args:</span>
</span><span id="Topology-1369"><a href="#Topology-1369"><span class="linenos">1369</span></a><span class="sd">      p0 (geom.Point): start point.</span>
</span><span id="Topology-1370"><a href="#Topology-1370"><span class="linenos">1370</span></a><span class="sd">      p1 (geom.Point): end point.</span>
</span><span id="Topology-1371"><a href="#Topology-1371"><span class="linenos">1371</span></a><span class="sd">      n (int): number of zig zags.</span>
</span><span id="Topology-1372"><a href="#Topology-1372"><span class="linenos">1372</span></a><span class="sd">      h (float, optional): amplitude of zig zags relative to distance between</span>
</span><span id="Topology-1373"><a href="#Topology-1373"><span class="linenos">1373</span></a><span class="sd">        points. Defaults to 1.0.</span>
</span><span id="Topology-1374"><a href="#Topology-1374"><span class="linenos">1374</span></a><span class="sd">      smoothness (int, optional): number of spline smoothed points to add. If</span>
</span><span id="Topology-1375"><a href="#Topology-1375"><span class="linenos">1375</span></a><span class="sd">        set to 0 a straight line zig zag is produced. Defaults to 0.</span>
</span><span id="Topology-1376"><a href="#Topology-1376"><span class="linenos">1376</span></a>
</span><span id="Topology-1377"><a href="#Topology-1377"><span class="linenos">1377</span></a><span class="sd">    Returns:</span>
</span><span id="Topology-1378"><a href="#Topology-1378"><span class="linenos">1378</span></a><span class="sd">      geom.LineString: the resulting zig zag line.</span>
</span><span id="Topology-1379"><a href="#Topology-1379"><span class="linenos">1379</span></a>
</span><span id="Topology-1380"><a href="#Topology-1380"><span class="linenos">1380</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Topology-1381"><a href="#Topology-1381"><span class="linenos">1381</span></a>    <span class="n">r</span> <span class="o">=</span> <span class="n">p0</span><span class="o">.</span><span class="n">distance</span><span class="p">(</span><span class="n">p1</span><span class="p">)</span>
</span><span id="Topology-1382"><a href="#Topology-1382"><span class="linenos">1382</span></a>    <span class="c1"># make a sinusoidal template</span>
</span><span id="Topology-1383"><a href="#Topology-1383"><span class="linenos">1383</span></a>    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">n</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">endpoint</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</span><span id="Topology-1384"><a href="#Topology-1384"><span class="linenos">1384</span></a>    <span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">x</span><span class="p">]</span>
</span><span id="Topology-1385"><a href="#Topology-1385"><span class="linenos">1385</span></a>    <span class="n">spline</span> <span class="o">=</span> <span class="n">interpolate</span><span class="o">.</span><span class="n">InterpolatedUnivariateSpline</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="Topology-1386"><a href="#Topology-1386"><span class="linenos">1386</span></a>
</span><span id="Topology-1387"><a href="#Topology-1387"><span class="linenos">1387</span></a>    <span class="n">spline_steps</span> <span class="o">=</span> <span class="p">(</span><span class="n">n</span> <span class="o">+</span> <span class="n">smoothness</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span>
</span><span id="Topology-1388"><a href="#Topology-1388"><span class="linenos">1388</span></a>    <span class="n">xs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">spline_steps</span><span class="p">,</span> <span class="n">endpoint</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</span><span id="Topology-1389"><a href="#Topology-1389"><span class="linenos">1389</span></a>    <span class="n">ys</span> <span class="o">=</span> <span class="n">spline</span><span class="p">(</span><span class="n">xs</span><span class="p">)</span>
</span><span id="Topology-1390"><a href="#Topology-1390"><span class="linenos">1390</span></a>
</span><span id="Topology-1391"><a href="#Topology-1391"><span class="linenos">1391</span></a>    <span class="n">sfx</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="nb">max</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">*</span> <span class="n">r</span>
</span><span id="Topology-1392"><a href="#Topology-1392"><span class="linenos">1392</span></a>    <span class="n">sfy</span> <span class="o">=</span> <span class="n">h</span> <span class="o">*</span> <span class="n">r</span> <span class="o">/</span> <span class="mi">2</span>
</span><span id="Topology-1393"><a href="#Topology-1393"><span class="linenos">1393</span></a>    <span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arctan2</span><span class="p">(</span><span class="n">p1</span><span class="o">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">p0</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">p1</span><span class="o">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">p0</span><span class="o">.</span><span class="n">x</span><span class="p">)</span>
</span><span id="Topology-1394"><a href="#Topology-1394"><span class="linenos">1394</span></a>
</span><span id="Topology-1395"><a href="#Topology-1395"><span class="linenos">1395</span></a>    <span class="n">ls</span> <span class="o">=</span> <span class="n">geom</span><span class="o">.</span><span class="n">LineString</span><span class="p">(</span>
</span><span id="Topology-1396"><a href="#Topology-1396"><span class="linenos">1396</span></a>      <span class="p">[</span><span class="n">geom</span><span class="o">.</span><span class="n">Point</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">ys</span><span class="p">,</span> <span class="n">strict</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)])</span>
</span><span id="Topology-1397"><a href="#Topology-1397"><span class="linenos">1397</span></a>    <span class="n">ls</span> <span class="o">=</span> <span class="n">affine</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="n">ls</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="p">(</span><span class="n">ls</span><span class="o">.</span><span class="n">bounds</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">ls</span><span class="o">.</span><span class="n">bounds</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="Topology-1398"><a href="#Topology-1398"><span class="linenos">1398</span></a>    <span class="n">ls</span> <span class="o">=</span> <span class="n">affine</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">ls</span><span class="p">,</span> <span class="n">xfact</span> <span class="o">=</span> <span class="n">sfx</span><span class="p">,</span> <span class="n">yfact</span> <span class="o">=</span> <span class="n">sfy</span><span class="p">,</span> <span class="n">origin</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
</span><span id="Topology-1399"><a href="#Topology-1399"><span class="linenos">1399</span></a>    <span class="n">ls</span> <span class="o">=</span> <span class="n">affine</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span><span class="n">ls</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">use_radians</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</span><span id="Topology-1400"><a href="#Topology-1400"><span class="linenos">1400</span></a>    <span class="n">x0</span><span class="p">,</span> <span class="n">y0</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">ls</span><span class="o">.</span><span class="n">coords</span><span class="p">))</span>
</span><span id="Topology-1401"><a href="#Topology-1401"><span class="linenos">1401</span></a>    <span class="k">return</span> <span class="n">affine</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="n">ls</span><span class="p">,</span> <span class="n">p0</span><span class="o">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">x0</span><span class="p">,</span> <span class="n">p0</span><span class="o">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">y0</span><span class="p">)</span>
</span><span id="Topology-1402"><a href="#Topology-1402"><span class="linenos">1402</span></a>
</span><span id="Topology-1403"><a href="#Topology-1403"><span class="linenos">1403</span></a>
</span><span id="Topology-1404"><a href="#Topology-1404"><span class="linenos">1404</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">rotate_edge</span><span class="p">(</span>
</span><span id="Topology-1405"><a href="#Topology-1405"><span class="linenos">1405</span></a>      <span class="bp">self</span><span class="p">,</span>
</span><span id="Topology-1406"><a href="#Topology-1406"><span class="linenos">1406</span></a>      <span class="n">edge</span><span class="p">:</span><span class="n">Edge</span><span class="p">,</span>
</span><span id="Topology-1407"><a href="#Topology-1407"><span class="linenos">1407</span></a>      <span class="n">centre</span><span class="p">:</span><span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="Topology-1408"><a href="#Topology-1408"><span class="linenos">1408</span></a>      <span class="n">angle</span><span class="p">:</span><span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
</span><span id="Topology-1409"><a href="#Topology-1409"><span class="linenos">1409</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Topology-1410"><a href="#Topology-1410"><span class="linenos">1410</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Rotate edge.</span>
</span><span id="Topology-1411"><a href="#Topology-1411"><span class="linenos">1411</span></a>
</span><span id="Topology-1412"><a href="#Topology-1412"><span class="linenos">1412</span></a><span class="sd">    Args:</span>
</span><span id="Topology-1413"><a href="#Topology-1413"><span class="linenos">1413</span></a><span class="sd">      edge (Edge): the edge to rotate.</span>
</span><span id="Topology-1414"><a href="#Topology-1414"><span class="linenos">1414</span></a><span class="sd">      centre (str): centre of rotation which should be label of one of its</span>
</span><span id="Topology-1415"><a href="#Topology-1415"><span class="linenos">1415</span></a><span class="sd">        end point vertices or &quot;&quot; when rotation will be about the Edge centroid.</span>
</span><span id="Topology-1416"><a href="#Topology-1416"><span class="linenos">1416</span></a><span class="sd">        Defaults to &quot;&quot;.</span>
</span><span id="Topology-1417"><a href="#Topology-1417"><span class="linenos">1417</span></a><span class="sd">      angle (float): angle of rotation.</span>
</span><span id="Topology-1418"><a href="#Topology-1418"><span class="linenos">1418</span></a>
</span><span id="Topology-1419"><a href="#Topology-1419"><span class="linenos">1419</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Topology-1420"><a href="#Topology-1420"><span class="linenos">1420</span></a>    <span class="n">v0</span><span class="p">,</span> <span class="n">v1</span> <span class="o">=</span> <span class="n">edge</span><span class="o">.</span><span class="n">vertices</span>
</span><span id="Topology-1421"><a href="#Topology-1421"><span class="linenos">1421</span></a>    <span class="n">ls</span> <span class="o">=</span> <span class="n">geom</span><span class="o">.</span><span class="n">LineString</span><span class="p">([</span><span class="n">v0</span><span class="o">.</span><span class="n">point</span><span class="p">,</span> <span class="n">v1</span><span class="o">.</span><span class="n">point</span><span class="p">])</span>
</span><span id="Topology-1422"><a href="#Topology-1422"><span class="linenos">1422</span></a>    <span class="k">if</span> <span class="n">v0</span><span class="o">.</span><span class="n">label</span> <span class="o">==</span> <span class="n">centre</span><span class="p">:</span>
</span><span id="Topology-1423"><a href="#Topology-1423"><span class="linenos">1423</span></a>      <span class="n">c</span> <span class="o">=</span> <span class="n">v0</span><span class="o">.</span><span class="n">point</span>
</span><span id="Topology-1424"><a href="#Topology-1424"><span class="linenos">1424</span></a>    <span class="k">elif</span> <span class="n">v1</span><span class="o">.</span><span class="n">label</span> <span class="o">==</span> <span class="n">centre</span><span class="p">:</span>
</span><span id="Topology-1425"><a href="#Topology-1425"><span class="linenos">1425</span></a>      <span class="n">c</span> <span class="o">=</span> <span class="n">v1</span><span class="o">.</span><span class="n">point</span>
</span><span id="Topology-1426"><a href="#Topology-1426"><span class="linenos">1426</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="Topology-1427"><a href="#Topology-1427"><span class="linenos">1427</span></a>      <span class="n">c</span> <span class="o">=</span> <span class="n">ls</span><span class="o">.</span><span class="n">centroid</span>
</span><span id="Topology-1428"><a href="#Topology-1428"><span class="linenos">1428</span></a>    <span class="n">ls</span> <span class="o">=</span> <span class="n">affine</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span><span class="n">ls</span><span class="p">,</span> <span class="n">angle</span><span class="p">,</span> <span class="n">origin</span> <span class="o">=</span> <span class="n">c</span><span class="p">)</span>
</span><span id="Topology-1429"><a href="#Topology-1429"><span class="linenos">1429</span></a>    <span class="n">v0</span><span class="o">.</span><span class="n">point</span><span class="p">,</span> <span class="n">v1</span><span class="o">.</span><span class="n">point</span> <span class="o">=</span> <span class="p">[</span><span class="n">geom</span><span class="o">.</span><span class="n">Point</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">ls</span><span class="o">.</span><span class="n">coords</span><span class="p">]</span>
</span><span id="Topology-1430"><a href="#Topology-1430"><span class="linenos">1430</span></a>
</span><span id="Topology-1431"><a href="#Topology-1431"><span class="linenos">1431</span></a>
</span><span id="Topology-1432"><a href="#Topology-1432"><span class="linenos">1432</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">scale_edge</span><span class="p">(</span>
</span><span id="Topology-1433"><a href="#Topology-1433"><span class="linenos">1433</span></a>      <span class="bp">self</span><span class="p">,</span>
</span><span id="Topology-1434"><a href="#Topology-1434"><span class="linenos">1434</span></a>      <span class="n">edge</span><span class="p">:</span><span class="n">Edge</span><span class="p">,</span>
</span><span id="Topology-1435"><a href="#Topology-1435"><span class="linenos">1435</span></a>      <span class="n">sf</span><span class="p">:</span><span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
</span><span id="Topology-1436"><a href="#Topology-1436"><span class="linenos">1436</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Topology-1437"><a href="#Topology-1437"><span class="linenos">1437</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Scale edge.</span>
</span><span id="Topology-1438"><a href="#Topology-1438"><span class="linenos">1438</span></a>
</span><span id="Topology-1439"><a href="#Topology-1439"><span class="linenos">1439</span></a><span class="sd">    Args:</span>
</span><span id="Topology-1440"><a href="#Topology-1440"><span class="linenos">1440</span></a><span class="sd">      edge (Edge): the edge to scale.</span>
</span><span id="Topology-1441"><a href="#Topology-1441"><span class="linenos">1441</span></a><span class="sd">      sf (float): amount by which to scale the edge.</span>
</span><span id="Topology-1442"><a href="#Topology-1442"><span class="linenos">1442</span></a>
</span><span id="Topology-1443"><a href="#Topology-1443"><span class="linenos">1443</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Topology-1444"><a href="#Topology-1444"><span class="linenos">1444</span></a>    <span class="n">v0</span><span class="p">,</span> <span class="n">v1</span> <span class="o">=</span> <span class="n">edge</span><span class="o">.</span><span class="n">vertices</span>
</span><span id="Topology-1445"><a href="#Topology-1445"><span class="linenos">1445</span></a>    <span class="n">ls</span> <span class="o">=</span> <span class="n">geom</span><span class="o">.</span><span class="n">LineString</span><span class="p">([</span><span class="n">v0</span><span class="o">.</span><span class="n">point</span><span class="p">,</span> <span class="n">v1</span><span class="o">.</span><span class="n">point</span><span class="p">])</span>
</span><span id="Topology-1446"><a href="#Topology-1446"><span class="linenos">1446</span></a>    <span class="n">ls</span> <span class="o">=</span> <span class="n">affine</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">ls</span><span class="p">,</span> <span class="n">xfact</span> <span class="o">=</span> <span class="n">sf</span><span class="p">,</span> <span class="n">yfact</span> <span class="o">=</span> <span class="n">sf</span><span class="p">,</span> <span class="n">origin</span> <span class="o">=</span> <span class="n">ls</span><span class="o">.</span><span class="n">centroid</span><span class="p">)</span>
</span><span id="Topology-1447"><a href="#Topology-1447"><span class="linenos">1447</span></a>    <span class="n">v0</span><span class="o">.</span><span class="n">point</span><span class="p">,</span> <span class="n">v1</span><span class="o">.</span><span class="n">point</span> <span class="o">=</span> <span class="p">[</span><span class="n">geom</span><span class="o">.</span><span class="n">Point</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">ls</span><span class="o">.</span><span class="n">coords</span><span class="p">]</span>
</span><span id="Topology-1448"><a href="#Topology-1448"><span class="linenos">1448</span></a>
</span><span id="Topology-1449"><a href="#Topology-1449"><span class="linenos">1449</span></a>
</span><span id="Topology-1450"><a href="#Topology-1450"><span class="linenos">1450</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">push_vertex</span><span class="p">(</span>
</span><span id="Topology-1451"><a href="#Topology-1451"><span class="linenos">1451</span></a>      <span class="bp">self</span><span class="p">,</span>
</span><span id="Topology-1452"><a href="#Topology-1452"><span class="linenos">1452</span></a>      <span class="n">vertex</span><span class="p">:</span><span class="n">Vertex</span><span class="p">,</span>
</span><span id="Topology-1453"><a href="#Topology-1453"><span class="linenos">1453</span></a>      <span class="n">push_d</span><span class="p">:</span><span class="nb">float</span><span class="p">,</span>
</span><span id="Topology-1454"><a href="#Topology-1454"><span class="linenos">1454</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">]:</span>
</span><span id="Topology-1455"><a href="#Topology-1455"><span class="linenos">1455</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return displacement vector to push a vertex based on incident edges.</span>
</span><span id="Topology-1456"><a href="#Topology-1456"><span class="linenos">1456</span></a>
</span><span id="Topology-1457"><a href="#Topology-1457"><span class="linenos">1457</span></a><span class="sd">    Args:</span>
</span><span id="Topology-1458"><a href="#Topology-1458"><span class="linenos">1458</span></a><span class="sd">      vertex (Vertex): the vertex to push.</span>
</span><span id="Topology-1459"><a href="#Topology-1459"><span class="linenos">1459</span></a><span class="sd">      push_d (float): the distance to push it.</span>
</span><span id="Topology-1460"><a href="#Topology-1460"><span class="linenos">1460</span></a>
</span><span id="Topology-1461"><a href="#Topology-1461"><span class="linenos">1461</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Topology-1462"><a href="#Topology-1462"><span class="linenos">1462</span></a>    <span class="n">neighbours</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">points</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">vertex</span><span class="o">.</span><span class="n">neighbours</span><span class="p">]</span>
</span><span id="Topology-1463"><a href="#Topology-1463"><span class="linenos">1463</span></a>    <span class="n">dists</span> <span class="o">=</span> <span class="p">[</span><span class="n">vertex</span><span class="o">.</span><span class="n">point</span><span class="o">.</span><span class="n">distance</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">point</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">neighbours</span><span class="p">]</span>
</span><span id="Topology-1464"><a href="#Topology-1464"><span class="linenos">1464</span></a>    <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">vertex</span><span class="o">.</span><span class="n">point</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">vertex</span><span class="o">.</span><span class="n">point</span><span class="o">.</span><span class="n">y</span>
</span><span id="Topology-1465"><a href="#Topology-1465"><span class="linenos">1465</span></a>    <span class="n">unit_vectors</span> <span class="o">=</span> <span class="p">[((</span><span class="n">x</span> <span class="o">-</span> <span class="n">v</span><span class="o">.</span><span class="n">point</span><span class="o">.</span><span class="n">x</span><span class="p">)</span> <span class="o">/</span> <span class="n">d</span><span class="p">,</span> <span class="p">(</span><span class="n">y</span> <span class="o">-</span> <span class="n">v</span><span class="o">.</span><span class="n">point</span><span class="o">.</span><span class="n">y</span><span class="p">)</span> <span class="o">/</span> <span class="n">d</span><span class="p">)</span>
</span><span id="Topology-1466"><a href="#Topology-1466"><span class="linenos">1466</span></a>                    <span class="k">for</span> <span class="n">v</span><span class="p">,</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">neighbours</span><span class="p">,</span> <span class="n">dists</span><span class="p">,</span> <span class="n">strict</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)]</span>
</span><span id="Topology-1467"><a href="#Topology-1467"><span class="linenos">1467</span></a>    <span class="k">return</span>  <span class="p">(</span><span class="n">push_d</span> <span class="o">*</span> <span class="nb">sum</span><span class="p">([</span><span class="n">xy</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">xy</span> <span class="ow">in</span> <span class="n">unit_vectors</span><span class="p">]),</span>
</span><span id="Topology-1468"><a href="#Topology-1468"><span class="linenos">1468</span></a>             <span class="n">push_d</span> <span class="o">*</span> <span class="nb">sum</span><span class="p">([</span><span class="n">xy</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">xy</span> <span class="ow">in</span> <span class="n">unit_vectors</span><span class="p">]))</span>
</span><span id="Topology-1469"><a href="#Topology-1469"><span class="linenos">1469</span></a>
</span><span id="Topology-1470"><a href="#Topology-1470"><span class="linenos">1470</span></a>
</span><span id="Topology-1471"><a href="#Topology-1471"><span class="linenos">1471</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">nudge_vertex</span><span class="p">(</span>
</span><span id="Topology-1472"><a href="#Topology-1472"><span class="linenos">1472</span></a>      <span class="bp">self</span><span class="p">,</span>
</span><span id="Topology-1473"><a href="#Topology-1473"><span class="linenos">1473</span></a>      <span class="n">vertex</span><span class="p">:</span><span class="n">Vertex</span><span class="p">,</span>
</span><span id="Topology-1474"><a href="#Topology-1474"><span class="linenos">1474</span></a>      <span class="n">dx</span><span class="p">:</span><span class="nb">float</span><span class="p">,</span>
</span><span id="Topology-1475"><a href="#Topology-1475"><span class="linenos">1475</span></a>      <span class="n">dy</span><span class="p">:</span><span class="nb">float</span><span class="p">,</span>
</span><span id="Topology-1476"><a href="#Topology-1476"><span class="linenos">1476</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Topology-1477"><a href="#Topology-1477"><span class="linenos">1477</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Nudge vertex by specified displacement.</span>
</span><span id="Topology-1478"><a href="#Topology-1478"><span class="linenos">1478</span></a>
</span><span id="Topology-1479"><a href="#Topology-1479"><span class="linenos">1479</span></a><span class="sd">    Args:</span>
</span><span id="Topology-1480"><a href="#Topology-1480"><span class="linenos">1480</span></a><span class="sd">      vertex (Vertex): the vertext to nudge.</span>
</span><span id="Topology-1481"><a href="#Topology-1481"><span class="linenos">1481</span></a><span class="sd">      dx (float): x displacement.</span>
</span><span id="Topology-1482"><a href="#Topology-1482"><span class="linenos">1482</span></a><span class="sd">      dy (float): y displacement.</span>
</span><span id="Topology-1483"><a href="#Topology-1483"><span class="linenos">1483</span></a>
</span><span id="Topology-1484"><a href="#Topology-1484"><span class="linenos">1484</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Topology-1485"><a href="#Topology-1485"><span class="linenos">1485</span></a>    <span class="n">vertex</span><span class="o">.</span><span class="n">point</span> <span class="o">=</span> <span class="n">affine</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="n">vertex</span><span class="o">.</span><span class="n">point</span><span class="p">,</span> <span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Class to represent topology of a Tileable object.</p>

<p>NOTE: It is important that get_local_patch return the tileable elements and
the translated copies in consistent sequence, i.e. if there are (say) four
tiles in the unit, the local patch should be 1 2 3 4 1 2 3 4 1 2 3 4 ... and
so on. This is because self.tiles[i % n_tiles] is frequently used to
reference the base unit Tile which corresponds to self.tiles[i].</p>
</div>


                            <div id="Topology.__init__" class="classattr">
                                        <input id="Topology.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">Topology</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unit</span><span class="p">:</span> <span class="n"><a href="tileable.html#Tileable">weavingspace.tileable.Tileable</a></span>, </span><span class="param"><span class="n">ignore_tile_ids</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span></span>)</span>

                <label class="view-source-button" for="Topology.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Topology.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Topology.__init__-108"><a href="#Topology.__init__-108"><span class="linenos">108</span></a>  <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="Topology.__init__-109"><a href="#Topology.__init__-109"><span class="linenos">109</span></a>      <span class="bp">self</span><span class="p">,</span>
</span><span id="Topology.__init__-110"><a href="#Topology.__init__-110"><span class="linenos">110</span></a>      <span class="n">unit</span><span class="p">:</span> <span class="n">Tileable</span><span class="p">,</span>
</span><span id="Topology.__init__-111"><a href="#Topology.__init__-111"><span class="linenos">111</span></a>      <span class="n">ignore_tile_ids</span><span class="p">:</span><span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="Topology.__init__-112"><a href="#Topology.__init__-112"><span class="linenos">112</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Topology.__init__-113"><a href="#Topology.__init__-113"><span class="linenos">113</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Class constructor.</span>
</span><span id="Topology.__init__-114"><a href="#Topology.__init__-114"><span class="linenos">114</span></a>
</span><span id="Topology.__init__-115"><a href="#Topology.__init__-115"><span class="linenos">115</span></a><span class="sd">    Args:</span>
</span><span id="Topology.__init__-116"><a href="#Topology.__init__-116"><span class="linenos">116</span></a><span class="sd">      unit (Tileable): the Tileable whose topology is required.</span>
</span><span id="Topology.__init__-117"><a href="#Topology.__init__-117"><span class="linenos">117</span></a><span class="sd">      ignore_tile_ids (bool): (EXPERIMENTAL) if True then only consider the tile</span>
</span><span id="Topology.__init__-118"><a href="#Topology.__init__-118"><span class="linenos">118</span></a><span class="sd">        shapes, not labels. If False consider any labels. Defaults to True.</span>
</span><span id="Topology.__init__-119"><a href="#Topology.__init__-119"><span class="linenos">119</span></a>
</span><span id="Topology.__init__-120"><a href="#Topology.__init__-120"><span class="linenos">120</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Topology.__init__-121"><a href="#Topology.__init__-121"><span class="linenos">121</span></a>    <span class="c1"># Note that the order of these setup steps is fragile sometimes</span>
</span><span id="Topology.__init__-122"><a href="#Topology.__init__-122"><span class="linenos">122</span></a>    <span class="c1"># not obviously so.</span>
</span><span id="Topology.__init__-123"><a href="#Topology.__init__-123"><span class="linenos">123</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">tileable</span> <span class="o">=</span> <span class="n">unit</span> <span class="c1"># keep this for reference</span>
</span><span id="Topology.__init__-124"><a href="#Topology.__init__-124"><span class="linenos">124</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">n_tiles</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tileable</span><span class="o">.</span><span class="n">tiles</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="Topology.__init__-125"><a href="#Topology.__init__-125"><span class="linenos">125</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_initialise_points_into_tiles</span><span class="p">()</span>
</span><span id="Topology.__init__-126"><a href="#Topology.__init__-126"><span class="linenos">126</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_setup_vertex_tile_relations</span><span class="p">()</span>
</span><span id="Topology.__init__-127"><a href="#Topology.__init__-127"><span class="linenos">127</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_setup_edges</span><span class="p">()</span>
</span><span id="Topology.__init__-128"><a href="#Topology.__init__-128"><span class="linenos">128</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_copy_base_tiles_to_patch</span><span class="p">()</span>
</span><span id="Topology.__init__-129"><a href="#Topology.__init__-129"><span class="linenos">129</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_assign_vertex_and_edge_base_IDs</span><span class="p">()</span>
</span><span id="Topology.__init__-130"><a href="#Topology.__init__-130"><span class="linenos">130</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_identify_distinct_tile_shapes</span><span class="p">(</span><span class="n">ignore_tile_ids</span><span class="p">)</span>
</span><span id="Topology.__init__-131"><a href="#Topology.__init__-131"><span class="linenos">131</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_find_tile_transitivity_classes</span><span class="p">(</span><span class="n">ignore_tile_ids</span><span class="p">)</span>
</span><span id="Topology.__init__-132"><a href="#Topology.__init__-132"><span class="linenos">132</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_find_vertex_transitivity_classes</span><span class="p">(</span><span class="n">ignore_tile_ids</span><span class="p">)</span>
</span><span id="Topology.__init__-133"><a href="#Topology.__init__-133"><span class="linenos">133</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_find_edge_transitivity_classes</span><span class="p">(</span><span class="n">ignore_tile_ids</span><span class="p">)</span>
</span><span id="Topology.__init__-134"><a href="#Topology.__init__-134"><span class="linenos">134</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">generate_dual</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Class constructor.</p>

<p>Args:
  unit (Tileable): the Tileable whose topology is required.
  ignore_tile_ids (bool): (EXPERIMENTAL) if True then only consider the tile
    shapes, not labels. If False consider any labels. Defaults to True.</p>
</div>


                            </div>
                            <div id="Topology.tileable" class="classattr">
                                <div class="attr variable">
            <span class="name">tileable</span><span class="annotation">: <a href="tileable.html#Tileable">weavingspace.tileable.Tileable</a></span>

        
    </div>
    <a class="headerlink" href="#Topology.tileable"></a>
    
            <div class="docstring"><p>the Tileable on which the topology will be based.</p>
</div>


                            </div>
                            <div id="Topology.tiles" class="classattr">
                                <div class="attr variable">
            <span class="name">tiles</span><span class="annotation">: list[<a href="#Tile">Tile</a>]</span>

        
    </div>
    <a class="headerlink" href="#Topology.tiles"></a>
    
            <div class="docstring"><p>list of the Tiles in the topology. We use polygons returned by the
tileable.get_local_patch method for these. That is the base tiles and 8
adjacent copies (for a rectangular tiling), or 6 adjacent copies (for a
hexagonal tiling).</p>
</div>


                            </div>
                            <div id="Topology.points" class="classattr">
                                <div class="attr variable">
            <span class="name">points</span><span class="annotation">: dict[int, <a href="#Vertex">Vertex</a>]</span>

        
    </div>
    <a class="headerlink" href="#Topology.points"></a>
    
            <div class="docstring"><p>dictionary of all points (vertices and corners) in the tiling, keyed by
Vertex ID.</p>
</div>


                            </div>
                            <div id="Topology.edges" class="classattr">
                                <div class="attr variable">
            <span class="name">edges</span><span class="annotation">: dict[tuple[int, int], <a href="#Edge">Edge</a>]</span>

        
    </div>
    <a class="headerlink" href="#Topology.edges"></a>
    
            <div class="docstring"><p>dictionary of the tiling edges, keyed by Edge ID.</p>
</div>


                            </div>
                            <div id="Topology.unique_tile_shapes" class="classattr">
                                <div class="attr variable">
            <span class="name">unique_tile_shapes</span><span class="annotation">: list[shapely.geometry.polygon.Polygon]</span>

        
    </div>
    <a class="headerlink" href="#Topology.unique_tile_shapes"></a>
    
            <div class="docstring"><p>a 'reference' tile shape one per tile shape (up to vertices, so two tiles
might be the same shape, but one might have extra vertices induced by the
tiling and hence is a different shape under this definition).</p>
</div>


                            </div>
                            <div id="Topology.dual_tiles" class="classattr">
                                <div class="attr variable">
            <span class="name">dual_tiles</span><span class="annotation">: list[shapely.geometry.polygon.Polygon]</span>

        
    </div>
    <a class="headerlink" href="#Topology.dual_tiles"></a>
    
            <div class="docstring"><p>list of geom.Polygons from which a dual tiling might be constructed.</p>
</div>


                            </div>
                            <div id="Topology.n_tiles" class="classattr">
                                <div class="attr variable">
            <span class="name">n_tiles</span><span class="annotation">: int</span>        =
<span class="default_value">0</span>

        
    </div>
    <a class="headerlink" href="#Topology.n_tiles"></a>
    
            <div class="docstring"><p>number of tiles in the base Tileable (retained for convenience).</p>
</div>


                            </div>
                            <div id="Topology.shape_groups" class="classattr">
                                <div class="attr variable">
            <span class="name">shape_groups</span><span class="annotation">: list[list[int]]</span>

        
    </div>
    <a class="headerlink" href="#Topology.shape_groups"></a>
    
            <div class="docstring"><p>list of lists of tile IDs distinguished by shape and optionally tile_id</p>
</div>


                            </div>
                            <div id="Topology.tile_matching_transforms" class="classattr">
                                <div class="attr variable">
            <span class="name">tile_matching_transforms</span><span class="annotation">: list[tuple[float]]</span>

        
    </div>
    <a class="headerlink" href="#Topology.tile_matching_transforms"></a>
    
            <div class="docstring"><p>shapely transform tuples that map tiles onto other tiles</p>
</div>


                            </div>
                            <div id="Topology.tile_transitivity_classes" class="classattr">
                                <div class="attr variable">
            <span class="name">tile_transitivity_classes</span><span class="annotation">: list[tuple[int]]</span>

        
    </div>
    <a class="headerlink" href="#Topology.tile_transitivity_classes"></a>
    
            <div class="docstring"><p>list of lists of tile IDs in each transitivity class</p>
</div>


                            </div>
                            <div id="Topology.vertex_transitivity_classes" class="classattr">
                                <div class="attr variable">
            <span class="name">vertex_transitivity_classes</span><span class="annotation">: list[list[int]]</span>

        
    </div>
    <a class="headerlink" href="#Topology.vertex_transitivity_classes"></a>
    
            <div class="docstring"><p>list of lists of vertex IDs in each transitivity class</p>
</div>


                            </div>
                            <div id="Topology.edge_transitivity_classes" class="classattr">
                                <div class="attr variable">
            <span class="name">edge_transitivity_classes</span><span class="annotation">: list[list[tuple[int]]]</span>

        
    </div>
    <a class="headerlink" href="#Topology.edge_transitivity_classes"></a>
    
            <div class="docstring"><p>list of lists of edge IDs in each transitivity class</p>
</div>


                            </div>
                            <div id="Topology.get_potential_symmetries" class="classattr">
                                        <input id="Topology.get_potential_symmetries-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_potential_symmetries</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">ignore_tile_id_labels</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span></span><span class="return-annotation">) -> <span class="nb">dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n"><a href="symmetry.html#Transform">weavingspace.symmetry.Transform</a></span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="Topology.get_potential_symmetries-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Topology.get_potential_symmetries"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Topology.get_potential_symmetries-553"><a href="#Topology.get_potential_symmetries-553"><span class="linenos">553</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">get_potential_symmetries</span><span class="p">(</span>
</span><span id="Topology.get_potential_symmetries-554"><a href="#Topology.get_potential_symmetries-554"><span class="linenos">554</span></a>      <span class="bp">self</span><span class="p">,</span>
</span><span id="Topology.get_potential_symmetries-555"><a href="#Topology.get_potential_symmetries-555"><span class="linenos">555</span></a>      <span class="n">ignore_tile_id_labels</span><span class="p">:</span><span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="Topology.get_potential_symmetries-556"><a href="#Topology.get_potential_symmetries-556"><span class="linenos">556</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">Transform</span><span class="p">]:</span>
</span><span id="Topology.get_potential_symmetries-557"><a href="#Topology.get_potential_symmetries-557"><span class="linenos">557</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Assemble potential symmetries from symmetries of prototile and tiles.</span>
</span><span id="Topology.get_potential_symmetries-558"><a href="#Topology.get_potential_symmetries-558"><span class="linenos">558</span></a>
</span><span id="Topology.get_potential_symmetries-559"><a href="#Topology.get_potential_symmetries-559"><span class="linenos">559</span></a><span class="sd">    Also remove any duplicates that result. The result is assigned to the</span>
</span><span id="Topology.get_potential_symmetries-560"><a href="#Topology.get_potential_symmetries-560"><span class="linenos">560</span></a><span class="sd">    tile_matching_transforms attribute.</span>
</span><span id="Topology.get_potential_symmetries-561"><a href="#Topology.get_potential_symmetries-561"><span class="linenos">561</span></a>
</span><span id="Topology.get_potential_symmetries-562"><a href="#Topology.get_potential_symmetries-562"><span class="linenos">562</span></a><span class="sd">    TODO: consider retaining the Symmetry objects as these carry additional</span>
</span><span id="Topology.get_potential_symmetries-563"><a href="#Topology.get_potential_symmetries-563"><span class="linenos">563</span></a><span class="sd">    information that might facilitate labelling under a limited number of the</span>
</span><span id="Topology.get_potential_symmetries-564"><a href="#Topology.get_potential_symmetries-564"><span class="linenos">564</span></a><span class="sd">    symmetries not all of them.</span>
</span><span id="Topology.get_potential_symmetries-565"><a href="#Topology.get_potential_symmetries-565"><span class="linenos">565</span></a>
</span><span id="Topology.get_potential_symmetries-566"><a href="#Topology.get_potential_symmetries-566"><span class="linenos">566</span></a><span class="sd">    Returns:</span>
</span><span id="Topology.get_potential_symmetries-567"><a href="#Topology.get_potential_symmetries-567"><span class="linenos">567</span></a><span class="sd">      dict[int, tuple[float]]: dictionary of the symmetries (transforms</span>
</span><span id="Topology.get_potential_symmetries-568"><a href="#Topology.get_potential_symmetries-568"><span class="linenos">568</span></a><span class="sd">        actually) in shapely affine transform 6-tuple format.</span>
</span><span id="Topology.get_potential_symmetries-569"><a href="#Topology.get_potential_symmetries-569"><span class="linenos">569</span></a>
</span><span id="Topology.get_potential_symmetries-570"><a href="#Topology.get_potential_symmetries-570"><span class="linenos">570</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Topology.get_potential_symmetries-571"><a href="#Topology.get_potential_symmetries-571"><span class="linenos">571</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">tile_matching_transforms</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="Topology.get_potential_symmetries-572"><a href="#Topology.get_potential_symmetries-572"><span class="linenos">572</span></a>      <span class="n">k</span><span class="p">:</span> <span class="n">Transform</span><span class="p">(</span><span class="s2">&quot;translation&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">geom</span><span class="o">.</span><span class="n">Point</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">v</span><span class="p">,</span>
</span><span id="Topology.get_potential_symmetries-573"><a href="#Topology.get_potential_symmetries-573"><span class="linenos">573</span></a>                   <span class="n">tiling_utils</span><span class="o">.</span><span class="n">get_translation_transform</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
</span><span id="Topology.get_potential_symmetries-574"><a href="#Topology.get_potential_symmetries-574"><span class="linenos">574</span></a>      <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tileable</span><span class="o">.</span><span class="n">get_vectors</span><span class="p">())}</span>
</span><span id="Topology.get_potential_symmetries-575"><a href="#Topology.get_potential_symmetries-575"><span class="linenos">575</span></a>    <span class="k">if</span> <span class="n">ignore_tile_id_labels</span><span class="p">:</span>
</span><span id="Topology.get_potential_symmetries-576"><a href="#Topology.get_potential_symmetries-576"><span class="linenos">576</span></a>      <span class="n">n_symmetries</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tile_matching_transforms</span><span class="p">)</span>
</span><span id="Topology.get_potential_symmetries-577"><a href="#Topology.get_potential_symmetries-577"><span class="linenos">577</span></a>      <span class="n">ptile</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tileable</span><span class="o">.</span><span class="n">prototile</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;geometry&quot;</span><span class="p">]</span>
</span><span id="Topology.get_potential_symmetries-578"><a href="#Topology.get_potential_symmetries-578"><span class="linenos">578</span></a>      <span class="k">for</span> <span class="n">tr</span> <span class="ow">in</span> <span class="n">ShapeMatcher</span><span class="p">(</span><span class="n">ptile</span><span class="p">)</span><span class="o">.</span><span class="n">get_polygon_matches</span><span class="p">(</span><span class="n">ptile</span><span class="p">):</span>
</span><span id="Topology.get_potential_symmetries-579"><a href="#Topology.get_potential_symmetries-579"><span class="linenos">579</span></a>        <span class="k">if</span> <span class="n">tr</span><span class="o">.</span><span class="n">transform_type</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;identity&quot;</span><span class="p">,</span> <span class="s2">&quot;translation&quot;</span><span class="p">]:</span>
</span><span id="Topology.get_potential_symmetries-580"><a href="#Topology.get_potential_symmetries-580"><span class="linenos">580</span></a>          <span class="bp">self</span><span class="o">.</span><span class="n">tile_matching_transforms</span><span class="p">[</span><span class="n">n_symmetries</span><span class="p">]</span> <span class="o">=</span> <span class="n">tr</span>
</span><span id="Topology.get_potential_symmetries-581"><a href="#Topology.get_potential_symmetries-581"><span class="linenos">581</span></a>          <span class="n">n_symmetries</span> <span class="o">=</span> <span class="n">n_symmetries</span> <span class="o">+</span> <span class="mi">1</span>
</span><span id="Topology.get_potential_symmetries-582"><a href="#Topology.get_potential_symmetries-582"><span class="linenos">582</span></a>      <span class="k">for</span> <span class="n">tile</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tiles</span><span class="p">[:</span><span class="bp">self</span><span class="o">.</span><span class="n">n_tiles</span><span class="p">]:</span>
</span><span id="Topology.get_potential_symmetries-583"><a href="#Topology.get_potential_symmetries-583"><span class="linenos">583</span></a>        <span class="k">for</span> <span class="n">tr</span> <span class="ow">in</span> <span class="n">ShapeMatcher</span><span class="p">(</span><span class="n">tile</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span><span class="o">.</span><span class="n">get_polygon_matches</span><span class="p">(</span><span class="n">tile</span><span class="o">.</span><span class="n">shape</span><span class="p">):</span>
</span><span id="Topology.get_potential_symmetries-584"><a href="#Topology.get_potential_symmetries-584"><span class="linenos">584</span></a>          <span class="k">if</span> <span class="n">tr</span><span class="o">.</span><span class="n">transform_type</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;identity&quot;</span><span class="p">,</span> <span class="s2">&quot;translation&quot;</span><span class="p">]:</span>
</span><span id="Topology.get_potential_symmetries-585"><a href="#Topology.get_potential_symmetries-585"><span class="linenos">585</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">tile_matching_transforms</span><span class="p">[</span><span class="n">n_symmetries</span><span class="p">]</span> <span class="o">=</span> <span class="n">tr</span>
</span><span id="Topology.get_potential_symmetries-586"><a href="#Topology.get_potential_symmetries-586"><span class="linenos">586</span></a>            <span class="n">n_symmetries</span> <span class="o">=</span> <span class="n">n_symmetries</span> <span class="o">+</span> <span class="mi">1</span>
</span><span id="Topology.get_potential_symmetries-587"><a href="#Topology.get_potential_symmetries-587"><span class="linenos">587</span></a>      <span class="k">for</span> <span class="n">tile</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tiles</span><span class="p">[:</span><span class="bp">self</span><span class="o">.</span><span class="n">n_tiles</span><span class="p">]:</span>
</span><span id="Topology.get_potential_symmetries-588"><a href="#Topology.get_potential_symmetries-588"><span class="linenos">588</span></a>        <span class="n">sm</span> <span class="o">=</span> <span class="n">ShapeMatcher</span><span class="p">(</span><span class="n">tile</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</span><span id="Topology.get_potential_symmetries-589"><a href="#Topology.get_potential_symmetries-589"><span class="linenos">589</span></a>        <span class="n">transforms</span> <span class="o">=</span> <span class="p">[</span><span class="n">sm</span><span class="o">.</span><span class="n">get_polygon_matches</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tiles</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</span><span id="Topology.get_potential_symmetries-590"><a href="#Topology.get_potential_symmetries-590"><span class="linenos">590</span></a>          <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">shape_groups</span><span class="p">[</span><span class="n">tile</span><span class="o">.</span><span class="n">shape_group</span><span class="p">]</span> <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_tiles</span><span class="p">]</span>
</span><span id="Topology.get_potential_symmetries-591"><a href="#Topology.get_potential_symmetries-591"><span class="linenos">591</span></a>        <span class="k">for</span> <span class="n">tr</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="p">(</span><span class="o">*</span><span class="n">transforms</span><span class="p">):</span>
</span><span id="Topology.get_potential_symmetries-592"><a href="#Topology.get_potential_symmetries-592"><span class="linenos">592</span></a>          <span class="k">if</span> <span class="n">tr</span><span class="o">.</span><span class="n">transform_type</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;identity&quot;</span><span class="p">,</span> <span class="s2">&quot;translation&quot;</span><span class="p">]:</span>
</span><span id="Topology.get_potential_symmetries-593"><a href="#Topology.get_potential_symmetries-593"><span class="linenos">593</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">tile_matching_transforms</span><span class="p">[</span><span class="n">n_symmetries</span><span class="p">]</span> <span class="o">=</span> <span class="n">tr</span>
</span><span id="Topology.get_potential_symmetries-594"><a href="#Topology.get_potential_symmetries-594"><span class="linenos">594</span></a>            <span class="n">n_symmetries</span> <span class="o">=</span> <span class="n">n_symmetries</span> <span class="o">+</span> <span class="mi">1</span>
</span><span id="Topology.get_potential_symmetries-595"><a href="#Topology.get_potential_symmetries-595"><span class="linenos">595</span></a>      <span class="bp">self</span><span class="o">.</span><span class="n">tile_matching_transforms</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_remove_duplicate_symmetries</span><span class="p">(</span>
</span><span id="Topology.get_potential_symmetries-596"><a href="#Topology.get_potential_symmetries-596"><span class="linenos">596</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">tile_matching_transforms</span><span class="p">)</span>
</span><span id="Topology.get_potential_symmetries-597"><a href="#Topology.get_potential_symmetries-597"><span class="linenos">597</span></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">tile_matching_transforms</span>
</span></pre></div>


            <div class="docstring"><p>Assemble potential symmetries from symmetries of prototile and tiles.</p>

<p>Also remove any duplicates that result. The result is assigned to the
tile_matching_transforms attribute.</p>

<p>TODO: consider retaining the Symmetry objects as these carry additional
information that might facilitate labelling under a limited number of the
symmetries not all of them.</p>

<p>Returns:
  dict[int, tuple[float]]: dictionary of the symmetries (transforms
    actually) in shapely affine transform 6-tuple format.</p>
</div>


                            </div>
                            <div id="Topology.vertices_in_tiles" class="classattr">
                                        <input id="Topology.vertices_in_tiles-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">vertices_in_tiles</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">tiles</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n"><a href="#Tile">Tile</a></span><span class="p">]</span></span><span class="return-annotation">) -> <span class="nb">list</span><span class="p">[</span><span class="n"><a href="#Vertex">Vertex</a></span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="Topology.vertices_in_tiles-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Topology.vertices_in_tiles"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Topology.vertices_in_tiles-802"><a href="#Topology.vertices_in_tiles-802"><span class="linenos">802</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">vertices_in_tiles</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tiles</span><span class="p">:</span><span class="nb">list</span><span class="p">[</span><span class="n">Tile</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Vertex</span><span class="p">]:</span>
</span><span id="Topology.vertices_in_tiles-803"><a href="#Topology.vertices_in_tiles-803"><span class="linenos">803</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get vertices incident on tiles in supplied list.</span>
</span><span id="Topology.vertices_in_tiles-804"><a href="#Topology.vertices_in_tiles-804"><span class="linenos">804</span></a>
</span><span id="Topology.vertices_in_tiles-805"><a href="#Topology.vertices_in_tiles-805"><span class="linenos">805</span></a><span class="sd">    Args:</span>
</span><span id="Topology.vertices_in_tiles-806"><a href="#Topology.vertices_in_tiles-806"><span class="linenos">806</span></a><span class="sd">      tiles (list[Tile]): tiles whose vertices are required.</span>
</span><span id="Topology.vertices_in_tiles-807"><a href="#Topology.vertices_in_tiles-807"><span class="linenos">807</span></a>
</span><span id="Topology.vertices_in_tiles-808"><a href="#Topology.vertices_in_tiles-808"><span class="linenos">808</span></a><span class="sd">    Returns:</span>
</span><span id="Topology.vertices_in_tiles-809"><a href="#Topology.vertices_in_tiles-809"><span class="linenos">809</span></a><span class="sd">      list[Vertex]: the required vertices.</span>
</span><span id="Topology.vertices_in_tiles-810"><a href="#Topology.vertices_in_tiles-810"><span class="linenos">810</span></a>
</span><span id="Topology.vertices_in_tiles-811"><a href="#Topology.vertices_in_tiles-811"><span class="linenos">811</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Topology.vertices_in_tiles-812"><a href="#Topology.vertices_in_tiles-812"><span class="linenos">812</span></a>    <span class="n">vs</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
</span><span id="Topology.vertices_in_tiles-813"><a href="#Topology.vertices_in_tiles-813"><span class="linenos">813</span></a>    <span class="k">for</span> <span class="n">tile</span> <span class="ow">in</span> <span class="n">tiles</span><span class="p">:</span>
</span><span id="Topology.vertices_in_tiles-814"><a href="#Topology.vertices_in_tiles-814"><span class="linenos">814</span></a>      <span class="n">vs</span> <span class="o">=</span> <span class="n">vs</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">tile</span><span class="o">.</span><span class="n">get_corner_IDs</span><span class="p">())</span>
</span><span id="Topology.vertices_in_tiles-815"><a href="#Topology.vertices_in_tiles-815"><span class="linenos">815</span></a>    <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">points</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">vs</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Get vertices incident on tiles in supplied list.</p>

<p>Args:
  tiles (list[Tile]): tiles whose vertices are required.</p>

<p>Returns:
  list[Vertex]: the required vertices.</p>
</div>


                            </div>
                            <div id="Topology.edges_in_tiles" class="classattr">
                                        <input id="Topology.edges_in_tiles-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">edges_in_tiles</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">tiles</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n"><a href="#Tile">Tile</a></span><span class="p">]</span></span><span class="return-annotation">) -> <span class="nb">list</span><span class="p">[</span><span class="n"><a href="#Edge">Edge</a></span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="Topology.edges_in_tiles-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Topology.edges_in_tiles"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Topology.edges_in_tiles-818"><a href="#Topology.edges_in_tiles-818"><span class="linenos">818</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">edges_in_tiles</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tiles</span><span class="p">:</span><span class="nb">list</span><span class="p">[</span><span class="n">Tile</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Edge</span><span class="p">]:</span>
</span><span id="Topology.edges_in_tiles-819"><a href="#Topology.edges_in_tiles-819"><span class="linenos">819</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get edges that are part of the boundary of tiles in supplied list.</span>
</span><span id="Topology.edges_in_tiles-820"><a href="#Topology.edges_in_tiles-820"><span class="linenos">820</span></a>
</span><span id="Topology.edges_in_tiles-821"><a href="#Topology.edges_in_tiles-821"><span class="linenos">821</span></a><span class="sd">    Args:</span>
</span><span id="Topology.edges_in_tiles-822"><a href="#Topology.edges_in_tiles-822"><span class="linenos">822</span></a><span class="sd">      tiles (list[Tile]): tiles whose edges are required.</span>
</span><span id="Topology.edges_in_tiles-823"><a href="#Topology.edges_in_tiles-823"><span class="linenos">823</span></a>
</span><span id="Topology.edges_in_tiles-824"><a href="#Topology.edges_in_tiles-824"><span class="linenos">824</span></a><span class="sd">    Returns:</span>
</span><span id="Topology.edges_in_tiles-825"><a href="#Topology.edges_in_tiles-825"><span class="linenos">825</span></a><span class="sd">      list[Edge]: the required edges.</span>
</span><span id="Topology.edges_in_tiles-826"><a href="#Topology.edges_in_tiles-826"><span class="linenos">826</span></a>
</span><span id="Topology.edges_in_tiles-827"><a href="#Topology.edges_in_tiles-827"><span class="linenos">827</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Topology.edges_in_tiles-828"><a href="#Topology.edges_in_tiles-828"><span class="linenos">828</span></a>    <span class="n">es</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
</span><span id="Topology.edges_in_tiles-829"><a href="#Topology.edges_in_tiles-829"><span class="linenos">829</span></a>    <span class="k">for</span> <span class="n">tile</span> <span class="ow">in</span> <span class="n">tiles</span><span class="p">:</span>
</span><span id="Topology.edges_in_tiles-830"><a href="#Topology.edges_in_tiles-830"><span class="linenos">830</span></a>      <span class="n">es</span> <span class="o">=</span> <span class="n">es</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">tile</span><span class="o">.</span><span class="n">get_edge_IDs</span><span class="p">())</span>
</span><span id="Topology.edges_in_tiles-831"><a href="#Topology.edges_in_tiles-831"><span class="linenos">831</span></a>    <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">e</span><span class="p">]</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">es</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Get edges that are part of the boundary of tiles in supplied list.</p>

<p>Args:
  tiles (list[Tile]): tiles whose edges are required.</p>

<p>Returns:
  list[Edge]: the required edges.</p>
</div>


                            </div>
                            <div id="Topology.generate_dual" class="classattr">
                                        <input id="Topology.generate_dual-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">generate_dual</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="nb">list</span><span class="p">[</span><span class="n">shapely</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">polygon</span><span class="o">.</span><span class="n">Polygon</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="Topology.generate_dual-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Topology.generate_dual"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Topology.generate_dual-834"><a href="#Topology.generate_dual-834"><span class="linenos">834</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">generate_dual</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">geom</span><span class="o">.</span><span class="n">Polygon</span><span class="p">]:</span>
</span><span id="Topology.generate_dual-835"><a href="#Topology.generate_dual-835"><span class="linenos">835</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Create the dual tiiing for the tiling of this Topology.</span>
</span><span id="Topology.generate_dual-836"><a href="#Topology.generate_dual-836"><span class="linenos">836</span></a>
</span><span id="Topology.generate_dual-837"><a href="#Topology.generate_dual-837"><span class="linenos">837</span></a><span class="sd">    TODO: make this a viable replacement for the existing dual tiling</span>
</span><span id="Topology.generate_dual-838"><a href="#Topology.generate_dual-838"><span class="linenos">838</span></a><span class="sd">    generation.</span>
</span><span id="Topology.generate_dual-839"><a href="#Topology.generate_dual-839"><span class="linenos">839</span></a>
</span><span id="Topology.generate_dual-840"><a href="#Topology.generate_dual-840"><span class="linenos">840</span></a><span class="sd">    TODO: also need to ensure that this finds a set of dual tiles that exhaust</span>
</span><span id="Topology.generate_dual-841"><a href="#Topology.generate_dual-841"><span class="linenos">841</span></a><span class="sd">    the plane...</span>
</span><span id="Topology.generate_dual-842"><a href="#Topology.generate_dual-842"><span class="linenos">842</span></a>
</span><span id="Topology.generate_dual-843"><a href="#Topology.generate_dual-843"><span class="linenos">843</span></a><span class="sd">    Returns:</span>
</span><span id="Topology.generate_dual-844"><a href="#Topology.generate_dual-844"><span class="linenos">844</span></a><span class="sd">      list[geom.Polygon]: a list of polygon objects.</span>
</span><span id="Topology.generate_dual-845"><a href="#Topology.generate_dual-845"><span class="linenos">845</span></a>
</span><span id="Topology.generate_dual-846"><a href="#Topology.generate_dual-846"><span class="linenos">846</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Topology.generate_dual-847"><a href="#Topology.generate_dual-847"><span class="linenos">847</span></a>    <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">points</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
</span><span id="Topology.generate_dual-848"><a href="#Topology.generate_dual-848"><span class="linenos">848</span></a>      <span class="n">v</span><span class="o">.</span><span class="n">clockwise_order_incident_tiles</span><span class="p">()</span>
</span><span id="Topology.generate_dual-849"><a href="#Topology.generate_dual-849"><span class="linenos">849</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">dual_tiles</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="Topology.generate_dual-850"><a href="#Topology.generate_dual-850"><span class="linenos">850</span></a>    <span class="n">base_id_sets</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
</span><span id="Topology.generate_dual-851"><a href="#Topology.generate_dual-851"><span class="linenos">851</span></a>    <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">points</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
</span><span id="Topology.generate_dual-852"><a href="#Topology.generate_dual-852"><span class="linenos">852</span></a>      <span class="n">base_id_sets</span><span class="p">[</span><span class="n">v</span><span class="o">.</span><span class="n">base_ID</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">ID</span><span class="p">)</span>
</span><span id="Topology.generate_dual-853"><a href="#Topology.generate_dual-853"><span class="linenos">853</span></a>    <span class="n">minimal_set</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">points</span><span class="p">[</span><span class="nb">min</span><span class="p">(</span><span class="n">s</span><span class="p">)]</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">base_id_sets</span><span class="o">.</span><span class="n">values</span><span class="p">()]</span>
</span><span id="Topology.generate_dual-854"><a href="#Topology.generate_dual-854"><span class="linenos">854</span></a>    <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">minimal_set</span><span class="p">:</span>
</span><span id="Topology.generate_dual-855"><a href="#Topology.generate_dual-855"><span class="linenos">855</span></a>    <span class="c1"># for v in self.points.values():</span>
</span><span id="Topology.generate_dual-856"><a href="#Topology.generate_dual-856"><span class="linenos">856</span></a>      <span class="k">if</span> <span class="n">v</span><span class="o">.</span><span class="n">is_interior</span><span class="p">()</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">tiles</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="Topology.generate_dual-857"><a href="#Topology.generate_dual-857"><span class="linenos">857</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">dual_tiles</span><span class="p">[</span><span class="n">v</span><span class="o">.</span><span class="n">ID</span><span class="p">]</span> <span class="o">=</span> \
</span><span id="Topology.generate_dual-858"><a href="#Topology.generate_dual-858"><span class="linenos">858</span></a>          <span class="n">geom</span><span class="o">.</span><span class="n">Polygon</span><span class="p">([</span><span class="n">t</span><span class="o">.</span><span class="n">centre</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">v</span><span class="o">.</span><span class="n">tiles</span><span class="p">])</span>
</span></pre></div>


            <div class="docstring"><p>Create the dual tiiing for the tiling of this Topology.</p>

<p>TODO: make this a viable replacement for the existing dual tiling
generation.</p>

<p>TODO: also need to ensure that this finds a set of dual tiles that exhaust
the plane...</p>

<p>Returns:
  list[geom.Polygon]: a list of polygon objects.</p>
</div>


                            </div>
                            <div id="Topology.get_dual_tiles" class="classattr">
                                        <input id="Topology.get_dual_tiles-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_dual_tiles</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="n">geopandas</span><span class="o">.</span><span class="n">geodataframe</span><span class="o">.</span><span class="n">GeoDataFrame</span>:</span></span>

                <label class="view-source-button" for="Topology.get_dual_tiles-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Topology.get_dual_tiles"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Topology.get_dual_tiles-861"><a href="#Topology.get_dual_tiles-861"><span class="linenos">861</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">get_dual_tiles</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">:</span>
</span><span id="Topology.get_dual_tiles-862"><a href="#Topology.get_dual_tiles-862"><span class="linenos">862</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return dual tiles as GeoDataFrame.&quot;&quot;&quot;</span>
</span><span id="Topology.get_dual_tiles-863"><a href="#Topology.get_dual_tiles-863"><span class="linenos">863</span></a>    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dual_tiles</span><span class="p">)</span>
</span><span id="Topology.get_dual_tiles-864"><a href="#Topology.get_dual_tiles-864"><span class="linenos">864</span></a>    <span class="k">return</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">(</span>
</span><span id="Topology.get_dual_tiles-865"><a href="#Topology.get_dual_tiles-865"><span class="linenos">865</span></a>      <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;tile_id&quot;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tileable</span><span class="o">.</span><span class="n">tiles</span><span class="o">.</span><span class="n">tile_id</span><span class="p">)[:</span><span class="n">n</span><span class="p">]},</span>
</span><span id="Topology.get_dual_tiles-866"><a href="#Topology.get_dual_tiles-866"><span class="linenos">866</span></a>      <span class="n">geometry</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoSeries</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dual_tiles</span><span class="o">.</span><span class="n">values</span><span class="p">()),</span>
</span><span id="Topology.get_dual_tiles-867"><a href="#Topology.get_dual_tiles-867"><span class="linenos">867</span></a>      <span class="n">crs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tileable</span><span class="o">.</span><span class="n">crs</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Return dual tiles as GeoDataFrame.</p>
</div>


                            </div>
                            <div id="Topology.add_vertex" class="classattr">
                                        <input id="Topology.add_vertex-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">add_vertex</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">pt</span><span class="p">:</span> <span class="n">shapely</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">point</span><span class="o">.</span><span class="n">Point</span></span><span class="return-annotation">) -> <span class="n"><a href="#Vertex">Vertex</a></span>:</span></span>

                <label class="view-source-button" for="Topology.add_vertex-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Topology.add_vertex"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Topology.add_vertex-870"><a href="#Topology.add_vertex-870"><span class="linenos">870</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">add_vertex</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pt</span><span class="p">:</span><span class="n">geom</span><span class="o">.</span><span class="n">Point</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Vertex</span><span class="p">:</span>
</span><span id="Topology.add_vertex-871"><a href="#Topology.add_vertex-871"><span class="linenos">871</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Add and return Vertex at the specified point location.</span>
</span><span id="Topology.add_vertex-872"><a href="#Topology.add_vertex-872"><span class="linenos">872</span></a>
</span><span id="Topology.add_vertex-873"><a href="#Topology.add_vertex-873"><span class="linenos">873</span></a><span class="sd">    No attempt is made to ensure Vertex IDs are an unbroken sequence: a new ID</span>
</span><span id="Topology.add_vertex-874"><a href="#Topology.add_vertex-874"><span class="linenos">874</span></a><span class="sd">    is generated one greater than the existing highest ID. IDs will usually be</span>
</span><span id="Topology.add_vertex-875"><a href="#Topology.add_vertex-875"><span class="linenos">875</span></a><span class="sd">    an unbroken sequence up to removals when geometry transformations are</span>
</span><span id="Topology.add_vertex-876"><a href="#Topology.add_vertex-876"><span class="linenos">876</span></a><span class="sd">    applied.</span>
</span><span id="Topology.add_vertex-877"><a href="#Topology.add_vertex-877"><span class="linenos">877</span></a>
</span><span id="Topology.add_vertex-878"><a href="#Topology.add_vertex-878"><span class="linenos">878</span></a><span class="sd">    Args:</span>
</span><span id="Topology.add_vertex-879"><a href="#Topology.add_vertex-879"><span class="linenos">879</span></a><span class="sd">      pt (geom.Point): point location of the Vertex.</span>
</span><span id="Topology.add_vertex-880"><a href="#Topology.add_vertex-880"><span class="linenos">880</span></a>
</span><span id="Topology.add_vertex-881"><a href="#Topology.add_vertex-881"><span class="linenos">881</span></a><span class="sd">    Returns:</span>
</span><span id="Topology.add_vertex-882"><a href="#Topology.add_vertex-882"><span class="linenos">882</span></a><span class="sd">      Vertex: the added Vertex object.</span>
</span><span id="Topology.add_vertex-883"><a href="#Topology.add_vertex-883"><span class="linenos">883</span></a>
</span><span id="Topology.add_vertex-884"><a href="#Topology.add_vertex-884"><span class="linenos">884</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Topology.add_vertex-885"><a href="#Topology.add_vertex-885"><span class="linenos">885</span></a>    <span class="n">n</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">points</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">points</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="o">+</span> <span class="mi">1</span>
</span><span id="Topology.add_vertex-886"><a href="#Topology.add_vertex-886"><span class="linenos">886</span></a>    <span class="n">v</span> <span class="o">=</span> <span class="n">Vertex</span><span class="p">(</span><span class="n">pt</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
</span><span id="Topology.add_vertex-887"><a href="#Topology.add_vertex-887"><span class="linenos">887</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">points</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>
</span><span id="Topology.add_vertex-888"><a href="#Topology.add_vertex-888"><span class="linenos">888</span></a>    <span class="k">return</span> <span class="n">v</span>
</span></pre></div>


            <div class="docstring"><p>Add and return Vertex at the specified point location.</p>

<p>No attempt is made to ensure Vertex IDs are an unbroken sequence: a new ID
is generated one greater than the existing highest ID. IDs will usually be
an unbroken sequence up to removals when geometry transformations are
applied.</p>

<p>Args:
  pt (geom.Point): point location of the Vertex.</p>

<p>Returns:
  Vertex: the added Vertex object.</p>
</div>


                            </div>
                            <div id="Topology.add_edge" class="classattr">
                                        <input id="Topology.add_edge-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">add_edge</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">vs</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n"><a href="#Vertex">Vertex</a></span><span class="p">]</span></span><span class="return-annotation">) -> <span class="n"><a href="#Edge">Edge</a></span>:</span></span>

                <label class="view-source-button" for="Topology.add_edge-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Topology.add_edge"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Topology.add_edge-891"><a href="#Topology.add_edge-891"><span class="linenos">891</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">add_edge</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vs</span><span class="p">:</span><span class="nb">list</span><span class="p">[</span><span class="n">Vertex</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Edge</span><span class="p">:</span>
</span><span id="Topology.add_edge-892"><a href="#Topology.add_edge-892"><span class="linenos">892</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Create an Edge from the suppled vertices and return it.</span>
</span><span id="Topology.add_edge-893"><a href="#Topology.add_edge-893"><span class="linenos">893</span></a>
</span><span id="Topology.add_edge-894"><a href="#Topology.add_edge-894"><span class="linenos">894</span></a><span class="sd">    The new Edge is added to the edges dictionary. Edges are self indexing by</span>
</span><span id="Topology.add_edge-895"><a href="#Topology.add_edge-895"><span class="linenos">895</span></a><span class="sd">    the IDs of their end Vertices.</span>
</span><span id="Topology.add_edge-896"><a href="#Topology.add_edge-896"><span class="linenos">896</span></a>
</span><span id="Topology.add_edge-897"><a href="#Topology.add_edge-897"><span class="linenos">897</span></a><span class="sd">    Args:</span>
</span><span id="Topology.add_edge-898"><a href="#Topology.add_edge-898"><span class="linenos">898</span></a><span class="sd">      vs (list[Vertex]): list of Vertices in the Edge to be created.</span>
</span><span id="Topology.add_edge-899"><a href="#Topology.add_edge-899"><span class="linenos">899</span></a>
</span><span id="Topology.add_edge-900"><a href="#Topology.add_edge-900"><span class="linenos">900</span></a><span class="sd">    Returns:</span>
</span><span id="Topology.add_edge-901"><a href="#Topology.add_edge-901"><span class="linenos">901</span></a><span class="sd">        Edge: the added Edge.</span>
</span><span id="Topology.add_edge-902"><a href="#Topology.add_edge-902"><span class="linenos">902</span></a>
</span><span id="Topology.add_edge-903"><a href="#Topology.add_edge-903"><span class="linenos">903</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Topology.add_edge-904"><a href="#Topology.add_edge-904"><span class="linenos">904</span></a>    <span class="n">e</span> <span class="o">=</span> <span class="n">Edge</span><span class="p">(</span><span class="n">vs</span><span class="p">)</span>
</span><span id="Topology.add_edge-905"><a href="#Topology.add_edge-905"><span class="linenos">905</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">ID</span><span class="p">]</span> <span class="o">=</span> <span class="n">e</span>
</span><span id="Topology.add_edge-906"><a href="#Topology.add_edge-906"><span class="linenos">906</span></a>    <span class="k">return</span> <span class="n">e</span>
</span></pre></div>


            <div class="docstring"><p>Create an Edge from the suppled vertices and return it.</p>

<p>The new Edge is added to the edges dictionary. Edges are self indexing by
the IDs of their end Vertices.</p>

<p>Args:
  vs (list[Vertex]): list of Vertices in the Edge to be created.</p>

<p>Returns:
    Edge: the added Edge.</p>
</div>


                            </div>
                            <div id="Topology.polygon_matches" class="classattr">
                                        <input id="Topology.polygon_matches-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">polygon_matches</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">geom1</span><span class="p">:</span> <span class="n">shapely</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">polygon</span><span class="o">.</span><span class="n">Polygon</span>,</span><span class="param">	<span class="n">geom2</span><span class="p">:</span> <span class="n">shapely</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">polygon</span><span class="o">.</span><span class="n">Polygon</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <label class="view-source-button" for="Topology.polygon_matches-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Topology.polygon_matches"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Topology.polygon_matches-909"><a href="#Topology.polygon_matches-909"><span class="linenos">909</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">polygon_matches</span><span class="p">(</span>
</span><span id="Topology.polygon_matches-910"><a href="#Topology.polygon_matches-910"><span class="linenos">910</span></a>      <span class="bp">self</span><span class="p">,</span>
</span><span id="Topology.polygon_matches-911"><a href="#Topology.polygon_matches-911"><span class="linenos">911</span></a>      <span class="n">geom1</span><span class="p">:</span><span class="n">geom</span><span class="o">.</span><span class="n">Polygon</span><span class="p">,</span>
</span><span id="Topology.polygon_matches-912"><a href="#Topology.polygon_matches-912"><span class="linenos">912</span></a>      <span class="n">geom2</span><span class="p">:</span><span class="n">geom</span><span class="o">.</span><span class="n">Polygon</span><span class="p">,</span>
</span><span id="Topology.polygon_matches-913"><a href="#Topology.polygon_matches-913"><span class="linenos">913</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="Topology.polygon_matches-914"><a href="#Topology.polygon_matches-914"><span class="linenos">914</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Test if supplied polygons match geometrically.</span>
</span><span id="Topology.polygon_matches-915"><a href="#Topology.polygon_matches-915"><span class="linenos">915</span></a>
</span><span id="Topology.polygon_matches-916"><a href="#Topology.polygon_matches-916"><span class="linenos">916</span></a><span class="sd">    Tests for equality of area, and equality of their area of overlap to their</span>
</span><span id="Topology.polygon_matches-917"><a href="#Topology.polygon_matches-917"><span class="linenos">917</span></a><span class="sd">    shared area, i.e. Area1 == Area2 == (Area 1 intersection 2).</span>
</span><span id="Topology.polygon_matches-918"><a href="#Topology.polygon_matches-918"><span class="linenos">918</span></a>
</span><span id="Topology.polygon_matches-919"><a href="#Topology.polygon_matches-919"><span class="linenos">919</span></a><span class="sd">    Args:</span>
</span><span id="Topology.polygon_matches-920"><a href="#Topology.polygon_matches-920"><span class="linenos">920</span></a><span class="sd">      geom1 (geom.Polygon): first polygon.</span>
</span><span id="Topology.polygon_matches-921"><a href="#Topology.polygon_matches-921"><span class="linenos">921</span></a><span class="sd">      geom2 (geom.Polygon): second polygon.</span>
</span><span id="Topology.polygon_matches-922"><a href="#Topology.polygon_matches-922"><span class="linenos">922</span></a>
</span><span id="Topology.polygon_matches-923"><a href="#Topology.polygon_matches-923"><span class="linenos">923</span></a><span class="sd">    Returns:</span>
</span><span id="Topology.polygon_matches-924"><a href="#Topology.polygon_matches-924"><span class="linenos">924</span></a><span class="sd">      bool: True if the polygons are the same, False otherwise.</span>
</span><span id="Topology.polygon_matches-925"><a href="#Topology.polygon_matches-925"><span class="linenos">925</span></a>
</span><span id="Topology.polygon_matches-926"><a href="#Topology.polygon_matches-926"><span class="linenos">926</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Topology.polygon_matches-927"><a href="#Topology.polygon_matches-927"><span class="linenos">927</span></a>    <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">geom1</span><span class="o">.</span><span class="n">area</span><span class="p">,</span> <span class="n">geom2</span><span class="o">.</span><span class="n">area</span>
</span><span id="Topology.polygon_matches-928"><a href="#Topology.polygon_matches-928"><span class="linenos">928</span></a>    <span class="k">return</span> <span class="nb">bool</span><span class="p">(</span>
</span><span id="Topology.polygon_matches-929"><a href="#Topology.polygon_matches-929"><span class="linenos">929</span></a>      <span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span>
</span><span id="Topology.polygon_matches-930"><a href="#Topology.polygon_matches-930"><span class="linenos">930</span></a>                 <span class="n">rtol</span> <span class="o">=</span> <span class="n">tiling_utils</span><span class="o">.</span><span class="n">RESOLUTION</span> <span class="o">*</span> <span class="mi">100</span><span class="p">,</span>
</span><span id="Topology.polygon_matches-931"><a href="#Topology.polygon_matches-931"><span class="linenos">931</span></a>                 <span class="n">atol</span> <span class="o">=</span> <span class="n">tiling_utils</span><span class="o">.</span><span class="n">RESOLUTION</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span> <span class="ow">and</span>
</span><span id="Topology.polygon_matches-932"><a href="#Topology.polygon_matches-932"><span class="linenos">932</span></a>      <span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">geom1</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">geom2</span><span class="p">)</span><span class="o">.</span><span class="n">area</span><span class="p">,</span>
</span><span id="Topology.polygon_matches-933"><a href="#Topology.polygon_matches-933"><span class="linenos">933</span></a>                 <span class="n">rtol</span> <span class="o">=</span> <span class="n">tiling_utils</span><span class="o">.</span><span class="n">RESOLUTION</span> <span class="o">*</span> <span class="mi">100</span><span class="p">,</span>
</span><span id="Topology.polygon_matches-934"><a href="#Topology.polygon_matches-934"><span class="linenos">934</span></a>                 <span class="n">atol</span> <span class="o">=</span> <span class="n">tiling_utils</span><span class="o">.</span><span class="n">RESOLUTION</span> <span class="o">*</span> <span class="mi">100</span><span class="p">))</span>
</span></pre></div>


            <div class="docstring"><p>Test if supplied polygons match geometrically.</p>

<p>Tests for equality of area, and equality of their area of overlap to their
shared area, i.e. Area1 == Area2 == (Area 1 intersection 2).</p>

<p>Args:
  geom1 (geom.Polygon): first polygon.
  geom2 (geom.Polygon): second polygon.</p>

<p>Returns:
  bool: True if the polygons are the same, False otherwise.</p>
</div>


                            </div>
                            <div id="Topology.plot" class="classattr">
                                        <input id="Topology.plot-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">plot</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">show_original_tiles</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>,</span><span class="param">	<span class="n">show_tile_centres</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">show_vertex_labels</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>,</span><span class="param">	<span class="n">show_vertex_ids</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">show_edges</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>,</span><span class="param">	<span class="n">offset_edges</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>,</span><span class="param">	<span class="n">show_edge_labels</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">show_dual_tiles</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span></span><span class="return-annotation">) -> <span class="n">matplotlib</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">_axes</span><span class="o">.</span><span class="n">Axes</span>:</span></span>

                <label class="view-source-button" for="Topology.plot-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Topology.plot"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Topology.plot-996"><a href="#Topology.plot-996"><span class="linenos"> 996</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">plot</span><span class="p">(</span>
</span><span id="Topology.plot-997"><a href="#Topology.plot-997"><span class="linenos"> 997</span></a>      <span class="bp">self</span><span class="p">,</span>
</span><span id="Topology.plot-998"><a href="#Topology.plot-998"><span class="linenos"> 998</span></a>      <span class="n">show_original_tiles</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="Topology.plot-999"><a href="#Topology.plot-999"><span class="linenos"> 999</span></a>      <span class="n">show_tile_centres</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="Topology.plot-1000"><a href="#Topology.plot-1000"><span class="linenos">1000</span></a>      <span class="n">show_vertex_labels</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="Topology.plot-1001"><a href="#Topology.plot-1001"><span class="linenos">1001</span></a>      <span class="n">show_vertex_ids</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="Topology.plot-1002"><a href="#Topology.plot-1002"><span class="linenos">1002</span></a>      <span class="n">show_edges</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="Topology.plot-1003"><a href="#Topology.plot-1003"><span class="linenos">1003</span></a>      <span class="n">offset_edges</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="Topology.plot-1004"><a href="#Topology.plot-1004"><span class="linenos">1004</span></a>      <span class="n">show_edge_labels</span><span class="p">:</span><span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="Topology.plot-1005"><a href="#Topology.plot-1005"><span class="linenos">1005</span></a>      <span class="n">show_dual_tiles</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="Topology.plot-1006"><a href="#Topology.plot-1006"><span class="linenos">1006</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">plt</span><span class="o">.</span><span class="n">Axes</span><span class="p">:</span>
</span><span id="Topology.plot-1007"><a href="#Topology.plot-1007"><span class="linenos">1007</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Delegate plotting of requested elements and return plt.Axes.</span>
</span><span id="Topology.plot-1008"><a href="#Topology.plot-1008"><span class="linenos">1008</span></a>
</span><span id="Topology.plot-1009"><a href="#Topology.plot-1009"><span class="linenos">1009</span></a><span class="sd">    Args:</span>
</span><span id="Topology.plot-1010"><a href="#Topology.plot-1010"><span class="linenos">1010</span></a><span class="sd">      show_original_tiles (bool, optional): if True show the tiles. Defaults to</span>
</span><span id="Topology.plot-1011"><a href="#Topology.plot-1011"><span class="linenos">1011</span></a><span class="sd">        True.</span>
</span><span id="Topology.plot-1012"><a href="#Topology.plot-1012"><span class="linenos">1012</span></a><span class="sd">      show_tile_centres (bool, optional): if True show tile centres with upper</span>
</span><span id="Topology.plot-1013"><a href="#Topology.plot-1013"><span class="linenos">1013</span></a><span class="sd">        case alphabetical labels. Defaults to False.</span>
</span><span id="Topology.plot-1014"><a href="#Topology.plot-1014"><span class="linenos">1014</span></a><span class="sd">      show_vertex_labels (bool, optional): if True show tiling vertices labelled</span>
</span><span id="Topology.plot-1015"><a href="#Topology.plot-1015"><span class="linenos">1015</span></a><span class="sd">        to show their equivalence classes. Defaults to True.</span>
</span><span id="Topology.plot-1016"><a href="#Topology.plot-1016"><span class="linenos">1016</span></a><span class="sd">      show_vertex_ids (bool, optional): if True show vertex IDs (i.e., sequence</span>
</span><span id="Topology.plot-1017"><a href="#Topology.plot-1017"><span class="linenos">1017</span></a><span class="sd">        numbers) which is useful for debugging. Defaults to False.</span>
</span><span id="Topology.plot-1018"><a href="#Topology.plot-1018"><span class="linenos">1018</span></a><span class="sd">      show_edges (bool, optional): if True show tiling edges (not tile sides).</span>
</span><span id="Topology.plot-1019"><a href="#Topology.plot-1019"><span class="linenos">1019</span></a><span class="sd">        Defaults to True.</span>
</span><span id="Topology.plot-1020"><a href="#Topology.plot-1020"><span class="linenos">1020</span></a><span class="sd">      offset_edges (bool, optional): if True offset edges a little from and</span>
</span><span id="Topology.plot-1021"><a href="#Topology.plot-1021"><span class="linenos">1021</span></a><span class="sd">        parallel to their geometric position. Defaults to True.</span>
</span><span id="Topology.plot-1022"><a href="#Topology.plot-1022"><span class="linenos">1022</span></a><span class="sd">      show_edge_labels (bool, optional): if true show lower case alphabetical</span>
</span><span id="Topology.plot-1023"><a href="#Topology.plot-1023"><span class="linenos">1023</span></a><span class="sd">        labels identifying edge equivalence classes. Defaults to False.</span>
</span><span id="Topology.plot-1024"><a href="#Topology.plot-1024"><span class="linenos">1024</span></a><span class="sd">      show_dual_tiles (bool, optional): if True show a candidate set of dual</span>
</span><span id="Topology.plot-1025"><a href="#Topology.plot-1025"><span class="linenos">1025</span></a><span class="sd">        tiles as an overlay. Defaults to False.</span>
</span><span id="Topology.plot-1026"><a href="#Topology.plot-1026"><span class="linenos">1026</span></a>
</span><span id="Topology.plot-1027"><a href="#Topology.plot-1027"><span class="linenos">1027</span></a><span class="sd">    Returns:</span>
</span><span id="Topology.plot-1028"><a href="#Topology.plot-1028"><span class="linenos">1028</span></a><span class="sd">      plt.Axes: a plot of the Topology as requested.</span>
</span><span id="Topology.plot-1029"><a href="#Topology.plot-1029"><span class="linenos">1029</span></a>
</span><span id="Topology.plot-1030"><a href="#Topology.plot-1030"><span class="linenos">1030</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Topology.plot-1031"><a href="#Topology.plot-1031"><span class="linenos">1031</span></a>    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
</span><span id="Topology.plot-1032"><a href="#Topology.plot-1032"><span class="linenos">1032</span></a>    <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
</span><span id="Topology.plot-1033"><a href="#Topology.plot-1033"><span class="linenos">1033</span></a>    <span class="n">extent</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoSeries</span><span class="p">([</span><span class="n">t</span><span class="o">.</span><span class="n">shape</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tiles</span><span class="p">])</span><span class="o">.</span><span class="n">total_bounds</span>
</span><span id="Topology.plot-1034"><a href="#Topology.plot-1034"><span class="linenos">1034</span></a>    <span class="n">dist</span> <span class="o">=</span> <span class="nb">max</span><span class="p">([</span><span class="n">extent</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="n">extent</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">extent</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">-</span> <span class="n">extent</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span> <span class="o">/</span> <span class="mi">100</span>
</span><span id="Topology.plot-1035"><a href="#Topology.plot-1035"><span class="linenos">1035</span></a>    <span class="k">if</span> <span class="n">show_original_tiles</span><span class="p">:</span>
</span><span id="Topology.plot-1036"><a href="#Topology.plot-1036"><span class="linenos">1036</span></a>      <span class="bp">self</span><span class="o">.</span><span class="n">_plot_tiles</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
</span><span id="Topology.plot-1037"><a href="#Topology.plot-1037"><span class="linenos">1037</span></a>    <span class="k">if</span> <span class="n">show_tile_centres</span><span class="p">:</span>
</span><span id="Topology.plot-1038"><a href="#Topology.plot-1038"><span class="linenos">1038</span></a>      <span class="bp">self</span><span class="o">.</span><span class="n">_plot_tile_centres</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
</span><span id="Topology.plot-1039"><a href="#Topology.plot-1039"><span class="linenos">1039</span></a>    <span class="k">if</span> <span class="n">show_vertex_labels</span><span class="p">:</span>
</span><span id="Topology.plot-1040"><a href="#Topology.plot-1040"><span class="linenos">1040</span></a>      <span class="bp">self</span><span class="o">.</span><span class="n">_plot_vertex_labels</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">show_vertex_ids</span><span class="p">)</span>
</span><span id="Topology.plot-1041"><a href="#Topology.plot-1041"><span class="linenos">1041</span></a>    <span class="k">if</span> <span class="n">show_edge_labels</span> <span class="ow">or</span> <span class="n">show_edges</span><span class="p">:</span>
</span><span id="Topology.plot-1042"><a href="#Topology.plot-1042"><span class="linenos">1042</span></a>      <span class="bp">self</span><span class="o">.</span><span class="n">_plot_edges</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">show_edges</span><span class="p">,</span> <span class="n">show_edge_labels</span><span class="p">,</span> <span class="n">dist</span><span class="p">,</span> <span class="n">offset_edges</span><span class="p">)</span>
</span><span id="Topology.plot-1043"><a href="#Topology.plot-1043"><span class="linenos">1043</span></a>    <span class="k">if</span> <span class="n">show_dual_tiles</span><span class="p">:</span>
</span><span id="Topology.plot-1044"><a href="#Topology.plot-1044"><span class="linenos">1044</span></a>      <span class="bp">self</span><span class="o">.</span><span class="n">_plot_dual_tiles</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">dist</span><span class="p">)</span>
</span><span id="Topology.plot-1045"><a href="#Topology.plot-1045"><span class="linenos">1045</span></a>    <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>
</span><span id="Topology.plot-1046"><a href="#Topology.plot-1046"><span class="linenos">1046</span></a>    <span class="k">return</span> <span class="n">ax</span>
</span></pre></div>


            <div class="docstring"><p>Delegate plotting of requested elements and return plt.Axes.</p>

<p>Args:
  show_original_tiles (bool, optional): if True show the tiles. Defaults to
    True.
  show_tile_centres (bool, optional): if True show tile centres with upper
    case alphabetical labels. Defaults to False.
  show_vertex_labels (bool, optional): if True show tiling vertices labelled
    to show their equivalence classes. Defaults to True.
  show_vertex_ids (bool, optional): if True show vertex IDs (i.e., sequence
    numbers) which is useful for debugging. Defaults to False.
  show_edges (bool, optional): if True show tiling edges (not tile sides).
    Defaults to True.
  offset_edges (bool, optional): if True offset edges a little from and
    parallel to their geometric position. Defaults to True.
  show_edge_labels (bool, optional): if true show lower case alphabetical
    labels identifying edge equivalence classes. Defaults to False.
  show_dual_tiles (bool, optional): if True show a candidate set of dual
    tiles as an overlay. Defaults to False.</p>

<p>Returns:
  plt.Axes: a plot of the Topology as requested.</p>
</div>


                            </div>
                            <div id="Topology.plot_tiling_symmetries" class="classattr">
                                        <input id="Topology.plot_tiling_symmetries-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">plot_tiling_symmetries</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="nb">float</span></span><span class="return-annotation">) -> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="Topology.plot_tiling_symmetries-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Topology.plot_tiling_symmetries"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Topology.plot_tiling_symmetries-1154"><a href="#Topology.plot_tiling_symmetries-1154"><span class="linenos">1154</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">plot_tiling_symmetries</span><span class="p">(</span>
</span><span id="Topology.plot_tiling_symmetries-1155"><a href="#Topology.plot_tiling_symmetries-1155"><span class="linenos">1155</span></a>      <span class="bp">self</span><span class="p">,</span>
</span><span id="Topology.plot_tiling_symmetries-1156"><a href="#Topology.plot_tiling_symmetries-1156"><span class="linenos">1156</span></a>      <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span><span class="nb">float</span><span class="p">,</span>
</span><span id="Topology.plot_tiling_symmetries-1157"><a href="#Topology.plot_tiling_symmetries-1157"><span class="linenos">1157</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Topology.plot_tiling_symmetries-1158"><a href="#Topology.plot_tiling_symmetries-1158"><span class="linenos">1158</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Plot the symmetries of Topology&#39;s tiling.</span>
</span><span id="Topology.plot_tiling_symmetries-1159"><a href="#Topology.plot_tiling_symmetries-1159"><span class="linenos">1159</span></a>
</span><span id="Topology.plot_tiling_symmetries-1160"><a href="#Topology.plot_tiling_symmetries-1160"><span class="linenos">1160</span></a><span class="sd">    Most of the work here is delegated to `_plot_tiling_symmetry` which is run</span>
</span><span id="Topology.plot_tiling_symmetries-1161"><a href="#Topology.plot_tiling_symmetries-1161"><span class="linenos">1161</span></a><span class="sd">    once per symmetry on a grid of plt.Axes built by this function.</span>
</span><span id="Topology.plot_tiling_symmetries-1162"><a href="#Topology.plot_tiling_symmetries-1162"><span class="linenos">1162</span></a>
</span><span id="Topology.plot_tiling_symmetries-1163"><a href="#Topology.plot_tiling_symmetries-1163"><span class="linenos">1163</span></a><span class="sd">    Args:</span>
</span><span id="Topology.plot_tiling_symmetries-1164"><a href="#Topology.plot_tiling_symmetries-1164"><span class="linenos">1164</span></a><span class="sd">      kwargs: passed through to `_plot_tiling_symmetry`</span>
</span><span id="Topology.plot_tiling_symmetries-1165"><a href="#Topology.plot_tiling_symmetries-1165"><span class="linenos">1165</span></a>
</span><span id="Topology.plot_tiling_symmetries-1166"><a href="#Topology.plot_tiling_symmetries-1166"><span class="linenos">1166</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Topology.plot_tiling_symmetries-1167"><a href="#Topology.plot_tiling_symmetries-1167"><span class="linenos">1167</span></a>    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tile_matching_transforms</span><span class="p">)</span>
</span><span id="Topology.plot_tiling_symmetries-1168"><a href="#Topology.plot_tiling_symmetries-1168"><span class="linenos">1168</span></a>    <span class="n">nc</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">n</span><span class="p">)))</span>
</span><span id="Topology.plot_tiling_symmetries-1169"><a href="#Topology.plot_tiling_symmetries-1169"><span class="linenos">1169</span></a>    <span class="n">nr</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">n</span> <span class="o">/</span> <span class="n">nc</span><span class="p">))</span>
</span><span id="Topology.plot_tiling_symmetries-1170"><a href="#Topology.plot_tiling_symmetries-1170"><span class="linenos">1170</span></a>    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">12</span> <span class="o">*</span> <span class="n">nr</span> <span class="o">/</span> <span class="n">nc</span><span class="p">))</span>
</span><span id="Topology.plot_tiling_symmetries-1171"><a href="#Topology.plot_tiling_symmetries-1171"><span class="linenos">1171</span></a>    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">tr</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tile_matching_transforms</span><span class="o">.</span><span class="n">values</span><span class="p">()):</span>
</span><span id="Topology.plot_tiling_symmetries-1172"><a href="#Topology.plot_tiling_symmetries-1172"><span class="linenos">1172</span></a>      <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">nr</span><span class="p">,</span> <span class="n">nc</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="Topology.plot_tiling_symmetries-1173"><a href="#Topology.plot_tiling_symmetries-1173"><span class="linenos">1173</span></a>      <span class="bp">self</span><span class="o">.</span><span class="n">_plot_tiling_symmetry</span><span class="p">(</span><span class="n">tr</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Plot the symmetries of Topology's tiling.</p>

<p>Most of the work here is delegated to <code>_plot_tiling_symmetry</code> which is run
once per symmetry on a grid of plt.Axes built by this function.</p>

<p>Args:
  kwargs: passed through to <code>_plot_tiling_symmetry</code></p>
</div>


                            </div>
                            <div id="Topology.transform_geometry" class="classattr">
                                        <input id="Topology.transform_geometry-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">transform_geometry</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">new_topology</span><span class="p">:</span> <span class="nb">bool</span>,</span><span class="param">	<span class="n">apply_to_tiles</span><span class="p">:</span> <span class="nb">bool</span>,</span><span class="param">	<span class="n">selector</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">transform_type</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="nb">float</span></span><span class="return-annotation">) -> <span class="n"><a href="#Topology">Topology</a></span>:</span></span>

                <label class="view-source-button" for="Topology.transform_geometry-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Topology.transform_geometry"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Topology.transform_geometry-1201"><a href="#Topology.transform_geometry-1201"><span class="linenos">1201</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">transform_geometry</span><span class="p">(</span>
</span><span id="Topology.transform_geometry-1202"><a href="#Topology.transform_geometry-1202"><span class="linenos">1202</span></a>      <span class="bp">self</span><span class="p">,</span>
</span><span id="Topology.transform_geometry-1203"><a href="#Topology.transform_geometry-1203"><span class="linenos">1203</span></a>      <span class="n">new_topology</span><span class="p">:</span><span class="nb">bool</span><span class="p">,</span>
</span><span id="Topology.transform_geometry-1204"><a href="#Topology.transform_geometry-1204"><span class="linenos">1204</span></a>      <span class="n">apply_to_tiles</span><span class="p">:</span><span class="nb">bool</span><span class="p">,</span>
</span><span id="Topology.transform_geometry-1205"><a href="#Topology.transform_geometry-1205"><span class="linenos">1205</span></a>      <span class="n">selector</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span>
</span><span id="Topology.transform_geometry-1206"><a href="#Topology.transform_geometry-1206"><span class="linenos">1206</span></a>      <span class="n">transform_type</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span>
</span><span id="Topology.transform_geometry-1207"><a href="#Topology.transform_geometry-1207"><span class="linenos">1207</span></a>      <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span><span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Topology</span><span class="p">:</span>
</span><span id="Topology.transform_geometry-1208"><a href="#Topology.transform_geometry-1208"><span class="linenos">1208</span></a><span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Get a new Topology by applying specified transformation.</span>
</span><span id="Topology.transform_geometry-1209"><a href="#Topology.transform_geometry-1209"><span class="linenos">1209</span></a>
</span><span id="Topology.transform_geometry-1210"><a href="#Topology.transform_geometry-1210"><span class="linenos">1210</span></a><span class="sd">    A transformation specified by `transform_type` and keyword arguments is</span>
</span><span id="Topology.transform_geometry-1211"><a href="#Topology.transform_geometry-1211"><span class="linenos">1211</span></a><span class="sd">    applied to elements in the Topology whose labels match the selector</span>
</span><span id="Topology.transform_geometry-1212"><a href="#Topology.transform_geometry-1212"><span class="linenos">1212</span></a><span class="sd">    parameter. The transform is optionally applied to update tiles and</span>
</span><span id="Topology.transform_geometry-1213"><a href="#Topology.transform_geometry-1213"><span class="linenos">1213</span></a><span class="sd">    optionally requests a new Topology object.</span>
</span><span id="Topology.transform_geometry-1214"><a href="#Topology.transform_geometry-1214"><span class="linenos">1214</span></a>
</span><span id="Topology.transform_geometry-1215"><a href="#Topology.transform_geometry-1215"><span class="linenos">1215</span></a><span class="sd">    Implemented in this way so that transformations can be applied one at a time</span>
</span><span id="Topology.transform_geometry-1216"><a href="#Topology.transform_geometry-1216"><span class="linenos">1216</span></a><span class="sd">    without creating an intermediate set of new tiles, which may be invalid and</span>
</span><span id="Topology.transform_geometry-1217"><a href="#Topology.transform_geometry-1217"><span class="linenos">1217</span></a><span class="sd">    fail. So, if you wish to apply (say) 3 transforms and generate a new</span>
</span><span id="Topology.transform_geometry-1218"><a href="#Topology.transform_geometry-1218"><span class="linenos">1218</span></a><span class="sd">    Topology leaving the existing one intact:</span>
</span><span id="Topology.transform_geometry-1219"><a href="#Topology.transform_geometry-1219"><span class="linenos">1219</span></a>
</span><span id="Topology.transform_geometry-1220"><a href="#Topology.transform_geometry-1220"><span class="linenos">1220</span></a><span class="sd">        new_topo = old_topo.transform_geometry(True,  False, &quot;a&quot;, ...) \</span>
</span><span id="Topology.transform_geometry-1221"><a href="#Topology.transform_geometry-1221"><span class="linenos">1221</span></a><span class="sd">                           .transform_geometry(False, False, &quot;B&quot;, ...) \</span>
</span><span id="Topology.transform_geometry-1222"><a href="#Topology.transform_geometry-1222"><span class="linenos">1222</span></a><span class="sd">                           .transform_geometry(False, True,  &quot;C&quot;, ...)</span>
</span><span id="Topology.transform_geometry-1223"><a href="#Topology.transform_geometry-1223"><span class="linenos">1223</span></a>
</span><span id="Topology.transform_geometry-1224"><a href="#Topology.transform_geometry-1224"><span class="linenos">1224</span></a><span class="sd">    The first transform requests a new Topology, subsequent steps do not, and it</span>
</span><span id="Topology.transform_geometry-1225"><a href="#Topology.transform_geometry-1225"><span class="linenos">1225</span></a><span class="sd">    is only the last step which attempts to create the new tile polygons.</span>
</span><span id="Topology.transform_geometry-1226"><a href="#Topology.transform_geometry-1226"><span class="linenos">1226</span></a>
</span><span id="Topology.transform_geometry-1227"><a href="#Topology.transform_geometry-1227"><span class="linenos">1227</span></a><span class="sd">    **kwargs supply named parameters for the requested transformation.</span>
</span><span id="Topology.transform_geometry-1228"><a href="#Topology.transform_geometry-1228"><span class="linenos">1228</span></a>
</span><span id="Topology.transform_geometry-1229"><a href="#Topology.transform_geometry-1229"><span class="linenos">1229</span></a><span class="sd">    Args:</span>
</span><span id="Topology.transform_geometry-1230"><a href="#Topology.transform_geometry-1230"><span class="linenos">1230</span></a><span class="sd">      new_topology (bool): if True returns a new Topology object, else returns</span>
</span><span id="Topology.transform_geometry-1231"><a href="#Topology.transform_geometry-1231"><span class="linenos">1231</span></a><span class="sd">        the current Topology modified.</span>
</span><span id="Topology.transform_geometry-1232"><a href="#Topology.transform_geometry-1232"><span class="linenos">1232</span></a><span class="sd">      apply_to_tiles (bool): if True attempts to create new Tiles after the</span>
</span><span id="Topology.transform_geometry-1233"><a href="#Topology.transform_geometry-1233"><span class="linenos">1233</span></a><span class="sd">        transformation has been applied. Usually set to False, unless the last</span>
</span><span id="Topology.transform_geometry-1234"><a href="#Topology.transform_geometry-1234"><span class="linenos">1234</span></a><span class="sd">        transformation in a pipeline, to avoid problems of topologically invalid</span>
</span><span id="Topology.transform_geometry-1235"><a href="#Topology.transform_geometry-1235"><span class="linenos">1235</span></a><span class="sd">        tiles at intermediate steps.</span>
</span><span id="Topology.transform_geometry-1236"><a href="#Topology.transform_geometry-1236"><span class="linenos">1236</span></a><span class="sd">      selector (str): label of elements to which to apply the transformation.</span>
</span><span id="Topology.transform_geometry-1237"><a href="#Topology.transform_geometry-1237"><span class="linenos">1237</span></a><span class="sd">        Note that all letters in the supplied string are checked, so you can</span>
</span><span id="Topology.transform_geometry-1238"><a href="#Topology.transform_geometry-1238"><span class="linenos">1238</span></a><span class="sd">        use e.g. &quot;abc&quot; to apply a transformation to edges labelled &quot;a&quot;, &quot;b&quot; or</span>
</span><span id="Topology.transform_geometry-1239"><a href="#Topology.transform_geometry-1239"><span class="linenos">1239</span></a><span class="sd">        &quot;c&quot;, or &quot;AB&quot; for vertices labelled &quot;A&quot; or &quot;B&quot;.</span>
</span><span id="Topology.transform_geometry-1240"><a href="#Topology.transform_geometry-1240"><span class="linenos">1240</span></a><span class="sd">      transform_type (str): name of the type of transformation requested.</span>
</span><span id="Topology.transform_geometry-1241"><a href="#Topology.transform_geometry-1241"><span class="linenos">1241</span></a><span class="sd">        Currently supported are `zigzag_edge`, `rotate_edge`, `scale_edge`,</span>
</span><span id="Topology.transform_geometry-1242"><a href="#Topology.transform_geometry-1242"><span class="linenos">1242</span></a><span class="sd">        `push_vertex`, and `nudge_vertex`. Keyword arguments for each are</span>
</span><span id="Topology.transform_geometry-1243"><a href="#Topology.transform_geometry-1243"><span class="linenos">1243</span></a><span class="sd">        documented in the corresponding methods.</span>
</span><span id="Topology.transform_geometry-1244"><a href="#Topology.transform_geometry-1244"><span class="linenos">1244</span></a><span class="sd">      kwargs: contains any needed arguments of the requested transform_type.</span>
</span><span id="Topology.transform_geometry-1245"><a href="#Topology.transform_geometry-1245"><span class="linenos">1245</span></a>
</span><span id="Topology.transform_geometry-1246"><a href="#Topology.transform_geometry-1246"><span class="linenos">1246</span></a><span class="sd">    Returns:</span>
</span><span id="Topology.transform_geometry-1247"><a href="#Topology.transform_geometry-1247"><span class="linenos">1247</span></a><span class="sd">      Topology: if new_topology is True a new Topology based on this one with</span>
</span><span id="Topology.transform_geometry-1248"><a href="#Topology.transform_geometry-1248"><span class="linenos">1248</span></a><span class="sd">        after transformation, if False this Topology is returned after the</span>
</span><span id="Topology.transform_geometry-1249"><a href="#Topology.transform_geometry-1249"><span class="linenos">1249</span></a><span class="sd">        transformation.</span>
</span><span id="Topology.transform_geometry-1250"><a href="#Topology.transform_geometry-1250"><span class="linenos">1250</span></a>
</span><span id="Topology.transform_geometry-1251"><a href="#Topology.transform_geometry-1251"><span class="linenos">1251</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Topology.transform_geometry-1252"><a href="#Topology.transform_geometry-1252"><span class="linenos">1252</span></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;CAUTION: new Topology will probably not be correctly labelled. &quot;</span>
</span><span id="Topology.transform_geometry-1253"><a href="#Topology.transform_geometry-1253"><span class="linenos">1253</span></a>          <span class="s2">&quot;To build a correct Topology, extract the tileable attribute and &quot;</span>
</span><span id="Topology.transform_geometry-1254"><a href="#Topology.transform_geometry-1254"><span class="linenos">1254</span></a>          <span class="s2">&quot;rebuild Topology from that.&quot;</span><span class="p">)</span>
</span><span id="Topology.transform_geometry-1255"><a href="#Topology.transform_geometry-1255"><span class="linenos">1255</span></a>    <span class="c1"># pickle seems to be more reliable than copy.deepcopy here</span>
</span><span id="Topology.transform_geometry-1256"><a href="#Topology.transform_geometry-1256"><span class="linenos">1256</span></a>    <span class="n">topo</span> <span class="o">=</span> <span class="p">(</span><span class="n">pickle</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">pickle</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>   <span class="c1"># noqa: S301</span>
</span><span id="Topology.transform_geometry-1257"><a href="#Topology.transform_geometry-1257"><span class="linenos">1257</span></a>            <span class="k">if</span> <span class="n">new_topology</span>
</span><span id="Topology.transform_geometry-1258"><a href="#Topology.transform_geometry-1258"><span class="linenos">1258</span></a>            <span class="k">else</span> <span class="bp">self</span><span class="p">)</span>
</span><span id="Topology.transform_geometry-1259"><a href="#Topology.transform_geometry-1259"><span class="linenos">1259</span></a>    <span class="n">transform_args</span> <span class="o">=</span> <span class="n">topo</span><span class="o">.</span><span class="n">get_kwargs</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">topo</span><span class="p">,</span> <span class="n">transform_type</span><span class="p">),</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Topology.transform_geometry-1260"><a href="#Topology.transform_geometry-1260"><span class="linenos">1260</span></a>    <span class="k">match</span> <span class="n">transform_type</span><span class="p">:</span>
</span><span id="Topology.transform_geometry-1261"><a href="#Topology.transform_geometry-1261"><span class="linenos">1261</span></a>      <span class="k">case</span> <span class="s2">&quot;zigzag_edge&quot;</span><span class="p">:</span>
</span><span id="Topology.transform_geometry-1262"><a href="#Topology.transform_geometry-1262"><span class="linenos">1262</span></a>        <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">topo</span><span class="o">.</span><span class="n">edges</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
</span><span id="Topology.transform_geometry-1263"><a href="#Topology.transform_geometry-1263"><span class="linenos">1263</span></a>          <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">label</span> <span class="ow">in</span> <span class="n">selector</span><span class="p">:</span>
</span><span id="Topology.transform_geometry-1264"><a href="#Topology.transform_geometry-1264"><span class="linenos">1264</span></a>            <span class="n">topo</span><span class="o">.</span><span class="n">zigzag_edge</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="o">**</span><span class="n">transform_args</span><span class="p">)</span>
</span><span id="Topology.transform_geometry-1265"><a href="#Topology.transform_geometry-1265"><span class="linenos">1265</span></a>      <span class="k">case</span> <span class="s2">&quot;rotate_edge&quot;</span><span class="p">:</span>
</span><span id="Topology.transform_geometry-1266"><a href="#Topology.transform_geometry-1266"><span class="linenos">1266</span></a>        <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">topo</span><span class="o">.</span><span class="n">edges</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
</span><span id="Topology.transform_geometry-1267"><a href="#Topology.transform_geometry-1267"><span class="linenos">1267</span></a>          <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">label</span> <span class="ow">in</span> <span class="n">selector</span><span class="p">:</span>
</span><span id="Topology.transform_geometry-1268"><a href="#Topology.transform_geometry-1268"><span class="linenos">1268</span></a>            <span class="n">topo</span><span class="o">.</span><span class="n">rotate_edge</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="o">**</span><span class="n">transform_args</span><span class="p">)</span>
</span><span id="Topology.transform_geometry-1269"><a href="#Topology.transform_geometry-1269"><span class="linenos">1269</span></a>      <span class="k">case</span> <span class="s2">&quot;scale_edge&quot;</span><span class="p">:</span>
</span><span id="Topology.transform_geometry-1270"><a href="#Topology.transform_geometry-1270"><span class="linenos">1270</span></a>        <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">topo</span><span class="o">.</span><span class="n">edges</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
</span><span id="Topology.transform_geometry-1271"><a href="#Topology.transform_geometry-1271"><span class="linenos">1271</span></a>          <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">label</span> <span class="ow">in</span> <span class="n">selector</span><span class="p">:</span>
</span><span id="Topology.transform_geometry-1272"><a href="#Topology.transform_geometry-1272"><span class="linenos">1272</span></a>            <span class="n">topo</span><span class="o">.</span><span class="n">scale_edge</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="o">**</span><span class="n">transform_args</span><span class="p">)</span>
</span><span id="Topology.transform_geometry-1273"><a href="#Topology.transform_geometry-1273"><span class="linenos">1273</span></a>      <span class="k">case</span> <span class="s2">&quot;push_vertex&quot;</span><span class="p">:</span>
</span><span id="Topology.transform_geometry-1274"><a href="#Topology.transform_geometry-1274"><span class="linenos">1274</span></a>        <span class="n">pushes</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="Topology.transform_geometry-1275"><a href="#Topology.transform_geometry-1275"><span class="linenos">1275</span></a>        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">topo</span><span class="o">.</span><span class="n">vertices_in_tiles</span><span class="p">(</span><span class="n">topo</span><span class="o">.</span><span class="n">tiles</span><span class="p">[:</span><span class="n">topo</span><span class="o">.</span><span class="n">n_tiles</span><span class="p">]):</span>
</span><span id="Topology.transform_geometry-1276"><a href="#Topology.transform_geometry-1276"><span class="linenos">1276</span></a>          <span class="k">if</span> <span class="n">v</span><span class="o">.</span><span class="n">label</span> <span class="ow">in</span> <span class="n">selector</span><span class="p">:</span>
</span><span id="Topology.transform_geometry-1277"><a href="#Topology.transform_geometry-1277"><span class="linenos">1277</span></a>            <span class="n">pushes</span><span class="p">[</span><span class="n">v</span><span class="o">.</span><span class="n">base_ID</span><span class="p">]</span> <span class="o">=</span> <span class="n">topo</span><span class="o">.</span><span class="n">push_vertex</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="o">**</span><span class="n">transform_args</span><span class="p">)</span>
</span><span id="Topology.transform_geometry-1278"><a href="#Topology.transform_geometry-1278"><span class="linenos">1278</span></a>        <span class="k">for</span> <span class="n">base_ID</span><span class="p">,</span> <span class="p">(</span><span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="p">)</span> <span class="ow">in</span> <span class="n">pushes</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="Topology.transform_geometry-1279"><a href="#Topology.transform_geometry-1279"><span class="linenos">1279</span></a>          <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="p">[</span><span class="n">v</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">topo</span><span class="o">.</span><span class="n">points</span><span class="o">.</span><span class="n">values</span><span class="p">()</span> <span class="k">if</span> <span class="n">v</span><span class="o">.</span><span class="n">base_ID</span> <span class="o">==</span> <span class="n">base_ID</span><span class="p">]:</span>
</span><span id="Topology.transform_geometry-1280"><a href="#Topology.transform_geometry-1280"><span class="linenos">1280</span></a>            <span class="n">v</span><span class="o">.</span><span class="n">point</span> <span class="o">=</span> <span class="n">affine</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">point</span><span class="p">,</span> <span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="p">)</span>
</span><span id="Topology.transform_geometry-1281"><a href="#Topology.transform_geometry-1281"><span class="linenos">1281</span></a>      <span class="k">case</span> <span class="s2">&quot;nudge_vertex&quot;</span><span class="p">:</span>
</span><span id="Topology.transform_geometry-1282"><a href="#Topology.transform_geometry-1282"><span class="linenos">1282</span></a>         <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">topo</span><span class="o">.</span><span class="n">points</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
</span><span id="Topology.transform_geometry-1283"><a href="#Topology.transform_geometry-1283"><span class="linenos">1283</span></a>          <span class="k">if</span> <span class="n">v</span><span class="o">.</span><span class="n">label</span> <span class="ow">in</span> <span class="n">selector</span><span class="p">:</span>
</span><span id="Topology.transform_geometry-1284"><a href="#Topology.transform_geometry-1284"><span class="linenos">1284</span></a>            <span class="n">topo</span><span class="o">.</span><span class="n">nudge_vertex</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="o">**</span><span class="n">transform_args</span><span class="p">)</span>
</span><span id="Topology.transform_geometry-1285"><a href="#Topology.transform_geometry-1285"><span class="linenos">1285</span></a>    <span class="k">if</span> <span class="n">apply_to_tiles</span><span class="p">:</span>
</span><span id="Topology.transform_geometry-1286"><a href="#Topology.transform_geometry-1286"><span class="linenos">1286</span></a>      <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">topo</span><span class="o">.</span><span class="n">tiles</span><span class="p">:</span>
</span><span id="Topology.transform_geometry-1287"><a href="#Topology.transform_geometry-1287"><span class="linenos">1287</span></a>        <span class="n">t</span><span class="o">.</span><span class="n">set_corners_from_edges</span><span class="p">()</span>
</span><span id="Topology.transform_geometry-1288"><a href="#Topology.transform_geometry-1288"><span class="linenos">1288</span></a>    <span class="n">topo</span><span class="o">.</span><span class="n">tileable</span><span class="o">.</span><span class="n">tiles</span><span class="o">.</span><span class="n">geometry</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoSeries</span><span class="p">(</span>
</span><span id="Topology.transform_geometry-1289"><a href="#Topology.transform_geometry-1289"><span class="linenos">1289</span></a>      <span class="p">[</span><span class="n">topo</span><span class="o">.</span><span class="n">tiles</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">topo</span><span class="o">.</span><span class="n">n_tiles</span><span class="p">)])</span>
</span><span id="Topology.transform_geometry-1290"><a href="#Topology.transform_geometry-1290"><span class="linenos">1290</span></a>    <span class="n">topo</span><span class="o">.</span><span class="n">tileable</span><span class="o">.</span><span class="n">_setup_regularised_prototile</span><span class="p">()</span>
</span><span id="Topology.transform_geometry-1291"><a href="#Topology.transform_geometry-1291"><span class="linenos">1291</span></a>    <span class="k">return</span> <span class="n">topo</span>
</span></pre></div>


            <div class="docstring"><p>Get a new Topology by applying specified transformation.</p>

<p>A transformation specified by <code>transform_type</code> and keyword arguments is
applied to elements in the Topology whose labels match the selector
parameter. The transform is optionally applied to update tiles and
optionally requests a new Topology object.</p>

<p>Implemented in this way so that transformations can be applied one at a time
without creating an intermediate set of new tiles, which may be invalid and
fail. So, if you wish to apply (say) 3 transforms and generate a new
Topology leaving the existing one intact:</p>

<pre><code>new_topo = old_topo.transform_geometry(True,  False, "a", ...) \
                   .transform_geometry(False, False, "B", ...) \
                   .transform_geometry(False, True,  "C", ...)
</code></pre>

<p>The first transform requests a new Topology, subsequent steps do not, and it
is only the last step which attempts to create the new tile polygons.</p>

<p>**kwargs supply named parameters for the requested transformation.</p>

<p>Args:
  new_topology (bool): if True returns a new Topology object, else returns
    the current Topology modified.
  apply_to_tiles (bool): if True attempts to create new Tiles after the
    transformation has been applied. Usually set to False, unless the last
    transformation in a pipeline, to avoid problems of topologically invalid
    tiles at intermediate steps.
  selector (str): label of elements to which to apply the transformation.
    Note that all letters in the supplied string are checked, so you can
    use e.g. "abc" to apply a transformation to edges labelled "a", "b" or
    "c", or "AB" for vertices labelled "A" or "B".
  transform_type (str): name of the type of transformation requested.
    Currently supported are <code><a href="#Topology.zigzag_edge">zigzag_edge</a></code>, <code><a href="#Topology.rotate_edge">rotate_edge</a></code>, <code><a href="#Topology.scale_edge">scale_edge</a></code>,
    <code><a href="#Topology.push_vertex">push_vertex</a></code>, and <code><a href="#Topology.nudge_vertex">nudge_vertex</a></code>. Keyword arguments for each are
    documented in the corresponding methods.
  kwargs: contains any needed arguments of the requested transform_type.</p>

<p>Returns:
  Topology: if new_topology is True a new Topology based on this one with
    after transformation, if False this Topology is returned after the
    transformation.</p>
</div>


                            </div>
                            <div id="Topology.get_kwargs" class="classattr">
                                        <input id="Topology.get_kwargs-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_kwargs</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">fn</span><span class="p">:</span> <span class="n">Callable</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">float</span></span><span class="return-annotation">) -> <span class="nb">dict</span>:</span></span>

                <label class="view-source-button" for="Topology.get_kwargs-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Topology.get_kwargs"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Topology.get_kwargs-1294"><a href="#Topology.get_kwargs-1294"><span class="linenos">1294</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">get_kwargs</span><span class="p">(</span>
</span><span id="Topology.get_kwargs-1295"><a href="#Topology.get_kwargs-1295"><span class="linenos">1295</span></a>      <span class="bp">self</span><span class="p">,</span>
</span><span id="Topology.get_kwargs-1296"><a href="#Topology.get_kwargs-1296"><span class="linenos">1296</span></a>      <span class="n">fn</span><span class="p">:</span><span class="n">Callable</span><span class="p">,</span>
</span><span id="Topology.get_kwargs-1297"><a href="#Topology.get_kwargs-1297"><span class="linenos">1297</span></a>      <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span><span class="nb">str</span><span class="o">|</span><span class="nb">float</span><span class="p">,</span>
</span><span id="Topology.get_kwargs-1298"><a href="#Topology.get_kwargs-1298"><span class="linenos">1298</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
</span><span id="Topology.get_kwargs-1299"><a href="#Topology.get_kwargs-1299"><span class="linenos">1299</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Filter the supplied kwargs to only contain arguments required by fn.</span>
</span><span id="Topology.get_kwargs-1300"><a href="#Topology.get_kwargs-1300"><span class="linenos">1300</span></a>
</span><span id="Topology.get_kwargs-1301"><a href="#Topology.get_kwargs-1301"><span class="linenos">1301</span></a><span class="sd">    Args:</span>
</span><span id="Topology.get_kwargs-1302"><a href="#Topology.get_kwargs-1302"><span class="linenos">1302</span></a><span class="sd">      fn (Callable): the function that is to be inspected.</span>
</span><span id="Topology.get_kwargs-1303"><a href="#Topology.get_kwargs-1303"><span class="linenos">1303</span></a><span class="sd">      **kwargs (str|float): kwargs to be filtered.</span>
</span><span id="Topology.get_kwargs-1304"><a href="#Topology.get_kwargs-1304"><span class="linenos">1304</span></a>
</span><span id="Topology.get_kwargs-1305"><a href="#Topology.get_kwargs-1305"><span class="linenos">1305</span></a><span class="sd">    Returns:</span>
</span><span id="Topology.get_kwargs-1306"><a href="#Topology.get_kwargs-1306"><span class="linenos">1306</span></a><span class="sd">      str|float: filtered dictionary of kwargs.</span>
</span><span id="Topology.get_kwargs-1307"><a href="#Topology.get_kwargs-1307"><span class="linenos">1307</span></a>
</span><span id="Topology.get_kwargs-1308"><a href="#Topology.get_kwargs-1308"><span class="linenos">1308</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Topology.get_kwargs-1309"><a href="#Topology.get_kwargs-1309"><span class="linenos">1309</span></a>    <span class="n">args</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">signature</span><span class="p">(</span><span class="n">fn</span><span class="p">)</span><span class="o">.</span><span class="n">parameters</span>
</span><span id="Topology.get_kwargs-1310"><a href="#Topology.get_kwargs-1310"><span class="linenos">1310</span></a>    <span class="k">return</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">dict</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span> <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">args</span><span class="p">}</span>
</span></pre></div>


            <div class="docstring"><p>Filter the supplied kwargs to only contain arguments required by fn.</p>

<p>Args:
  fn (Callable): the function that is to be inspected.
  **kwargs (str|float): kwargs to be filtered.</p>

<p>Returns:
  str|float: filtered dictionary of kwargs.</p>
</div>


                            </div>
                            <div id="Topology.zigzag_edge" class="classattr">
                                        <input id="Topology.zigzag_edge-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">zigzag_edge</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">edge</span><span class="p">:</span> <span class="n"><a href="#Edge">Edge</a></span>,</span><span class="param">	<span class="n">start</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;A&#39;</span>,</span><span class="param">	<span class="n">n</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span>,</span><span class="param">	<span class="n">h</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.5</span>,</span><span class="param">	<span class="n">smoothness</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span></span><span class="return-annotation">) -> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="Topology.zigzag_edge-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Topology.zigzag_edge"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Topology.zigzag_edge-1313"><a href="#Topology.zigzag_edge-1313"><span class="linenos">1313</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">zigzag_edge</span><span class="p">(</span>
</span><span id="Topology.zigzag_edge-1314"><a href="#Topology.zigzag_edge-1314"><span class="linenos">1314</span></a>      <span class="bp">self</span><span class="p">,</span>
</span><span id="Topology.zigzag_edge-1315"><a href="#Topology.zigzag_edge-1315"><span class="linenos">1315</span></a>      <span class="n">edge</span><span class="p">:</span><span class="n">Edge</span><span class="p">,</span>
</span><span id="Topology.zigzag_edge-1316"><a href="#Topology.zigzag_edge-1316"><span class="linenos">1316</span></a>      <span class="n">start</span><span class="p">:</span><span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;A&quot;</span><span class="p">,</span>
</span><span id="Topology.zigzag_edge-1317"><a href="#Topology.zigzag_edge-1317"><span class="linenos">1317</span></a>      <span class="n">n</span><span class="p">:</span><span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
</span><span id="Topology.zigzag_edge-1318"><a href="#Topology.zigzag_edge-1318"><span class="linenos">1318</span></a>      <span class="n">h</span><span class="p">:</span><span class="nb">float</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span>
</span><span id="Topology.zigzag_edge-1319"><a href="#Topology.zigzag_edge-1319"><span class="linenos">1319</span></a>      <span class="n">smoothness</span><span class="p">:</span><span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
</span><span id="Topology.zigzag_edge-1320"><a href="#Topology.zigzag_edge-1320"><span class="linenos">1320</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Topology.zigzag_edge-1321"><a href="#Topology.zigzag_edge-1321"><span class="linenos">1321</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Apply zigzag transformation to supplied Edge.</span>
</span><span id="Topology.zigzag_edge-1322"><a href="#Topology.zigzag_edge-1322"><span class="linenos">1322</span></a>
</span><span id="Topology.zigzag_edge-1323"><a href="#Topology.zigzag_edge-1323"><span class="linenos">1323</span></a><span class="sd">    Currently this will only work correctly if h is even.</span>
</span><span id="Topology.zigzag_edge-1324"><a href="#Topology.zigzag_edge-1324"><span class="linenos">1324</span></a>
</span><span id="Topology.zigzag_edge-1325"><a href="#Topology.zigzag_edge-1325"><span class="linenos">1325</span></a><span class="sd">    TODO: make it possible for odd numbers of &#39;peaks&#39; to work (this may require</span>
</span><span id="Topology.zigzag_edge-1326"><a href="#Topology.zigzag_edge-1326"><span class="linenos">1326</span></a><span class="sd">    allowing bidirectional Edges, i.e. storing Edges in both directions so that</span>
</span><span id="Topology.zigzag_edge-1327"><a href="#Topology.zigzag_edge-1327"><span class="linenos">1327</span></a><span class="sd">    all Tile edges are drawn CW). The `start` parameter is a temporary hack for</span>
</span><span id="Topology.zigzag_edge-1328"><a href="#Topology.zigzag_edge-1328"><span class="linenos">1328</span></a><span class="sd">    this.</span>
</span><span id="Topology.zigzag_edge-1329"><a href="#Topology.zigzag_edge-1329"><span class="linenos">1329</span></a>
</span><span id="Topology.zigzag_edge-1330"><a href="#Topology.zigzag_edge-1330"><span class="linenos">1330</span></a><span class="sd">    Args:</span>
</span><span id="Topology.zigzag_edge-1331"><a href="#Topology.zigzag_edge-1331"><span class="linenos">1331</span></a><span class="sd">      edge (Edge): Edge to transform</span>
</span><span id="Topology.zigzag_edge-1332"><a href="#Topology.zigzag_edge-1332"><span class="linenos">1332</span></a><span class="sd">      start (str, optional): label at one end of edge which is used to determine</span>
</span><span id="Topology.zigzag_edge-1333"><a href="#Topology.zigzag_edge-1333"><span class="linenos">1333</span></a><span class="sd">        the sense of h, enabling C-curves with an odd number n of zigs and zags</span>
</span><span id="Topology.zigzag_edge-1334"><a href="#Topology.zigzag_edge-1334"><span class="linenos">1334</span></a><span class="sd">        to be applied. Defaults to &#39;A&#39;.</span>
</span><span id="Topology.zigzag_edge-1335"><a href="#Topology.zigzag_edge-1335"><span class="linenos">1335</span></a><span class="sd">      n (int, optional): number of zigs and zags in the edge. Defaults to 2.</span>
</span><span id="Topology.zigzag_edge-1336"><a href="#Topology.zigzag_edge-1336"><span class="linenos">1336</span></a><span class="sd">      h (float, optional): width of the zig zags relative to edge length.</span>
</span><span id="Topology.zigzag_edge-1337"><a href="#Topology.zigzag_edge-1337"><span class="linenos">1337</span></a><span class="sd">        Defaults to 0.5.</span>
</span><span id="Topology.zigzag_edge-1338"><a href="#Topology.zigzag_edge-1338"><span class="linenos">1338</span></a><span class="sd">      smoothness (int, optional): spline smoothness. 0 gives a zig zag proper,</span>
</span><span id="Topology.zigzag_edge-1339"><a href="#Topology.zigzag_edge-1339"><span class="linenos">1339</span></a><span class="sd">        higher values will produce a sinusoid. Defaults to 0.</span>
</span><span id="Topology.zigzag_edge-1340"><a href="#Topology.zigzag_edge-1340"><span class="linenos">1340</span></a>
</span><span id="Topology.zigzag_edge-1341"><a href="#Topology.zigzag_edge-1341"><span class="linenos">1341</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Topology.zigzag_edge-1342"><a href="#Topology.zigzag_edge-1342"><span class="linenos">1342</span></a>    <span class="n">v0</span><span class="p">,</span> <span class="n">v1</span> <span class="o">=</span> <span class="n">edge</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">edge</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="Topology.zigzag_edge-1343"><a href="#Topology.zigzag_edge-1343"><span class="linenos">1343</span></a>    <span class="k">if</span> <span class="n">n</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">v0</span><span class="o">.</span><span class="n">label</span> <span class="o">!=</span> <span class="n">start</span><span class="p">:</span>
</span><span id="Topology.zigzag_edge-1344"><a href="#Topology.zigzag_edge-1344"><span class="linenos">1344</span></a>      <span class="n">h</span> <span class="o">=</span> <span class="o">-</span><span class="n">h</span>
</span><span id="Topology.zigzag_edge-1345"><a href="#Topology.zigzag_edge-1345"><span class="linenos">1345</span></a>    <span class="n">ls</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">zigzag_between_points</span><span class="p">(</span><span class="n">v0</span><span class="o">.</span><span class="n">point</span><span class="p">,</span> <span class="n">v1</span><span class="o">.</span><span class="n">point</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">smoothness</span><span class="p">)</span>
</span><span id="Topology.zigzag_edge-1346"><a href="#Topology.zigzag_edge-1346"><span class="linenos">1346</span></a>    <span class="c1"># remove current corners</span>
</span><span id="Topology.zigzag_edge-1347"><a href="#Topology.zigzag_edge-1347"><span class="linenos">1347</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">points</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">points</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
</span><span id="Topology.zigzag_edge-1348"><a href="#Topology.zigzag_edge-1348"><span class="linenos">1348</span></a>                   <span class="k">if</span> <span class="n">k</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">edge</span><span class="o">.</span><span class="n">get_corner_IDs</span><span class="p">()[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]}</span>
</span><span id="Topology.zigzag_edge-1349"><a href="#Topology.zigzag_edge-1349"><span class="linenos">1349</span></a>    <span class="c1"># add the new ones</span>
</span><span id="Topology.zigzag_edge-1350"><a href="#Topology.zigzag_edge-1350"><span class="linenos">1350</span></a>    <span class="n">new_corners</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">add_vertex</span><span class="p">(</span><span class="n">geom</span><span class="o">.</span><span class="n">Point</span><span class="p">(</span><span class="n">xy</span><span class="p">))</span> <span class="k">for</span> <span class="n">xy</span> <span class="ow">in</span> <span class="n">ls</span><span class="o">.</span><span class="n">coords</span><span class="p">]</span>
</span><span id="Topology.zigzag_edge-1351"><a href="#Topology.zigzag_edge-1351"><span class="linenos">1351</span></a>    <span class="n">edge</span><span class="o">.</span><span class="n">corners</span> <span class="o">=</span> <span class="n">edge</span><span class="o">.</span><span class="n">vertices</span><span class="p">[:</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">new_corners</span> <span class="o">+</span> <span class="n">edge</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">:]</span>
</span><span id="Topology.zigzag_edge-1352"><a href="#Topology.zigzag_edge-1352"><span class="linenos">1352</span></a>    <span class="k">if</span> <span class="n">edge</span><span class="o">.</span><span class="n">right_tile</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Topology.zigzag_edge-1353"><a href="#Topology.zigzag_edge-1353"><span class="linenos">1353</span></a>      <span class="n">edge</span><span class="o">.</span><span class="n">right_tile</span><span class="o">.</span><span class="n">set_corners_from_edges</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
</span><span id="Topology.zigzag_edge-1354"><a href="#Topology.zigzag_edge-1354"><span class="linenos">1354</span></a>    <span class="k">if</span> <span class="n">edge</span><span class="o">.</span><span class="n">left_tile</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Topology.zigzag_edge-1355"><a href="#Topology.zigzag_edge-1355"><span class="linenos">1355</span></a>      <span class="n">edge</span><span class="o">.</span><span class="n">left_tile</span><span class="o">.</span><span class="n">set_corners_from_edges</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Apply zigzag transformation to supplied Edge.</p>

<p>Currently this will only work correctly if h is even.</p>

<p>TODO: make it possible for odd numbers of 'peaks' to work (this may require
allowing bidirectional Edges, i.e. storing Edges in both directions so that
all Tile edges are drawn CW). The <code>start</code> parameter is a temporary hack for
this.</p>

<p>Args:
  edge (Edge): Edge to transform
  start (str, optional): label at one end of edge which is used to determine
    the sense of h, enabling C-curves with an odd number n of zigs and zags
    to be applied. Defaults to 'A'.
  n (int, optional): number of zigs and zags in the edge. Defaults to 2.
  h (float, optional): width of the zig zags relative to edge length.
    Defaults to 0.5.
  smoothness (int, optional): spline smoothness. 0 gives a zig zag proper,
    higher values will produce a sinusoid. Defaults to 0.</p>
</div>


                            </div>
                            <div id="Topology.zigzag_between_points" class="classattr">
                                        <input id="Topology.zigzag_between_points-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">zigzag_between_points</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">p0</span><span class="p">:</span> <span class="n">shapely</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">point</span><span class="o">.</span><span class="n">Point</span>,</span><span class="param">	<span class="n">p1</span><span class="p">:</span> <span class="n">shapely</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">point</span><span class="o">.</span><span class="n">Point</span>,</span><span class="param">	<span class="n">n</span><span class="p">:</span> <span class="nb">int</span>,</span><span class="param">	<span class="n">h</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span>,</span><span class="param">	<span class="n">smoothness</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span></span><span class="return-annotation">) -> <span class="n">shapely</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">linestring</span><span class="o">.</span><span class="n">LineString</span>:</span></span>

                <label class="view-source-button" for="Topology.zigzag_between_points-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Topology.zigzag_between_points"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Topology.zigzag_between_points-1358"><a href="#Topology.zigzag_between_points-1358"><span class="linenos">1358</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">zigzag_between_points</span><span class="p">(</span>
</span><span id="Topology.zigzag_between_points-1359"><a href="#Topology.zigzag_between_points-1359"><span class="linenos">1359</span></a>      <span class="bp">self</span><span class="p">,</span>
</span><span id="Topology.zigzag_between_points-1360"><a href="#Topology.zigzag_between_points-1360"><span class="linenos">1360</span></a>      <span class="n">p0</span><span class="p">:</span><span class="n">geom</span><span class="o">.</span><span class="n">Point</span><span class="p">,</span>
</span><span id="Topology.zigzag_between_points-1361"><a href="#Topology.zigzag_between_points-1361"><span class="linenos">1361</span></a>      <span class="n">p1</span><span class="p">:</span><span class="n">geom</span><span class="o">.</span><span class="n">Point</span><span class="p">,</span>
</span><span id="Topology.zigzag_between_points-1362"><a href="#Topology.zigzag_between_points-1362"><span class="linenos">1362</span></a>      <span class="n">n</span><span class="p">:</span><span class="nb">int</span><span class="p">,</span>
</span><span id="Topology.zigzag_between_points-1363"><a href="#Topology.zigzag_between_points-1363"><span class="linenos">1363</span></a>      <span class="n">h</span><span class="p">:</span><span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
</span><span id="Topology.zigzag_between_points-1364"><a href="#Topology.zigzag_between_points-1364"><span class="linenos">1364</span></a>      <span class="n">smoothness</span><span class="p">:</span><span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
</span><span id="Topology.zigzag_between_points-1365"><a href="#Topology.zigzag_between_points-1365"><span class="linenos">1365</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">geom</span><span class="o">.</span><span class="n">LineString</span><span class="p">:</span>
</span><span id="Topology.zigzag_between_points-1366"><a href="#Topology.zigzag_between_points-1366"><span class="linenos">1366</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return a zig zag line optionally smoothed as a spline between two points.</span>
</span><span id="Topology.zigzag_between_points-1367"><a href="#Topology.zigzag_between_points-1367"><span class="linenos">1367</span></a>
</span><span id="Topology.zigzag_between_points-1368"><a href="#Topology.zigzag_between_points-1368"><span class="linenos">1368</span></a><span class="sd">    Args:</span>
</span><span id="Topology.zigzag_between_points-1369"><a href="#Topology.zigzag_between_points-1369"><span class="linenos">1369</span></a><span class="sd">      p0 (geom.Point): start point.</span>
</span><span id="Topology.zigzag_between_points-1370"><a href="#Topology.zigzag_between_points-1370"><span class="linenos">1370</span></a><span class="sd">      p1 (geom.Point): end point.</span>
</span><span id="Topology.zigzag_between_points-1371"><a href="#Topology.zigzag_between_points-1371"><span class="linenos">1371</span></a><span class="sd">      n (int): number of zig zags.</span>
</span><span id="Topology.zigzag_between_points-1372"><a href="#Topology.zigzag_between_points-1372"><span class="linenos">1372</span></a><span class="sd">      h (float, optional): amplitude of zig zags relative to distance between</span>
</span><span id="Topology.zigzag_between_points-1373"><a href="#Topology.zigzag_between_points-1373"><span class="linenos">1373</span></a><span class="sd">        points. Defaults to 1.0.</span>
</span><span id="Topology.zigzag_between_points-1374"><a href="#Topology.zigzag_between_points-1374"><span class="linenos">1374</span></a><span class="sd">      smoothness (int, optional): number of spline smoothed points to add. If</span>
</span><span id="Topology.zigzag_between_points-1375"><a href="#Topology.zigzag_between_points-1375"><span class="linenos">1375</span></a><span class="sd">        set to 0 a straight line zig zag is produced. Defaults to 0.</span>
</span><span id="Topology.zigzag_between_points-1376"><a href="#Topology.zigzag_between_points-1376"><span class="linenos">1376</span></a>
</span><span id="Topology.zigzag_between_points-1377"><a href="#Topology.zigzag_between_points-1377"><span class="linenos">1377</span></a><span class="sd">    Returns:</span>
</span><span id="Topology.zigzag_between_points-1378"><a href="#Topology.zigzag_between_points-1378"><span class="linenos">1378</span></a><span class="sd">      geom.LineString: the resulting zig zag line.</span>
</span><span id="Topology.zigzag_between_points-1379"><a href="#Topology.zigzag_between_points-1379"><span class="linenos">1379</span></a>
</span><span id="Topology.zigzag_between_points-1380"><a href="#Topology.zigzag_between_points-1380"><span class="linenos">1380</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Topology.zigzag_between_points-1381"><a href="#Topology.zigzag_between_points-1381"><span class="linenos">1381</span></a>    <span class="n">r</span> <span class="o">=</span> <span class="n">p0</span><span class="o">.</span><span class="n">distance</span><span class="p">(</span><span class="n">p1</span><span class="p">)</span>
</span><span id="Topology.zigzag_between_points-1382"><a href="#Topology.zigzag_between_points-1382"><span class="linenos">1382</span></a>    <span class="c1"># make a sinusoidal template</span>
</span><span id="Topology.zigzag_between_points-1383"><a href="#Topology.zigzag_between_points-1383"><span class="linenos">1383</span></a>    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">n</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">endpoint</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</span><span id="Topology.zigzag_between_points-1384"><a href="#Topology.zigzag_between_points-1384"><span class="linenos">1384</span></a>    <span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">x</span><span class="p">]</span>
</span><span id="Topology.zigzag_between_points-1385"><a href="#Topology.zigzag_between_points-1385"><span class="linenos">1385</span></a>    <span class="n">spline</span> <span class="o">=</span> <span class="n">interpolate</span><span class="o">.</span><span class="n">InterpolatedUnivariateSpline</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="Topology.zigzag_between_points-1386"><a href="#Topology.zigzag_between_points-1386"><span class="linenos">1386</span></a>
</span><span id="Topology.zigzag_between_points-1387"><a href="#Topology.zigzag_between_points-1387"><span class="linenos">1387</span></a>    <span class="n">spline_steps</span> <span class="o">=</span> <span class="p">(</span><span class="n">n</span> <span class="o">+</span> <span class="n">smoothness</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span>
</span><span id="Topology.zigzag_between_points-1388"><a href="#Topology.zigzag_between_points-1388"><span class="linenos">1388</span></a>    <span class="n">xs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">spline_steps</span><span class="p">,</span> <span class="n">endpoint</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</span><span id="Topology.zigzag_between_points-1389"><a href="#Topology.zigzag_between_points-1389"><span class="linenos">1389</span></a>    <span class="n">ys</span> <span class="o">=</span> <span class="n">spline</span><span class="p">(</span><span class="n">xs</span><span class="p">)</span>
</span><span id="Topology.zigzag_between_points-1390"><a href="#Topology.zigzag_between_points-1390"><span class="linenos">1390</span></a>
</span><span id="Topology.zigzag_between_points-1391"><a href="#Topology.zigzag_between_points-1391"><span class="linenos">1391</span></a>    <span class="n">sfx</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="nb">max</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">*</span> <span class="n">r</span>
</span><span id="Topology.zigzag_between_points-1392"><a href="#Topology.zigzag_between_points-1392"><span class="linenos">1392</span></a>    <span class="n">sfy</span> <span class="o">=</span> <span class="n">h</span> <span class="o">*</span> <span class="n">r</span> <span class="o">/</span> <span class="mi">2</span>
</span><span id="Topology.zigzag_between_points-1393"><a href="#Topology.zigzag_between_points-1393"><span class="linenos">1393</span></a>    <span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arctan2</span><span class="p">(</span><span class="n">p1</span><span class="o">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">p0</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">p1</span><span class="o">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">p0</span><span class="o">.</span><span class="n">x</span><span class="p">)</span>
</span><span id="Topology.zigzag_between_points-1394"><a href="#Topology.zigzag_between_points-1394"><span class="linenos">1394</span></a>
</span><span id="Topology.zigzag_between_points-1395"><a href="#Topology.zigzag_between_points-1395"><span class="linenos">1395</span></a>    <span class="n">ls</span> <span class="o">=</span> <span class="n">geom</span><span class="o">.</span><span class="n">LineString</span><span class="p">(</span>
</span><span id="Topology.zigzag_between_points-1396"><a href="#Topology.zigzag_between_points-1396"><span class="linenos">1396</span></a>      <span class="p">[</span><span class="n">geom</span><span class="o">.</span><span class="n">Point</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">ys</span><span class="p">,</span> <span class="n">strict</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)])</span>
</span><span id="Topology.zigzag_between_points-1397"><a href="#Topology.zigzag_between_points-1397"><span class="linenos">1397</span></a>    <span class="n">ls</span> <span class="o">=</span> <span class="n">affine</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="n">ls</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="p">(</span><span class="n">ls</span><span class="o">.</span><span class="n">bounds</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">ls</span><span class="o">.</span><span class="n">bounds</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="Topology.zigzag_between_points-1398"><a href="#Topology.zigzag_between_points-1398"><span class="linenos">1398</span></a>    <span class="n">ls</span> <span class="o">=</span> <span class="n">affine</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">ls</span><span class="p">,</span> <span class="n">xfact</span> <span class="o">=</span> <span class="n">sfx</span><span class="p">,</span> <span class="n">yfact</span> <span class="o">=</span> <span class="n">sfy</span><span class="p">,</span> <span class="n">origin</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
</span><span id="Topology.zigzag_between_points-1399"><a href="#Topology.zigzag_between_points-1399"><span class="linenos">1399</span></a>    <span class="n">ls</span> <span class="o">=</span> <span class="n">affine</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span><span class="n">ls</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">use_radians</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</span><span id="Topology.zigzag_between_points-1400"><a href="#Topology.zigzag_between_points-1400"><span class="linenos">1400</span></a>    <span class="n">x0</span><span class="p">,</span> <span class="n">y0</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">ls</span><span class="o">.</span><span class="n">coords</span><span class="p">))</span>
</span><span id="Topology.zigzag_between_points-1401"><a href="#Topology.zigzag_between_points-1401"><span class="linenos">1401</span></a>    <span class="k">return</span> <span class="n">affine</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="n">ls</span><span class="p">,</span> <span class="n">p0</span><span class="o">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">x0</span><span class="p">,</span> <span class="n">p0</span><span class="o">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">y0</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Return a zig zag line optionally smoothed as a spline between two points.</p>

<p>Args:
  p0 (geom.Point): start point.
  p1 (geom.Point): end point.
  n (int): number of zig zags.
  h (float, optional): amplitude of zig zags relative to distance between
    points. Defaults to 1.0.
  smoothness (int, optional): number of spline smoothed points to add. If
    set to 0 a straight line zig zag is produced. Defaults to 0.</p>

<p>Returns:
  geom.LineString: the resulting zig zag line.</p>
</div>


                            </div>
                            <div id="Topology.rotate_edge" class="classattr">
                                        <input id="Topology.rotate_edge-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">rotate_edge</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">edge</span><span class="p">:</span> <span class="n"><a href="#Edge">Edge</a></span>,</span><span class="param">	<span class="n">centre</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>,</span><span class="param">	<span class="n">angle</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span></span><span class="return-annotation">) -> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="Topology.rotate_edge-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Topology.rotate_edge"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Topology.rotate_edge-1404"><a href="#Topology.rotate_edge-1404"><span class="linenos">1404</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">rotate_edge</span><span class="p">(</span>
</span><span id="Topology.rotate_edge-1405"><a href="#Topology.rotate_edge-1405"><span class="linenos">1405</span></a>      <span class="bp">self</span><span class="p">,</span>
</span><span id="Topology.rotate_edge-1406"><a href="#Topology.rotate_edge-1406"><span class="linenos">1406</span></a>      <span class="n">edge</span><span class="p">:</span><span class="n">Edge</span><span class="p">,</span>
</span><span id="Topology.rotate_edge-1407"><a href="#Topology.rotate_edge-1407"><span class="linenos">1407</span></a>      <span class="n">centre</span><span class="p">:</span><span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="Topology.rotate_edge-1408"><a href="#Topology.rotate_edge-1408"><span class="linenos">1408</span></a>      <span class="n">angle</span><span class="p">:</span><span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
</span><span id="Topology.rotate_edge-1409"><a href="#Topology.rotate_edge-1409"><span class="linenos">1409</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Topology.rotate_edge-1410"><a href="#Topology.rotate_edge-1410"><span class="linenos">1410</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Rotate edge.</span>
</span><span id="Topology.rotate_edge-1411"><a href="#Topology.rotate_edge-1411"><span class="linenos">1411</span></a>
</span><span id="Topology.rotate_edge-1412"><a href="#Topology.rotate_edge-1412"><span class="linenos">1412</span></a><span class="sd">    Args:</span>
</span><span id="Topology.rotate_edge-1413"><a href="#Topology.rotate_edge-1413"><span class="linenos">1413</span></a><span class="sd">      edge (Edge): the edge to rotate.</span>
</span><span id="Topology.rotate_edge-1414"><a href="#Topology.rotate_edge-1414"><span class="linenos">1414</span></a><span class="sd">      centre (str): centre of rotation which should be label of one of its</span>
</span><span id="Topology.rotate_edge-1415"><a href="#Topology.rotate_edge-1415"><span class="linenos">1415</span></a><span class="sd">        end point vertices or &quot;&quot; when rotation will be about the Edge centroid.</span>
</span><span id="Topology.rotate_edge-1416"><a href="#Topology.rotate_edge-1416"><span class="linenos">1416</span></a><span class="sd">        Defaults to &quot;&quot;.</span>
</span><span id="Topology.rotate_edge-1417"><a href="#Topology.rotate_edge-1417"><span class="linenos">1417</span></a><span class="sd">      angle (float): angle of rotation.</span>
</span><span id="Topology.rotate_edge-1418"><a href="#Topology.rotate_edge-1418"><span class="linenos">1418</span></a>
</span><span id="Topology.rotate_edge-1419"><a href="#Topology.rotate_edge-1419"><span class="linenos">1419</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Topology.rotate_edge-1420"><a href="#Topology.rotate_edge-1420"><span class="linenos">1420</span></a>    <span class="n">v0</span><span class="p">,</span> <span class="n">v1</span> <span class="o">=</span> <span class="n">edge</span><span class="o">.</span><span class="n">vertices</span>
</span><span id="Topology.rotate_edge-1421"><a href="#Topology.rotate_edge-1421"><span class="linenos">1421</span></a>    <span class="n">ls</span> <span class="o">=</span> <span class="n">geom</span><span class="o">.</span><span class="n">LineString</span><span class="p">([</span><span class="n">v0</span><span class="o">.</span><span class="n">point</span><span class="p">,</span> <span class="n">v1</span><span class="o">.</span><span class="n">point</span><span class="p">])</span>
</span><span id="Topology.rotate_edge-1422"><a href="#Topology.rotate_edge-1422"><span class="linenos">1422</span></a>    <span class="k">if</span> <span class="n">v0</span><span class="o">.</span><span class="n">label</span> <span class="o">==</span> <span class="n">centre</span><span class="p">:</span>
</span><span id="Topology.rotate_edge-1423"><a href="#Topology.rotate_edge-1423"><span class="linenos">1423</span></a>      <span class="n">c</span> <span class="o">=</span> <span class="n">v0</span><span class="o">.</span><span class="n">point</span>
</span><span id="Topology.rotate_edge-1424"><a href="#Topology.rotate_edge-1424"><span class="linenos">1424</span></a>    <span class="k">elif</span> <span class="n">v1</span><span class="o">.</span><span class="n">label</span> <span class="o">==</span> <span class="n">centre</span><span class="p">:</span>
</span><span id="Topology.rotate_edge-1425"><a href="#Topology.rotate_edge-1425"><span class="linenos">1425</span></a>      <span class="n">c</span> <span class="o">=</span> <span class="n">v1</span><span class="o">.</span><span class="n">point</span>
</span><span id="Topology.rotate_edge-1426"><a href="#Topology.rotate_edge-1426"><span class="linenos">1426</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="Topology.rotate_edge-1427"><a href="#Topology.rotate_edge-1427"><span class="linenos">1427</span></a>      <span class="n">c</span> <span class="o">=</span> <span class="n">ls</span><span class="o">.</span><span class="n">centroid</span>
</span><span id="Topology.rotate_edge-1428"><a href="#Topology.rotate_edge-1428"><span class="linenos">1428</span></a>    <span class="n">ls</span> <span class="o">=</span> <span class="n">affine</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span><span class="n">ls</span><span class="p">,</span> <span class="n">angle</span><span class="p">,</span> <span class="n">origin</span> <span class="o">=</span> <span class="n">c</span><span class="p">)</span>
</span><span id="Topology.rotate_edge-1429"><a href="#Topology.rotate_edge-1429"><span class="linenos">1429</span></a>    <span class="n">v0</span><span class="o">.</span><span class="n">point</span><span class="p">,</span> <span class="n">v1</span><span class="o">.</span><span class="n">point</span> <span class="o">=</span> <span class="p">[</span><span class="n">geom</span><span class="o">.</span><span class="n">Point</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">ls</span><span class="o">.</span><span class="n">coords</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Rotate edge.</p>

<p>Args:
  edge (Edge): the edge to rotate.
  centre (str): centre of rotation which should be label of one of its
    end point vertices or "" when rotation will be about the Edge centroid.
    Defaults to "".
  angle (float): angle of rotation.</p>
</div>


                            </div>
                            <div id="Topology.scale_edge" class="classattr">
                                        <input id="Topology.scale_edge-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">scale_edge</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">edge</span><span class="p">:</span> <span class="n"><a href="#Edge">Edge</a></span>, </span><span class="param"><span class="n">sf</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span></span><span class="return-annotation">) -> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="Topology.scale_edge-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Topology.scale_edge"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Topology.scale_edge-1432"><a href="#Topology.scale_edge-1432"><span class="linenos">1432</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">scale_edge</span><span class="p">(</span>
</span><span id="Topology.scale_edge-1433"><a href="#Topology.scale_edge-1433"><span class="linenos">1433</span></a>      <span class="bp">self</span><span class="p">,</span>
</span><span id="Topology.scale_edge-1434"><a href="#Topology.scale_edge-1434"><span class="linenos">1434</span></a>      <span class="n">edge</span><span class="p">:</span><span class="n">Edge</span><span class="p">,</span>
</span><span id="Topology.scale_edge-1435"><a href="#Topology.scale_edge-1435"><span class="linenos">1435</span></a>      <span class="n">sf</span><span class="p">:</span><span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
</span><span id="Topology.scale_edge-1436"><a href="#Topology.scale_edge-1436"><span class="linenos">1436</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Topology.scale_edge-1437"><a href="#Topology.scale_edge-1437"><span class="linenos">1437</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Scale edge.</span>
</span><span id="Topology.scale_edge-1438"><a href="#Topology.scale_edge-1438"><span class="linenos">1438</span></a>
</span><span id="Topology.scale_edge-1439"><a href="#Topology.scale_edge-1439"><span class="linenos">1439</span></a><span class="sd">    Args:</span>
</span><span id="Topology.scale_edge-1440"><a href="#Topology.scale_edge-1440"><span class="linenos">1440</span></a><span class="sd">      edge (Edge): the edge to scale.</span>
</span><span id="Topology.scale_edge-1441"><a href="#Topology.scale_edge-1441"><span class="linenos">1441</span></a><span class="sd">      sf (float): amount by which to scale the edge.</span>
</span><span id="Topology.scale_edge-1442"><a href="#Topology.scale_edge-1442"><span class="linenos">1442</span></a>
</span><span id="Topology.scale_edge-1443"><a href="#Topology.scale_edge-1443"><span class="linenos">1443</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Topology.scale_edge-1444"><a href="#Topology.scale_edge-1444"><span class="linenos">1444</span></a>    <span class="n">v0</span><span class="p">,</span> <span class="n">v1</span> <span class="o">=</span> <span class="n">edge</span><span class="o">.</span><span class="n">vertices</span>
</span><span id="Topology.scale_edge-1445"><a href="#Topology.scale_edge-1445"><span class="linenos">1445</span></a>    <span class="n">ls</span> <span class="o">=</span> <span class="n">geom</span><span class="o">.</span><span class="n">LineString</span><span class="p">([</span><span class="n">v0</span><span class="o">.</span><span class="n">point</span><span class="p">,</span> <span class="n">v1</span><span class="o">.</span><span class="n">point</span><span class="p">])</span>
</span><span id="Topology.scale_edge-1446"><a href="#Topology.scale_edge-1446"><span class="linenos">1446</span></a>    <span class="n">ls</span> <span class="o">=</span> <span class="n">affine</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">ls</span><span class="p">,</span> <span class="n">xfact</span> <span class="o">=</span> <span class="n">sf</span><span class="p">,</span> <span class="n">yfact</span> <span class="o">=</span> <span class="n">sf</span><span class="p">,</span> <span class="n">origin</span> <span class="o">=</span> <span class="n">ls</span><span class="o">.</span><span class="n">centroid</span><span class="p">)</span>
</span><span id="Topology.scale_edge-1447"><a href="#Topology.scale_edge-1447"><span class="linenos">1447</span></a>    <span class="n">v0</span><span class="o">.</span><span class="n">point</span><span class="p">,</span> <span class="n">v1</span><span class="o">.</span><span class="n">point</span> <span class="o">=</span> <span class="p">[</span><span class="n">geom</span><span class="o">.</span><span class="n">Point</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">ls</span><span class="o">.</span><span class="n">coords</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Scale edge.</p>

<p>Args:
  edge (Edge): the edge to scale.
  sf (float): amount by which to scale the edge.</p>
</div>


                            </div>
                            <div id="Topology.push_vertex" class="classattr">
                                        <input id="Topology.push_vertex-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">push_vertex</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">vertex</span><span class="p">:</span> <span class="n"><a href="#Vertex">Vertex</a></span>,</span><span class="param">	<span class="n">push_d</span><span class="p">:</span> <span class="nb">float</span></span><span class="return-annotation">) -> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="Topology.push_vertex-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Topology.push_vertex"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Topology.push_vertex-1450"><a href="#Topology.push_vertex-1450"><span class="linenos">1450</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">push_vertex</span><span class="p">(</span>
</span><span id="Topology.push_vertex-1451"><a href="#Topology.push_vertex-1451"><span class="linenos">1451</span></a>      <span class="bp">self</span><span class="p">,</span>
</span><span id="Topology.push_vertex-1452"><a href="#Topology.push_vertex-1452"><span class="linenos">1452</span></a>      <span class="n">vertex</span><span class="p">:</span><span class="n">Vertex</span><span class="p">,</span>
</span><span id="Topology.push_vertex-1453"><a href="#Topology.push_vertex-1453"><span class="linenos">1453</span></a>      <span class="n">push_d</span><span class="p">:</span><span class="nb">float</span><span class="p">,</span>
</span><span id="Topology.push_vertex-1454"><a href="#Topology.push_vertex-1454"><span class="linenos">1454</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">]:</span>
</span><span id="Topology.push_vertex-1455"><a href="#Topology.push_vertex-1455"><span class="linenos">1455</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return displacement vector to push a vertex based on incident edges.</span>
</span><span id="Topology.push_vertex-1456"><a href="#Topology.push_vertex-1456"><span class="linenos">1456</span></a>
</span><span id="Topology.push_vertex-1457"><a href="#Topology.push_vertex-1457"><span class="linenos">1457</span></a><span class="sd">    Args:</span>
</span><span id="Topology.push_vertex-1458"><a href="#Topology.push_vertex-1458"><span class="linenos">1458</span></a><span class="sd">      vertex (Vertex): the vertex to push.</span>
</span><span id="Topology.push_vertex-1459"><a href="#Topology.push_vertex-1459"><span class="linenos">1459</span></a><span class="sd">      push_d (float): the distance to push it.</span>
</span><span id="Topology.push_vertex-1460"><a href="#Topology.push_vertex-1460"><span class="linenos">1460</span></a>
</span><span id="Topology.push_vertex-1461"><a href="#Topology.push_vertex-1461"><span class="linenos">1461</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Topology.push_vertex-1462"><a href="#Topology.push_vertex-1462"><span class="linenos">1462</span></a>    <span class="n">neighbours</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">points</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">vertex</span><span class="o">.</span><span class="n">neighbours</span><span class="p">]</span>
</span><span id="Topology.push_vertex-1463"><a href="#Topology.push_vertex-1463"><span class="linenos">1463</span></a>    <span class="n">dists</span> <span class="o">=</span> <span class="p">[</span><span class="n">vertex</span><span class="o">.</span><span class="n">point</span><span class="o">.</span><span class="n">distance</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">point</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">neighbours</span><span class="p">]</span>
</span><span id="Topology.push_vertex-1464"><a href="#Topology.push_vertex-1464"><span class="linenos">1464</span></a>    <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">vertex</span><span class="o">.</span><span class="n">point</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">vertex</span><span class="o">.</span><span class="n">point</span><span class="o">.</span><span class="n">y</span>
</span><span id="Topology.push_vertex-1465"><a href="#Topology.push_vertex-1465"><span class="linenos">1465</span></a>    <span class="n">unit_vectors</span> <span class="o">=</span> <span class="p">[((</span><span class="n">x</span> <span class="o">-</span> <span class="n">v</span><span class="o">.</span><span class="n">point</span><span class="o">.</span><span class="n">x</span><span class="p">)</span> <span class="o">/</span> <span class="n">d</span><span class="p">,</span> <span class="p">(</span><span class="n">y</span> <span class="o">-</span> <span class="n">v</span><span class="o">.</span><span class="n">point</span><span class="o">.</span><span class="n">y</span><span class="p">)</span> <span class="o">/</span> <span class="n">d</span><span class="p">)</span>
</span><span id="Topology.push_vertex-1466"><a href="#Topology.push_vertex-1466"><span class="linenos">1466</span></a>                    <span class="k">for</span> <span class="n">v</span><span class="p">,</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">neighbours</span><span class="p">,</span> <span class="n">dists</span><span class="p">,</span> <span class="n">strict</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)]</span>
</span><span id="Topology.push_vertex-1467"><a href="#Topology.push_vertex-1467"><span class="linenos">1467</span></a>    <span class="k">return</span>  <span class="p">(</span><span class="n">push_d</span> <span class="o">*</span> <span class="nb">sum</span><span class="p">([</span><span class="n">xy</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">xy</span> <span class="ow">in</span> <span class="n">unit_vectors</span><span class="p">]),</span>
</span><span id="Topology.push_vertex-1468"><a href="#Topology.push_vertex-1468"><span class="linenos">1468</span></a>             <span class="n">push_d</span> <span class="o">*</span> <span class="nb">sum</span><span class="p">([</span><span class="n">xy</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">xy</span> <span class="ow">in</span> <span class="n">unit_vectors</span><span class="p">]))</span>
</span></pre></div>


            <div class="docstring"><p>Return displacement vector to push a vertex based on incident edges.</p>

<p>Args:
  vertex (Vertex): the vertex to push.
  push_d (float): the distance to push it.</p>
</div>


                            </div>
                            <div id="Topology.nudge_vertex" class="classattr">
                                        <input id="Topology.nudge_vertex-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">nudge_vertex</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">vertex</span><span class="p">:</span> <span class="n"><a href="#Vertex">Vertex</a></span>, </span><span class="param"><span class="n">dx</span><span class="p">:</span> <span class="nb">float</span>, </span><span class="param"><span class="n">dy</span><span class="p">:</span> <span class="nb">float</span></span><span class="return-annotation">) -> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="Topology.nudge_vertex-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Topology.nudge_vertex"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Topology.nudge_vertex-1471"><a href="#Topology.nudge_vertex-1471"><span class="linenos">1471</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">nudge_vertex</span><span class="p">(</span>
</span><span id="Topology.nudge_vertex-1472"><a href="#Topology.nudge_vertex-1472"><span class="linenos">1472</span></a>      <span class="bp">self</span><span class="p">,</span>
</span><span id="Topology.nudge_vertex-1473"><a href="#Topology.nudge_vertex-1473"><span class="linenos">1473</span></a>      <span class="n">vertex</span><span class="p">:</span><span class="n">Vertex</span><span class="p">,</span>
</span><span id="Topology.nudge_vertex-1474"><a href="#Topology.nudge_vertex-1474"><span class="linenos">1474</span></a>      <span class="n">dx</span><span class="p">:</span><span class="nb">float</span><span class="p">,</span>
</span><span id="Topology.nudge_vertex-1475"><a href="#Topology.nudge_vertex-1475"><span class="linenos">1475</span></a>      <span class="n">dy</span><span class="p">:</span><span class="nb">float</span><span class="p">,</span>
</span><span id="Topology.nudge_vertex-1476"><a href="#Topology.nudge_vertex-1476"><span class="linenos">1476</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Topology.nudge_vertex-1477"><a href="#Topology.nudge_vertex-1477"><span class="linenos">1477</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Nudge vertex by specified displacement.</span>
</span><span id="Topology.nudge_vertex-1478"><a href="#Topology.nudge_vertex-1478"><span class="linenos">1478</span></a>
</span><span id="Topology.nudge_vertex-1479"><a href="#Topology.nudge_vertex-1479"><span class="linenos">1479</span></a><span class="sd">    Args:</span>
</span><span id="Topology.nudge_vertex-1480"><a href="#Topology.nudge_vertex-1480"><span class="linenos">1480</span></a><span class="sd">      vertex (Vertex): the vertext to nudge.</span>
</span><span id="Topology.nudge_vertex-1481"><a href="#Topology.nudge_vertex-1481"><span class="linenos">1481</span></a><span class="sd">      dx (float): x displacement.</span>
</span><span id="Topology.nudge_vertex-1482"><a href="#Topology.nudge_vertex-1482"><span class="linenos">1482</span></a><span class="sd">      dy (float): y displacement.</span>
</span><span id="Topology.nudge_vertex-1483"><a href="#Topology.nudge_vertex-1483"><span class="linenos">1483</span></a>
</span><span id="Topology.nudge_vertex-1484"><a href="#Topology.nudge_vertex-1484"><span class="linenos">1484</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Topology.nudge_vertex-1485"><a href="#Topology.nudge_vertex-1485"><span class="linenos">1485</span></a>    <span class="n">vertex</span><span class="o">.</span><span class="n">point</span> <span class="o">=</span> <span class="n">affine</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="n">vertex</span><span class="o">.</span><span class="n">point</span><span class="p">,</span> <span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Nudge vertex by specified displacement.</p>

<p>Args:
  vertex (Vertex): the vertext to nudge.
  dx (float): x displacement.
  dy (float): y displacement.</p>
</div>


                            </div>
                </section>
                <section id="Tile">
                            <input id="Tile-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">Tile</span>:

                <label class="view-source-button" for="Tile-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Tile"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Tile-1488"><a href="#Tile-1488"><span class="linenos">1488</span></a><span class="k">class</span><span class="w"> </span><span class="nc">Tile</span><span class="p">:</span>
</span><span id="Tile-1489"><a href="#Tile-1489"><span class="linenos">1489</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;Class to represent essential features of polygons in a tiling.&quot;&quot;&quot;</span>
</span><span id="Tile-1490"><a href="#Tile-1490"><span class="linenos">1490</span></a>
</span><span id="Tile-1491"><a href="#Tile-1491"><span class="linenos">1491</span></a>  <span class="n">ID</span><span class="p">:</span> <span class="nb">int</span>
</span><span id="Tile-1492"><a href="#Tile-1492"><span class="linenos">1492</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;integer ID number which indexes the Tile in the containing Topology tiles</span>
</span><span id="Tile-1493"><a href="#Tile-1493"><span class="linenos">1493</span></a><span class="sd">  list.&quot;&quot;&quot;</span>
</span><span id="Tile-1494"><a href="#Tile-1494"><span class="linenos">1494</span></a>  <span class="n">base_ID</span><span class="p">:</span> <span class="nb">int</span>
</span><span id="Tile-1495"><a href="#Tile-1495"><span class="linenos">1495</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;ID of corresponding Tile in the base tileable unit&quot;&quot;&quot;</span>
</span><span id="Tile-1496"><a href="#Tile-1496"><span class="linenos">1496</span></a>  <span class="n">corners</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Vertex</span><span class="p">]</span>
</span><span id="Tile-1497"><a href="#Tile-1497"><span class="linenos">1497</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;list of Vertex objects. This includes all corners of the original polygon</span>
</span><span id="Tile-1498"><a href="#Tile-1498"><span class="linenos">1498</span></a><span class="sd">  and any tiling vertices induced by (for example) a the corner of an adjacent</span>
</span><span id="Tile-1499"><a href="#Tile-1499"><span class="linenos">1499</span></a><span class="sd">  tile lying halfway along an edge of the original polygon on which this tile</span>
</span><span id="Tile-1500"><a href="#Tile-1500"><span class="linenos">1500</span></a><span class="sd">  is based. Vertex objects are stored in strictly clockwise sequence.&quot;&quot;&quot;</span>
</span><span id="Tile-1501"><a href="#Tile-1501"><span class="linenos">1501</span></a>  <span class="n">edges</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Edge</span><span class="p">]</span>
</span><span id="Tile-1502"><a href="#Tile-1502"><span class="linenos">1502</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;list of Edge objects that together compose the tile boundary.&quot;&quot;&quot;</span>
</span><span id="Tile-1503"><a href="#Tile-1503"><span class="linenos">1503</span></a>  <span class="n">edges_CW</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span>
</span><span id="Tile-1504"><a href="#Tile-1504"><span class="linenos">1504</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;list of Edge direction. Edges are stored only once in a Topology so some</span>
</span><span id="Tile-1505"><a href="#Tile-1505"><span class="linenos">1505</span></a><span class="sd">  edges are in clockwise order and others  are in counter-clockwise order.</span>
</span><span id="Tile-1506"><a href="#Tile-1506"><span class="linenos">1506</span></a><span class="sd">  These boolean flags are True if the corresponding Edge is clockwise, False if</span>
</span><span id="Tile-1507"><a href="#Tile-1507"><span class="linenos">1507</span></a><span class="sd">  counter-clockwise.&quot;&quot;&quot;</span>
</span><span id="Tile-1508"><a href="#Tile-1508"><span class="linenos">1508</span></a>  <span class="n">label</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="Tile-1509"><a href="#Tile-1509"><span class="linenos">1509</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;tile_id label from the tileable source&quot;&quot;&quot;</span>
</span><span id="Tile-1510"><a href="#Tile-1510"><span class="linenos">1510</span></a>  <span class="n">vertex_labels</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
</span><span id="Tile-1511"><a href="#Tile-1511"><span class="linenos">1511</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;list of (upper case) letter labels of the tile corners (i.e. all corners,</span>
</span><span id="Tile-1512"><a href="#Tile-1512"><span class="linenos">1512</span></a><span class="sd">  not only tiling vertices).&quot;&quot;&quot;</span>
</span><span id="Tile-1513"><a href="#Tile-1513"><span class="linenos">1513</span></a>  <span class="n">edge_labels</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
</span><span id="Tile-1514"><a href="#Tile-1514"><span class="linenos">1514</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;list of (lower case) letter labels of the tile edges (tiling edges, not</span>
</span><span id="Tile-1515"><a href="#Tile-1515"><span class="linenos">1515</span></a><span class="sd">  tile sides).&quot;&quot;&quot;</span>
</span><span id="Tile-1516"><a href="#Tile-1516"><span class="linenos">1516</span></a>  <span class="n">shape</span><span class="p">:</span> <span class="n">geom</span><span class="o">.</span><span class="n">Polygon</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Tile-1517"><a href="#Tile-1517"><span class="linenos">1517</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;the tile geometry (which may include some redundant points along sides</span>
</span><span id="Tile-1518"><a href="#Tile-1518"><span class="linenos">1518</span></a><span class="sd">  where neighbouring tiles induce a tiling vertex). So for example a rectangle</span>
</span><span id="Tile-1519"><a href="#Tile-1519"><span class="linenos">1519</span></a><span class="sd">  might have additional points along its sides:</span>
</span><span id="Tile-1520"><a href="#Tile-1520"><span class="linenos">1520</span></a>
</span><span id="Tile-1521"><a href="#Tile-1521"><span class="linenos">1521</span></a><span class="sd">        +---+-------+</span>
</span><span id="Tile-1522"><a href="#Tile-1522"><span class="linenos">1522</span></a><span class="sd">        |   |   2   |</span>
</span><span id="Tile-1523"><a href="#Tile-1523"><span class="linenos">1523</span></a><span class="sd">        | 1 A---B---E---+</span>
</span><span id="Tile-1524"><a href="#Tile-1524"><span class="linenos">1524</span></a><span class="sd">        |   |   |   4   |</span>
</span><span id="Tile-1525"><a href="#Tile-1525"><span class="linenos">1525</span></a><span class="sd">        +---C 3 D-------+</span>
</span><span id="Tile-1526"><a href="#Tile-1526"><span class="linenos">1526</span></a><span class="sd">            |   |</span>
</span><span id="Tile-1527"><a href="#Tile-1527"><span class="linenos">1527</span></a><span class="sd">            +---+</span>
</span><span id="Tile-1528"><a href="#Tile-1528"><span class="linenos">1528</span></a>
</span><span id="Tile-1529"><a href="#Tile-1529"><span class="linenos">1529</span></a><span class="sd">  In the above Tile 1 has additional point A, 2 has B and 3 has C and D induced</span>
</span><span id="Tile-1530"><a href="#Tile-1530"><span class="linenos">1530</span></a><span class="sd">  by the corners of neighbouring tiles.&quot;&quot;&quot;</span>
</span><span id="Tile-1531"><a href="#Tile-1531"><span class="linenos">1531</span></a>  <span class="n">centre</span><span class="p">:</span> <span class="n">geom</span><span class="o">.</span><span class="n">Point</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Tile-1532"><a href="#Tile-1532"><span class="linenos">1532</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;a point centre for the Tile (determined by weavingspace.tiling_utils.</span>
</span><span id="Tile-1533"><a href="#Tile-1533"><span class="linenos">1533</span></a><span class="sd">  incentre).&quot;&quot;&quot;</span>
</span><span id="Tile-1534"><a href="#Tile-1534"><span class="linenos">1534</span></a>  <span class="n">shape_group</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Tile-1535"><a href="#Tile-1535"><span class="linenos">1535</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;the tile shape group of this tile in its containing Topology.&quot;&quot;&quot;</span>
</span><span id="Tile-1536"><a href="#Tile-1536"><span class="linenos">1536</span></a>  <span class="n">transitivity_class</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Tile-1537"><a href="#Tile-1537"><span class="linenos">1537</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;the tile transitivity class of this tile its containing Topology&quot;&quot;&quot;</span>
</span><span id="Tile-1538"><a href="#Tile-1538"><span class="linenos">1538</span></a>
</span><span id="Tile-1539"><a href="#Tile-1539"><span class="linenos">1539</span></a>  <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="Tile-1540"><a href="#Tile-1540"><span class="linenos">1540</span></a>      <span class="bp">self</span><span class="p">,</span>
</span><span id="Tile-1541"><a href="#Tile-1541"><span class="linenos">1541</span></a>      <span class="n">ID</span><span class="p">:</span><span class="nb">int</span><span class="p">,</span>
</span><span id="Tile-1542"><a href="#Tile-1542"><span class="linenos">1542</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Tile-1543"><a href="#Tile-1543"><span class="linenos">1543</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Class constructor.</span>
</span><span id="Tile-1544"><a href="#Tile-1544"><span class="linenos">1544</span></a>
</span><span id="Tile-1545"><a href="#Tile-1545"><span class="linenos">1545</span></a><span class="sd">    Args:</span>
</span><span id="Tile-1546"><a href="#Tile-1546"><span class="linenos">1546</span></a><span class="sd">      ID (int): sequence number ID of this vertex in the Topology.</span>
</span><span id="Tile-1547"><a href="#Tile-1547"><span class="linenos">1547</span></a>
</span><span id="Tile-1548"><a href="#Tile-1548"><span class="linenos">1548</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Tile-1549"><a href="#Tile-1549"><span class="linenos">1549</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">ID</span> <span class="o">=</span> <span class="n">ID</span>
</span><span id="Tile-1550"><a href="#Tile-1550"><span class="linenos">1550</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">corners</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Tile-1551"><a href="#Tile-1551"><span class="linenos">1551</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">edges</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Tile-1552"><a href="#Tile-1552"><span class="linenos">1552</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">edges_CW</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Tile-1553"><a href="#Tile-1553"><span class="linenos">1553</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">vertex_labels</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Tile-1554"><a href="#Tile-1554"><span class="linenos">1554</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">edge_labels</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Tile-1555"><a href="#Tile-1555"><span class="linenos">1555</span></a>
</span><span id="Tile-1556"><a href="#Tile-1556"><span class="linenos">1556</span></a>
</span><span id="Tile-1557"><a href="#Tile-1557"><span class="linenos">1557</span></a>  <span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="Tile-1558"><a href="#Tile-1558"><span class="linenos">1558</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return string representation of the Tile.</span>
</span><span id="Tile-1559"><a href="#Tile-1559"><span class="linenos">1559</span></a>
</span><span id="Tile-1560"><a href="#Tile-1560"><span class="linenos">1560</span></a><span class="sd">    Returns:</span>
</span><span id="Tile-1561"><a href="#Tile-1561"><span class="linenos">1561</span></a><span class="sd">      str: string including Tile ID, list of corner vertex IDs and list of</span>
</span><span id="Tile-1562"><a href="#Tile-1562"><span class="linenos">1562</span></a><span class="sd">        edge IDs.</span>
</span><span id="Tile-1563"><a href="#Tile-1563"><span class="linenos">1563</span></a>
</span><span id="Tile-1564"><a href="#Tile-1564"><span class="linenos">1564</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Tile-1565"><a href="#Tile-1565"><span class="linenos">1565</span></a>    <span class="k">return</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Tile </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">ID</span><span class="si">}</span><span class="s2"> Corners: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">get_corner_IDs</span><span class="p">()</span><span class="si">}</span><span class="s2"> &quot;</span>
</span><span id="Tile-1566"><a href="#Tile-1566"><span class="linenos">1566</span></a>            <span class="sa">f</span><span class="s2">&quot;Edges: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">get_edge_IDs</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="Tile-1567"><a href="#Tile-1567"><span class="linenos">1567</span></a>
</span><span id="Tile-1568"><a href="#Tile-1568"><span class="linenos">1568</span></a>
</span><span id="Tile-1569"><a href="#Tile-1569"><span class="linenos">1569</span></a>  <span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="Tile-1570"><a href="#Tile-1570"><span class="linenos">1570</span></a>    <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="Tile-1571"><a href="#Tile-1571"><span class="linenos">1571</span></a>
</span><span id="Tile-1572"><a href="#Tile-1572"><span class="linenos">1572</span></a>
</span><span id="Tile-1573"><a href="#Tile-1573"><span class="linenos">1573</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">get_corner_IDs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
</span><span id="Tile-1574"><a href="#Tile-1574"><span class="linenos">1574</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return list of corner IDs (not Vertex objects).</span>
</span><span id="Tile-1575"><a href="#Tile-1575"><span class="linenos">1575</span></a>
</span><span id="Tile-1576"><a href="#Tile-1576"><span class="linenos">1576</span></a><span class="sd">    Returns:</span>
</span><span id="Tile-1577"><a href="#Tile-1577"><span class="linenos">1577</span></a><span class="sd">      list[int]: list of integer IDs of tile corners.</span>
</span><span id="Tile-1578"><a href="#Tile-1578"><span class="linenos">1578</span></a>
</span><span id="Tile-1579"><a href="#Tile-1579"><span class="linenos">1579</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Tile-1580"><a href="#Tile-1580"><span class="linenos">1580</span></a>    <span class="k">return</span> <span class="p">[</span><span class="n">c</span><span class="o">.</span><span class="n">ID</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">corners</span><span class="p">]</span>
</span><span id="Tile-1581"><a href="#Tile-1581"><span class="linenos">1581</span></a>
</span><span id="Tile-1582"><a href="#Tile-1582"><span class="linenos">1582</span></a>
</span><span id="Tile-1583"><a href="#Tile-1583"><span class="linenos">1583</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">get_edge_IDs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span><span class="nb">int</span><span class="p">]]:</span>
</span><span id="Tile-1584"><a href="#Tile-1584"><span class="linenos">1584</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return list of edge IDs (not Edge objects).</span>
</span><span id="Tile-1585"><a href="#Tile-1585"><span class="linenos">1585</span></a>
</span><span id="Tile-1586"><a href="#Tile-1586"><span class="linenos">1586</span></a><span class="sd">    Returns:</span>
</span><span id="Tile-1587"><a href="#Tile-1587"><span class="linenos">1587</span></a><span class="sd">      list[tuple[int]]: list of 2-element tuples of the start and end Vertex IDs</span>
</span><span id="Tile-1588"><a href="#Tile-1588"><span class="linenos">1588</span></a><span class="sd">        of each edge.</span>
</span><span id="Tile-1589"><a href="#Tile-1589"><span class="linenos">1589</span></a>
</span><span id="Tile-1590"><a href="#Tile-1590"><span class="linenos">1590</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Tile-1591"><a href="#Tile-1591"><span class="linenos">1591</span></a>    <span class="k">return</span> <span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">ID</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">]</span>
</span><span id="Tile-1592"><a href="#Tile-1592"><span class="linenos">1592</span></a>
</span><span id="Tile-1593"><a href="#Tile-1593"><span class="linenos">1593</span></a>
</span><span id="Tile-1594"><a href="#Tile-1594"><span class="linenos">1594</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">set_shape_from_corners</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Tile-1595"><a href="#Tile-1595"><span class="linenos">1595</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Set the shape attribute based on corners, and associated tile centre.&quot;&quot;&quot;</span>
</span><span id="Tile-1596"><a href="#Tile-1596"><span class="linenos">1596</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">shape</span> <span class="o">=</span> <span class="n">geom</span><span class="o">.</span><span class="n">Polygon</span><span class="p">([</span><span class="n">c</span><span class="o">.</span><span class="n">point</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">corners</span><span class="p">])</span>
</span><span id="Tile-1597"><a href="#Tile-1597"><span class="linenos">1597</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">centre</span> <span class="o">=</span> <span class="n">tiling_utils</span><span class="o">.</span><span class="n">get_incentre</span><span class="p">(</span>
</span><span id="Tile-1598"><a href="#Tile-1598"><span class="linenos">1598</span></a>      <span class="n">tiling_utils</span><span class="o">.</span><span class="n">get_clean_polygon</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
</span><span id="Tile-1599"><a href="#Tile-1599"><span class="linenos">1599</span></a>
</span><span id="Tile-1600"><a href="#Tile-1600"><span class="linenos">1600</span></a>
</span><span id="Tile-1601"><a href="#Tile-1601"><span class="linenos">1601</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">set_corners_from_edges</span><span class="p">(</span>
</span><span id="Tile-1602"><a href="#Tile-1602"><span class="linenos">1602</span></a>      <span class="bp">self</span><span class="p">,</span>
</span><span id="Tile-1603"><a href="#Tile-1603"><span class="linenos">1603</span></a>      <span class="n">update_shape</span><span class="p">:</span><span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="Tile-1604"><a href="#Tile-1604"><span class="linenos">1604</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Tile-1605"><a href="#Tile-1605"><span class="linenos">1605</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Set corners attribute from the edges attribute.</span>
</span><span id="Tile-1606"><a href="#Tile-1606"><span class="linenos">1606</span></a>
</span><span id="Tile-1607"><a href="#Tile-1607"><span class="linenos">1607</span></a><span class="sd">    Typically called after modification of topology edges. Optionally the shape</span>
</span><span id="Tile-1608"><a href="#Tile-1608"><span class="linenos">1608</span></a><span class="sd">    attribute is NOT updated, which may save time when multiple changes to the</span>
</span><span id="Tile-1609"><a href="#Tile-1609"><span class="linenos">1609</span></a><span class="sd">    edges of a tile are in process (i.e., only update the shape after all</span>
</span><span id="Tile-1610"><a href="#Tile-1610"><span class="linenos">1610</span></a><span class="sd">    changes are complete).</span>
</span><span id="Tile-1611"><a href="#Tile-1611"><span class="linenos">1611</span></a>
</span><span id="Tile-1612"><a href="#Tile-1612"><span class="linenos">1612</span></a><span class="sd">    Args:</span>
</span><span id="Tile-1613"><a href="#Tile-1613"><span class="linenos">1613</span></a><span class="sd">      update_shape (bool, optional): if True the shape attribute will be</span>
</span><span id="Tile-1614"><a href="#Tile-1614"><span class="linenos">1614</span></a><span class="sd">        updated, otherwise not. Defaults to True.</span>
</span><span id="Tile-1615"><a href="#Tile-1615"><span class="linenos">1615</span></a>
</span><span id="Tile-1616"><a href="#Tile-1616"><span class="linenos">1616</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Tile-1617"><a href="#Tile-1617"><span class="linenos">1617</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">corners</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Tile-1618"><a href="#Tile-1618"><span class="linenos">1618</span></a>    <span class="k">for</span> <span class="n">e</span><span class="p">,</span> <span class="n">cw</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges_CW</span><span class="p">,</span> <span class="n">strict</span> <span class="o">=</span> <span class="kc">True</span><span class="p">):</span>
</span><span id="Tile-1619"><a href="#Tile-1619"><span class="linenos">1619</span></a>      <span class="k">if</span> <span class="n">cw</span><span class="p">:</span> <span class="c1"># clockwise to extend by all but the first corner</span>
</span><span id="Tile-1620"><a href="#Tile-1620"><span class="linenos">1620</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">corners</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">corners</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</span><span id="Tile-1621"><a href="#Tile-1621"><span class="linenos">1621</span></a>      <span class="k">else</span><span class="p">:</span> <span class="c1"># counter-clockwise so extend in reverse</span>
</span><span id="Tile-1622"><a href="#Tile-1622"><span class="linenos">1622</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">corners</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">corners</span><span class="p">[</span><span class="mi">1</span><span class="p">:][::</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</span><span id="Tile-1623"><a href="#Tile-1623"><span class="linenos">1623</span></a>    <span class="k">if</span> <span class="n">update_shape</span><span class="p">:</span>
</span><span id="Tile-1624"><a href="#Tile-1624"><span class="linenos">1624</span></a>      <span class="bp">self</span><span class="o">.</span><span class="n">set_shape_from_corners</span><span class="p">()</span>
</span><span id="Tile-1625"><a href="#Tile-1625"><span class="linenos">1625</span></a>
</span><span id="Tile-1626"><a href="#Tile-1626"><span class="linenos">1626</span></a>
</span><span id="Tile-1627"><a href="#Tile-1627"><span class="linenos">1627</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">set_edge_directions</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Tile-1628"><a href="#Tile-1628"><span class="linenos">1628</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Set up edges_CW attribute by inspection of the edges list.</span>
</span><span id="Tile-1629"><a href="#Tile-1629"><span class="linenos">1629</span></a>
</span><span id="Tile-1630"><a href="#Tile-1630"><span class="linenos">1630</span></a><span class="sd">    It is (frankly!) hard to keep track of the correct sequence of CW/CCW order</span>
</span><span id="Tile-1631"><a href="#Tile-1631"><span class="linenos">1631</span></a><span class="sd">    of edges as new ones are created or old ones merged. This method inspects</span>
</span><span id="Tile-1632"><a href="#Tile-1632"><span class="linenos">1632</span></a><span class="sd">    the &#39;tail-head&#39; relations between consecutive edges to set these flags</span>
</span><span id="Tile-1633"><a href="#Tile-1633"><span class="linenos">1633</span></a><span class="sd">    correctly.</span>
</span><span id="Tile-1634"><a href="#Tile-1634"><span class="linenos">1634</span></a>
</span><span id="Tile-1635"><a href="#Tile-1635"><span class="linenos">1635</span></a><span class="sd">    The test is simply to check if the &#39;tail&#39; Vertex ID in each edge appears</span>
</span><span id="Tile-1636"><a href="#Tile-1636"><span class="linenos">1636</span></a><span class="sd">    in the ID tuple of the following edge, i.e. if successive edge</span>
</span><span id="Tile-1637"><a href="#Tile-1637"><span class="linenos">1637</span></a><span class="sd">    IDs are (0, 1) (2, 1) or (0, 1) (1, 2), then edge (0, 1) is in clockwise</span>
</span><span id="Tile-1638"><a href="#Tile-1638"><span class="linenos">1638</span></a><span class="sd">    direction, but if we have (0, 1) (2, 3) then it is not.</span>
</span><span id="Tile-1639"><a href="#Tile-1639"><span class="linenos">1639</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Tile-1640"><a href="#Tile-1640"><span class="linenos">1640</span></a>    <span class="n">edge_IDs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_edge_IDs</span><span class="p">()</span>
</span><span id="Tile-1641"><a href="#Tile-1641"><span class="linenos">1641</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">edges_CW</span> <span class="o">=</span> <span class="p">[</span><span class="n">e1</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="n">e2</span> <span class="k">for</span> <span class="n">e1</span><span class="p">,</span> <span class="n">e2</span> <span class="ow">in</span>
</span><span id="Tile-1642"><a href="#Tile-1642"><span class="linenos">1642</span></a>                     <span class="nb">zip</span><span class="p">(</span><span class="n">edge_IDs</span><span class="p">,</span> <span class="n">edge_IDs</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">+</span> <span class="n">edge_IDs</span><span class="p">[:</span><span class="mi">1</span><span class="p">],</span> <span class="n">strict</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)]</span>
</span><span id="Tile-1643"><a href="#Tile-1643"><span class="linenos">1643</span></a>
</span><span id="Tile-1644"><a href="#Tile-1644"><span class="linenos">1644</span></a>
</span><span id="Tile-1645"><a href="#Tile-1645"><span class="linenos">1645</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">insert_vertex_at</span><span class="p">(</span>
</span><span id="Tile-1646"><a href="#Tile-1646"><span class="linenos">1646</span></a>      <span class="bp">self</span><span class="p">,</span>
</span><span id="Tile-1647"><a href="#Tile-1647"><span class="linenos">1647</span></a>      <span class="n">v</span><span class="p">:</span><span class="n">Vertex</span><span class="p">,</span>
</span><span id="Tile-1648"><a href="#Tile-1648"><span class="linenos">1648</span></a>      <span class="n">i</span><span class="p">:</span><span class="nb">int</span><span class="p">,</span>
</span><span id="Tile-1649"><a href="#Tile-1649"><span class="linenos">1649</span></a>      <span class="n">update_shape</span><span class="p">:</span><span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="Tile-1650"><a href="#Tile-1650"><span class="linenos">1650</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span><span class="nb">int</span><span class="p">],</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span><span class="nb">int</span><span class="p">],</span><span class="o">...</span><span class="p">]]:</span>
</span><span id="Tile-1651"><a href="#Tile-1651"><span class="linenos">1651</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Insert the Vertex into tile at index position i.</span>
</span><span id="Tile-1652"><a href="#Tile-1652"><span class="linenos">1652</span></a>
</span><span id="Tile-1653"><a href="#Tile-1653"><span class="linenos">1653</span></a><span class="sd">    Both corners and edges attributes are updated, and the old edge IDs for</span>
</span><span id="Tile-1654"><a href="#Tile-1654"><span class="linenos">1654</span></a><span class="sd">    removal and the new edge itself are returned to the calling context (the</span>
</span><span id="Tile-1655"><a href="#Tile-1655"><span class="linenos">1655</span></a><span class="sd">    containing Topology) for update of its edges collection. Optionally update</span>
</span><span id="Tile-1656"><a href="#Tile-1656"><span class="linenos">1656</span></a><span class="sd">    the shape attribute.</span>
</span><span id="Tile-1657"><a href="#Tile-1657"><span class="linenos">1657</span></a>
</span><span id="Tile-1658"><a href="#Tile-1658"><span class="linenos">1658</span></a><span class="sd">    This is NOT a generic vertex insertion method: it is only for use during</span>
</span><span id="Tile-1659"><a href="#Tile-1659"><span class="linenos">1659</span></a><span class="sd">    Topology initialisation, and does not guarantee correct maintenance of</span>
</span><span id="Tile-1660"><a href="#Tile-1660"><span class="linenos">1660</span></a><span class="sd">    all tile, edge and vertex relations in the general case---at any rate it</span>
</span><span id="Tile-1661"><a href="#Tile-1661"><span class="linenos">1661</span></a><span class="sd">    has not been tested for this!</span>
</span><span id="Tile-1662"><a href="#Tile-1662"><span class="linenos">1662</span></a>
</span><span id="Tile-1663"><a href="#Tile-1663"><span class="linenos">1663</span></a><span class="sd">    Args:</span>
</span><span id="Tile-1664"><a href="#Tile-1664"><span class="linenos">1664</span></a><span class="sd">      v (Vertex): the Vertex to insert.</span>
</span><span id="Tile-1665"><a href="#Tile-1665"><span class="linenos">1665</span></a><span class="sd">      i (int): index position in current corners after which to insert</span>
</span><span id="Tile-1666"><a href="#Tile-1666"><span class="linenos">1666</span></a><span class="sd">        supplied Vertex.</span>
</span><span id="Tile-1667"><a href="#Tile-1667"><span class="linenos">1667</span></a><span class="sd">      update_shape (bool, optional): if True shape attribute is updated.</span>
</span><span id="Tile-1668"><a href="#Tile-1668"><span class="linenos">1668</span></a><span class="sd">        Defaults to False.</span>
</span><span id="Tile-1669"><a href="#Tile-1669"><span class="linenos">1669</span></a>
</span><span id="Tile-1670"><a href="#Tile-1670"><span class="linenos">1670</span></a><span class="sd">    Returns:</span>
</span><span id="Tile-1671"><a href="#Tile-1671"><span class="linenos">1671</span></a><span class="sd">      tuple: the (tuple) ID of the old edge which should be deleted, and</span>
</span><span id="Tile-1672"><a href="#Tile-1672"><span class="linenos">1672</span></a><span class="sd">        the new Edges arising from insertion of this Vertex.</span>
</span><span id="Tile-1673"><a href="#Tile-1673"><span class="linenos">1673</span></a>
</span><span id="Tile-1674"><a href="#Tile-1674"><span class="linenos">1674</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Tile-1675"><a href="#Tile-1675"><span class="linenos">1675</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">corners</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">corners</span><span class="p">[:</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">corners</span><span class="p">[</span><span class="n">i</span><span class="p">:]</span>
</span><span id="Tile-1676"><a href="#Tile-1676"><span class="linenos">1676</span></a>    <span class="n">old_edge</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
</span><span id="Tile-1677"><a href="#Tile-1677"><span class="linenos">1677</span></a>    <span class="c1"># store current ID of the affected edge for return to calling context</span>
</span><span id="Tile-1678"><a href="#Tile-1678"><span class="linenos">1678</span></a>    <span class="n">old_edge_ID</span> <span class="o">=</span> <span class="n">old_edge</span><span class="o">.</span><span class="n">ID</span>
</span><span id="Tile-1679"><a href="#Tile-1679"><span class="linenos">1679</span></a>    <span class="n">new_edges</span> <span class="o">=</span> <span class="n">old_edge</span><span class="o">.</span><span class="n">insert_vertex</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">corners</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">])</span>
</span><span id="Tile-1680"><a href="#Tile-1680"><span class="linenos">1680</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">edges</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">[:(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)]</span> <span class="o">+</span> <span class="n">new_edges</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">i</span><span class="p">:]</span>
</span><span id="Tile-1681"><a href="#Tile-1681"><span class="linenos">1681</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">set_edge_directions</span><span class="p">()</span>
</span><span id="Tile-1682"><a href="#Tile-1682"><span class="linenos">1682</span></a>    <span class="k">if</span> <span class="n">update_shape</span><span class="p">:</span>
</span><span id="Tile-1683"><a href="#Tile-1683"><span class="linenos">1683</span></a>      <span class="bp">self</span><span class="o">.</span><span class="n">set_shape_from_corners</span><span class="p">()</span>
</span><span id="Tile-1684"><a href="#Tile-1684"><span class="linenos">1684</span></a>    <span class="k">return</span> <span class="n">old_edge_ID</span><span class="p">,</span> <span class="n">new_edges</span>
</span><span id="Tile-1685"><a href="#Tile-1685"><span class="linenos">1685</span></a>
</span><span id="Tile-1686"><a href="#Tile-1686"><span class="linenos">1686</span></a>
</span><span id="Tile-1687"><a href="#Tile-1687"><span class="linenos">1687</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">merge_edges_at_vertex</span><span class="p">(</span>
</span><span id="Tile-1688"><a href="#Tile-1688"><span class="linenos">1688</span></a>      <span class="bp">self</span><span class="p">,</span>
</span><span id="Tile-1689"><a href="#Tile-1689"><span class="linenos">1689</span></a>      <span class="n">v</span><span class="p">:</span><span class="n">Vertex</span><span class="p">,</span>
</span><span id="Tile-1690"><a href="#Tile-1690"><span class="linenos">1690</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
</span><span id="Tile-1691"><a href="#Tile-1691"><span class="linenos">1691</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Merge edges that meet at the supplied Vertex.</span>
</span><span id="Tile-1692"><a href="#Tile-1692"><span class="linenos">1692</span></a>
</span><span id="Tile-1693"><a href="#Tile-1693"><span class="linenos">1693</span></a><span class="sd">    It is assumed that only two tiles are impacted this one, and its neighbour</span>
</span><span id="Tile-1694"><a href="#Tile-1694"><span class="linenos">1694</span></a><span class="sd">    across the Edge on which v lies. Both are updated. For this reason the work</span>
</span><span id="Tile-1695"><a href="#Tile-1695"><span class="linenos">1695</span></a><span class="sd">    is delegated to `get_updated_edges_from_merge` which is run on both affected</span>
</span><span id="Tile-1696"><a href="#Tile-1696"><span class="linenos">1696</span></a><span class="sd">    tiles, but only determines the edges to remove and the new edge to be added</span>
</span><span id="Tile-1697"><a href="#Tile-1697"><span class="linenos">1697</span></a><span class="sd">    once. See that method for details.</span>
</span><span id="Tile-1698"><a href="#Tile-1698"><span class="linenos">1698</span></a>
</span><span id="Tile-1699"><a href="#Tile-1699"><span class="linenos">1699</span></a><span class="sd">    Args:</span>
</span><span id="Tile-1700"><a href="#Tile-1700"><span class="linenos">1700</span></a><span class="sd">      v (Vertex): Vertex at which to merge Edges. This should currently be an</span>
</span><span id="Tile-1701"><a href="#Tile-1701"><span class="linenos">1701</span></a><span class="sd">        end</span>
</span><span id="Tile-1702"><a href="#Tile-1702"><span class="linenos">1702</span></a>
</span><span id="Tile-1703"><a href="#Tile-1703"><span class="linenos">1703</span></a><span class="sd">    Returns:</span>
</span><span id="Tile-1704"><a href="#Tile-1704"><span class="linenos">1704</span></a><span class="sd">      tuple: 2 item list of the edge IDs to be removed and a new Edge object to</span>
</span><span id="Tile-1705"><a href="#Tile-1705"><span class="linenos">1705</span></a><span class="sd">        be added by the calling context (i.e. the containing Topology).</span>
</span><span id="Tile-1706"><a href="#Tile-1706"><span class="linenos">1706</span></a>
</span><span id="Tile-1707"><a href="#Tile-1707"><span class="linenos">1707</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Tile-1708"><a href="#Tile-1708"><span class="linenos">1708</span></a>    <span class="n">to_remove</span><span class="p">,</span> <span class="n">new_edge</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_updated_edges_from_merge</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
</span><span id="Tile-1709"><a href="#Tile-1709"><span class="linenos">1709</span></a>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">tiles</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="Tile-1710"><a href="#Tile-1710"><span class="linenos">1710</span></a>      <span class="n">v</span><span class="o">.</span><span class="n">tiles</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">get_updated_edges_from_merge</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">new_edge</span><span class="p">)</span>
</span><span id="Tile-1711"><a href="#Tile-1711"><span class="linenos">1711</span></a>    <span class="k">return</span> <span class="n">to_remove</span><span class="p">,</span> <span class="n">new_edge</span>
</span><span id="Tile-1712"><a href="#Tile-1712"><span class="linenos">1712</span></a>
</span><span id="Tile-1713"><a href="#Tile-1713"><span class="linenos">1713</span></a>
</span><span id="Tile-1714"><a href="#Tile-1714"><span class="linenos">1714</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">get_updated_edges_from_merge</span><span class="p">(</span>
</span><span id="Tile-1715"><a href="#Tile-1715"><span class="linenos">1715</span></a>      <span class="bp">self</span><span class="p">,</span>
</span><span id="Tile-1716"><a href="#Tile-1716"><span class="linenos">1716</span></a>      <span class="n">v</span><span class="p">:</span><span class="n">Vertex</span><span class="p">,</span>
</span><span id="Tile-1717"><a href="#Tile-1717"><span class="linenos">1717</span></a>      <span class="n">new_edge</span><span class="p">:</span><span class="n">Edge</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Tile-1718"><a href="#Tile-1718"><span class="linenos">1718</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="o">|</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span><span class="nb">int</span><span class="p">],</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span><span class="nb">int</span><span class="p">]],</span> <span class="n">Edge</span><span class="p">]:</span>
</span><span id="Tile-1719"><a href="#Tile-1719"><span class="linenos">1719</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Update edges and edges_CW attributes based on insertion of Vertex.</span>
</span><span id="Tile-1720"><a href="#Tile-1720"><span class="linenos">1720</span></a>
</span><span id="Tile-1721"><a href="#Tile-1721"><span class="linenos">1721</span></a><span class="sd">    If new_edge is supplied then the neighbour tile at v has already created</span>
</span><span id="Tile-1722"><a href="#Tile-1722"><span class="linenos">1722</span></a><span class="sd">    the needed new Edge and this Edge is the one that will be &#39;slotted in&#39; at</span>
</span><span id="Tile-1723"><a href="#Tile-1723"><span class="linenos">1723</span></a><span class="sd">    the appropriate spot in the edges list.</span>
</span><span id="Tile-1724"><a href="#Tile-1724"><span class="linenos">1724</span></a>
</span><span id="Tile-1725"><a href="#Tile-1725"><span class="linenos">1725</span></a><span class="sd">    The edges_CW is also updated to maintain correct directions of the edges.</span>
</span><span id="Tile-1726"><a href="#Tile-1726"><span class="linenos">1726</span></a><span class="sd">    The corners attribute is unaffected by these changes.</span>
</span><span id="Tile-1727"><a href="#Tile-1727"><span class="linenos">1727</span></a>
</span><span id="Tile-1728"><a href="#Tile-1728"><span class="linenos">1728</span></a><span class="sd">    Args:</span>
</span><span id="Tile-1729"><a href="#Tile-1729"><span class="linenos">1729</span></a><span class="sd">      v (Vertex): existing Vertex at which to carry out the merge.</span>
</span><span id="Tile-1730"><a href="#Tile-1730"><span class="linenos">1730</span></a><span class="sd">      new_edge (Edge, optional): if another Tile has already carried out this</span>
</span><span id="Tile-1731"><a href="#Tile-1731"><span class="linenos">1731</span></a><span class="sd">        merge this should be the resulting new Edge for insertion into this</span>
</span><span id="Tile-1732"><a href="#Tile-1732"><span class="linenos">1732</span></a><span class="sd">        Tile. Defaults to None (when the new Edge will be constructed).</span>
</span><span id="Tile-1733"><a href="#Tile-1733"><span class="linenos">1733</span></a>
</span><span id="Tile-1734"><a href="#Tile-1734"><span class="linenos">1734</span></a><span class="sd">    Returns:</span>
</span><span id="Tile-1735"><a href="#Tile-1735"><span class="linenos">1735</span></a><span class="sd">      None|tuple: either None (if a new edge was supplied) or a tuple</span>
</span><span id="Tile-1736"><a href="#Tile-1736"><span class="linenos">1736</span></a><span class="sd">        of the two edge IDs to be removed and the new edge added for return to</span>
</span><span id="Tile-1737"><a href="#Tile-1737"><span class="linenos">1737</span></a><span class="sd">        the calling context (i.e. the containing Topology).</span>
</span><span id="Tile-1738"><a href="#Tile-1738"><span class="linenos">1738</span></a>
</span><span id="Tile-1739"><a href="#Tile-1739"><span class="linenos">1739</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Tile-1740"><a href="#Tile-1740"><span class="linenos">1740</span></a>    <span class="c1"># get the two edge list index positions in which Vertex v is found</span>
</span><span id="Tile-1741"><a href="#Tile-1741"><span class="linenos">1741</span></a>    <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_edge_IDs_including_vertex</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
</span><span id="Tile-1742"><a href="#Tile-1742"><span class="linenos">1742</span></a>    <span class="k">if</span> <span class="n">new_edge</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="c1"># then we must make a new one</span>
</span><span id="Tile-1743"><a href="#Tile-1743"><span class="linenos">1743</span></a>      <span class="c1"># also record existing edge IDs to be removed</span>
</span><span id="Tile-1744"><a href="#Tile-1744"><span class="linenos">1744</span></a>      <span class="n">to_remove</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">ID</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">ID</span><span class="p">]</span>
</span><span id="Tile-1745"><a href="#Tile-1745"><span class="linenos">1745</span></a>      <span class="n">new_edge</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_merged_edge</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span>
</span><span id="Tile-1746"><a href="#Tile-1746"><span class="linenos">1746</span></a>      <span class="n">return_edge_updates</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="Tile-1747"><a href="#Tile-1747"><span class="linenos">1747</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="Tile-1748"><a href="#Tile-1748"><span class="linenos">1748</span></a>      <span class="n">return_edge_updates</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="Tile-1749"><a href="#Tile-1749"><span class="linenos">1749</span></a>    <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">i</span> <span class="o">-</span> <span class="n">j</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="Tile-1750"><a href="#Tile-1750"><span class="linenos">1750</span></a>      <span class="c1"># edge indices &#39;wrap&#39; around from end of edge list to start so drop</span>
</span><span id="Tile-1751"><a href="#Tile-1751"><span class="linenos">1751</span></a>      <span class="c1"># first and last current edges and stick new one on at the end</span>
</span><span id="Tile-1752"><a href="#Tile-1752"><span class="linenos">1752</span></a>      <span class="bp">self</span><span class="o">.</span><span class="n">edges</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="n">new_edge</span><span class="p">]</span>
</span><span id="Tile-1753"><a href="#Tile-1753"><span class="linenos">1753</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="Tile-1754"><a href="#Tile-1754"><span class="linenos">1754</span></a>      <span class="c1"># insert new edge into list in place of the two old ones</span>
</span><span id="Tile-1755"><a href="#Tile-1755"><span class="linenos">1755</span></a>      <span class="bp">self</span><span class="o">.</span><span class="n">edges</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">[:</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="n">new_edge</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">:]</span>
</span><span id="Tile-1756"><a href="#Tile-1756"><span class="linenos">1756</span></a>    <span class="c1"># update the edge directions</span>
</span><span id="Tile-1757"><a href="#Tile-1757"><span class="linenos">1757</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">set_edge_directions</span><span class="p">()</span>
</span><span id="Tile-1758"><a href="#Tile-1758"><span class="linenos">1758</span></a>    <span class="k">if</span> <span class="n">return_edge_updates</span><span class="p">:</span>
</span><span id="Tile-1759"><a href="#Tile-1759"><span class="linenos">1759</span></a>      <span class="k">return</span> <span class="n">to_remove</span><span class="p">,</span> <span class="n">new_edge</span>
</span><span id="Tile-1760"><a href="#Tile-1760"><span class="linenos">1760</span></a>    <span class="k">return</span> <span class="kc">None</span>
</span><span id="Tile-1761"><a href="#Tile-1761"><span class="linenos">1761</span></a>
</span><span id="Tile-1762"><a href="#Tile-1762"><span class="linenos">1762</span></a>
</span><span id="Tile-1763"><a href="#Tile-1763"><span class="linenos">1763</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">get_edge_IDs_including_vertex</span><span class="p">(</span>
</span><span id="Tile-1764"><a href="#Tile-1764"><span class="linenos">1764</span></a>      <span class="bp">self</span><span class="p">,</span>
</span><span id="Tile-1765"><a href="#Tile-1765"><span class="linenos">1765</span></a>      <span class="n">v</span><span class="p">:</span><span class="n">Vertex</span><span class="p">,</span>
</span><span id="Tile-1766"><a href="#Tile-1766"><span class="linenos">1766</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
</span><span id="Tile-1767"><a href="#Tile-1767"><span class="linenos">1767</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the (two) index positions of the edges that include supplied Vertex.</span>
</span><span id="Tile-1768"><a href="#Tile-1768"><span class="linenos">1768</span></a>
</span><span id="Tile-1769"><a href="#Tile-1769"><span class="linenos">1769</span></a><span class="sd">    Args:</span>
</span><span id="Tile-1770"><a href="#Tile-1770"><span class="linenos">1770</span></a><span class="sd">        v (Vertex): Vertex of interest.</span>
</span><span id="Tile-1771"><a href="#Tile-1771"><span class="linenos">1771</span></a>
</span><span id="Tile-1772"><a href="#Tile-1772"><span class="linenos">1772</span></a><span class="sd">    Returns:</span>
</span><span id="Tile-1773"><a href="#Tile-1773"><span class="linenos">1773</span></a><span class="sd">      tuple[int]: two index positions of Edges in edges list that contain v.</span>
</span><span id="Tile-1774"><a href="#Tile-1774"><span class="linenos">1774</span></a>
</span><span id="Tile-1775"><a href="#Tile-1775"><span class="linenos">1775</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Tile-1776"><a href="#Tile-1776"><span class="linenos">1776</span></a>    <span class="k">return</span> <span class="p">(</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">e</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">)</span> <span class="k">if</span> <span class="n">v</span><span class="o">.</span><span class="n">ID</span> <span class="ow">in</span> <span class="n">e</span><span class="o">.</span><span class="n">ID</span><span class="p">)</span>
</span><span id="Tile-1777"><a href="#Tile-1777"><span class="linenos">1777</span></a>
</span><span id="Tile-1778"><a href="#Tile-1778"><span class="linenos">1778</span></a>
</span><span id="Tile-1779"><a href="#Tile-1779"><span class="linenos">1779</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">get_merged_edge</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">:</span><span class="nb">int</span><span class="p">,</span> <span class="n">j</span><span class="p">:</span><span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Edge</span><span class="p">:</span>
</span><span id="Tile-1780"><a href="#Tile-1780"><span class="linenos">1780</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return edge made by merging existing edges at i and j in the edges list.</span>
</span><span id="Tile-1781"><a href="#Tile-1781"><span class="linenos">1781</span></a>
</span><span id="Tile-1782"><a href="#Tile-1782"><span class="linenos">1782</span></a><span class="sd">    For example, if the current list of edge IDs was</span>
</span><span id="Tile-1783"><a href="#Tile-1783"><span class="linenos">1783</span></a>
</span><span id="Tile-1784"><a href="#Tile-1784"><span class="linenos">1784</span></a><span class="sd">        (0 1 2) (4 2) (4 5) (5 0)</span>
</span><span id="Tile-1785"><a href="#Tile-1785"><span class="linenos">1785</span></a>
</span><span id="Tile-1786"><a href="#Tile-1786"><span class="linenos">1786</span></a><span class="sd">    and the merge requested is 0 and 1, the resulting new edge is constructed</span>
</span><span id="Tile-1787"><a href="#Tile-1787"><span class="linenos">1787</span></a><span class="sd">    from vertices (0 1 2 4).</span>
</span><span id="Tile-1788"><a href="#Tile-1788"><span class="linenos">1788</span></a>
</span><span id="Tile-1789"><a href="#Tile-1789"><span class="linenos">1789</span></a><span class="sd">    Returns:</span>
</span><span id="Tile-1790"><a href="#Tile-1790"><span class="linenos">1790</span></a><span class="sd">      Edge: the requested new Edge.</span>
</span><span id="Tile-1791"><a href="#Tile-1791"><span class="linenos">1791</span></a>
</span><span id="Tile-1792"><a href="#Tile-1792"><span class="linenos">1792</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Tile-1793"><a href="#Tile-1793"><span class="linenos">1793</span></a>    <span class="c1"># if i and j are not consecutive, then j is predecessor edge</span>
</span><span id="Tile-1794"><a href="#Tile-1794"><span class="linenos">1794</span></a>    <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">i</span> <span class="o">-</span> <span class="n">j</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="Tile-1795"><a href="#Tile-1795"><span class="linenos">1795</span></a>      <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="n">j</span><span class="p">,</span> <span class="n">i</span>
</span><span id="Tile-1796"><a href="#Tile-1796"><span class="linenos">1796</span></a>    <span class="c1"># get edges and their directions</span>
</span><span id="Tile-1797"><a href="#Tile-1797"><span class="linenos">1797</span></a>    <span class="n">ei</span><span class="p">,</span> <span class="n">ej</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
</span><span id="Tile-1798"><a href="#Tile-1798"><span class="linenos">1798</span></a>    <span class="n">CWi</span><span class="p">,</span> <span class="n">CWj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges_CW</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges_CW</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
</span><span id="Tile-1799"><a href="#Tile-1799"><span class="linenos">1799</span></a>    <span class="c1"># DON&#39;T MESS WITH THIS!!!</span>
</span><span id="Tile-1800"><a href="#Tile-1800"><span class="linenos">1800</span></a>    <span class="c1"># for predecessors (the head) we want everything including the Vertex</span>
</span><span id="Tile-1801"><a href="#Tile-1801"><span class="linenos">1801</span></a>    <span class="c1"># where the merge is occurring; for successors (the tail) we want all but</span>
</span><span id="Tile-1802"><a href="#Tile-1802"><span class="linenos">1802</span></a>    <span class="c1"># the first Vertex (which is the one where the merge is occurring). In both</span>
</span><span id="Tile-1803"><a href="#Tile-1803"><span class="linenos">1803</span></a>    <span class="c1"># cases contingent on whether existing Edges are CW or CCW we may need to</span>
</span><span id="Tile-1804"><a href="#Tile-1804"><span class="linenos">1804</span></a>    <span class="c1"># flip the Vertex sequence to ensure that the merge Vertex is in the middle</span>
</span><span id="Tile-1805"><a href="#Tile-1805"><span class="linenos">1805</span></a>    <span class="c1"># of the new edge that will be created</span>
</span><span id="Tile-1806"><a href="#Tile-1806"><span class="linenos">1806</span></a>    <span class="n">head</span> <span class="o">=</span> <span class="n">ei</span><span class="o">.</span><span class="n">corners</span> <span class="k">if</span> <span class="n">CWi</span> <span class="k">else</span> <span class="n">ei</span><span class="o">.</span><span class="n">corners</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="Tile-1807"><a href="#Tile-1807"><span class="linenos">1807</span></a>    <span class="n">tail</span> <span class="o">=</span> <span class="n">ej</span><span class="o">.</span><span class="n">corners</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="k">if</span> <span class="n">CWj</span> <span class="k">else</span> <span class="n">ej</span><span class="o">.</span><span class="n">corners</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">:]</span>
</span><span id="Tile-1808"><a href="#Tile-1808"><span class="linenos">1808</span></a>    <span class="n">v_sequence</span> <span class="o">=</span> <span class="p">(</span><span class="n">head</span> <span class="k">if</span> <span class="n">CWi</span> <span class="k">else</span> <span class="n">head</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="p">(</span><span class="n">tail</span> <span class="k">if</span> <span class="n">CWj</span> <span class="k">else</span> <span class="n">tail</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</span><span id="Tile-1809"><a href="#Tile-1809"><span class="linenos">1809</span></a>    <span class="k">return</span> <span class="n">Edge</span><span class="p">(</span><span class="n">v_sequence</span><span class="p">)</span>
</span><span id="Tile-1810"><a href="#Tile-1810"><span class="linenos">1810</span></a>
</span><span id="Tile-1811"><a href="#Tile-1811"><span class="linenos">1811</span></a>
</span><span id="Tile-1812"><a href="#Tile-1812"><span class="linenos">1812</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">offset_corners</span><span class="p">(</span>
</span><span id="Tile-1813"><a href="#Tile-1813"><span class="linenos">1813</span></a>      <span class="bp">self</span><span class="p">,</span>
</span><span id="Tile-1814"><a href="#Tile-1814"><span class="linenos">1814</span></a>      <span class="n">offset</span><span class="p">:</span><span class="nb">int</span><span class="p">,</span>
</span><span id="Tile-1815"><a href="#Tile-1815"><span class="linenos">1815</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Tile-1816"><a href="#Tile-1816"><span class="linenos">1816</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Shift shape, corners, edges, and edges_CW by an offset amount.</span>
</span><span id="Tile-1817"><a href="#Tile-1817"><span class="linenos">1817</span></a>
</span><span id="Tile-1818"><a href="#Tile-1818"><span class="linenos">1818</span></a><span class="sd">    This is used to align tiles that are similar, which is required for correct</span>
</span><span id="Tile-1819"><a href="#Tile-1819"><span class="linenos">1819</span></a><span class="sd">    transfer of &#39;base&#39; tile labelling on to &#39;radius 1&#39; tiles during Topology</span>
</span><span id="Tile-1820"><a href="#Tile-1820"><span class="linenos">1820</span></a><span class="sd">    construction.</span>
</span><span id="Tile-1821"><a href="#Tile-1821"><span class="linenos">1821</span></a>
</span><span id="Tile-1822"><a href="#Tile-1822"><span class="linenos">1822</span></a><span class="sd">    Args:</span>
</span><span id="Tile-1823"><a href="#Tile-1823"><span class="linenos">1823</span></a><span class="sd">      offset (int): the number of positions to shift the lists.</span>
</span><span id="Tile-1824"><a href="#Tile-1824"><span class="linenos">1824</span></a>
</span><span id="Tile-1825"><a href="#Tile-1825"><span class="linenos">1825</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Tile-1826"><a href="#Tile-1826"><span class="linenos">1826</span></a>    <span class="k">if</span> <span class="n">offset</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">offset</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Tile-1827"><a href="#Tile-1827"><span class="linenos">1827</span></a>      <span class="bp">self</span><span class="o">.</span><span class="n">corners</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">corners</span><span class="p">[</span><span class="n">offset</span><span class="p">:]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">corners</span><span class="p">[:</span><span class="n">offset</span><span class="p">]</span>
</span><span id="Tile-1828"><a href="#Tile-1828"><span class="linenos">1828</span></a>      <span class="bp">self</span><span class="o">.</span><span class="n">shape</span> <span class="o">=</span> <span class="n">geom</span><span class="o">.</span><span class="n">Polygon</span><span class="p">([</span><span class="n">c</span><span class="o">.</span><span class="n">point</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">corners</span><span class="p">])</span>
</span><span id="Tile-1829"><a href="#Tile-1829"><span class="linenos">1829</span></a>      <span class="bp">self</span><span class="o">.</span><span class="n">edges</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">offset</span><span class="p">:]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">[:</span><span class="n">offset</span><span class="p">]</span>
</span><span id="Tile-1830"><a href="#Tile-1830"><span class="linenos">1830</span></a>      <span class="bp">self</span><span class="o">.</span><span class="n">edges_CW</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges_CW</span><span class="p">[</span><span class="n">offset</span><span class="p">:]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges_CW</span><span class="p">[:</span><span class="n">offset</span><span class="p">]</span>
</span><span id="Tile-1831"><a href="#Tile-1831"><span class="linenos">1831</span></a>
</span><span id="Tile-1832"><a href="#Tile-1832"><span class="linenos">1832</span></a>
</span><span id="Tile-1833"><a href="#Tile-1833"><span class="linenos">1833</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">get_edge_label</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">e</span><span class="p">:</span><span class="n">Edge</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="Tile-1834"><a href="#Tile-1834"><span class="linenos">1834</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return edge label of specified edge.</span>
</span><span id="Tile-1835"><a href="#Tile-1835"><span class="linenos">1835</span></a>
</span><span id="Tile-1836"><a href="#Tile-1836"><span class="linenos">1836</span></a><span class="sd">    Args:</span>
</span><span id="Tile-1837"><a href="#Tile-1837"><span class="linenos">1837</span></a><span class="sd">        e (Edge): Edge whose label is required.</span>
</span><span id="Tile-1838"><a href="#Tile-1838"><span class="linenos">1838</span></a>
</span><span id="Tile-1839"><a href="#Tile-1839"><span class="linenos">1839</span></a><span class="sd">    Returns:</span>
</span><span id="Tile-1840"><a href="#Tile-1840"><span class="linenos">1840</span></a><span class="sd">        str: requested edge label.</span>
</span><span id="Tile-1841"><a href="#Tile-1841"><span class="linenos">1841</span></a>
</span><span id="Tile-1842"><a href="#Tile-1842"><span class="linenos">1842</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Tile-1843"><a href="#Tile-1843"><span class="linenos">1843</span></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">edge_labels</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">get_edge_IDs</span><span class="p">()</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">ID</span><span class="p">)]</span>
</span><span id="Tile-1844"><a href="#Tile-1844"><span class="linenos">1844</span></a>
</span><span id="Tile-1845"><a href="#Tile-1845"><span class="linenos">1845</span></a>
</span><span id="Tile-1846"><a href="#Tile-1846"><span class="linenos">1846</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">get_corner_label</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">v</span><span class="p">:</span><span class="n">Vertex</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="Tile-1847"><a href="#Tile-1847"><span class="linenos">1847</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return corner label of specified corner.</span>
</span><span id="Tile-1848"><a href="#Tile-1848"><span class="linenos">1848</span></a>
</span><span id="Tile-1849"><a href="#Tile-1849"><span class="linenos">1849</span></a><span class="sd">    Args:</span>
</span><span id="Tile-1850"><a href="#Tile-1850"><span class="linenos">1850</span></a><span class="sd">        v (Vertex): corner whose label is required.</span>
</span><span id="Tile-1851"><a href="#Tile-1851"><span class="linenos">1851</span></a>
</span><span id="Tile-1852"><a href="#Tile-1852"><span class="linenos">1852</span></a><span class="sd">    Returns:</span>
</span><span id="Tile-1853"><a href="#Tile-1853"><span class="linenos">1853</span></a><span class="sd">        str: requested corner label.</span>
</span><span id="Tile-1854"><a href="#Tile-1854"><span class="linenos">1854</span></a>
</span><span id="Tile-1855"><a href="#Tile-1855"><span class="linenos">1855</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Tile-1856"><a href="#Tile-1856"><span class="linenos">1856</span></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">edge_labels</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">get_corner_IDs</span><span class="p">()</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">ID</span><span class="p">)]</span>
</span><span id="Tile-1857"><a href="#Tile-1857"><span class="linenos">1857</span></a>
</span><span id="Tile-1858"><a href="#Tile-1858"><span class="linenos">1858</span></a>
</span><span id="Tile-1859"><a href="#Tile-1859"><span class="linenos">1859</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">angle_at</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">v</span><span class="p">:</span><span class="n">Vertex</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="Tile-1860"><a href="#Tile-1860"><span class="linenos">1860</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return interior angle at the specified corner (in degrees).</span>
</span><span id="Tile-1861"><a href="#Tile-1861"><span class="linenos">1861</span></a>
</span><span id="Tile-1862"><a href="#Tile-1862"><span class="linenos">1862</span></a><span class="sd">    Args:</span>
</span><span id="Tile-1863"><a href="#Tile-1863"><span class="linenos">1863</span></a><span class="sd">        v (Vertex): corner where angle is requested.</span>
</span><span id="Tile-1864"><a href="#Tile-1864"><span class="linenos">1864</span></a>
</span><span id="Tile-1865"><a href="#Tile-1865"><span class="linenos">1865</span></a><span class="sd">    Returns:</span>
</span><span id="Tile-1866"><a href="#Tile-1866"><span class="linenos">1866</span></a><span class="sd">        float: angle at corner v in degrees.</span>
</span><span id="Tile-1867"><a href="#Tile-1867"><span class="linenos">1867</span></a>
</span><span id="Tile-1868"><a href="#Tile-1868"><span class="linenos">1868</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Tile-1869"><a href="#Tile-1869"><span class="linenos">1869</span></a>    <span class="n">i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">corners</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
</span><span id="Tile-1870"><a href="#Tile-1870"><span class="linenos">1870</span></a>    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">corners</span><span class="p">)</span>
</span><span id="Tile-1871"><a href="#Tile-1871"><span class="linenos">1871</span></a>    <span class="k">return</span> <span class="n">tiling_utils</span><span class="o">.</span><span class="n">get_inner_angle</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">corners</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">point</span><span class="p">,</span>
</span><span id="Tile-1872"><a href="#Tile-1872"><span class="linenos">1872</span></a>                                        <span class="bp">self</span><span class="o">.</span><span class="n">corners</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">point</span><span class="p">,</span>
</span><span id="Tile-1873"><a href="#Tile-1873"><span class="linenos">1873</span></a>                                        <span class="bp">self</span><span class="o">.</span><span class="n">corners</span><span class="p">[(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="n">n</span><span class="p">]</span><span class="o">.</span><span class="n">point</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Class to represent essential features of polygons in a tiling.</p>
</div>


                            <div id="Tile.__init__" class="classattr">
                                        <input id="Tile.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">Tile</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">ID</span><span class="p">:</span> <span class="nb">int</span></span>)</span>

                <label class="view-source-button" for="Tile.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Tile.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Tile.__init__-1539"><a href="#Tile.__init__-1539"><span class="linenos">1539</span></a>  <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="Tile.__init__-1540"><a href="#Tile.__init__-1540"><span class="linenos">1540</span></a>      <span class="bp">self</span><span class="p">,</span>
</span><span id="Tile.__init__-1541"><a href="#Tile.__init__-1541"><span class="linenos">1541</span></a>      <span class="n">ID</span><span class="p">:</span><span class="nb">int</span><span class="p">,</span>
</span><span id="Tile.__init__-1542"><a href="#Tile.__init__-1542"><span class="linenos">1542</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Tile.__init__-1543"><a href="#Tile.__init__-1543"><span class="linenos">1543</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Class constructor.</span>
</span><span id="Tile.__init__-1544"><a href="#Tile.__init__-1544"><span class="linenos">1544</span></a>
</span><span id="Tile.__init__-1545"><a href="#Tile.__init__-1545"><span class="linenos">1545</span></a><span class="sd">    Args:</span>
</span><span id="Tile.__init__-1546"><a href="#Tile.__init__-1546"><span class="linenos">1546</span></a><span class="sd">      ID (int): sequence number ID of this vertex in the Topology.</span>
</span><span id="Tile.__init__-1547"><a href="#Tile.__init__-1547"><span class="linenos">1547</span></a>
</span><span id="Tile.__init__-1548"><a href="#Tile.__init__-1548"><span class="linenos">1548</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Tile.__init__-1549"><a href="#Tile.__init__-1549"><span class="linenos">1549</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">ID</span> <span class="o">=</span> <span class="n">ID</span>
</span><span id="Tile.__init__-1550"><a href="#Tile.__init__-1550"><span class="linenos">1550</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">corners</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Tile.__init__-1551"><a href="#Tile.__init__-1551"><span class="linenos">1551</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">edges</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Tile.__init__-1552"><a href="#Tile.__init__-1552"><span class="linenos">1552</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">edges_CW</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Tile.__init__-1553"><a href="#Tile.__init__-1553"><span class="linenos">1553</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">vertex_labels</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Tile.__init__-1554"><a href="#Tile.__init__-1554"><span class="linenos">1554</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">edge_labels</span> <span class="o">=</span> <span class="p">[]</span>
</span></pre></div>


            <div class="docstring"><p>Class constructor.</p>

<p>Args:
  ID (int): sequence number ID of this vertex in the Topology.</p>
</div>


                            </div>
                            <div id="Tile.ID" class="classattr">
                                <div class="attr variable">
            <span class="name">ID</span><span class="annotation">: int</span>

        
    </div>
    <a class="headerlink" href="#Tile.ID"></a>
    
            <div class="docstring"><p>integer ID number which indexes the Tile in the containing Topology tiles
list.</p>
</div>


                            </div>
                            <div id="Tile.base_ID" class="classattr">
                                <div class="attr variable">
            <span class="name">base_ID</span><span class="annotation">: int</span>

        
    </div>
    <a class="headerlink" href="#Tile.base_ID"></a>
    
            <div class="docstring"><p>ID of corresponding Tile in the base tileable unit</p>
</div>


                            </div>
                            <div id="Tile.corners" class="classattr">
                                <div class="attr variable">
            <span class="name">corners</span><span class="annotation">: list[<a href="#Vertex">Vertex</a>]</span>

        
    </div>
    <a class="headerlink" href="#Tile.corners"></a>
    
            <div class="docstring"><p>list of Vertex objects. This includes all corners of the original polygon
and any tiling vertices induced by (for example) a the corner of an adjacent
tile lying halfway along an edge of the original polygon on which this tile
is based. Vertex objects are stored in strictly clockwise sequence.</p>
</div>


                            </div>
                            <div id="Tile.edges" class="classattr">
                                <div class="attr variable">
            <span class="name">edges</span><span class="annotation">: list[<a href="#Edge">Edge</a>]</span>

        
    </div>
    <a class="headerlink" href="#Tile.edges"></a>
    
            <div class="docstring"><p>list of Edge objects that together compose the tile boundary.</p>
</div>


                            </div>
                            <div id="Tile.edges_CW" class="classattr">
                                <div class="attr variable">
            <span class="name">edges_CW</span><span class="annotation">: list[bool]</span>

        
    </div>
    <a class="headerlink" href="#Tile.edges_CW"></a>
    
            <div class="docstring"><p>list of Edge direction. Edges are stored only once in a Topology so some
edges are in clockwise order and others  are in counter-clockwise order.
These boolean flags are True if the corresponding Edge is clockwise, False if
counter-clockwise.</p>
</div>


                            </div>
                            <div id="Tile.label" class="classattr">
                                <div class="attr variable">
            <span class="name">label</span><span class="annotation">: str</span>

        
    </div>
    <a class="headerlink" href="#Tile.label"></a>
    
            <div class="docstring"><p>tile_id label from the tileable source</p>
</div>


                            </div>
                            <div id="Tile.vertex_labels" class="classattr">
                                <div class="attr variable">
            <span class="name">vertex_labels</span><span class="annotation">: list[str]</span>

        
    </div>
    <a class="headerlink" href="#Tile.vertex_labels"></a>
    
            <div class="docstring"><p>list of (upper case) letter labels of the tile corners (i.e. all corners,
not only tiling vertices).</p>
</div>


                            </div>
                            <div id="Tile.edge_labels" class="classattr">
                                <div class="attr variable">
            <span class="name">edge_labels</span><span class="annotation">: list[str]</span>

        
    </div>
    <a class="headerlink" href="#Tile.edge_labels"></a>
    
            <div class="docstring"><p>list of (lower case) letter labels of the tile edges (tiling edges, not
tile sides).</p>
</div>


                            </div>
                            <div id="Tile.shape" class="classattr">
                                <div class="attr variable">
            <span class="name">shape</span><span class="annotation">: shapely.geometry.polygon.Polygon</span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#Tile.shape"></a>
    
            <div class="docstring"><p>the tile geometry (which may include some redundant points along sides
where neighbouring tiles induce a tiling vertex). So for example a rectangle
might have additional points along its sides:</p>

<pre><code>  +---+-------+
  |   |   2   |
  | 1 A---B---E---+
  |   |   |   4   |
  +---C 3 D-------+
      |   |
      +---+
</code></pre>

<p>In the above Tile 1 has additional point A, 2 has B and 3 has C and D induced
by the corners of neighbouring tiles.</p>
</div>


                            </div>
                            <div id="Tile.centre" class="classattr">
                                <div class="attr variable">
            <span class="name">centre</span><span class="annotation">: shapely.geometry.point.Point</span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#Tile.centre"></a>
    
            <div class="docstring"><p>a point centre for the Tile (determined by <a href="tiling_utils.html">weavingspace.tiling_utils</a>.
incentre).</p>
</div>


                            </div>
                            <div id="Tile.shape_group" class="classattr">
                                <div class="attr variable">
            <span class="name">shape_group</span><span class="annotation">: int</span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#Tile.shape_group"></a>
    
            <div class="docstring"><p>the tile shape group of this tile in its containing Topology.</p>
</div>


                            </div>
                            <div id="Tile.transitivity_class" class="classattr">
                                <div class="attr variable">
            <span class="name">transitivity_class</span><span class="annotation">: int</span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#Tile.transitivity_class"></a>
    
            <div class="docstring"><p>the tile transitivity class of this tile its containing Topology</p>
</div>


                            </div>
                            <div id="Tile.get_corner_IDs" class="classattr">
                                        <input id="Tile.get_corner_IDs-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_corner_IDs</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="Tile.get_corner_IDs-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Tile.get_corner_IDs"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Tile.get_corner_IDs-1573"><a href="#Tile.get_corner_IDs-1573"><span class="linenos">1573</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">get_corner_IDs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
</span><span id="Tile.get_corner_IDs-1574"><a href="#Tile.get_corner_IDs-1574"><span class="linenos">1574</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return list of corner IDs (not Vertex objects).</span>
</span><span id="Tile.get_corner_IDs-1575"><a href="#Tile.get_corner_IDs-1575"><span class="linenos">1575</span></a>
</span><span id="Tile.get_corner_IDs-1576"><a href="#Tile.get_corner_IDs-1576"><span class="linenos">1576</span></a><span class="sd">    Returns:</span>
</span><span id="Tile.get_corner_IDs-1577"><a href="#Tile.get_corner_IDs-1577"><span class="linenos">1577</span></a><span class="sd">      list[int]: list of integer IDs of tile corners.</span>
</span><span id="Tile.get_corner_IDs-1578"><a href="#Tile.get_corner_IDs-1578"><span class="linenos">1578</span></a>
</span><span id="Tile.get_corner_IDs-1579"><a href="#Tile.get_corner_IDs-1579"><span class="linenos">1579</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Tile.get_corner_IDs-1580"><a href="#Tile.get_corner_IDs-1580"><span class="linenos">1580</span></a>    <span class="k">return</span> <span class="p">[</span><span class="n">c</span><span class="o">.</span><span class="n">ID</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">corners</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Return list of corner IDs (not Vertex objects).</p>

<p>Returns:
  list[int]: list of integer IDs of tile corners.</p>
</div>


                            </div>
                            <div id="Tile.get_edge_IDs" class="classattr">
                                        <input id="Tile.get_edge_IDs-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_edge_IDs</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]</span>:</span></span>

                <label class="view-source-button" for="Tile.get_edge_IDs-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Tile.get_edge_IDs"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Tile.get_edge_IDs-1583"><a href="#Tile.get_edge_IDs-1583"><span class="linenos">1583</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">get_edge_IDs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span><span class="nb">int</span><span class="p">]]:</span>
</span><span id="Tile.get_edge_IDs-1584"><a href="#Tile.get_edge_IDs-1584"><span class="linenos">1584</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return list of edge IDs (not Edge objects).</span>
</span><span id="Tile.get_edge_IDs-1585"><a href="#Tile.get_edge_IDs-1585"><span class="linenos">1585</span></a>
</span><span id="Tile.get_edge_IDs-1586"><a href="#Tile.get_edge_IDs-1586"><span class="linenos">1586</span></a><span class="sd">    Returns:</span>
</span><span id="Tile.get_edge_IDs-1587"><a href="#Tile.get_edge_IDs-1587"><span class="linenos">1587</span></a><span class="sd">      list[tuple[int]]: list of 2-element tuples of the start and end Vertex IDs</span>
</span><span id="Tile.get_edge_IDs-1588"><a href="#Tile.get_edge_IDs-1588"><span class="linenos">1588</span></a><span class="sd">        of each edge.</span>
</span><span id="Tile.get_edge_IDs-1589"><a href="#Tile.get_edge_IDs-1589"><span class="linenos">1589</span></a>
</span><span id="Tile.get_edge_IDs-1590"><a href="#Tile.get_edge_IDs-1590"><span class="linenos">1590</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Tile.get_edge_IDs-1591"><a href="#Tile.get_edge_IDs-1591"><span class="linenos">1591</span></a>    <span class="k">return</span> <span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">ID</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Return list of edge IDs (not Edge objects).</p>

<p>Returns:
  list[tuple[int]]: list of 2-element tuples of the start and end Vertex IDs
    of each edge.</p>
</div>


                            </div>
                            <div id="Tile.set_shape_from_corners" class="classattr">
                                        <input id="Tile.set_shape_from_corners-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">set_shape_from_corners</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="Tile.set_shape_from_corners-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Tile.set_shape_from_corners"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Tile.set_shape_from_corners-1594"><a href="#Tile.set_shape_from_corners-1594"><span class="linenos">1594</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">set_shape_from_corners</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Tile.set_shape_from_corners-1595"><a href="#Tile.set_shape_from_corners-1595"><span class="linenos">1595</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Set the shape attribute based on corners, and associated tile centre.&quot;&quot;&quot;</span>
</span><span id="Tile.set_shape_from_corners-1596"><a href="#Tile.set_shape_from_corners-1596"><span class="linenos">1596</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">shape</span> <span class="o">=</span> <span class="n">geom</span><span class="o">.</span><span class="n">Polygon</span><span class="p">([</span><span class="n">c</span><span class="o">.</span><span class="n">point</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">corners</span><span class="p">])</span>
</span><span id="Tile.set_shape_from_corners-1597"><a href="#Tile.set_shape_from_corners-1597"><span class="linenos">1597</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">centre</span> <span class="o">=</span> <span class="n">tiling_utils</span><span class="o">.</span><span class="n">get_incentre</span><span class="p">(</span>
</span><span id="Tile.set_shape_from_corners-1598"><a href="#Tile.set_shape_from_corners-1598"><span class="linenos">1598</span></a>      <span class="n">tiling_utils</span><span class="o">.</span><span class="n">get_clean_polygon</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
</span></pre></div>


            <div class="docstring"><p>Set the shape attribute based on corners, and associated tile centre.</p>
</div>


                            </div>
                            <div id="Tile.set_corners_from_edges" class="classattr">
                                        <input id="Tile.set_corners_from_edges-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">set_corners_from_edges</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">update_shape</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span></span><span class="return-annotation">) -> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="Tile.set_corners_from_edges-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Tile.set_corners_from_edges"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Tile.set_corners_from_edges-1601"><a href="#Tile.set_corners_from_edges-1601"><span class="linenos">1601</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">set_corners_from_edges</span><span class="p">(</span>
</span><span id="Tile.set_corners_from_edges-1602"><a href="#Tile.set_corners_from_edges-1602"><span class="linenos">1602</span></a>      <span class="bp">self</span><span class="p">,</span>
</span><span id="Tile.set_corners_from_edges-1603"><a href="#Tile.set_corners_from_edges-1603"><span class="linenos">1603</span></a>      <span class="n">update_shape</span><span class="p">:</span><span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="Tile.set_corners_from_edges-1604"><a href="#Tile.set_corners_from_edges-1604"><span class="linenos">1604</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Tile.set_corners_from_edges-1605"><a href="#Tile.set_corners_from_edges-1605"><span class="linenos">1605</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Set corners attribute from the edges attribute.</span>
</span><span id="Tile.set_corners_from_edges-1606"><a href="#Tile.set_corners_from_edges-1606"><span class="linenos">1606</span></a>
</span><span id="Tile.set_corners_from_edges-1607"><a href="#Tile.set_corners_from_edges-1607"><span class="linenos">1607</span></a><span class="sd">    Typically called after modification of topology edges. Optionally the shape</span>
</span><span id="Tile.set_corners_from_edges-1608"><a href="#Tile.set_corners_from_edges-1608"><span class="linenos">1608</span></a><span class="sd">    attribute is NOT updated, which may save time when multiple changes to the</span>
</span><span id="Tile.set_corners_from_edges-1609"><a href="#Tile.set_corners_from_edges-1609"><span class="linenos">1609</span></a><span class="sd">    edges of a tile are in process (i.e., only update the shape after all</span>
</span><span id="Tile.set_corners_from_edges-1610"><a href="#Tile.set_corners_from_edges-1610"><span class="linenos">1610</span></a><span class="sd">    changes are complete).</span>
</span><span id="Tile.set_corners_from_edges-1611"><a href="#Tile.set_corners_from_edges-1611"><span class="linenos">1611</span></a>
</span><span id="Tile.set_corners_from_edges-1612"><a href="#Tile.set_corners_from_edges-1612"><span class="linenos">1612</span></a><span class="sd">    Args:</span>
</span><span id="Tile.set_corners_from_edges-1613"><a href="#Tile.set_corners_from_edges-1613"><span class="linenos">1613</span></a><span class="sd">      update_shape (bool, optional): if True the shape attribute will be</span>
</span><span id="Tile.set_corners_from_edges-1614"><a href="#Tile.set_corners_from_edges-1614"><span class="linenos">1614</span></a><span class="sd">        updated, otherwise not. Defaults to True.</span>
</span><span id="Tile.set_corners_from_edges-1615"><a href="#Tile.set_corners_from_edges-1615"><span class="linenos">1615</span></a>
</span><span id="Tile.set_corners_from_edges-1616"><a href="#Tile.set_corners_from_edges-1616"><span class="linenos">1616</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Tile.set_corners_from_edges-1617"><a href="#Tile.set_corners_from_edges-1617"><span class="linenos">1617</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">corners</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Tile.set_corners_from_edges-1618"><a href="#Tile.set_corners_from_edges-1618"><span class="linenos">1618</span></a>    <span class="k">for</span> <span class="n">e</span><span class="p">,</span> <span class="n">cw</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges_CW</span><span class="p">,</span> <span class="n">strict</span> <span class="o">=</span> <span class="kc">True</span><span class="p">):</span>
</span><span id="Tile.set_corners_from_edges-1619"><a href="#Tile.set_corners_from_edges-1619"><span class="linenos">1619</span></a>      <span class="k">if</span> <span class="n">cw</span><span class="p">:</span> <span class="c1"># clockwise to extend by all but the first corner</span>
</span><span id="Tile.set_corners_from_edges-1620"><a href="#Tile.set_corners_from_edges-1620"><span class="linenos">1620</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">corners</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">corners</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</span><span id="Tile.set_corners_from_edges-1621"><a href="#Tile.set_corners_from_edges-1621"><span class="linenos">1621</span></a>      <span class="k">else</span><span class="p">:</span> <span class="c1"># counter-clockwise so extend in reverse</span>
</span><span id="Tile.set_corners_from_edges-1622"><a href="#Tile.set_corners_from_edges-1622"><span class="linenos">1622</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">corners</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">corners</span><span class="p">[</span><span class="mi">1</span><span class="p">:][::</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</span><span id="Tile.set_corners_from_edges-1623"><a href="#Tile.set_corners_from_edges-1623"><span class="linenos">1623</span></a>    <span class="k">if</span> <span class="n">update_shape</span><span class="p">:</span>
</span><span id="Tile.set_corners_from_edges-1624"><a href="#Tile.set_corners_from_edges-1624"><span class="linenos">1624</span></a>      <span class="bp">self</span><span class="o">.</span><span class="n">set_shape_from_corners</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Set corners attribute from the edges attribute.</p>

<p>Typically called after modification of topology edges. Optionally the shape
attribute is NOT updated, which may save time when multiple changes to the
edges of a tile are in process (i.e., only update the shape after all
changes are complete).</p>

<p>Args:
  update_shape (bool, optional): if True the shape attribute will be
    updated, otherwise not. Defaults to True.</p>
</div>


                            </div>
                            <div id="Tile.set_edge_directions" class="classattr">
                                        <input id="Tile.set_edge_directions-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">set_edge_directions</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="Tile.set_edge_directions-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Tile.set_edge_directions"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Tile.set_edge_directions-1627"><a href="#Tile.set_edge_directions-1627"><span class="linenos">1627</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">set_edge_directions</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Tile.set_edge_directions-1628"><a href="#Tile.set_edge_directions-1628"><span class="linenos">1628</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Set up edges_CW attribute by inspection of the edges list.</span>
</span><span id="Tile.set_edge_directions-1629"><a href="#Tile.set_edge_directions-1629"><span class="linenos">1629</span></a>
</span><span id="Tile.set_edge_directions-1630"><a href="#Tile.set_edge_directions-1630"><span class="linenos">1630</span></a><span class="sd">    It is (frankly!) hard to keep track of the correct sequence of CW/CCW order</span>
</span><span id="Tile.set_edge_directions-1631"><a href="#Tile.set_edge_directions-1631"><span class="linenos">1631</span></a><span class="sd">    of edges as new ones are created or old ones merged. This method inspects</span>
</span><span id="Tile.set_edge_directions-1632"><a href="#Tile.set_edge_directions-1632"><span class="linenos">1632</span></a><span class="sd">    the &#39;tail-head&#39; relations between consecutive edges to set these flags</span>
</span><span id="Tile.set_edge_directions-1633"><a href="#Tile.set_edge_directions-1633"><span class="linenos">1633</span></a><span class="sd">    correctly.</span>
</span><span id="Tile.set_edge_directions-1634"><a href="#Tile.set_edge_directions-1634"><span class="linenos">1634</span></a>
</span><span id="Tile.set_edge_directions-1635"><a href="#Tile.set_edge_directions-1635"><span class="linenos">1635</span></a><span class="sd">    The test is simply to check if the &#39;tail&#39; Vertex ID in each edge appears</span>
</span><span id="Tile.set_edge_directions-1636"><a href="#Tile.set_edge_directions-1636"><span class="linenos">1636</span></a><span class="sd">    in the ID tuple of the following edge, i.e. if successive edge</span>
</span><span id="Tile.set_edge_directions-1637"><a href="#Tile.set_edge_directions-1637"><span class="linenos">1637</span></a><span class="sd">    IDs are (0, 1) (2, 1) or (0, 1) (1, 2), then edge (0, 1) is in clockwise</span>
</span><span id="Tile.set_edge_directions-1638"><a href="#Tile.set_edge_directions-1638"><span class="linenos">1638</span></a><span class="sd">    direction, but if we have (0, 1) (2, 3) then it is not.</span>
</span><span id="Tile.set_edge_directions-1639"><a href="#Tile.set_edge_directions-1639"><span class="linenos">1639</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Tile.set_edge_directions-1640"><a href="#Tile.set_edge_directions-1640"><span class="linenos">1640</span></a>    <span class="n">edge_IDs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_edge_IDs</span><span class="p">()</span>
</span><span id="Tile.set_edge_directions-1641"><a href="#Tile.set_edge_directions-1641"><span class="linenos">1641</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">edges_CW</span> <span class="o">=</span> <span class="p">[</span><span class="n">e1</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="n">e2</span> <span class="k">for</span> <span class="n">e1</span><span class="p">,</span> <span class="n">e2</span> <span class="ow">in</span>
</span><span id="Tile.set_edge_directions-1642"><a href="#Tile.set_edge_directions-1642"><span class="linenos">1642</span></a>                     <span class="nb">zip</span><span class="p">(</span><span class="n">edge_IDs</span><span class="p">,</span> <span class="n">edge_IDs</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">+</span> <span class="n">edge_IDs</span><span class="p">[:</span><span class="mi">1</span><span class="p">],</span> <span class="n">strict</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)]</span>
</span></pre></div>


            <div class="docstring"><p>Set up edges_CW attribute by inspection of the edges list.</p>

<p>It is (frankly!) hard to keep track of the correct sequence of CW/CCW order
of edges as new ones are created or old ones merged. This method inspects
the 'tail-head' relations between consecutive edges to set these flags
correctly.</p>

<p>The test is simply to check if the 'tail' Vertex ID in each edge appears
in the ID tuple of the following edge, i.e. if successive edge
IDs are (0, 1) (2, 1) or (0, 1) (1, 2), then edge (0, 1) is in clockwise
direction, but if we have (0, 1) (2, 3) then it is not.</p>
</div>


                            </div>
                            <div id="Tile.insert_vertex_at" class="classattr">
                                        <input id="Tile.insert_vertex_at-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">insert_vertex_at</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">v</span><span class="p">:</span> <span class="n"><a href="#Vertex">Vertex</a></span>,</span><span class="param">	<span class="n">i</span><span class="p">:</span> <span class="nb">int</span>,</span><span class="param">	<span class="n">update_shape</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span></span><span class="return-annotation">) -> <span class="nb">tuple</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span> <span class="o">...</span><span class="p">]]</span>:</span></span>

                <label class="view-source-button" for="Tile.insert_vertex_at-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Tile.insert_vertex_at"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Tile.insert_vertex_at-1645"><a href="#Tile.insert_vertex_at-1645"><span class="linenos">1645</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">insert_vertex_at</span><span class="p">(</span>
</span><span id="Tile.insert_vertex_at-1646"><a href="#Tile.insert_vertex_at-1646"><span class="linenos">1646</span></a>      <span class="bp">self</span><span class="p">,</span>
</span><span id="Tile.insert_vertex_at-1647"><a href="#Tile.insert_vertex_at-1647"><span class="linenos">1647</span></a>      <span class="n">v</span><span class="p">:</span><span class="n">Vertex</span><span class="p">,</span>
</span><span id="Tile.insert_vertex_at-1648"><a href="#Tile.insert_vertex_at-1648"><span class="linenos">1648</span></a>      <span class="n">i</span><span class="p">:</span><span class="nb">int</span><span class="p">,</span>
</span><span id="Tile.insert_vertex_at-1649"><a href="#Tile.insert_vertex_at-1649"><span class="linenos">1649</span></a>      <span class="n">update_shape</span><span class="p">:</span><span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="Tile.insert_vertex_at-1650"><a href="#Tile.insert_vertex_at-1650"><span class="linenos">1650</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span><span class="nb">int</span><span class="p">],</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span><span class="nb">int</span><span class="p">],</span><span class="o">...</span><span class="p">]]:</span>
</span><span id="Tile.insert_vertex_at-1651"><a href="#Tile.insert_vertex_at-1651"><span class="linenos">1651</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Insert the Vertex into tile at index position i.</span>
</span><span id="Tile.insert_vertex_at-1652"><a href="#Tile.insert_vertex_at-1652"><span class="linenos">1652</span></a>
</span><span id="Tile.insert_vertex_at-1653"><a href="#Tile.insert_vertex_at-1653"><span class="linenos">1653</span></a><span class="sd">    Both corners and edges attributes are updated, and the old edge IDs for</span>
</span><span id="Tile.insert_vertex_at-1654"><a href="#Tile.insert_vertex_at-1654"><span class="linenos">1654</span></a><span class="sd">    removal and the new edge itself are returned to the calling context (the</span>
</span><span id="Tile.insert_vertex_at-1655"><a href="#Tile.insert_vertex_at-1655"><span class="linenos">1655</span></a><span class="sd">    containing Topology) for update of its edges collection. Optionally update</span>
</span><span id="Tile.insert_vertex_at-1656"><a href="#Tile.insert_vertex_at-1656"><span class="linenos">1656</span></a><span class="sd">    the shape attribute.</span>
</span><span id="Tile.insert_vertex_at-1657"><a href="#Tile.insert_vertex_at-1657"><span class="linenos">1657</span></a>
</span><span id="Tile.insert_vertex_at-1658"><a href="#Tile.insert_vertex_at-1658"><span class="linenos">1658</span></a><span class="sd">    This is NOT a generic vertex insertion method: it is only for use during</span>
</span><span id="Tile.insert_vertex_at-1659"><a href="#Tile.insert_vertex_at-1659"><span class="linenos">1659</span></a><span class="sd">    Topology initialisation, and does not guarantee correct maintenance of</span>
</span><span id="Tile.insert_vertex_at-1660"><a href="#Tile.insert_vertex_at-1660"><span class="linenos">1660</span></a><span class="sd">    all tile, edge and vertex relations in the general case---at any rate it</span>
</span><span id="Tile.insert_vertex_at-1661"><a href="#Tile.insert_vertex_at-1661"><span class="linenos">1661</span></a><span class="sd">    has not been tested for this!</span>
</span><span id="Tile.insert_vertex_at-1662"><a href="#Tile.insert_vertex_at-1662"><span class="linenos">1662</span></a>
</span><span id="Tile.insert_vertex_at-1663"><a href="#Tile.insert_vertex_at-1663"><span class="linenos">1663</span></a><span class="sd">    Args:</span>
</span><span id="Tile.insert_vertex_at-1664"><a href="#Tile.insert_vertex_at-1664"><span class="linenos">1664</span></a><span class="sd">      v (Vertex): the Vertex to insert.</span>
</span><span id="Tile.insert_vertex_at-1665"><a href="#Tile.insert_vertex_at-1665"><span class="linenos">1665</span></a><span class="sd">      i (int): index position in current corners after which to insert</span>
</span><span id="Tile.insert_vertex_at-1666"><a href="#Tile.insert_vertex_at-1666"><span class="linenos">1666</span></a><span class="sd">        supplied Vertex.</span>
</span><span id="Tile.insert_vertex_at-1667"><a href="#Tile.insert_vertex_at-1667"><span class="linenos">1667</span></a><span class="sd">      update_shape (bool, optional): if True shape attribute is updated.</span>
</span><span id="Tile.insert_vertex_at-1668"><a href="#Tile.insert_vertex_at-1668"><span class="linenos">1668</span></a><span class="sd">        Defaults to False.</span>
</span><span id="Tile.insert_vertex_at-1669"><a href="#Tile.insert_vertex_at-1669"><span class="linenos">1669</span></a>
</span><span id="Tile.insert_vertex_at-1670"><a href="#Tile.insert_vertex_at-1670"><span class="linenos">1670</span></a><span class="sd">    Returns:</span>
</span><span id="Tile.insert_vertex_at-1671"><a href="#Tile.insert_vertex_at-1671"><span class="linenos">1671</span></a><span class="sd">      tuple: the (tuple) ID of the old edge which should be deleted, and</span>
</span><span id="Tile.insert_vertex_at-1672"><a href="#Tile.insert_vertex_at-1672"><span class="linenos">1672</span></a><span class="sd">        the new Edges arising from insertion of this Vertex.</span>
</span><span id="Tile.insert_vertex_at-1673"><a href="#Tile.insert_vertex_at-1673"><span class="linenos">1673</span></a>
</span><span id="Tile.insert_vertex_at-1674"><a href="#Tile.insert_vertex_at-1674"><span class="linenos">1674</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Tile.insert_vertex_at-1675"><a href="#Tile.insert_vertex_at-1675"><span class="linenos">1675</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">corners</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">corners</span><span class="p">[:</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">corners</span><span class="p">[</span><span class="n">i</span><span class="p">:]</span>
</span><span id="Tile.insert_vertex_at-1676"><a href="#Tile.insert_vertex_at-1676"><span class="linenos">1676</span></a>    <span class="n">old_edge</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
</span><span id="Tile.insert_vertex_at-1677"><a href="#Tile.insert_vertex_at-1677"><span class="linenos">1677</span></a>    <span class="c1"># store current ID of the affected edge for return to calling context</span>
</span><span id="Tile.insert_vertex_at-1678"><a href="#Tile.insert_vertex_at-1678"><span class="linenos">1678</span></a>    <span class="n">old_edge_ID</span> <span class="o">=</span> <span class="n">old_edge</span><span class="o">.</span><span class="n">ID</span>
</span><span id="Tile.insert_vertex_at-1679"><a href="#Tile.insert_vertex_at-1679"><span class="linenos">1679</span></a>    <span class="n">new_edges</span> <span class="o">=</span> <span class="n">old_edge</span><span class="o">.</span><span class="n">insert_vertex</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">corners</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">])</span>
</span><span id="Tile.insert_vertex_at-1680"><a href="#Tile.insert_vertex_at-1680"><span class="linenos">1680</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">edges</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">[:(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)]</span> <span class="o">+</span> <span class="n">new_edges</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">i</span><span class="p">:]</span>
</span><span id="Tile.insert_vertex_at-1681"><a href="#Tile.insert_vertex_at-1681"><span class="linenos">1681</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">set_edge_directions</span><span class="p">()</span>
</span><span id="Tile.insert_vertex_at-1682"><a href="#Tile.insert_vertex_at-1682"><span class="linenos">1682</span></a>    <span class="k">if</span> <span class="n">update_shape</span><span class="p">:</span>
</span><span id="Tile.insert_vertex_at-1683"><a href="#Tile.insert_vertex_at-1683"><span class="linenos">1683</span></a>      <span class="bp">self</span><span class="o">.</span><span class="n">set_shape_from_corners</span><span class="p">()</span>
</span><span id="Tile.insert_vertex_at-1684"><a href="#Tile.insert_vertex_at-1684"><span class="linenos">1684</span></a>    <span class="k">return</span> <span class="n">old_edge_ID</span><span class="p">,</span> <span class="n">new_edges</span>
</span></pre></div>


            <div class="docstring"><p>Insert the Vertex into tile at index position i.</p>

<p>Both corners and edges attributes are updated, and the old edge IDs for
removal and the new edge itself are returned to the calling context (the
containing Topology) for update of its edges collection. Optionally update
the shape attribute.</p>

<p>This is NOT a generic vertex insertion method: it is only for use during
Topology initialisation, and does not guarantee correct maintenance of
all tile, edge and vertex relations in the general case---at any rate it
has not been tested for this!</p>

<p>Args:
  v (Vertex): the Vertex to insert.
  i (int): index position in current corners after which to insert
    supplied Vertex.
  update_shape (bool, optional): if True shape attribute is updated.
    Defaults to False.</p>

<p>Returns:
  tuple: the (tuple) ID of the old edge which should be deleted, and
    the new Edges arising from insertion of this Vertex.</p>
</div>


                            </div>
                            <div id="Tile.merge_edges_at_vertex" class="classattr">
                                        <input id="Tile.merge_edges_at_vertex-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">merge_edges_at_vertex</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">v</span><span class="p">:</span> <span class="n"><a href="#Vertex">Vertex</a></span></span><span class="return-annotation">) -> <span class="nb">tuple</span>:</span></span>

                <label class="view-source-button" for="Tile.merge_edges_at_vertex-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Tile.merge_edges_at_vertex"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Tile.merge_edges_at_vertex-1687"><a href="#Tile.merge_edges_at_vertex-1687"><span class="linenos">1687</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">merge_edges_at_vertex</span><span class="p">(</span>
</span><span id="Tile.merge_edges_at_vertex-1688"><a href="#Tile.merge_edges_at_vertex-1688"><span class="linenos">1688</span></a>      <span class="bp">self</span><span class="p">,</span>
</span><span id="Tile.merge_edges_at_vertex-1689"><a href="#Tile.merge_edges_at_vertex-1689"><span class="linenos">1689</span></a>      <span class="n">v</span><span class="p">:</span><span class="n">Vertex</span><span class="p">,</span>
</span><span id="Tile.merge_edges_at_vertex-1690"><a href="#Tile.merge_edges_at_vertex-1690"><span class="linenos">1690</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
</span><span id="Tile.merge_edges_at_vertex-1691"><a href="#Tile.merge_edges_at_vertex-1691"><span class="linenos">1691</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Merge edges that meet at the supplied Vertex.</span>
</span><span id="Tile.merge_edges_at_vertex-1692"><a href="#Tile.merge_edges_at_vertex-1692"><span class="linenos">1692</span></a>
</span><span id="Tile.merge_edges_at_vertex-1693"><a href="#Tile.merge_edges_at_vertex-1693"><span class="linenos">1693</span></a><span class="sd">    It is assumed that only two tiles are impacted this one, and its neighbour</span>
</span><span id="Tile.merge_edges_at_vertex-1694"><a href="#Tile.merge_edges_at_vertex-1694"><span class="linenos">1694</span></a><span class="sd">    across the Edge on which v lies. Both are updated. For this reason the work</span>
</span><span id="Tile.merge_edges_at_vertex-1695"><a href="#Tile.merge_edges_at_vertex-1695"><span class="linenos">1695</span></a><span class="sd">    is delegated to `get_updated_edges_from_merge` which is run on both affected</span>
</span><span id="Tile.merge_edges_at_vertex-1696"><a href="#Tile.merge_edges_at_vertex-1696"><span class="linenos">1696</span></a><span class="sd">    tiles, but only determines the edges to remove and the new edge to be added</span>
</span><span id="Tile.merge_edges_at_vertex-1697"><a href="#Tile.merge_edges_at_vertex-1697"><span class="linenos">1697</span></a><span class="sd">    once. See that method for details.</span>
</span><span id="Tile.merge_edges_at_vertex-1698"><a href="#Tile.merge_edges_at_vertex-1698"><span class="linenos">1698</span></a>
</span><span id="Tile.merge_edges_at_vertex-1699"><a href="#Tile.merge_edges_at_vertex-1699"><span class="linenos">1699</span></a><span class="sd">    Args:</span>
</span><span id="Tile.merge_edges_at_vertex-1700"><a href="#Tile.merge_edges_at_vertex-1700"><span class="linenos">1700</span></a><span class="sd">      v (Vertex): Vertex at which to merge Edges. This should currently be an</span>
</span><span id="Tile.merge_edges_at_vertex-1701"><a href="#Tile.merge_edges_at_vertex-1701"><span class="linenos">1701</span></a><span class="sd">        end</span>
</span><span id="Tile.merge_edges_at_vertex-1702"><a href="#Tile.merge_edges_at_vertex-1702"><span class="linenos">1702</span></a>
</span><span id="Tile.merge_edges_at_vertex-1703"><a href="#Tile.merge_edges_at_vertex-1703"><span class="linenos">1703</span></a><span class="sd">    Returns:</span>
</span><span id="Tile.merge_edges_at_vertex-1704"><a href="#Tile.merge_edges_at_vertex-1704"><span class="linenos">1704</span></a><span class="sd">      tuple: 2 item list of the edge IDs to be removed and a new Edge object to</span>
</span><span id="Tile.merge_edges_at_vertex-1705"><a href="#Tile.merge_edges_at_vertex-1705"><span class="linenos">1705</span></a><span class="sd">        be added by the calling context (i.e. the containing Topology).</span>
</span><span id="Tile.merge_edges_at_vertex-1706"><a href="#Tile.merge_edges_at_vertex-1706"><span class="linenos">1706</span></a>
</span><span id="Tile.merge_edges_at_vertex-1707"><a href="#Tile.merge_edges_at_vertex-1707"><span class="linenos">1707</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Tile.merge_edges_at_vertex-1708"><a href="#Tile.merge_edges_at_vertex-1708"><span class="linenos">1708</span></a>    <span class="n">to_remove</span><span class="p">,</span> <span class="n">new_edge</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_updated_edges_from_merge</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
</span><span id="Tile.merge_edges_at_vertex-1709"><a href="#Tile.merge_edges_at_vertex-1709"><span class="linenos">1709</span></a>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">tiles</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="Tile.merge_edges_at_vertex-1710"><a href="#Tile.merge_edges_at_vertex-1710"><span class="linenos">1710</span></a>      <span class="n">v</span><span class="o">.</span><span class="n">tiles</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">get_updated_edges_from_merge</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">new_edge</span><span class="p">)</span>
</span><span id="Tile.merge_edges_at_vertex-1711"><a href="#Tile.merge_edges_at_vertex-1711"><span class="linenos">1711</span></a>    <span class="k">return</span> <span class="n">to_remove</span><span class="p">,</span> <span class="n">new_edge</span>
</span></pre></div>


            <div class="docstring"><p>Merge edges that meet at the supplied Vertex.</p>

<p>It is assumed that only two tiles are impacted this one, and its neighbour
across the Edge on which v lies. Both are updated. For this reason the work
is delegated to <code><a href="#Tile.get_updated_edges_from_merge">get_updated_edges_from_merge</a></code> which is run on both affected
tiles, but only determines the edges to remove and the new edge to be added
once. See that method for details.</p>

<p>Args:
  v (Vertex): Vertex at which to merge Edges. This should currently be an
    end</p>

<p>Returns:
  tuple: 2 item list of the edge IDs to be removed and a new Edge object to
    be added by the calling context (i.e. the containing Topology).</p>
</div>


                            </div>
                            <div id="Tile.get_updated_edges_from_merge" class="classattr">
                                        <input id="Tile.get_updated_edges_from_merge-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_updated_edges_from_merge</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">v</span><span class="p">:</span> <span class="n"><a href="#Vertex">Vertex</a></span>,</span><span class="param">	<span class="n">new_edge</span><span class="p">:</span> <span class="n"><a href="#Edge">Edge</a></span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">) -> <span class="kc">None</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]],</span> <span class="n"><a href="#Edge">Edge</a></span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="Tile.get_updated_edges_from_merge-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Tile.get_updated_edges_from_merge"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Tile.get_updated_edges_from_merge-1714"><a href="#Tile.get_updated_edges_from_merge-1714"><span class="linenos">1714</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">get_updated_edges_from_merge</span><span class="p">(</span>
</span><span id="Tile.get_updated_edges_from_merge-1715"><a href="#Tile.get_updated_edges_from_merge-1715"><span class="linenos">1715</span></a>      <span class="bp">self</span><span class="p">,</span>
</span><span id="Tile.get_updated_edges_from_merge-1716"><a href="#Tile.get_updated_edges_from_merge-1716"><span class="linenos">1716</span></a>      <span class="n">v</span><span class="p">:</span><span class="n">Vertex</span><span class="p">,</span>
</span><span id="Tile.get_updated_edges_from_merge-1717"><a href="#Tile.get_updated_edges_from_merge-1717"><span class="linenos">1717</span></a>      <span class="n">new_edge</span><span class="p">:</span><span class="n">Edge</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Tile.get_updated_edges_from_merge-1718"><a href="#Tile.get_updated_edges_from_merge-1718"><span class="linenos">1718</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="o">|</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span><span class="nb">int</span><span class="p">],</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span><span class="nb">int</span><span class="p">]],</span> <span class="n">Edge</span><span class="p">]:</span>
</span><span id="Tile.get_updated_edges_from_merge-1719"><a href="#Tile.get_updated_edges_from_merge-1719"><span class="linenos">1719</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Update edges and edges_CW attributes based on insertion of Vertex.</span>
</span><span id="Tile.get_updated_edges_from_merge-1720"><a href="#Tile.get_updated_edges_from_merge-1720"><span class="linenos">1720</span></a>
</span><span id="Tile.get_updated_edges_from_merge-1721"><a href="#Tile.get_updated_edges_from_merge-1721"><span class="linenos">1721</span></a><span class="sd">    If new_edge is supplied then the neighbour tile at v has already created</span>
</span><span id="Tile.get_updated_edges_from_merge-1722"><a href="#Tile.get_updated_edges_from_merge-1722"><span class="linenos">1722</span></a><span class="sd">    the needed new Edge and this Edge is the one that will be &#39;slotted in&#39; at</span>
</span><span id="Tile.get_updated_edges_from_merge-1723"><a href="#Tile.get_updated_edges_from_merge-1723"><span class="linenos">1723</span></a><span class="sd">    the appropriate spot in the edges list.</span>
</span><span id="Tile.get_updated_edges_from_merge-1724"><a href="#Tile.get_updated_edges_from_merge-1724"><span class="linenos">1724</span></a>
</span><span id="Tile.get_updated_edges_from_merge-1725"><a href="#Tile.get_updated_edges_from_merge-1725"><span class="linenos">1725</span></a><span class="sd">    The edges_CW is also updated to maintain correct directions of the edges.</span>
</span><span id="Tile.get_updated_edges_from_merge-1726"><a href="#Tile.get_updated_edges_from_merge-1726"><span class="linenos">1726</span></a><span class="sd">    The corners attribute is unaffected by these changes.</span>
</span><span id="Tile.get_updated_edges_from_merge-1727"><a href="#Tile.get_updated_edges_from_merge-1727"><span class="linenos">1727</span></a>
</span><span id="Tile.get_updated_edges_from_merge-1728"><a href="#Tile.get_updated_edges_from_merge-1728"><span class="linenos">1728</span></a><span class="sd">    Args:</span>
</span><span id="Tile.get_updated_edges_from_merge-1729"><a href="#Tile.get_updated_edges_from_merge-1729"><span class="linenos">1729</span></a><span class="sd">      v (Vertex): existing Vertex at which to carry out the merge.</span>
</span><span id="Tile.get_updated_edges_from_merge-1730"><a href="#Tile.get_updated_edges_from_merge-1730"><span class="linenos">1730</span></a><span class="sd">      new_edge (Edge, optional): if another Tile has already carried out this</span>
</span><span id="Tile.get_updated_edges_from_merge-1731"><a href="#Tile.get_updated_edges_from_merge-1731"><span class="linenos">1731</span></a><span class="sd">        merge this should be the resulting new Edge for insertion into this</span>
</span><span id="Tile.get_updated_edges_from_merge-1732"><a href="#Tile.get_updated_edges_from_merge-1732"><span class="linenos">1732</span></a><span class="sd">        Tile. Defaults to None (when the new Edge will be constructed).</span>
</span><span id="Tile.get_updated_edges_from_merge-1733"><a href="#Tile.get_updated_edges_from_merge-1733"><span class="linenos">1733</span></a>
</span><span id="Tile.get_updated_edges_from_merge-1734"><a href="#Tile.get_updated_edges_from_merge-1734"><span class="linenos">1734</span></a><span class="sd">    Returns:</span>
</span><span id="Tile.get_updated_edges_from_merge-1735"><a href="#Tile.get_updated_edges_from_merge-1735"><span class="linenos">1735</span></a><span class="sd">      None|tuple: either None (if a new edge was supplied) or a tuple</span>
</span><span id="Tile.get_updated_edges_from_merge-1736"><a href="#Tile.get_updated_edges_from_merge-1736"><span class="linenos">1736</span></a><span class="sd">        of the two edge IDs to be removed and the new edge added for return to</span>
</span><span id="Tile.get_updated_edges_from_merge-1737"><a href="#Tile.get_updated_edges_from_merge-1737"><span class="linenos">1737</span></a><span class="sd">        the calling context (i.e. the containing Topology).</span>
</span><span id="Tile.get_updated_edges_from_merge-1738"><a href="#Tile.get_updated_edges_from_merge-1738"><span class="linenos">1738</span></a>
</span><span id="Tile.get_updated_edges_from_merge-1739"><a href="#Tile.get_updated_edges_from_merge-1739"><span class="linenos">1739</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Tile.get_updated_edges_from_merge-1740"><a href="#Tile.get_updated_edges_from_merge-1740"><span class="linenos">1740</span></a>    <span class="c1"># get the two edge list index positions in which Vertex v is found</span>
</span><span id="Tile.get_updated_edges_from_merge-1741"><a href="#Tile.get_updated_edges_from_merge-1741"><span class="linenos">1741</span></a>    <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_edge_IDs_including_vertex</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
</span><span id="Tile.get_updated_edges_from_merge-1742"><a href="#Tile.get_updated_edges_from_merge-1742"><span class="linenos">1742</span></a>    <span class="k">if</span> <span class="n">new_edge</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="c1"># then we must make a new one</span>
</span><span id="Tile.get_updated_edges_from_merge-1743"><a href="#Tile.get_updated_edges_from_merge-1743"><span class="linenos">1743</span></a>      <span class="c1"># also record existing edge IDs to be removed</span>
</span><span id="Tile.get_updated_edges_from_merge-1744"><a href="#Tile.get_updated_edges_from_merge-1744"><span class="linenos">1744</span></a>      <span class="n">to_remove</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">ID</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">ID</span><span class="p">]</span>
</span><span id="Tile.get_updated_edges_from_merge-1745"><a href="#Tile.get_updated_edges_from_merge-1745"><span class="linenos">1745</span></a>      <span class="n">new_edge</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_merged_edge</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span>
</span><span id="Tile.get_updated_edges_from_merge-1746"><a href="#Tile.get_updated_edges_from_merge-1746"><span class="linenos">1746</span></a>      <span class="n">return_edge_updates</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="Tile.get_updated_edges_from_merge-1747"><a href="#Tile.get_updated_edges_from_merge-1747"><span class="linenos">1747</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="Tile.get_updated_edges_from_merge-1748"><a href="#Tile.get_updated_edges_from_merge-1748"><span class="linenos">1748</span></a>      <span class="n">return_edge_updates</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="Tile.get_updated_edges_from_merge-1749"><a href="#Tile.get_updated_edges_from_merge-1749"><span class="linenos">1749</span></a>    <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">i</span> <span class="o">-</span> <span class="n">j</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="Tile.get_updated_edges_from_merge-1750"><a href="#Tile.get_updated_edges_from_merge-1750"><span class="linenos">1750</span></a>      <span class="c1"># edge indices &#39;wrap&#39; around from end of edge list to start so drop</span>
</span><span id="Tile.get_updated_edges_from_merge-1751"><a href="#Tile.get_updated_edges_from_merge-1751"><span class="linenos">1751</span></a>      <span class="c1"># first and last current edges and stick new one on at the end</span>
</span><span id="Tile.get_updated_edges_from_merge-1752"><a href="#Tile.get_updated_edges_from_merge-1752"><span class="linenos">1752</span></a>      <span class="bp">self</span><span class="o">.</span><span class="n">edges</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="n">new_edge</span><span class="p">]</span>
</span><span id="Tile.get_updated_edges_from_merge-1753"><a href="#Tile.get_updated_edges_from_merge-1753"><span class="linenos">1753</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="Tile.get_updated_edges_from_merge-1754"><a href="#Tile.get_updated_edges_from_merge-1754"><span class="linenos">1754</span></a>      <span class="c1"># insert new edge into list in place of the two old ones</span>
</span><span id="Tile.get_updated_edges_from_merge-1755"><a href="#Tile.get_updated_edges_from_merge-1755"><span class="linenos">1755</span></a>      <span class="bp">self</span><span class="o">.</span><span class="n">edges</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">[:</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="n">new_edge</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">:]</span>
</span><span id="Tile.get_updated_edges_from_merge-1756"><a href="#Tile.get_updated_edges_from_merge-1756"><span class="linenos">1756</span></a>    <span class="c1"># update the edge directions</span>
</span><span id="Tile.get_updated_edges_from_merge-1757"><a href="#Tile.get_updated_edges_from_merge-1757"><span class="linenos">1757</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">set_edge_directions</span><span class="p">()</span>
</span><span id="Tile.get_updated_edges_from_merge-1758"><a href="#Tile.get_updated_edges_from_merge-1758"><span class="linenos">1758</span></a>    <span class="k">if</span> <span class="n">return_edge_updates</span><span class="p">:</span>
</span><span id="Tile.get_updated_edges_from_merge-1759"><a href="#Tile.get_updated_edges_from_merge-1759"><span class="linenos">1759</span></a>      <span class="k">return</span> <span class="n">to_remove</span><span class="p">,</span> <span class="n">new_edge</span>
</span><span id="Tile.get_updated_edges_from_merge-1760"><a href="#Tile.get_updated_edges_from_merge-1760"><span class="linenos">1760</span></a>    <span class="k">return</span> <span class="kc">None</span>
</span></pre></div>


            <div class="docstring"><p>Update edges and edges_CW attributes based on insertion of Vertex.</p>

<p>If new_edge is supplied then the neighbour tile at v has already created
the needed new Edge and this Edge is the one that will be 'slotted in' at
the appropriate spot in the edges list.</p>

<p>The edges_CW is also updated to maintain correct directions of the edges.
The corners attribute is unaffected by these changes.</p>

<p>Args:
  v (Vertex): existing Vertex at which to carry out the merge.
  new_edge (Edge, optional): if another Tile has already carried out this
    merge this should be the resulting new Edge for insertion into this
    Tile. Defaults to None (when the new Edge will be constructed).</p>

<p>Returns:
  None|tuple: either None (if a new edge was supplied) or a tuple
    of the two edge IDs to be removed and the new edge added for return to
    the calling context (i.e. the containing Topology).</p>
</div>


                            </div>
                            <div id="Tile.get_edge_IDs_including_vertex" class="classattr">
                                        <input id="Tile.get_edge_IDs_including_vertex-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_edge_IDs_including_vertex</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">v</span><span class="p">:</span> <span class="n"><a href="#Vertex">Vertex</a></span></span><span class="return-annotation">) -> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="Tile.get_edge_IDs_including_vertex-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Tile.get_edge_IDs_including_vertex"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Tile.get_edge_IDs_including_vertex-1763"><a href="#Tile.get_edge_IDs_including_vertex-1763"><span class="linenos">1763</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">get_edge_IDs_including_vertex</span><span class="p">(</span>
</span><span id="Tile.get_edge_IDs_including_vertex-1764"><a href="#Tile.get_edge_IDs_including_vertex-1764"><span class="linenos">1764</span></a>      <span class="bp">self</span><span class="p">,</span>
</span><span id="Tile.get_edge_IDs_including_vertex-1765"><a href="#Tile.get_edge_IDs_including_vertex-1765"><span class="linenos">1765</span></a>      <span class="n">v</span><span class="p">:</span><span class="n">Vertex</span><span class="p">,</span>
</span><span id="Tile.get_edge_IDs_including_vertex-1766"><a href="#Tile.get_edge_IDs_including_vertex-1766"><span class="linenos">1766</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
</span><span id="Tile.get_edge_IDs_including_vertex-1767"><a href="#Tile.get_edge_IDs_including_vertex-1767"><span class="linenos">1767</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the (two) index positions of the edges that include supplied Vertex.</span>
</span><span id="Tile.get_edge_IDs_including_vertex-1768"><a href="#Tile.get_edge_IDs_including_vertex-1768"><span class="linenos">1768</span></a>
</span><span id="Tile.get_edge_IDs_including_vertex-1769"><a href="#Tile.get_edge_IDs_including_vertex-1769"><span class="linenos">1769</span></a><span class="sd">    Args:</span>
</span><span id="Tile.get_edge_IDs_including_vertex-1770"><a href="#Tile.get_edge_IDs_including_vertex-1770"><span class="linenos">1770</span></a><span class="sd">        v (Vertex): Vertex of interest.</span>
</span><span id="Tile.get_edge_IDs_including_vertex-1771"><a href="#Tile.get_edge_IDs_including_vertex-1771"><span class="linenos">1771</span></a>
</span><span id="Tile.get_edge_IDs_including_vertex-1772"><a href="#Tile.get_edge_IDs_including_vertex-1772"><span class="linenos">1772</span></a><span class="sd">    Returns:</span>
</span><span id="Tile.get_edge_IDs_including_vertex-1773"><a href="#Tile.get_edge_IDs_including_vertex-1773"><span class="linenos">1773</span></a><span class="sd">      tuple[int]: two index positions of Edges in edges list that contain v.</span>
</span><span id="Tile.get_edge_IDs_including_vertex-1774"><a href="#Tile.get_edge_IDs_including_vertex-1774"><span class="linenos">1774</span></a>
</span><span id="Tile.get_edge_IDs_including_vertex-1775"><a href="#Tile.get_edge_IDs_including_vertex-1775"><span class="linenos">1775</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Tile.get_edge_IDs_including_vertex-1776"><a href="#Tile.get_edge_IDs_including_vertex-1776"><span class="linenos">1776</span></a>    <span class="k">return</span> <span class="p">(</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">e</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">)</span> <span class="k">if</span> <span class="n">v</span><span class="o">.</span><span class="n">ID</span> <span class="ow">in</span> <span class="n">e</span><span class="o">.</span><span class="n">ID</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Get the (two) index positions of the edges that include supplied Vertex.</p>

<p>Args:
    v (Vertex): Vertex of interest.</p>

<p>Returns:
  tuple[int]: two index positions of Edges in edges list that contain v.</p>
</div>


                            </div>
                            <div id="Tile.get_merged_edge" class="classattr">
                                        <input id="Tile.get_merged_edge-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_merged_edge</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">i</span><span class="p">:</span> <span class="nb">int</span>, </span><span class="param"><span class="n">j</span><span class="p">:</span> <span class="nb">int</span></span><span class="return-annotation">) -> <span class="n"><a href="#Edge">Edge</a></span>:</span></span>

                <label class="view-source-button" for="Tile.get_merged_edge-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Tile.get_merged_edge"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Tile.get_merged_edge-1779"><a href="#Tile.get_merged_edge-1779"><span class="linenos">1779</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">get_merged_edge</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">:</span><span class="nb">int</span><span class="p">,</span> <span class="n">j</span><span class="p">:</span><span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Edge</span><span class="p">:</span>
</span><span id="Tile.get_merged_edge-1780"><a href="#Tile.get_merged_edge-1780"><span class="linenos">1780</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return edge made by merging existing edges at i and j in the edges list.</span>
</span><span id="Tile.get_merged_edge-1781"><a href="#Tile.get_merged_edge-1781"><span class="linenos">1781</span></a>
</span><span id="Tile.get_merged_edge-1782"><a href="#Tile.get_merged_edge-1782"><span class="linenos">1782</span></a><span class="sd">    For example, if the current list of edge IDs was</span>
</span><span id="Tile.get_merged_edge-1783"><a href="#Tile.get_merged_edge-1783"><span class="linenos">1783</span></a>
</span><span id="Tile.get_merged_edge-1784"><a href="#Tile.get_merged_edge-1784"><span class="linenos">1784</span></a><span class="sd">        (0 1 2) (4 2) (4 5) (5 0)</span>
</span><span id="Tile.get_merged_edge-1785"><a href="#Tile.get_merged_edge-1785"><span class="linenos">1785</span></a>
</span><span id="Tile.get_merged_edge-1786"><a href="#Tile.get_merged_edge-1786"><span class="linenos">1786</span></a><span class="sd">    and the merge requested is 0 and 1, the resulting new edge is constructed</span>
</span><span id="Tile.get_merged_edge-1787"><a href="#Tile.get_merged_edge-1787"><span class="linenos">1787</span></a><span class="sd">    from vertices (0 1 2 4).</span>
</span><span id="Tile.get_merged_edge-1788"><a href="#Tile.get_merged_edge-1788"><span class="linenos">1788</span></a>
</span><span id="Tile.get_merged_edge-1789"><a href="#Tile.get_merged_edge-1789"><span class="linenos">1789</span></a><span class="sd">    Returns:</span>
</span><span id="Tile.get_merged_edge-1790"><a href="#Tile.get_merged_edge-1790"><span class="linenos">1790</span></a><span class="sd">      Edge: the requested new Edge.</span>
</span><span id="Tile.get_merged_edge-1791"><a href="#Tile.get_merged_edge-1791"><span class="linenos">1791</span></a>
</span><span id="Tile.get_merged_edge-1792"><a href="#Tile.get_merged_edge-1792"><span class="linenos">1792</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Tile.get_merged_edge-1793"><a href="#Tile.get_merged_edge-1793"><span class="linenos">1793</span></a>    <span class="c1"># if i and j are not consecutive, then j is predecessor edge</span>
</span><span id="Tile.get_merged_edge-1794"><a href="#Tile.get_merged_edge-1794"><span class="linenos">1794</span></a>    <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">i</span> <span class="o">-</span> <span class="n">j</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="Tile.get_merged_edge-1795"><a href="#Tile.get_merged_edge-1795"><span class="linenos">1795</span></a>      <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="n">j</span><span class="p">,</span> <span class="n">i</span>
</span><span id="Tile.get_merged_edge-1796"><a href="#Tile.get_merged_edge-1796"><span class="linenos">1796</span></a>    <span class="c1"># get edges and their directions</span>
</span><span id="Tile.get_merged_edge-1797"><a href="#Tile.get_merged_edge-1797"><span class="linenos">1797</span></a>    <span class="n">ei</span><span class="p">,</span> <span class="n">ej</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
</span><span id="Tile.get_merged_edge-1798"><a href="#Tile.get_merged_edge-1798"><span class="linenos">1798</span></a>    <span class="n">CWi</span><span class="p">,</span> <span class="n">CWj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges_CW</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges_CW</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
</span><span id="Tile.get_merged_edge-1799"><a href="#Tile.get_merged_edge-1799"><span class="linenos">1799</span></a>    <span class="c1"># DON&#39;T MESS WITH THIS!!!</span>
</span><span id="Tile.get_merged_edge-1800"><a href="#Tile.get_merged_edge-1800"><span class="linenos">1800</span></a>    <span class="c1"># for predecessors (the head) we want everything including the Vertex</span>
</span><span id="Tile.get_merged_edge-1801"><a href="#Tile.get_merged_edge-1801"><span class="linenos">1801</span></a>    <span class="c1"># where the merge is occurring; for successors (the tail) we want all but</span>
</span><span id="Tile.get_merged_edge-1802"><a href="#Tile.get_merged_edge-1802"><span class="linenos">1802</span></a>    <span class="c1"># the first Vertex (which is the one where the merge is occurring). In both</span>
</span><span id="Tile.get_merged_edge-1803"><a href="#Tile.get_merged_edge-1803"><span class="linenos">1803</span></a>    <span class="c1"># cases contingent on whether existing Edges are CW or CCW we may need to</span>
</span><span id="Tile.get_merged_edge-1804"><a href="#Tile.get_merged_edge-1804"><span class="linenos">1804</span></a>    <span class="c1"># flip the Vertex sequence to ensure that the merge Vertex is in the middle</span>
</span><span id="Tile.get_merged_edge-1805"><a href="#Tile.get_merged_edge-1805"><span class="linenos">1805</span></a>    <span class="c1"># of the new edge that will be created</span>
</span><span id="Tile.get_merged_edge-1806"><a href="#Tile.get_merged_edge-1806"><span class="linenos">1806</span></a>    <span class="n">head</span> <span class="o">=</span> <span class="n">ei</span><span class="o">.</span><span class="n">corners</span> <span class="k">if</span> <span class="n">CWi</span> <span class="k">else</span> <span class="n">ei</span><span class="o">.</span><span class="n">corners</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="Tile.get_merged_edge-1807"><a href="#Tile.get_merged_edge-1807"><span class="linenos">1807</span></a>    <span class="n">tail</span> <span class="o">=</span> <span class="n">ej</span><span class="o">.</span><span class="n">corners</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="k">if</span> <span class="n">CWj</span> <span class="k">else</span> <span class="n">ej</span><span class="o">.</span><span class="n">corners</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">:]</span>
</span><span id="Tile.get_merged_edge-1808"><a href="#Tile.get_merged_edge-1808"><span class="linenos">1808</span></a>    <span class="n">v_sequence</span> <span class="o">=</span> <span class="p">(</span><span class="n">head</span> <span class="k">if</span> <span class="n">CWi</span> <span class="k">else</span> <span class="n">head</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="p">(</span><span class="n">tail</span> <span class="k">if</span> <span class="n">CWj</span> <span class="k">else</span> <span class="n">tail</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</span><span id="Tile.get_merged_edge-1809"><a href="#Tile.get_merged_edge-1809"><span class="linenos">1809</span></a>    <span class="k">return</span> <span class="n">Edge</span><span class="p">(</span><span class="n">v_sequence</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Return edge made by merging existing edges at i and j in the edges list.</p>

<p>For example, if the current list of edge IDs was</p>

<pre><code>(0 1 2) (4 2) (4 5) (5 0)
</code></pre>

<p>and the merge requested is 0 and 1, the resulting new edge is constructed
from vertices (0 1 2 4).</p>

<p>Returns:
  Edge: the requested new Edge.</p>
</div>


                            </div>
                            <div id="Tile.offset_corners" class="classattr">
                                        <input id="Tile.offset_corners-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">offset_corners</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">offset</span><span class="p">:</span> <span class="nb">int</span></span><span class="return-annotation">) -> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="Tile.offset_corners-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Tile.offset_corners"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Tile.offset_corners-1812"><a href="#Tile.offset_corners-1812"><span class="linenos">1812</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">offset_corners</span><span class="p">(</span>
</span><span id="Tile.offset_corners-1813"><a href="#Tile.offset_corners-1813"><span class="linenos">1813</span></a>      <span class="bp">self</span><span class="p">,</span>
</span><span id="Tile.offset_corners-1814"><a href="#Tile.offset_corners-1814"><span class="linenos">1814</span></a>      <span class="n">offset</span><span class="p">:</span><span class="nb">int</span><span class="p">,</span>
</span><span id="Tile.offset_corners-1815"><a href="#Tile.offset_corners-1815"><span class="linenos">1815</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Tile.offset_corners-1816"><a href="#Tile.offset_corners-1816"><span class="linenos">1816</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Shift shape, corners, edges, and edges_CW by an offset amount.</span>
</span><span id="Tile.offset_corners-1817"><a href="#Tile.offset_corners-1817"><span class="linenos">1817</span></a>
</span><span id="Tile.offset_corners-1818"><a href="#Tile.offset_corners-1818"><span class="linenos">1818</span></a><span class="sd">    This is used to align tiles that are similar, which is required for correct</span>
</span><span id="Tile.offset_corners-1819"><a href="#Tile.offset_corners-1819"><span class="linenos">1819</span></a><span class="sd">    transfer of &#39;base&#39; tile labelling on to &#39;radius 1&#39; tiles during Topology</span>
</span><span id="Tile.offset_corners-1820"><a href="#Tile.offset_corners-1820"><span class="linenos">1820</span></a><span class="sd">    construction.</span>
</span><span id="Tile.offset_corners-1821"><a href="#Tile.offset_corners-1821"><span class="linenos">1821</span></a>
</span><span id="Tile.offset_corners-1822"><a href="#Tile.offset_corners-1822"><span class="linenos">1822</span></a><span class="sd">    Args:</span>
</span><span id="Tile.offset_corners-1823"><a href="#Tile.offset_corners-1823"><span class="linenos">1823</span></a><span class="sd">      offset (int): the number of positions to shift the lists.</span>
</span><span id="Tile.offset_corners-1824"><a href="#Tile.offset_corners-1824"><span class="linenos">1824</span></a>
</span><span id="Tile.offset_corners-1825"><a href="#Tile.offset_corners-1825"><span class="linenos">1825</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Tile.offset_corners-1826"><a href="#Tile.offset_corners-1826"><span class="linenos">1826</span></a>    <span class="k">if</span> <span class="n">offset</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">offset</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Tile.offset_corners-1827"><a href="#Tile.offset_corners-1827"><span class="linenos">1827</span></a>      <span class="bp">self</span><span class="o">.</span><span class="n">corners</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">corners</span><span class="p">[</span><span class="n">offset</span><span class="p">:]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">corners</span><span class="p">[:</span><span class="n">offset</span><span class="p">]</span>
</span><span id="Tile.offset_corners-1828"><a href="#Tile.offset_corners-1828"><span class="linenos">1828</span></a>      <span class="bp">self</span><span class="o">.</span><span class="n">shape</span> <span class="o">=</span> <span class="n">geom</span><span class="o">.</span><span class="n">Polygon</span><span class="p">([</span><span class="n">c</span><span class="o">.</span><span class="n">point</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">corners</span><span class="p">])</span>
</span><span id="Tile.offset_corners-1829"><a href="#Tile.offset_corners-1829"><span class="linenos">1829</span></a>      <span class="bp">self</span><span class="o">.</span><span class="n">edges</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">offset</span><span class="p">:]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">[:</span><span class="n">offset</span><span class="p">]</span>
</span><span id="Tile.offset_corners-1830"><a href="#Tile.offset_corners-1830"><span class="linenos">1830</span></a>      <span class="bp">self</span><span class="o">.</span><span class="n">edges_CW</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges_CW</span><span class="p">[</span><span class="n">offset</span><span class="p">:]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges_CW</span><span class="p">[:</span><span class="n">offset</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Shift shape, corners, edges, and edges_CW by an offset amount.</p>

<p>This is used to align tiles that are similar, which is required for correct
transfer of 'base' tile labelling on to 'radius 1' tiles during Topology
construction.</p>

<p>Args:
  offset (int): the number of positions to shift the lists.</p>
</div>


                            </div>
                            <div id="Tile.get_edge_label" class="classattr">
                                        <input id="Tile.get_edge_label-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_edge_label</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">e</span><span class="p">:</span> <span class="n"><a href="#Edge">Edge</a></span></span><span class="return-annotation">) -> <span class="nb">str</span>:</span></span>

                <label class="view-source-button" for="Tile.get_edge_label-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Tile.get_edge_label"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Tile.get_edge_label-1833"><a href="#Tile.get_edge_label-1833"><span class="linenos">1833</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">get_edge_label</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">e</span><span class="p">:</span><span class="n">Edge</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="Tile.get_edge_label-1834"><a href="#Tile.get_edge_label-1834"><span class="linenos">1834</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return edge label of specified edge.</span>
</span><span id="Tile.get_edge_label-1835"><a href="#Tile.get_edge_label-1835"><span class="linenos">1835</span></a>
</span><span id="Tile.get_edge_label-1836"><a href="#Tile.get_edge_label-1836"><span class="linenos">1836</span></a><span class="sd">    Args:</span>
</span><span id="Tile.get_edge_label-1837"><a href="#Tile.get_edge_label-1837"><span class="linenos">1837</span></a><span class="sd">        e (Edge): Edge whose label is required.</span>
</span><span id="Tile.get_edge_label-1838"><a href="#Tile.get_edge_label-1838"><span class="linenos">1838</span></a>
</span><span id="Tile.get_edge_label-1839"><a href="#Tile.get_edge_label-1839"><span class="linenos">1839</span></a><span class="sd">    Returns:</span>
</span><span id="Tile.get_edge_label-1840"><a href="#Tile.get_edge_label-1840"><span class="linenos">1840</span></a><span class="sd">        str: requested edge label.</span>
</span><span id="Tile.get_edge_label-1841"><a href="#Tile.get_edge_label-1841"><span class="linenos">1841</span></a>
</span><span id="Tile.get_edge_label-1842"><a href="#Tile.get_edge_label-1842"><span class="linenos">1842</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Tile.get_edge_label-1843"><a href="#Tile.get_edge_label-1843"><span class="linenos">1843</span></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">edge_labels</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">get_edge_IDs</span><span class="p">()</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">ID</span><span class="p">)]</span>
</span></pre></div>


            <div class="docstring"><p>Return edge label of specified edge.</p>

<p>Args:
    e (Edge): Edge whose label is required.</p>

<p>Returns:
    str: requested edge label.</p>
</div>


                            </div>
                            <div id="Tile.get_corner_label" class="classattr">
                                        <input id="Tile.get_corner_label-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_corner_label</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">v</span><span class="p">:</span> <span class="n"><a href="#Vertex">Vertex</a></span></span><span class="return-annotation">) -> <span class="nb">str</span>:</span></span>

                <label class="view-source-button" for="Tile.get_corner_label-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Tile.get_corner_label"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Tile.get_corner_label-1846"><a href="#Tile.get_corner_label-1846"><span class="linenos">1846</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">get_corner_label</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">v</span><span class="p">:</span><span class="n">Vertex</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="Tile.get_corner_label-1847"><a href="#Tile.get_corner_label-1847"><span class="linenos">1847</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return corner label of specified corner.</span>
</span><span id="Tile.get_corner_label-1848"><a href="#Tile.get_corner_label-1848"><span class="linenos">1848</span></a>
</span><span id="Tile.get_corner_label-1849"><a href="#Tile.get_corner_label-1849"><span class="linenos">1849</span></a><span class="sd">    Args:</span>
</span><span id="Tile.get_corner_label-1850"><a href="#Tile.get_corner_label-1850"><span class="linenos">1850</span></a><span class="sd">        v (Vertex): corner whose label is required.</span>
</span><span id="Tile.get_corner_label-1851"><a href="#Tile.get_corner_label-1851"><span class="linenos">1851</span></a>
</span><span id="Tile.get_corner_label-1852"><a href="#Tile.get_corner_label-1852"><span class="linenos">1852</span></a><span class="sd">    Returns:</span>
</span><span id="Tile.get_corner_label-1853"><a href="#Tile.get_corner_label-1853"><span class="linenos">1853</span></a><span class="sd">        str: requested corner label.</span>
</span><span id="Tile.get_corner_label-1854"><a href="#Tile.get_corner_label-1854"><span class="linenos">1854</span></a>
</span><span id="Tile.get_corner_label-1855"><a href="#Tile.get_corner_label-1855"><span class="linenos">1855</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Tile.get_corner_label-1856"><a href="#Tile.get_corner_label-1856"><span class="linenos">1856</span></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">edge_labels</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">get_corner_IDs</span><span class="p">()</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">ID</span><span class="p">)]</span>
</span></pre></div>


            <div class="docstring"><p>Return corner label of specified corner.</p>

<p>Args:
    v (Vertex): corner whose label is required.</p>

<p>Returns:
    str: requested corner label.</p>
</div>


                            </div>
                            <div id="Tile.angle_at" class="classattr">
                                        <input id="Tile.angle_at-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">angle_at</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">v</span><span class="p">:</span> <span class="n"><a href="#Vertex">Vertex</a></span></span><span class="return-annotation">) -> <span class="nb">float</span>:</span></span>

                <label class="view-source-button" for="Tile.angle_at-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Tile.angle_at"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Tile.angle_at-1859"><a href="#Tile.angle_at-1859"><span class="linenos">1859</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">angle_at</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">v</span><span class="p">:</span><span class="n">Vertex</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="Tile.angle_at-1860"><a href="#Tile.angle_at-1860"><span class="linenos">1860</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return interior angle at the specified corner (in degrees).</span>
</span><span id="Tile.angle_at-1861"><a href="#Tile.angle_at-1861"><span class="linenos">1861</span></a>
</span><span id="Tile.angle_at-1862"><a href="#Tile.angle_at-1862"><span class="linenos">1862</span></a><span class="sd">    Args:</span>
</span><span id="Tile.angle_at-1863"><a href="#Tile.angle_at-1863"><span class="linenos">1863</span></a><span class="sd">        v (Vertex): corner where angle is requested.</span>
</span><span id="Tile.angle_at-1864"><a href="#Tile.angle_at-1864"><span class="linenos">1864</span></a>
</span><span id="Tile.angle_at-1865"><a href="#Tile.angle_at-1865"><span class="linenos">1865</span></a><span class="sd">    Returns:</span>
</span><span id="Tile.angle_at-1866"><a href="#Tile.angle_at-1866"><span class="linenos">1866</span></a><span class="sd">        float: angle at corner v in degrees.</span>
</span><span id="Tile.angle_at-1867"><a href="#Tile.angle_at-1867"><span class="linenos">1867</span></a>
</span><span id="Tile.angle_at-1868"><a href="#Tile.angle_at-1868"><span class="linenos">1868</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Tile.angle_at-1869"><a href="#Tile.angle_at-1869"><span class="linenos">1869</span></a>    <span class="n">i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">corners</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
</span><span id="Tile.angle_at-1870"><a href="#Tile.angle_at-1870"><span class="linenos">1870</span></a>    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">corners</span><span class="p">)</span>
</span><span id="Tile.angle_at-1871"><a href="#Tile.angle_at-1871"><span class="linenos">1871</span></a>    <span class="k">return</span> <span class="n">tiling_utils</span><span class="o">.</span><span class="n">get_inner_angle</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">corners</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">point</span><span class="p">,</span>
</span><span id="Tile.angle_at-1872"><a href="#Tile.angle_at-1872"><span class="linenos">1872</span></a>                                        <span class="bp">self</span><span class="o">.</span><span class="n">corners</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">point</span><span class="p">,</span>
</span><span id="Tile.angle_at-1873"><a href="#Tile.angle_at-1873"><span class="linenos">1873</span></a>                                        <span class="bp">self</span><span class="o">.</span><span class="n">corners</span><span class="p">[(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="n">n</span><span class="p">]</span><span class="o">.</span><span class="n">point</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Return interior angle at the specified corner (in degrees).</p>

<p>Args:
    v (Vertex): corner where angle is requested.</p>

<p>Returns:
    float: angle at corner v in degrees.</p>
</div>


                            </div>
                </section>
                <section id="Vertex">
                            <input id="Vertex-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">Vertex</span>:

                <label class="view-source-button" for="Vertex-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Vertex"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Vertex-1876"><a href="#Vertex-1876"><span class="linenos">1876</span></a><span class="k">class</span><span class="w"> </span><span class="nc">Vertex</span><span class="p">:</span>
</span><span id="Vertex-1877"><a href="#Vertex-1877"><span class="linenos">1877</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;Class to store attributes of a vertex in a tiling.&quot;&quot;&quot;</span>
</span><span id="Vertex-1878"><a href="#Vertex-1878"><span class="linenos">1878</span></a>
</span><span id="Vertex-1879"><a href="#Vertex-1879"><span class="linenos">1879</span></a>  <span class="n">point</span><span class="p">:</span> <span class="n">geom</span><span class="o">.</span><span class="n">Point</span>
</span><span id="Vertex-1880"><a href="#Vertex-1880"><span class="linenos">1880</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;point (geom.Point): point location of the vertex.&quot;&quot;&quot;</span>
</span><span id="Vertex-1881"><a href="#Vertex-1881"><span class="linenos">1881</span></a>  <span class="n">ID</span><span class="p">:</span> <span class="nb">int</span>
</span><span id="Vertex-1882"><a href="#Vertex-1882"><span class="linenos">1882</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;integer (mostly but not necessarily in sequence) of vertex keyed into the</span>
</span><span id="Vertex-1883"><a href="#Vertex-1883"><span class="linenos">1883</span></a><span class="sd">  points dictionary of the containing Topology.&quot;&quot;&quot;</span>
</span><span id="Vertex-1884"><a href="#Vertex-1884"><span class="linenos">1884</span></a>  <span class="n">tiles</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Tile</span><span class="p">]</span>
</span><span id="Vertex-1885"><a href="#Vertex-1885"><span class="linenos">1885</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;list of Tiles incident on this vertex.&quot;&quot;&quot;</span>
</span><span id="Vertex-1886"><a href="#Vertex-1886"><span class="linenos">1886</span></a>  <span class="n">neighbours</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span>
</span><span id="Vertex-1887"><a href="#Vertex-1887"><span class="linenos">1887</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;list of the immediately adjacent other corner IDs. Only required to</span>
</span><span id="Vertex-1888"><a href="#Vertex-1888"><span class="linenos">1888</span></a><span class="sd">  determine if a point is a tiling vertex (when it will have) three or more</span>
</span><span id="Vertex-1889"><a href="#Vertex-1889"><span class="linenos">1889</span></a><span class="sd">  neighbours, so only IDs are stored.&quot;&quot;&quot;</span>
</span><span id="Vertex-1890"><a href="#Vertex-1890"><span class="linenos">1890</span></a>  <span class="n">base_ID</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1_000_000</span>
</span><span id="Vertex-1891"><a href="#Vertex-1891"><span class="linenos">1891</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;ID of corresponding Vertex in the tileable base_unit&quot;&quot;&quot;</span>
</span><span id="Vertex-1892"><a href="#Vertex-1892"><span class="linenos">1892</span></a>  <span class="n">transitivity_class</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Vertex-1893"><a href="#Vertex-1893"><span class="linenos">1893</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;transitivity class of the vertex under symmetries of the tiling&quot;&quot;&quot;</span>
</span><span id="Vertex-1894"><a href="#Vertex-1894"><span class="linenos">1894</span></a>  <span class="n">label</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="Vertex-1895"><a href="#Vertex-1895"><span class="linenos">1895</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;the (upper case letter) label of the vertex under the symmetries of the</span>
</span><span id="Vertex-1896"><a href="#Vertex-1896"><span class="linenos">1896</span></a><span class="sd">  tiling.&quot;&quot;&quot;</span>
</span><span id="Vertex-1897"><a href="#Vertex-1897"><span class="linenos">1897</span></a>  <span class="n">is_tiling_vertex</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="Vertex-1898"><a href="#Vertex-1898"><span class="linenos">1898</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;is_tiling_vertex (bool): True if this is a tiling vertex, rather than a</span>
</span><span id="Vertex-1899"><a href="#Vertex-1899"><span class="linenos">1899</span></a><span class="sd">  tile corner. E.g., A below is a corner, not a tiling vertex. B is a tiling</span>
</span><span id="Vertex-1900"><a href="#Vertex-1900"><span class="linenos">1900</span></a><span class="sd">  vertex:</span>
</span><span id="Vertex-1901"><a href="#Vertex-1901"><span class="linenos">1901</span></a>
</span><span id="Vertex-1902"><a href="#Vertex-1902"><span class="linenos">1902</span></a><span class="sd">      +-------+</span>
</span><span id="Vertex-1903"><a href="#Vertex-1903"><span class="linenos">1903</span></a><span class="sd">      | 1     |</span>
</span><span id="Vertex-1904"><a href="#Vertex-1904"><span class="linenos">1904</span></a><span class="sd">      |   A---B---+</span>
</span><span id="Vertex-1905"><a href="#Vertex-1905"><span class="linenos">1905</span></a><span class="sd">      |   | 2     |</span>
</span><span id="Vertex-1906"><a href="#Vertex-1906"><span class="linenos">1906</span></a><span class="sd">      +---C   +---+</span>
</span><span id="Vertex-1907"><a href="#Vertex-1907"><span class="linenos">1907</span></a><span class="sd">          |   |</span>
</span><span id="Vertex-1908"><a href="#Vertex-1908"><span class="linenos">1908</span></a><span class="sd">          +---+&quot;&quot;&quot;</span>
</span><span id="Vertex-1909"><a href="#Vertex-1909"><span class="linenos">1909</span></a>
</span><span id="Vertex-1910"><a href="#Vertex-1910"><span class="linenos">1910</span></a>
</span><span id="Vertex-1911"><a href="#Vertex-1911"><span class="linenos">1911</span></a>  <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="Vertex-1912"><a href="#Vertex-1912"><span class="linenos">1912</span></a>      <span class="bp">self</span><span class="p">,</span>
</span><span id="Vertex-1913"><a href="#Vertex-1913"><span class="linenos">1913</span></a>      <span class="n">point</span><span class="p">:</span><span class="n">geom</span><span class="o">.</span><span class="n">Point</span><span class="p">,</span>
</span><span id="Vertex-1914"><a href="#Vertex-1914"><span class="linenos">1914</span></a>      <span class="n">ID</span><span class="p">:</span><span class="nb">int</span><span class="p">,</span>
</span><span id="Vertex-1915"><a href="#Vertex-1915"><span class="linenos">1915</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Vertex-1916"><a href="#Vertex-1916"><span class="linenos">1916</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Class constructor.</span>
</span><span id="Vertex-1917"><a href="#Vertex-1917"><span class="linenos">1917</span></a>
</span><span id="Vertex-1918"><a href="#Vertex-1918"><span class="linenos">1918</span></a><span class="sd">    Args:</span>
</span><span id="Vertex-1919"><a href="#Vertex-1919"><span class="linenos">1919</span></a><span class="sd">      point (geom.Point): point location of the vertex.</span>
</span><span id="Vertex-1920"><a href="#Vertex-1920"><span class="linenos">1920</span></a><span class="sd">      ID (int): a unique integer ID (which will be its key in the containing</span>
</span><span id="Vertex-1921"><a href="#Vertex-1921"><span class="linenos">1921</span></a><span class="sd">        Topology points dictionary).</span>
</span><span id="Vertex-1922"><a href="#Vertex-1922"><span class="linenos">1922</span></a>
</span><span id="Vertex-1923"><a href="#Vertex-1923"><span class="linenos">1923</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Vertex-1924"><a href="#Vertex-1924"><span class="linenos">1924</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">point</span> <span class="o">=</span> <span class="n">point</span>
</span><span id="Vertex-1925"><a href="#Vertex-1925"><span class="linenos">1925</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">ID</span> <span class="o">=</span> <span class="n">ID</span>
</span><span id="Vertex-1926"><a href="#Vertex-1926"><span class="linenos">1926</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">base_ID</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ID</span>
</span><span id="Vertex-1927"><a href="#Vertex-1927"><span class="linenos">1927</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">tiles</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Vertex-1928"><a href="#Vertex-1928"><span class="linenos">1928</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">neighbours</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Vertex-1929"><a href="#Vertex-1929"><span class="linenos">1929</span></a>
</span><span id="Vertex-1930"><a href="#Vertex-1930"><span class="linenos">1930</span></a>
</span><span id="Vertex-1931"><a href="#Vertex-1931"><span class="linenos">1931</span></a>  <span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="Vertex-1932"><a href="#Vertex-1932"><span class="linenos">1932</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return string representation of Vertex.</span>
</span><span id="Vertex-1933"><a href="#Vertex-1933"><span class="linenos">1933</span></a>
</span><span id="Vertex-1934"><a href="#Vertex-1934"><span class="linenos">1934</span></a><span class="sd">    Returns:</span>
</span><span id="Vertex-1935"><a href="#Vertex-1935"><span class="linenos">1935</span></a><span class="sd">        str: string including ID, point and list of incident Tiles.</span>
</span><span id="Vertex-1936"><a href="#Vertex-1936"><span class="linenos">1936</span></a>
</span><span id="Vertex-1937"><a href="#Vertex-1937"><span class="linenos">1937</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Vertex-1938"><a href="#Vertex-1938"><span class="linenos">1938</span></a>    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;Vertex </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">ID</span><span class="si">}</span><span class="s2"> at </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">point</span><span class="si">}</span><span class="s2"> Tiles: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">get_tile_IDs</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="Vertex-1939"><a href="#Vertex-1939"><span class="linenos">1939</span></a>
</span><span id="Vertex-1940"><a href="#Vertex-1940"><span class="linenos">1940</span></a>
</span><span id="Vertex-1941"><a href="#Vertex-1941"><span class="linenos">1941</span></a>  <span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="Vertex-1942"><a href="#Vertex-1942"><span class="linenos">1942</span></a>    <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="Vertex-1943"><a href="#Vertex-1943"><span class="linenos">1943</span></a>
</span><span id="Vertex-1944"><a href="#Vertex-1944"><span class="linenos">1944</span></a>
</span><span id="Vertex-1945"><a href="#Vertex-1945"><span class="linenos">1945</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">get_tile_IDs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
</span><span id="Vertex-1946"><a href="#Vertex-1946"><span class="linenos">1946</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return list of Tile IDs (not the Tiles themselves).</span>
</span><span id="Vertex-1947"><a href="#Vertex-1947"><span class="linenos">1947</span></a>
</span><span id="Vertex-1948"><a href="#Vertex-1948"><span class="linenos">1948</span></a><span class="sd">    Returns:</span>
</span><span id="Vertex-1949"><a href="#Vertex-1949"><span class="linenos">1949</span></a><span class="sd">        list[int]: list of Tile IDs</span>
</span><span id="Vertex-1950"><a href="#Vertex-1950"><span class="linenos">1950</span></a>
</span><span id="Vertex-1951"><a href="#Vertex-1951"><span class="linenos">1951</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Vertex-1952"><a href="#Vertex-1952"><span class="linenos">1952</span></a>    <span class="k">return</span> <span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">ID</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tiles</span><span class="p">]</span>
</span><span id="Vertex-1953"><a href="#Vertex-1953"><span class="linenos">1953</span></a>
</span><span id="Vertex-1954"><a href="#Vertex-1954"><span class="linenos">1954</span></a>
</span><span id="Vertex-1955"><a href="#Vertex-1955"><span class="linenos">1955</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">add_tile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tile</span><span class="p">:</span><span class="n">Tile</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Vertex-1956"><a href="#Vertex-1956"><span class="linenos">1956</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Add supplied Tile to the tiles list if it is not already present.</span>
</span><span id="Vertex-1957"><a href="#Vertex-1957"><span class="linenos">1957</span></a>
</span><span id="Vertex-1958"><a href="#Vertex-1958"><span class="linenos">1958</span></a><span class="sd">    Args:</span>
</span><span id="Vertex-1959"><a href="#Vertex-1959"><span class="linenos">1959</span></a><span class="sd">        tile (Tile): Tile to add.</span>
</span><span id="Vertex-1960"><a href="#Vertex-1960"><span class="linenos">1960</span></a>
</span><span id="Vertex-1961"><a href="#Vertex-1961"><span class="linenos">1961</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Vertex-1962"><a href="#Vertex-1962"><span class="linenos">1962</span></a>    <span class="k">if</span> <span class="n">tile</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tiles</span><span class="p">:</span>
</span><span id="Vertex-1963"><a href="#Vertex-1963"><span class="linenos">1963</span></a>      <span class="bp">self</span><span class="o">.</span><span class="n">tiles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tile</span><span class="p">)</span>
</span><span id="Vertex-1964"><a href="#Vertex-1964"><span class="linenos">1964</span></a>
</span><span id="Vertex-1965"><a href="#Vertex-1965"><span class="linenos">1965</span></a>
</span><span id="Vertex-1966"><a href="#Vertex-1966"><span class="linenos">1966</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">add_neighbour</span><span class="p">(</span>
</span><span id="Vertex-1967"><a href="#Vertex-1967"><span class="linenos">1967</span></a>      <span class="bp">self</span><span class="p">,</span>
</span><span id="Vertex-1968"><a href="#Vertex-1968"><span class="linenos">1968</span></a>      <span class="n">vertex_id</span><span class="p">:</span><span class="nb">int</span><span class="p">,</span>
</span><span id="Vertex-1969"><a href="#Vertex-1969"><span class="linenos">1969</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Vertex-1970"><a href="#Vertex-1970"><span class="linenos">1970</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Add supplied ID to the neighbours list if it is not already present.</span>
</span><span id="Vertex-1971"><a href="#Vertex-1971"><span class="linenos">1971</span></a>
</span><span id="Vertex-1972"><a href="#Vertex-1972"><span class="linenos">1972</span></a><span class="sd">    Args:</span>
</span><span id="Vertex-1973"><a href="#Vertex-1973"><span class="linenos">1973</span></a><span class="sd">      vertex_id (int): ID to add to the neighbours list.</span>
</span><span id="Vertex-1974"><a href="#Vertex-1974"><span class="linenos">1974</span></a>
</span><span id="Vertex-1975"><a href="#Vertex-1975"><span class="linenos">1975</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Vertex-1976"><a href="#Vertex-1976"><span class="linenos">1976</span></a>    <span class="k">if</span> <span class="n">vertex_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">neighbours</span><span class="p">:</span>
</span><span id="Vertex-1977"><a href="#Vertex-1977"><span class="linenos">1977</span></a>      <span class="bp">self</span><span class="o">.</span><span class="n">neighbours</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">vertex_id</span><span class="p">)</span>
</span><span id="Vertex-1978"><a href="#Vertex-1978"><span class="linenos">1978</span></a>
</span><span id="Vertex-1979"><a href="#Vertex-1979"><span class="linenos">1979</span></a>
</span><span id="Vertex-1980"><a href="#Vertex-1980"><span class="linenos">1980</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">clockwise_order_incident_tiles</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Vertex-1981"><a href="#Vertex-1981"><span class="linenos">1981</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Reorder tiles list clockwise (this is for dual tiling construction).&quot;&quot;&quot;</span>
</span><span id="Vertex-1982"><a href="#Vertex-1982"><span class="linenos">1982</span></a>    <span class="n">cw_order</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_order_of_pts_cw_around_centre</span><span class="p">(</span>
</span><span id="Vertex-1983"><a href="#Vertex-1983"><span class="linenos">1983</span></a>      <span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">centre</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tiles</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">point</span><span class="p">)</span>
</span><span id="Vertex-1984"><a href="#Vertex-1984"><span class="linenos">1984</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">tiles</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">tiles</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">cw_order</span><span class="p">]</span>
</span><span id="Vertex-1985"><a href="#Vertex-1985"><span class="linenos">1985</span></a>
</span><span id="Vertex-1986"><a href="#Vertex-1986"><span class="linenos">1986</span></a>
</span><span id="Vertex-1987"><a href="#Vertex-1987"><span class="linenos">1987</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">is_interior</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="Vertex-1988"><a href="#Vertex-1988"><span class="linenos">1988</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Test if vertex is completely enclosed by its incident Tiles.</span>
</span><span id="Vertex-1989"><a href="#Vertex-1989"><span class="linenos">1989</span></a>
</span><span id="Vertex-1990"><a href="#Vertex-1990"><span class="linenos">1990</span></a><span class="sd">    Based on summing the interior angles of the incident tiles at this vertex.</span>
</span><span id="Vertex-1991"><a href="#Vertex-1991"><span class="linenos">1991</span></a>
</span><span id="Vertex-1992"><a href="#Vertex-1992"><span class="linenos">1992</span></a><span class="sd">    Returns:</span>
</span><span id="Vertex-1993"><a href="#Vertex-1993"><span class="linenos">1993</span></a><span class="sd">        bool: True if vertex is completely enclosed by incident Tiles.</span>
</span><span id="Vertex-1994"><a href="#Vertex-1994"><span class="linenos">1994</span></a>
</span><span id="Vertex-1995"><a href="#Vertex-1995"><span class="linenos">1995</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Vertex-1996"><a href="#Vertex-1996"><span class="linenos">1996</span></a>    <span class="k">return</span> <span class="nb">abs</span><span class="p">(</span><span class="mi">360</span> <span class="o">-</span> <span class="nb">sum</span><span class="p">([</span><span class="n">t</span><span class="o">.</span><span class="n">angle_at</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tiles</span><span class="p">]))</span> \
</span><span id="Vertex-1997"><a href="#Vertex-1997"><span class="linenos">1997</span></a>                     <span class="o">&lt;</span> <span class="n">tiling_utils</span><span class="o">.</span><span class="n">RESOLUTION</span>
</span><span id="Vertex-1998"><a href="#Vertex-1998"><span class="linenos">1998</span></a>
</span><span id="Vertex-1999"><a href="#Vertex-1999"><span class="linenos">1999</span></a>
</span><span id="Vertex-2000"><a href="#Vertex-2000"><span class="linenos">2000</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">_order_of_pts_cw_around_centre</span><span class="p">(</span>
</span><span id="Vertex-2001"><a href="#Vertex-2001"><span class="linenos">2001</span></a>      <span class="bp">self</span><span class="p">,</span>
</span><span id="Vertex-2002"><a href="#Vertex-2002"><span class="linenos">2002</span></a>      <span class="n">pts</span><span class="p">:</span><span class="nb">list</span><span class="p">[</span><span class="n">geom</span><span class="o">.</span><span class="n">Point</span><span class="p">],</span>
</span><span id="Vertex-2003"><a href="#Vertex-2003"><span class="linenos">2003</span></a>      <span class="n">centre</span><span class="p">:</span><span class="n">geom</span><span class="o">.</span><span class="n">Point</span><span class="p">,</span>
</span><span id="Vertex-2004"><a href="#Vertex-2004"><span class="linenos">2004</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
</span><span id="Vertex-2005"><a href="#Vertex-2005"><span class="linenos">2005</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return order of points clockwise relative to centre point.</span>
</span><span id="Vertex-2006"><a href="#Vertex-2006"><span class="linenos">2006</span></a>
</span><span id="Vertex-2007"><a href="#Vertex-2007"><span class="linenos">2007</span></a><span class="sd">    Args:</span>
</span><span id="Vertex-2008"><a href="#Vertex-2008"><span class="linenos">2008</span></a><span class="sd">      pts (list[geom.Point]): list of points to order.</span>
</span><span id="Vertex-2009"><a href="#Vertex-2009"><span class="linenos">2009</span></a><span class="sd">      centre (geom.Point): centre relative to which CW order is determined.</span>
</span><span id="Vertex-2010"><a href="#Vertex-2010"><span class="linenos">2010</span></a>
</span><span id="Vertex-2011"><a href="#Vertex-2011"><span class="linenos">2011</span></a><span class="sd">    Returns:</span>
</span><span id="Vertex-2012"><a href="#Vertex-2012"><span class="linenos">2012</span></a><span class="sd">      list[int]: list of indices of reordered points.</span>
</span><span id="Vertex-2013"><a href="#Vertex-2013"><span class="linenos">2013</span></a>
</span><span id="Vertex-2014"><a href="#Vertex-2014"><span class="linenos">2014</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Vertex-2015"><a href="#Vertex-2015"><span class="linenos">2015</span></a>    <span class="n">dx</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span><span class="o">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">centre</span><span class="o">.</span><span class="n">x</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">pts</span><span class="p">]</span>
</span><span id="Vertex-2016"><a href="#Vertex-2016"><span class="linenos">2016</span></a>    <span class="n">dy</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span><span class="o">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">centre</span><span class="o">.</span><span class="n">y</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">pts</span><span class="p">]</span>
</span><span id="Vertex-2017"><a href="#Vertex-2017"><span class="linenos">2017</span></a>    <span class="n">angles</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">arctan2</span><span class="p">(</span><span class="n">dy</span><span class="p">,</span> <span class="n">dx</span><span class="p">)</span> <span class="k">for</span> <span class="n">dx</span><span class="p">,</span> <span class="n">dy</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="p">,</span> <span class="n">strict</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)]</span>
</span><span id="Vertex-2018"><a href="#Vertex-2018"><span class="linenos">2018</span></a>    <span class="n">d</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">angles</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">pts</span><span class="p">)),</span> <span class="n">strict</span> <span class="o">=</span> <span class="kc">True</span><span class="p">))</span>
</span><span id="Vertex-2019"><a href="#Vertex-2019"><span class="linenos">2019</span></a>    <span class="k">return</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">angle</span><span class="p">,</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)]</span>
</span></pre></div>


            <div class="docstring"><p>Class to store attributes of a vertex in a tiling.</p>
</div>


                            <div id="Vertex.__init__" class="classattr">
                                        <input id="Vertex.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">Vertex</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">point</span><span class="p">:</span> <span class="n">shapely</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">point</span><span class="o">.</span><span class="n">Point</span>, </span><span class="param"><span class="n">ID</span><span class="p">:</span> <span class="nb">int</span></span>)</span>

                <label class="view-source-button" for="Vertex.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Vertex.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Vertex.__init__-1911"><a href="#Vertex.__init__-1911"><span class="linenos">1911</span></a>  <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="Vertex.__init__-1912"><a href="#Vertex.__init__-1912"><span class="linenos">1912</span></a>      <span class="bp">self</span><span class="p">,</span>
</span><span id="Vertex.__init__-1913"><a href="#Vertex.__init__-1913"><span class="linenos">1913</span></a>      <span class="n">point</span><span class="p">:</span><span class="n">geom</span><span class="o">.</span><span class="n">Point</span><span class="p">,</span>
</span><span id="Vertex.__init__-1914"><a href="#Vertex.__init__-1914"><span class="linenos">1914</span></a>      <span class="n">ID</span><span class="p">:</span><span class="nb">int</span><span class="p">,</span>
</span><span id="Vertex.__init__-1915"><a href="#Vertex.__init__-1915"><span class="linenos">1915</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Vertex.__init__-1916"><a href="#Vertex.__init__-1916"><span class="linenos">1916</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Class constructor.</span>
</span><span id="Vertex.__init__-1917"><a href="#Vertex.__init__-1917"><span class="linenos">1917</span></a>
</span><span id="Vertex.__init__-1918"><a href="#Vertex.__init__-1918"><span class="linenos">1918</span></a><span class="sd">    Args:</span>
</span><span id="Vertex.__init__-1919"><a href="#Vertex.__init__-1919"><span class="linenos">1919</span></a><span class="sd">      point (geom.Point): point location of the vertex.</span>
</span><span id="Vertex.__init__-1920"><a href="#Vertex.__init__-1920"><span class="linenos">1920</span></a><span class="sd">      ID (int): a unique integer ID (which will be its key in the containing</span>
</span><span id="Vertex.__init__-1921"><a href="#Vertex.__init__-1921"><span class="linenos">1921</span></a><span class="sd">        Topology points dictionary).</span>
</span><span id="Vertex.__init__-1922"><a href="#Vertex.__init__-1922"><span class="linenos">1922</span></a>
</span><span id="Vertex.__init__-1923"><a href="#Vertex.__init__-1923"><span class="linenos">1923</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Vertex.__init__-1924"><a href="#Vertex.__init__-1924"><span class="linenos">1924</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">point</span> <span class="o">=</span> <span class="n">point</span>
</span><span id="Vertex.__init__-1925"><a href="#Vertex.__init__-1925"><span class="linenos">1925</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">ID</span> <span class="o">=</span> <span class="n">ID</span>
</span><span id="Vertex.__init__-1926"><a href="#Vertex.__init__-1926"><span class="linenos">1926</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">base_ID</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ID</span>
</span><span id="Vertex.__init__-1927"><a href="#Vertex.__init__-1927"><span class="linenos">1927</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">tiles</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Vertex.__init__-1928"><a href="#Vertex.__init__-1928"><span class="linenos">1928</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">neighbours</span> <span class="o">=</span> <span class="p">[]</span>
</span></pre></div>


            <div class="docstring"><p>Class constructor.</p>

<p>Args:
  point (geom.Point): point location of the vertex.
  ID (int): a unique integer ID (which will be its key in the containing
    Topology points dictionary).</p>
</div>


                            </div>
                            <div id="Vertex.point" class="classattr">
                                <div class="attr variable">
            <span class="name">point</span><span class="annotation">: shapely.geometry.point.Point</span>

        
    </div>
    <a class="headerlink" href="#Vertex.point"></a>
    
            <div class="docstring"><p>point (geom.Point): point location of the vertex.</p>
</div>


                            </div>
                            <div id="Vertex.ID" class="classattr">
                                <div class="attr variable">
            <span class="name">ID</span><span class="annotation">: int</span>

        
    </div>
    <a class="headerlink" href="#Vertex.ID"></a>
    
            <div class="docstring"><p>integer (mostly but not necessarily in sequence) of vertex keyed into the
points dictionary of the containing Topology.</p>
</div>


                            </div>
                            <div id="Vertex.tiles" class="classattr">
                                <div class="attr variable">
            <span class="name">tiles</span><span class="annotation">: list[<a href="#Tile">Tile</a>]</span>

        
    </div>
    <a class="headerlink" href="#Vertex.tiles"></a>
    
            <div class="docstring"><p>list of Tiles incident on this vertex.</p>
</div>


                            </div>
                            <div id="Vertex.neighbours" class="classattr">
                                <div class="attr variable">
            <span class="name">neighbours</span><span class="annotation">: list[int]</span>

        
    </div>
    <a class="headerlink" href="#Vertex.neighbours"></a>
    
            <div class="docstring"><p>list of the immediately adjacent other corner IDs. Only required to
determine if a point is a tiling vertex (when it will have) three or more
neighbours, so only IDs are stored.</p>
</div>


                            </div>
                            <div id="Vertex.base_ID" class="classattr">
                                <div class="attr variable">
            <span class="name">base_ID</span><span class="annotation">: int</span>        =
<span class="default_value">1000000</span>

        
    </div>
    <a class="headerlink" href="#Vertex.base_ID"></a>
    
            <div class="docstring"><p>ID of corresponding Vertex in the tileable base_unit</p>
</div>


                            </div>
                            <div id="Vertex.transitivity_class" class="classattr">
                                <div class="attr variable">
            <span class="name">transitivity_class</span><span class="annotation">: int</span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#Vertex.transitivity_class"></a>
    
            <div class="docstring"><p>transitivity class of the vertex under symmetries of the tiling</p>
</div>


                            </div>
                            <div id="Vertex.label" class="classattr">
                                <div class="attr variable">
            <span class="name">label</span><span class="annotation">: str</span>        =
<span class="default_value">&#39;&#39;</span>

        
    </div>
    <a class="headerlink" href="#Vertex.label"></a>
    
            <div class="docstring"><p>the (upper case letter) label of the vertex under the symmetries of the
tiling.</p>
</div>


                            </div>
                            <div id="Vertex.is_tiling_vertex" class="classattr">
                                <div class="attr variable">
            <span class="name">is_tiling_vertex</span><span class="annotation">: bool</span>        =
<span class="default_value">True</span>

        
    </div>
    <a class="headerlink" href="#Vertex.is_tiling_vertex"></a>
    
            <div class="docstring"><p>is_tiling_vertex (bool): True if this is a tiling vertex, rather than a
tile corner. E.g., A below is a corner, not a tiling vertex. B is a tiling
vertex:</p>

<pre><code>+-------+
| 1     |
|   A---B---+
|   | 2     |
+---C   +---+
    |   |
    +---+
</code></pre>
</div>


                            </div>
                            <div id="Vertex.get_tile_IDs" class="classattr">
                                        <input id="Vertex.get_tile_IDs-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_tile_IDs</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="Vertex.get_tile_IDs-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Vertex.get_tile_IDs"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Vertex.get_tile_IDs-1945"><a href="#Vertex.get_tile_IDs-1945"><span class="linenos">1945</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">get_tile_IDs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
</span><span id="Vertex.get_tile_IDs-1946"><a href="#Vertex.get_tile_IDs-1946"><span class="linenos">1946</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return list of Tile IDs (not the Tiles themselves).</span>
</span><span id="Vertex.get_tile_IDs-1947"><a href="#Vertex.get_tile_IDs-1947"><span class="linenos">1947</span></a>
</span><span id="Vertex.get_tile_IDs-1948"><a href="#Vertex.get_tile_IDs-1948"><span class="linenos">1948</span></a><span class="sd">    Returns:</span>
</span><span id="Vertex.get_tile_IDs-1949"><a href="#Vertex.get_tile_IDs-1949"><span class="linenos">1949</span></a><span class="sd">        list[int]: list of Tile IDs</span>
</span><span id="Vertex.get_tile_IDs-1950"><a href="#Vertex.get_tile_IDs-1950"><span class="linenos">1950</span></a>
</span><span id="Vertex.get_tile_IDs-1951"><a href="#Vertex.get_tile_IDs-1951"><span class="linenos">1951</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Vertex.get_tile_IDs-1952"><a href="#Vertex.get_tile_IDs-1952"><span class="linenos">1952</span></a>    <span class="k">return</span> <span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">ID</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tiles</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Return list of Tile IDs (not the Tiles themselves).</p>

<p>Returns:
    list[int]: list of Tile IDs</p>
</div>


                            </div>
                            <div id="Vertex.add_tile" class="classattr">
                                        <input id="Vertex.add_tile-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">add_tile</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">tile</span><span class="p">:</span> <span class="n"><a href="#Tile">Tile</a></span></span><span class="return-annotation">) -> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="Vertex.add_tile-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Vertex.add_tile"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Vertex.add_tile-1955"><a href="#Vertex.add_tile-1955"><span class="linenos">1955</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">add_tile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tile</span><span class="p">:</span><span class="n">Tile</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Vertex.add_tile-1956"><a href="#Vertex.add_tile-1956"><span class="linenos">1956</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Add supplied Tile to the tiles list if it is not already present.</span>
</span><span id="Vertex.add_tile-1957"><a href="#Vertex.add_tile-1957"><span class="linenos">1957</span></a>
</span><span id="Vertex.add_tile-1958"><a href="#Vertex.add_tile-1958"><span class="linenos">1958</span></a><span class="sd">    Args:</span>
</span><span id="Vertex.add_tile-1959"><a href="#Vertex.add_tile-1959"><span class="linenos">1959</span></a><span class="sd">        tile (Tile): Tile to add.</span>
</span><span id="Vertex.add_tile-1960"><a href="#Vertex.add_tile-1960"><span class="linenos">1960</span></a>
</span><span id="Vertex.add_tile-1961"><a href="#Vertex.add_tile-1961"><span class="linenos">1961</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Vertex.add_tile-1962"><a href="#Vertex.add_tile-1962"><span class="linenos">1962</span></a>    <span class="k">if</span> <span class="n">tile</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tiles</span><span class="p">:</span>
</span><span id="Vertex.add_tile-1963"><a href="#Vertex.add_tile-1963"><span class="linenos">1963</span></a>      <span class="bp">self</span><span class="o">.</span><span class="n">tiles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tile</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Add supplied Tile to the tiles list if it is not already present.</p>

<p>Args:
    tile (Tile): Tile to add.</p>
</div>


                            </div>
                            <div id="Vertex.add_neighbour" class="classattr">
                                        <input id="Vertex.add_neighbour-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">add_neighbour</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">vertex_id</span><span class="p">:</span> <span class="nb">int</span></span><span class="return-annotation">) -> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="Vertex.add_neighbour-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Vertex.add_neighbour"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Vertex.add_neighbour-1966"><a href="#Vertex.add_neighbour-1966"><span class="linenos">1966</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">add_neighbour</span><span class="p">(</span>
</span><span id="Vertex.add_neighbour-1967"><a href="#Vertex.add_neighbour-1967"><span class="linenos">1967</span></a>      <span class="bp">self</span><span class="p">,</span>
</span><span id="Vertex.add_neighbour-1968"><a href="#Vertex.add_neighbour-1968"><span class="linenos">1968</span></a>      <span class="n">vertex_id</span><span class="p">:</span><span class="nb">int</span><span class="p">,</span>
</span><span id="Vertex.add_neighbour-1969"><a href="#Vertex.add_neighbour-1969"><span class="linenos">1969</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Vertex.add_neighbour-1970"><a href="#Vertex.add_neighbour-1970"><span class="linenos">1970</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Add supplied ID to the neighbours list if it is not already present.</span>
</span><span id="Vertex.add_neighbour-1971"><a href="#Vertex.add_neighbour-1971"><span class="linenos">1971</span></a>
</span><span id="Vertex.add_neighbour-1972"><a href="#Vertex.add_neighbour-1972"><span class="linenos">1972</span></a><span class="sd">    Args:</span>
</span><span id="Vertex.add_neighbour-1973"><a href="#Vertex.add_neighbour-1973"><span class="linenos">1973</span></a><span class="sd">      vertex_id (int): ID to add to the neighbours list.</span>
</span><span id="Vertex.add_neighbour-1974"><a href="#Vertex.add_neighbour-1974"><span class="linenos">1974</span></a>
</span><span id="Vertex.add_neighbour-1975"><a href="#Vertex.add_neighbour-1975"><span class="linenos">1975</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Vertex.add_neighbour-1976"><a href="#Vertex.add_neighbour-1976"><span class="linenos">1976</span></a>    <span class="k">if</span> <span class="n">vertex_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">neighbours</span><span class="p">:</span>
</span><span id="Vertex.add_neighbour-1977"><a href="#Vertex.add_neighbour-1977"><span class="linenos">1977</span></a>      <span class="bp">self</span><span class="o">.</span><span class="n">neighbours</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">vertex_id</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Add supplied ID to the neighbours list if it is not already present.</p>

<p>Args:
  vertex_id (int): ID to add to the neighbours list.</p>
</div>


                            </div>
                            <div id="Vertex.clockwise_order_incident_tiles" class="classattr">
                                        <input id="Vertex.clockwise_order_incident_tiles-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">clockwise_order_incident_tiles</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="Vertex.clockwise_order_incident_tiles-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Vertex.clockwise_order_incident_tiles"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Vertex.clockwise_order_incident_tiles-1980"><a href="#Vertex.clockwise_order_incident_tiles-1980"><span class="linenos">1980</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">clockwise_order_incident_tiles</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Vertex.clockwise_order_incident_tiles-1981"><a href="#Vertex.clockwise_order_incident_tiles-1981"><span class="linenos">1981</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Reorder tiles list clockwise (this is for dual tiling construction).&quot;&quot;&quot;</span>
</span><span id="Vertex.clockwise_order_incident_tiles-1982"><a href="#Vertex.clockwise_order_incident_tiles-1982"><span class="linenos">1982</span></a>    <span class="n">cw_order</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_order_of_pts_cw_around_centre</span><span class="p">(</span>
</span><span id="Vertex.clockwise_order_incident_tiles-1983"><a href="#Vertex.clockwise_order_incident_tiles-1983"><span class="linenos">1983</span></a>      <span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">centre</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tiles</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">point</span><span class="p">)</span>
</span><span id="Vertex.clockwise_order_incident_tiles-1984"><a href="#Vertex.clockwise_order_incident_tiles-1984"><span class="linenos">1984</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">tiles</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">tiles</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">cw_order</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Reorder tiles list clockwise (this is for dual tiling construction).</p>
</div>


                            </div>
                            <div id="Vertex.is_interior" class="classattr">
                                        <input id="Vertex.is_interior-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">is_interior</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <label class="view-source-button" for="Vertex.is_interior-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Vertex.is_interior"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Vertex.is_interior-1987"><a href="#Vertex.is_interior-1987"><span class="linenos">1987</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">is_interior</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="Vertex.is_interior-1988"><a href="#Vertex.is_interior-1988"><span class="linenos">1988</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Test if vertex is completely enclosed by its incident Tiles.</span>
</span><span id="Vertex.is_interior-1989"><a href="#Vertex.is_interior-1989"><span class="linenos">1989</span></a>
</span><span id="Vertex.is_interior-1990"><a href="#Vertex.is_interior-1990"><span class="linenos">1990</span></a><span class="sd">    Based on summing the interior angles of the incident tiles at this vertex.</span>
</span><span id="Vertex.is_interior-1991"><a href="#Vertex.is_interior-1991"><span class="linenos">1991</span></a>
</span><span id="Vertex.is_interior-1992"><a href="#Vertex.is_interior-1992"><span class="linenos">1992</span></a><span class="sd">    Returns:</span>
</span><span id="Vertex.is_interior-1993"><a href="#Vertex.is_interior-1993"><span class="linenos">1993</span></a><span class="sd">        bool: True if vertex is completely enclosed by incident Tiles.</span>
</span><span id="Vertex.is_interior-1994"><a href="#Vertex.is_interior-1994"><span class="linenos">1994</span></a>
</span><span id="Vertex.is_interior-1995"><a href="#Vertex.is_interior-1995"><span class="linenos">1995</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Vertex.is_interior-1996"><a href="#Vertex.is_interior-1996"><span class="linenos">1996</span></a>    <span class="k">return</span> <span class="nb">abs</span><span class="p">(</span><span class="mi">360</span> <span class="o">-</span> <span class="nb">sum</span><span class="p">([</span><span class="n">t</span><span class="o">.</span><span class="n">angle_at</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tiles</span><span class="p">]))</span> \
</span><span id="Vertex.is_interior-1997"><a href="#Vertex.is_interior-1997"><span class="linenos">1997</span></a>                     <span class="o">&lt;</span> <span class="n">tiling_utils</span><span class="o">.</span><span class="n">RESOLUTION</span>
</span></pre></div>


            <div class="docstring"><p>Test if vertex is completely enclosed by its incident Tiles.</p>

<p>Based on summing the interior angles of the incident tiles at this vertex.</p>

<p>Returns:
    bool: True if vertex is completely enclosed by incident Tiles.</p>
</div>


                            </div>
                </section>
                <section id="Edge">
                            <input id="Edge-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">Edge</span>:

                <label class="view-source-button" for="Edge-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Edge"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Edge-2022"><a href="#Edge-2022"><span class="linenos">2022</span></a><span class="k">class</span><span class="w"> </span><span class="nc">Edge</span><span class="p">:</span>
</span><span id="Edge-2023"><a href="#Edge-2023"><span class="linenos">2023</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;Class to represent edges in a tiling (not tile sides).&quot;&quot;&quot;</span>
</span><span id="Edge-2024"><a href="#Edge-2024"><span class="linenos">2024</span></a>
</span><span id="Edge-2025"><a href="#Edge-2025"><span class="linenos">2025</span></a>  <span class="n">ID</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span>
</span><span id="Edge-2026"><a href="#Edge-2026"><span class="linenos">2026</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;IDs of the vertices at ends of the edge. Used as key in the containing</span>
</span><span id="Edge-2027"><a href="#Edge-2027"><span class="linenos">2027</span></a><span class="sd">  Topology&#39;s edges dictionary.&quot;&quot;&quot;</span>
</span><span id="Edge-2028"><a href="#Edge-2028"><span class="linenos">2028</span></a>  <span class="n">vertices</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Vertex</span><span class="p">]</span>
</span><span id="Edge-2029"><a href="#Edge-2029"><span class="linenos">2029</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;two item list of the end vertices.&quot;&quot;&quot;</span>
</span><span id="Edge-2030"><a href="#Edge-2030"><span class="linenos">2030</span></a>  <span class="n">corners</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Vertex</span><span class="p">]</span>
</span><span id="Edge-2031"><a href="#Edge-2031"><span class="linenos">2031</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;list of all the vertices in the edge (including its end vertices). In a</span>
</span><span id="Edge-2032"><a href="#Edge-2032"><span class="linenos">2032</span></a><span class="sd">  &#39;normal&#39; edge to edge tiling corners and vertices will be identical.&quot;&quot;&quot;</span>
</span><span id="Edge-2033"><a href="#Edge-2033"><span class="linenos">2033</span></a>  <span class="n">right_tile</span><span class="p">:</span> <span class="n">Tile</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Edge-2034"><a href="#Edge-2034"><span class="linenos">2034</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;the tile to the right of the edge traversed from its first to its last</span>
</span><span id="Edge-2035"><a href="#Edge-2035"><span class="linenos">2035</span></a><span class="sd">  vertex. Given clockwise winding default, all edges will have a right_tile.&quot;&quot;&quot;</span>
</span><span id="Edge-2036"><a href="#Edge-2036"><span class="linenos">2036</span></a>  <span class="n">left_tile</span><span class="p">:</span> <span class="n">Tile</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Edge-2037"><a href="#Edge-2037"><span class="linenos">2037</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;the tile to the left of the edge traversed from its first to its last</span>
</span><span id="Edge-2038"><a href="#Edge-2038"><span class="linenos">2038</span></a><span class="sd">  vertex. Exterior edges of the tiles in a Topology will not have a left_tile.</span>
</span><span id="Edge-2039"><a href="#Edge-2039"><span class="linenos">2039</span></a><span class="sd">  &quot;&quot;&quot;</span>
</span><span id="Edge-2040"><a href="#Edge-2040"><span class="linenos">2040</span></a>  <span class="n">base_ID</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1_000_000</span><span class="p">,</span> <span class="mi">1_000_000</span><span class="p">)</span>
</span><span id="Edge-2041"><a href="#Edge-2041"><span class="linenos">2041</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;ID of corresponding edge in the base tileable&quot;&quot;&quot;</span>
</span><span id="Edge-2042"><a href="#Edge-2042"><span class="linenos">2042</span></a>  <span class="n">transitivity_class</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Edge-2043"><a href="#Edge-2043"><span class="linenos">2043</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;transitivity class of the edge under symmetries of the tiling&quot;&quot;&quot;</span>
</span><span id="Edge-2044"><a href="#Edge-2044"><span class="linenos">2044</span></a>  <span class="n">label</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="Edge-2045"><a href="#Edge-2045"><span class="linenos">2045</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;the (lower case letter) label of the edge under the symmetries of the</span>
</span><span id="Edge-2046"><a href="#Edge-2046"><span class="linenos">2046</span></a><span class="sd">  tiling.&quot;&quot;&quot;</span>
</span><span id="Edge-2047"><a href="#Edge-2047"><span class="linenos">2047</span></a>
</span><span id="Edge-2048"><a href="#Edge-2048"><span class="linenos">2048</span></a>  <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="Edge-2049"><a href="#Edge-2049"><span class="linenos">2049</span></a>      <span class="bp">self</span><span class="p">,</span>
</span><span id="Edge-2050"><a href="#Edge-2050"><span class="linenos">2050</span></a>      <span class="n">corners</span><span class="p">:</span><span class="nb">list</span><span class="p">[</span><span class="n">Vertex</span><span class="p">],</span>
</span><span id="Edge-2051"><a href="#Edge-2051"><span class="linenos">2051</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Edge-2052"><a href="#Edge-2052"><span class="linenos">2052</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Class constructor.</span>
</span><span id="Edge-2053"><a href="#Edge-2053"><span class="linenos">2053</span></a>
</span><span id="Edge-2054"><a href="#Edge-2054"><span class="linenos">2054</span></a><span class="sd">    Initialises the corners and vertices lists and sets ID to (vertices[0].ID,</span>
</span><span id="Edge-2055"><a href="#Edge-2055"><span class="linenos">2055</span></a><span class="sd">    vertices[1].ID). The vertices list is all the corners with is_tiling_vertex</span>
</span><span id="Edge-2056"><a href="#Edge-2056"><span class="linenos">2056</span></a><span class="sd">    property True -- Note that during initialisation the default of this</span>
</span><span id="Edge-2057"><a href="#Edge-2057"><span class="linenos">2057</span></a><span class="sd">    property is True until after the relations between tiles and vertices have</span>
</span><span id="Edge-2058"><a href="#Edge-2058"><span class="linenos">2058</span></a><span class="sd">    been determined.</span>
</span><span id="Edge-2059"><a href="#Edge-2059"><span class="linenos">2059</span></a>
</span><span id="Edge-2060"><a href="#Edge-2060"><span class="linenos">2060</span></a><span class="sd">    Args:</span>
</span><span id="Edge-2061"><a href="#Edge-2061"><span class="linenos">2061</span></a><span class="sd">      corners (list[Vertex]): list of all corners along the edge.</span>
</span><span id="Edge-2062"><a href="#Edge-2062"><span class="linenos">2062</span></a>
</span><span id="Edge-2063"><a href="#Edge-2063"><span class="linenos">2063</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Edge-2064"><a href="#Edge-2064"><span class="linenos">2064</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">corners</span> <span class="o">=</span> <span class="n">corners</span>
</span><span id="Edge-2065"><a href="#Edge-2065"><span class="linenos">2065</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">corners</span> <span class="k">if</span> <span class="n">v</span><span class="o">.</span><span class="n">is_tiling_vertex</span><span class="p">]</span>
</span><span id="Edge-2066"><a href="#Edge-2066"><span class="linenos">2066</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">ID</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">ID</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">)</span>
</span><span id="Edge-2067"><a href="#Edge-2067"><span class="linenos">2067</span></a>
</span><span id="Edge-2068"><a href="#Edge-2068"><span class="linenos">2068</span></a>
</span><span id="Edge-2069"><a href="#Edge-2069"><span class="linenos">2069</span></a>  <span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="Edge-2070"><a href="#Edge-2070"><span class="linenos">2070</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return a string representation of the Edge.</span>
</span><span id="Edge-2071"><a href="#Edge-2071"><span class="linenos">2071</span></a>
</span><span id="Edge-2072"><a href="#Edge-2072"><span class="linenos">2072</span></a><span class="sd">    Returns:</span>
</span><span id="Edge-2073"><a href="#Edge-2073"><span class="linenos">2073</span></a><span class="sd">      str: include ID and a list of corner vertex IDs.</span>
</span><span id="Edge-2074"><a href="#Edge-2074"><span class="linenos">2074</span></a>
</span><span id="Edge-2075"><a href="#Edge-2075"><span class="linenos">2075</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Edge-2076"><a href="#Edge-2076"><span class="linenos">2076</span></a>    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;Edge </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">ID</span><span class="si">}</span><span class="s2"> Corners: </span><span class="si">{</span><span class="p">[</span><span class="n">c</span><span class="o">.</span><span class="n">ID</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">corners</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="Edge-2077"><a href="#Edge-2077"><span class="linenos">2077</span></a>
</span><span id="Edge-2078"><a href="#Edge-2078"><span class="linenos">2078</span></a>
</span><span id="Edge-2079"><a href="#Edge-2079"><span class="linenos">2079</span></a>  <span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="Edge-2080"><a href="#Edge-2080"><span class="linenos">2080</span></a>    <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="Edge-2081"><a href="#Edge-2081"><span class="linenos">2081</span></a>
</span><span id="Edge-2082"><a href="#Edge-2082"><span class="linenos">2082</span></a>
</span><span id="Edge-2083"><a href="#Edge-2083"><span class="linenos">2083</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">get_corner_IDs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
</span><span id="Edge-2084"><a href="#Edge-2084"><span class="linenos">2084</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the IDs of edge corners.</span>
</span><span id="Edge-2085"><a href="#Edge-2085"><span class="linenos">2085</span></a>
</span><span id="Edge-2086"><a href="#Edge-2086"><span class="linenos">2086</span></a><span class="sd">    Returns:</span>
</span><span id="Edge-2087"><a href="#Edge-2087"><span class="linenos">2087</span></a><span class="sd">      list[int]: IDs of all corners.</span>
</span><span id="Edge-2088"><a href="#Edge-2088"><span class="linenos">2088</span></a>
</span><span id="Edge-2089"><a href="#Edge-2089"><span class="linenos">2089</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Edge-2090"><a href="#Edge-2090"><span class="linenos">2090</span></a>    <span class="k">return</span> <span class="p">[</span><span class="n">c</span><span class="o">.</span><span class="n">ID</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">corners</span><span class="p">]</span>
</span><span id="Edge-2091"><a href="#Edge-2091"><span class="linenos">2091</span></a>
</span><span id="Edge-2092"><a href="#Edge-2092"><span class="linenos">2092</span></a>
</span><span id="Edge-2093"><a href="#Edge-2093"><span class="linenos">2093</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">get_vertex_IDs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
</span><span id="Edge-2094"><a href="#Edge-2094"><span class="linenos">2094</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return IDs of edge vertices.</span>
</span><span id="Edge-2095"><a href="#Edge-2095"><span class="linenos">2095</span></a>
</span><span id="Edge-2096"><a href="#Edge-2096"><span class="linenos">2096</span></a><span class="sd">    Returns:</span>
</span><span id="Edge-2097"><a href="#Edge-2097"><span class="linenos">2097</span></a><span class="sd">      list[int]: list of IDs of the vertices.</span>
</span><span id="Edge-2098"><a href="#Edge-2098"><span class="linenos">2098</span></a>
</span><span id="Edge-2099"><a href="#Edge-2099"><span class="linenos">2099</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Edge-2100"><a href="#Edge-2100"><span class="linenos">2100</span></a>    <span class="k">return</span> <span class="p">[</span><span class="n">v</span><span class="o">.</span><span class="n">ID</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">]</span>
</span><span id="Edge-2101"><a href="#Edge-2101"><span class="linenos">2101</span></a>
</span><span id="Edge-2102"><a href="#Edge-2102"><span class="linenos">2102</span></a>
</span><span id="Edge-2103"><a href="#Edge-2103"><span class="linenos">2103</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">insert_vertex</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">v</span><span class="p">:</span><span class="n">Vertex</span><span class="p">,</span> <span class="n">predecessor</span><span class="p">:</span><span class="n">Vertex</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Edge</span><span class="p">]:</span>
</span><span id="Edge-2104"><a href="#Edge-2104"><span class="linenos">2104</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Insert vertex after predecessor and return modified edge and new edge.</span>
</span><span id="Edge-2105"><a href="#Edge-2105"><span class="linenos">2105</span></a>
</span><span id="Edge-2106"><a href="#Edge-2106"><span class="linenos">2106</span></a><span class="sd">    If the initial edge was (say) (0 1 2 5) and the predecessor was set to 1</span>
</span><span id="Edge-2107"><a href="#Edge-2107"><span class="linenos">2107</span></a><span class="sd">    the returned edges would be (0 1 v) and (v 2 5).</span>
</span><span id="Edge-2108"><a href="#Edge-2108"><span class="linenos">2108</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Edge-2109"><a href="#Edge-2109"><span class="linenos">2109</span></a>    <span class="n">i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">corners</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">predecessor</span><span class="p">)</span>
</span><span id="Edge-2110"><a href="#Edge-2110"><span class="linenos">2110</span></a>    <span class="n">new_edge</span> <span class="o">=</span> <span class="n">Edge</span><span class="p">([</span><span class="n">v</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">corners</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">):])</span>
</span><span id="Edge-2111"><a href="#Edge-2111"><span class="linenos">2111</span></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">right_tile</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Edge-2112"><a href="#Edge-2112"><span class="linenos">2112</span></a>      <span class="n">new_edge</span><span class="o">.</span><span class="n">right_tile</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">right_tile</span>
</span><span id="Edge-2113"><a href="#Edge-2113"><span class="linenos">2113</span></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">left_tile</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Edge-2114"><a href="#Edge-2114"><span class="linenos">2114</span></a>      <span class="n">new_edge</span><span class="o">.</span><span class="n">left_tile</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">left_tile</span>
</span><span id="Edge-2115"><a href="#Edge-2115"><span class="linenos">2115</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">corners</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">corners</span><span class="p">[:(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)]</span> <span class="o">+</span> <span class="p">[</span><span class="n">v</span><span class="p">]</span>
</span><span id="Edge-2116"><a href="#Edge-2116"><span class="linenos">2116</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">v</span><span class="p">]</span>
</span><span id="Edge-2117"><a href="#Edge-2117"><span class="linenos">2117</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">ID</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">ID</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">)</span>
</span><span id="Edge-2118"><a href="#Edge-2118"><span class="linenos">2118</span></a>    <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_edge</span><span class="p">]</span>
</span><span id="Edge-2119"><a href="#Edge-2119"><span class="linenos">2119</span></a>
</span><span id="Edge-2120"><a href="#Edge-2120"><span class="linenos">2120</span></a>
</span><span id="Edge-2121"><a href="#Edge-2121"><span class="linenos">2121</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">get_geometry</span><span class="p">(</span>
</span><span id="Edge-2122"><a href="#Edge-2122"><span class="linenos">2122</span></a>      <span class="bp">self</span><span class="p">,</span>
</span><span id="Edge-2123"><a href="#Edge-2123"><span class="linenos">2123</span></a>      <span class="n">forward</span><span class="p">:</span><span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="Edge-2124"><a href="#Edge-2124"><span class="linenos">2124</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">geom</span><span class="o">.</span><span class="n">LineString</span><span class="p">:</span>
</span><span id="Edge-2125"><a href="#Edge-2125"><span class="linenos">2125</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return geom.LineString representing geometry (including corners).</span>
</span><span id="Edge-2126"><a href="#Edge-2126"><span class="linenos">2126</span></a>
</span><span id="Edge-2127"><a href="#Edge-2127"><span class="linenos">2127</span></a><span class="sd">    Args:</span>
</span><span id="Edge-2128"><a href="#Edge-2128"><span class="linenos">2128</span></a><span class="sd">      forward (bool, optional): if True the returned LineString starts at</span>
</span><span id="Edge-2129"><a href="#Edge-2129"><span class="linenos">2129</span></a><span class="sd">        corners[0], else at corners[-1]. Defaults to True.</span>
</span><span id="Edge-2130"><a href="#Edge-2130"><span class="linenos">2130</span></a>
</span><span id="Edge-2131"><a href="#Edge-2131"><span class="linenos">2131</span></a><span class="sd">    Returns:</span>
</span><span id="Edge-2132"><a href="#Edge-2132"><span class="linenos">2132</span></a><span class="sd">      geom.LineString: the required LineString.</span>
</span><span id="Edge-2133"><a href="#Edge-2133"><span class="linenos">2133</span></a>
</span><span id="Edge-2134"><a href="#Edge-2134"><span class="linenos">2134</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Edge-2135"><a href="#Edge-2135"><span class="linenos">2135</span></a>    <span class="k">if</span> <span class="n">forward</span><span class="p">:</span>
</span><span id="Edge-2136"><a href="#Edge-2136"><span class="linenos">2136</span></a>      <span class="k">return</span> <span class="n">geom</span><span class="o">.</span><span class="n">LineString</span><span class="p">([</span><span class="n">v</span><span class="o">.</span><span class="n">point</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">corners</span><span class="p">])</span>
</span><span id="Edge-2137"><a href="#Edge-2137"><span class="linenos">2137</span></a>    <span class="k">return</span> <span class="n">geom</span><span class="o">.</span><span class="n">LineString</span><span class="p">([</span><span class="n">v</span><span class="o">.</span><span class="n">point</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">corners</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]])</span>
</span><span id="Edge-2138"><a href="#Edge-2138"><span class="linenos">2138</span></a>
</span><span id="Edge-2139"><a href="#Edge-2139"><span class="linenos">2139</span></a>
</span><span id="Edge-2140"><a href="#Edge-2140"><span class="linenos">2140</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">get_topology</span><span class="p">(</span>
</span><span id="Edge-2141"><a href="#Edge-2141"><span class="linenos">2141</span></a>      <span class="bp">self</span><span class="p">,</span>
</span><span id="Edge-2142"><a href="#Edge-2142"><span class="linenos">2142</span></a>      <span class="n">forward</span><span class="p">:</span><span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="Edge-2143"><a href="#Edge-2143"><span class="linenos">2143</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">geom</span><span class="o">.</span><span class="n">LineString</span><span class="p">:</span>
</span><span id="Edge-2144"><a href="#Edge-2144"><span class="linenos">2144</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return LineString connecting vertices of this edge.</span>
</span><span id="Edge-2145"><a href="#Edge-2145"><span class="linenos">2145</span></a>
</span><span id="Edge-2146"><a href="#Edge-2146"><span class="linenos">2146</span></a><span class="sd">    Args:</span>
</span><span id="Edge-2147"><a href="#Edge-2147"><span class="linenos">2147</span></a><span class="sd">      forward (bool, optional): if True LineString starts at vertices[0],</span>
</span><span id="Edge-2148"><a href="#Edge-2148"><span class="linenos">2148</span></a><span class="sd">        else at vertices[1]. Defaults to True.</span>
</span><span id="Edge-2149"><a href="#Edge-2149"><span class="linenos">2149</span></a>
</span><span id="Edge-2150"><a href="#Edge-2150"><span class="linenos">2150</span></a><span class="sd">    Returns:</span>
</span><span id="Edge-2151"><a href="#Edge-2151"><span class="linenos">2151</span></a><span class="sd">        geom.LineString: the required LineString.</span>
</span><span id="Edge-2152"><a href="#Edge-2152"><span class="linenos">2152</span></a>
</span><span id="Edge-2153"><a href="#Edge-2153"><span class="linenos">2153</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Edge-2154"><a href="#Edge-2154"><span class="linenos">2154</span></a>    <span class="k">if</span> <span class="n">forward</span><span class="p">:</span>
</span><span id="Edge-2155"><a href="#Edge-2155"><span class="linenos">2155</span></a>      <span class="k">return</span> <span class="n">geom</span><span class="o">.</span><span class="n">LineString</span><span class="p">([</span><span class="n">v</span><span class="o">.</span><span class="n">point</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">])</span>
</span><span id="Edge-2156"><a href="#Edge-2156"><span class="linenos">2156</span></a>    <span class="k">return</span> <span class="n">geom</span><span class="o">.</span><span class="n">LineString</span><span class="p">([</span><span class="n">v</span><span class="o">.</span><span class="n">point</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]])</span>
</span></pre></div>


            <div class="docstring"><p>Class to represent edges in a tiling (not tile sides).</p>
</div>


                            <div id="Edge.__init__" class="classattr">
                                        <input id="Edge.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">Edge</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">corners</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n"><a href="#Vertex">Vertex</a></span><span class="p">]</span></span>)</span>

                <label class="view-source-button" for="Edge.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Edge.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Edge.__init__-2048"><a href="#Edge.__init__-2048"><span class="linenos">2048</span></a>  <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="Edge.__init__-2049"><a href="#Edge.__init__-2049"><span class="linenos">2049</span></a>      <span class="bp">self</span><span class="p">,</span>
</span><span id="Edge.__init__-2050"><a href="#Edge.__init__-2050"><span class="linenos">2050</span></a>      <span class="n">corners</span><span class="p">:</span><span class="nb">list</span><span class="p">[</span><span class="n">Vertex</span><span class="p">],</span>
</span><span id="Edge.__init__-2051"><a href="#Edge.__init__-2051"><span class="linenos">2051</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Edge.__init__-2052"><a href="#Edge.__init__-2052"><span class="linenos">2052</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Class constructor.</span>
</span><span id="Edge.__init__-2053"><a href="#Edge.__init__-2053"><span class="linenos">2053</span></a>
</span><span id="Edge.__init__-2054"><a href="#Edge.__init__-2054"><span class="linenos">2054</span></a><span class="sd">    Initialises the corners and vertices lists and sets ID to (vertices[0].ID,</span>
</span><span id="Edge.__init__-2055"><a href="#Edge.__init__-2055"><span class="linenos">2055</span></a><span class="sd">    vertices[1].ID). The vertices list is all the corners with is_tiling_vertex</span>
</span><span id="Edge.__init__-2056"><a href="#Edge.__init__-2056"><span class="linenos">2056</span></a><span class="sd">    property True -- Note that during initialisation the default of this</span>
</span><span id="Edge.__init__-2057"><a href="#Edge.__init__-2057"><span class="linenos">2057</span></a><span class="sd">    property is True until after the relations between tiles and vertices have</span>
</span><span id="Edge.__init__-2058"><a href="#Edge.__init__-2058"><span class="linenos">2058</span></a><span class="sd">    been determined.</span>
</span><span id="Edge.__init__-2059"><a href="#Edge.__init__-2059"><span class="linenos">2059</span></a>
</span><span id="Edge.__init__-2060"><a href="#Edge.__init__-2060"><span class="linenos">2060</span></a><span class="sd">    Args:</span>
</span><span id="Edge.__init__-2061"><a href="#Edge.__init__-2061"><span class="linenos">2061</span></a><span class="sd">      corners (list[Vertex]): list of all corners along the edge.</span>
</span><span id="Edge.__init__-2062"><a href="#Edge.__init__-2062"><span class="linenos">2062</span></a>
</span><span id="Edge.__init__-2063"><a href="#Edge.__init__-2063"><span class="linenos">2063</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Edge.__init__-2064"><a href="#Edge.__init__-2064"><span class="linenos">2064</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">corners</span> <span class="o">=</span> <span class="n">corners</span>
</span><span id="Edge.__init__-2065"><a href="#Edge.__init__-2065"><span class="linenos">2065</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">corners</span> <span class="k">if</span> <span class="n">v</span><span class="o">.</span><span class="n">is_tiling_vertex</span><span class="p">]</span>
</span><span id="Edge.__init__-2066"><a href="#Edge.__init__-2066"><span class="linenos">2066</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">ID</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">ID</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Class constructor.</p>

<p>Initialises the corners and vertices lists and sets ID to (vertices[0].ID,
vertices[1].ID). The vertices list is all the corners with is_tiling_vertex
property True -- Note that during initialisation the default of this
property is True until after the relations between tiles and vertices have
been determined.</p>

<p>Args:
  corners (list[Vertex]): list of all corners along the edge.</p>
</div>


                            </div>
                            <div id="Edge.ID" class="classattr">
                                <div class="attr variable">
            <span class="name">ID</span><span class="annotation">: tuple[int]</span>

        
    </div>
    <a class="headerlink" href="#Edge.ID"></a>
    
            <div class="docstring"><p>IDs of the vertices at ends of the edge. Used as key in the containing
Topology's edges dictionary.</p>
</div>


                            </div>
                            <div id="Edge.vertices" class="classattr">
                                <div class="attr variable">
            <span class="name">vertices</span><span class="annotation">: list[<a href="#Vertex">Vertex</a>]</span>

        
    </div>
    <a class="headerlink" href="#Edge.vertices"></a>
    
            <div class="docstring"><p>two item list of the end vertices.</p>
</div>


                            </div>
                            <div id="Edge.corners" class="classattr">
                                <div class="attr variable">
            <span class="name">corners</span><span class="annotation">: list[<a href="#Vertex">Vertex</a>]</span>

        
    </div>
    <a class="headerlink" href="#Edge.corners"></a>
    
            <div class="docstring"><p>list of all the vertices in the edge (including its end vertices). In a
'normal' edge to edge tiling corners and vertices will be identical.</p>
</div>


                            </div>
                            <div id="Edge.right_tile" class="classattr">
                                <div class="attr variable">
            <span class="name">right_tile</span><span class="annotation">: <a href="#Tile">Tile</a></span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#Edge.right_tile"></a>
    
            <div class="docstring"><p>the tile to the right of the edge traversed from its first to its last
vertex. Given clockwise winding default, all edges will have a right_tile.</p>
</div>


                            </div>
                            <div id="Edge.left_tile" class="classattr">
                                <div class="attr variable">
            <span class="name">left_tile</span><span class="annotation">: <a href="#Tile">Tile</a></span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#Edge.left_tile"></a>
    
            <div class="docstring"><p>the tile to the left of the edge traversed from its first to its last
vertex. Exterior edges of the tiles in a Topology will not have a left_tile.</p>
</div>


                            </div>
                            <div id="Edge.base_ID" class="classattr">
                                <div class="attr variable">
            <span class="name">base_ID</span><span class="annotation">: tuple[int]</span>        =
<span class="default_value">(1000000, 1000000)</span>

        
    </div>
    <a class="headerlink" href="#Edge.base_ID"></a>
    
            <div class="docstring"><p>ID of corresponding edge in the base tileable</p>
</div>


                            </div>
                            <div id="Edge.transitivity_class" class="classattr">
                                <div class="attr variable">
            <span class="name">transitivity_class</span><span class="annotation">: int</span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#Edge.transitivity_class"></a>
    
            <div class="docstring"><p>transitivity class of the edge under symmetries of the tiling</p>
</div>


                            </div>
                            <div id="Edge.label" class="classattr">
                                <div class="attr variable">
            <span class="name">label</span><span class="annotation">: str</span>        =
<span class="default_value">&#39;&#39;</span>

        
    </div>
    <a class="headerlink" href="#Edge.label"></a>
    
            <div class="docstring"><p>the (lower case letter) label of the edge under the symmetries of the
tiling.</p>
</div>


                            </div>
                            <div id="Edge.get_corner_IDs" class="classattr">
                                        <input id="Edge.get_corner_IDs-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_corner_IDs</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="Edge.get_corner_IDs-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Edge.get_corner_IDs"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Edge.get_corner_IDs-2083"><a href="#Edge.get_corner_IDs-2083"><span class="linenos">2083</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">get_corner_IDs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
</span><span id="Edge.get_corner_IDs-2084"><a href="#Edge.get_corner_IDs-2084"><span class="linenos">2084</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the IDs of edge corners.</span>
</span><span id="Edge.get_corner_IDs-2085"><a href="#Edge.get_corner_IDs-2085"><span class="linenos">2085</span></a>
</span><span id="Edge.get_corner_IDs-2086"><a href="#Edge.get_corner_IDs-2086"><span class="linenos">2086</span></a><span class="sd">    Returns:</span>
</span><span id="Edge.get_corner_IDs-2087"><a href="#Edge.get_corner_IDs-2087"><span class="linenos">2087</span></a><span class="sd">      list[int]: IDs of all corners.</span>
</span><span id="Edge.get_corner_IDs-2088"><a href="#Edge.get_corner_IDs-2088"><span class="linenos">2088</span></a>
</span><span id="Edge.get_corner_IDs-2089"><a href="#Edge.get_corner_IDs-2089"><span class="linenos">2089</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Edge.get_corner_IDs-2090"><a href="#Edge.get_corner_IDs-2090"><span class="linenos">2090</span></a>    <span class="k">return</span> <span class="p">[</span><span class="n">c</span><span class="o">.</span><span class="n">ID</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">corners</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Return the IDs of edge corners.</p>

<p>Returns:
  list[int]: IDs of all corners.</p>
</div>


                            </div>
                            <div id="Edge.get_vertex_IDs" class="classattr">
                                        <input id="Edge.get_vertex_IDs-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_vertex_IDs</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="Edge.get_vertex_IDs-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Edge.get_vertex_IDs"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Edge.get_vertex_IDs-2093"><a href="#Edge.get_vertex_IDs-2093"><span class="linenos">2093</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">get_vertex_IDs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
</span><span id="Edge.get_vertex_IDs-2094"><a href="#Edge.get_vertex_IDs-2094"><span class="linenos">2094</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return IDs of edge vertices.</span>
</span><span id="Edge.get_vertex_IDs-2095"><a href="#Edge.get_vertex_IDs-2095"><span class="linenos">2095</span></a>
</span><span id="Edge.get_vertex_IDs-2096"><a href="#Edge.get_vertex_IDs-2096"><span class="linenos">2096</span></a><span class="sd">    Returns:</span>
</span><span id="Edge.get_vertex_IDs-2097"><a href="#Edge.get_vertex_IDs-2097"><span class="linenos">2097</span></a><span class="sd">      list[int]: list of IDs of the vertices.</span>
</span><span id="Edge.get_vertex_IDs-2098"><a href="#Edge.get_vertex_IDs-2098"><span class="linenos">2098</span></a>
</span><span id="Edge.get_vertex_IDs-2099"><a href="#Edge.get_vertex_IDs-2099"><span class="linenos">2099</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Edge.get_vertex_IDs-2100"><a href="#Edge.get_vertex_IDs-2100"><span class="linenos">2100</span></a>    <span class="k">return</span> <span class="p">[</span><span class="n">v</span><span class="o">.</span><span class="n">ID</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Return IDs of edge vertices.</p>

<p>Returns:
  list[int]: list of IDs of the vertices.</p>
</div>


                            </div>
                            <div id="Edge.insert_vertex" class="classattr">
                                        <input id="Edge.insert_vertex-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">insert_vertex</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">v</span><span class="p">:</span> <span class="n"><a href="#Vertex">Vertex</a></span>,</span><span class="param">	<span class="n">predecessor</span><span class="p">:</span> <span class="n"><a href="#Vertex">Vertex</a></span></span><span class="return-annotation">) -> <span class="nb">list</span><span class="p">[</span><span class="n"><a href="#Edge">Edge</a></span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="Edge.insert_vertex-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Edge.insert_vertex"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Edge.insert_vertex-2103"><a href="#Edge.insert_vertex-2103"><span class="linenos">2103</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">insert_vertex</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">v</span><span class="p">:</span><span class="n">Vertex</span><span class="p">,</span> <span class="n">predecessor</span><span class="p">:</span><span class="n">Vertex</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Edge</span><span class="p">]:</span>
</span><span id="Edge.insert_vertex-2104"><a href="#Edge.insert_vertex-2104"><span class="linenos">2104</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Insert vertex after predecessor and return modified edge and new edge.</span>
</span><span id="Edge.insert_vertex-2105"><a href="#Edge.insert_vertex-2105"><span class="linenos">2105</span></a>
</span><span id="Edge.insert_vertex-2106"><a href="#Edge.insert_vertex-2106"><span class="linenos">2106</span></a><span class="sd">    If the initial edge was (say) (0 1 2 5) and the predecessor was set to 1</span>
</span><span id="Edge.insert_vertex-2107"><a href="#Edge.insert_vertex-2107"><span class="linenos">2107</span></a><span class="sd">    the returned edges would be (0 1 v) and (v 2 5).</span>
</span><span id="Edge.insert_vertex-2108"><a href="#Edge.insert_vertex-2108"><span class="linenos">2108</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Edge.insert_vertex-2109"><a href="#Edge.insert_vertex-2109"><span class="linenos">2109</span></a>    <span class="n">i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">corners</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">predecessor</span><span class="p">)</span>
</span><span id="Edge.insert_vertex-2110"><a href="#Edge.insert_vertex-2110"><span class="linenos">2110</span></a>    <span class="n">new_edge</span> <span class="o">=</span> <span class="n">Edge</span><span class="p">([</span><span class="n">v</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">corners</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">):])</span>
</span><span id="Edge.insert_vertex-2111"><a href="#Edge.insert_vertex-2111"><span class="linenos">2111</span></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">right_tile</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Edge.insert_vertex-2112"><a href="#Edge.insert_vertex-2112"><span class="linenos">2112</span></a>      <span class="n">new_edge</span><span class="o">.</span><span class="n">right_tile</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">right_tile</span>
</span><span id="Edge.insert_vertex-2113"><a href="#Edge.insert_vertex-2113"><span class="linenos">2113</span></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">left_tile</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Edge.insert_vertex-2114"><a href="#Edge.insert_vertex-2114"><span class="linenos">2114</span></a>      <span class="n">new_edge</span><span class="o">.</span><span class="n">left_tile</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">left_tile</span>
</span><span id="Edge.insert_vertex-2115"><a href="#Edge.insert_vertex-2115"><span class="linenos">2115</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">corners</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">corners</span><span class="p">[:(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)]</span> <span class="o">+</span> <span class="p">[</span><span class="n">v</span><span class="p">]</span>
</span><span id="Edge.insert_vertex-2116"><a href="#Edge.insert_vertex-2116"><span class="linenos">2116</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">v</span><span class="p">]</span>
</span><span id="Edge.insert_vertex-2117"><a href="#Edge.insert_vertex-2117"><span class="linenos">2117</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">ID</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">ID</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">)</span>
</span><span id="Edge.insert_vertex-2118"><a href="#Edge.insert_vertex-2118"><span class="linenos">2118</span></a>    <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_edge</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Insert vertex after predecessor and return modified edge and new edge.</p>

<p>If the initial edge was (say) (0 1 2 5) and the predecessor was set to 1
the returned edges would be (0 1 v) and (v 2 5).</p>
</div>


                            </div>
                            <div id="Edge.get_geometry" class="classattr">
                                        <input id="Edge.get_geometry-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_geometry</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">forward</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span></span><span class="return-annotation">) -> <span class="n">shapely</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">linestring</span><span class="o">.</span><span class="n">LineString</span>:</span></span>

                <label class="view-source-button" for="Edge.get_geometry-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Edge.get_geometry"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Edge.get_geometry-2121"><a href="#Edge.get_geometry-2121"><span class="linenos">2121</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">get_geometry</span><span class="p">(</span>
</span><span id="Edge.get_geometry-2122"><a href="#Edge.get_geometry-2122"><span class="linenos">2122</span></a>      <span class="bp">self</span><span class="p">,</span>
</span><span id="Edge.get_geometry-2123"><a href="#Edge.get_geometry-2123"><span class="linenos">2123</span></a>      <span class="n">forward</span><span class="p">:</span><span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="Edge.get_geometry-2124"><a href="#Edge.get_geometry-2124"><span class="linenos">2124</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">geom</span><span class="o">.</span><span class="n">LineString</span><span class="p">:</span>
</span><span id="Edge.get_geometry-2125"><a href="#Edge.get_geometry-2125"><span class="linenos">2125</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return geom.LineString representing geometry (including corners).</span>
</span><span id="Edge.get_geometry-2126"><a href="#Edge.get_geometry-2126"><span class="linenos">2126</span></a>
</span><span id="Edge.get_geometry-2127"><a href="#Edge.get_geometry-2127"><span class="linenos">2127</span></a><span class="sd">    Args:</span>
</span><span id="Edge.get_geometry-2128"><a href="#Edge.get_geometry-2128"><span class="linenos">2128</span></a><span class="sd">      forward (bool, optional): if True the returned LineString starts at</span>
</span><span id="Edge.get_geometry-2129"><a href="#Edge.get_geometry-2129"><span class="linenos">2129</span></a><span class="sd">        corners[0], else at corners[-1]. Defaults to True.</span>
</span><span id="Edge.get_geometry-2130"><a href="#Edge.get_geometry-2130"><span class="linenos">2130</span></a>
</span><span id="Edge.get_geometry-2131"><a href="#Edge.get_geometry-2131"><span class="linenos">2131</span></a><span class="sd">    Returns:</span>
</span><span id="Edge.get_geometry-2132"><a href="#Edge.get_geometry-2132"><span class="linenos">2132</span></a><span class="sd">      geom.LineString: the required LineString.</span>
</span><span id="Edge.get_geometry-2133"><a href="#Edge.get_geometry-2133"><span class="linenos">2133</span></a>
</span><span id="Edge.get_geometry-2134"><a href="#Edge.get_geometry-2134"><span class="linenos">2134</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Edge.get_geometry-2135"><a href="#Edge.get_geometry-2135"><span class="linenos">2135</span></a>    <span class="k">if</span> <span class="n">forward</span><span class="p">:</span>
</span><span id="Edge.get_geometry-2136"><a href="#Edge.get_geometry-2136"><span class="linenos">2136</span></a>      <span class="k">return</span> <span class="n">geom</span><span class="o">.</span><span class="n">LineString</span><span class="p">([</span><span class="n">v</span><span class="o">.</span><span class="n">point</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">corners</span><span class="p">])</span>
</span><span id="Edge.get_geometry-2137"><a href="#Edge.get_geometry-2137"><span class="linenos">2137</span></a>    <span class="k">return</span> <span class="n">geom</span><span class="o">.</span><span class="n">LineString</span><span class="p">([</span><span class="n">v</span><span class="o">.</span><span class="n">point</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">corners</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]])</span>
</span></pre></div>


            <div class="docstring"><p>Return geom.LineString representing geometry (including corners).</p>

<p>Args:
  forward (bool, optional): if True the returned LineString starts at
    corners[0], else at corners[-1]. Defaults to True.</p>

<p>Returns:
  geom.LineString: the required LineString.</p>
</div>


                            </div>
                            <div id="Edge.get_topology" class="classattr">
                                        <input id="Edge.get_topology-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_topology</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">forward</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span></span><span class="return-annotation">) -> <span class="n">shapely</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">linestring</span><span class="o">.</span><span class="n">LineString</span>:</span></span>

                <label class="view-source-button" for="Edge.get_topology-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Edge.get_topology"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Edge.get_topology-2140"><a href="#Edge.get_topology-2140"><span class="linenos">2140</span></a>  <span class="k">def</span><span class="w"> </span><span class="nf">get_topology</span><span class="p">(</span>
</span><span id="Edge.get_topology-2141"><a href="#Edge.get_topology-2141"><span class="linenos">2141</span></a>      <span class="bp">self</span><span class="p">,</span>
</span><span id="Edge.get_topology-2142"><a href="#Edge.get_topology-2142"><span class="linenos">2142</span></a>      <span class="n">forward</span><span class="p">:</span><span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="Edge.get_topology-2143"><a href="#Edge.get_topology-2143"><span class="linenos">2143</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">geom</span><span class="o">.</span><span class="n">LineString</span><span class="p">:</span>
</span><span id="Edge.get_topology-2144"><a href="#Edge.get_topology-2144"><span class="linenos">2144</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return LineString connecting vertices of this edge.</span>
</span><span id="Edge.get_topology-2145"><a href="#Edge.get_topology-2145"><span class="linenos">2145</span></a>
</span><span id="Edge.get_topology-2146"><a href="#Edge.get_topology-2146"><span class="linenos">2146</span></a><span class="sd">    Args:</span>
</span><span id="Edge.get_topology-2147"><a href="#Edge.get_topology-2147"><span class="linenos">2147</span></a><span class="sd">      forward (bool, optional): if True LineString starts at vertices[0],</span>
</span><span id="Edge.get_topology-2148"><a href="#Edge.get_topology-2148"><span class="linenos">2148</span></a><span class="sd">        else at vertices[1]. Defaults to True.</span>
</span><span id="Edge.get_topology-2149"><a href="#Edge.get_topology-2149"><span class="linenos">2149</span></a>
</span><span id="Edge.get_topology-2150"><a href="#Edge.get_topology-2150"><span class="linenos">2150</span></a><span class="sd">    Returns:</span>
</span><span id="Edge.get_topology-2151"><a href="#Edge.get_topology-2151"><span class="linenos">2151</span></a><span class="sd">        geom.LineString: the required LineString.</span>
</span><span id="Edge.get_topology-2152"><a href="#Edge.get_topology-2152"><span class="linenos">2152</span></a>
</span><span id="Edge.get_topology-2153"><a href="#Edge.get_topology-2153"><span class="linenos">2153</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Edge.get_topology-2154"><a href="#Edge.get_topology-2154"><span class="linenos">2154</span></a>    <span class="k">if</span> <span class="n">forward</span><span class="p">:</span>
</span><span id="Edge.get_topology-2155"><a href="#Edge.get_topology-2155"><span class="linenos">2155</span></a>      <span class="k">return</span> <span class="n">geom</span><span class="o">.</span><span class="n">LineString</span><span class="p">([</span><span class="n">v</span><span class="o">.</span><span class="n">point</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">])</span>
</span><span id="Edge.get_topology-2156"><a href="#Edge.get_topology-2156"><span class="linenos">2156</span></a>    <span class="k">return</span> <span class="n">geom</span><span class="o">.</span><span class="n">LineString</span><span class="p">([</span><span class="n">v</span><span class="o">.</span><span class="n">point</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]])</span>
</span></pre></div>


            <div class="docstring"><p>Return LineString connecting vertices of this edge.</p>

<p>Args:
  forward (bool, optional): if True LineString starts at vertices[0],
    else at vertices[1]. Defaults to True.</p>

<p>Returns:
    geom.LineString: the required LineString.</p>
</div>


                            </div>
                </section>
    </main>
<script>
    function escapeHTML(html) {
        return document.createElement('div').appendChild(document.createTextNode(html)).parentNode.innerHTML;
    }

    const originalContent = document.querySelector("main.pdoc");
    let currentContent = originalContent;

    function setContent(innerHTML) {
        let elem;
        if (innerHTML) {
            elem = document.createElement("main");
            elem.classList.add("pdoc");
            elem.innerHTML = innerHTML;
        } else {
            elem = originalContent;
        }
        if (currentContent !== elem) {
            currentContent.replaceWith(elem);
            currentContent = elem;
        }
    }

    function getSearchTerm() {
        return (new URL(window.location)).searchParams.get("search");
    }

    const searchBox = document.querySelector(".pdoc input[type=search]");
    searchBox.addEventListener("input", function () {
        let url = new URL(window.location);
        if (searchBox.value.trim()) {
            url.hash = "";
            url.searchParams.set("search", searchBox.value);
        } else {
            url.searchParams.delete("search");
        }
        history.replaceState("", "", url.toString());
        onInput();
    });
    window.addEventListener("popstate", onInput);


    let search, searchErr;

    async function initialize() {
        try {
            search = await new Promise((resolve, reject) => {
                const script = document.createElement("script");
                script.type = "text/javascript";
                script.async = true;
                script.onload = () => resolve(window.pdocSearch);
                script.onerror = (e) => reject(e);
                script.src = "../search.js";
                document.getElementsByTagName("head")[0].appendChild(script);
            });
        } catch (e) {
            console.error("Cannot fetch pdoc search index");
            searchErr = "Cannot fetch search index.";
        }
        onInput();

        document.querySelector("nav.pdoc").addEventListener("click", e => {
            if (e.target.hash) {
                searchBox.value = "";
                searchBox.dispatchEvent(new Event("input"));
            }
        });
    }

    function onInput() {
        setContent((() => {
            const term = getSearchTerm();
            if (!term) {
                return null
            }
            if (searchErr) {
                return `<h3>Error: ${searchErr}</h3>`
            }
            if (!search) {
                return "<h3>Searching...</h3>"
            }

            window.scrollTo({top: 0, left: 0, behavior: 'auto'});

            const results = search(term);

            let html;
            if (results.length === 0) {
                html = `No search results for '${escapeHTML(term)}'.`
            } else {
                html = `<h4>${results.length} search result${results.length > 1 ? "s" : ""} for '${escapeHTML(term)}'.</h4>`;
            }
            for (let result of results.slice(0, 10)) {
                let doc = result.doc;
                let url = `../${doc.modulename.replaceAll(".", "/")}.html`;
                if (doc.qualname) {
                    url += `#${doc.qualname}`;
                }

                let heading;
                switch (result.doc.kind) {
                    case "function":
                        if (doc.fullname.endsWith(".__init__")) {
                            heading = `<span class="name">${doc.fullname.replace(/\.__init__$/, "")}</span>${doc.signature}`;
                        } else {
                            heading = `<span class="def">${doc.funcdef}</span> <span class="name">${doc.fullname}</span>${doc.signature}`;
                        }
                        break;
                    case "class":
                        heading = `<span class="def">class</span> <span class="name">${doc.fullname}</span>`;
                        if (doc.bases)
                            heading += `<wbr>(<span class="base">${doc.bases}</span>)`;
                        heading += `:`;
                        break;
                    case "variable":
                        heading = `<span class="name">${doc.fullname}</span>`;
                        if (doc.annotation)
                            heading += `<span class="annotation">${doc.annotation}</span>`;
                        if (doc.default_value)
                            heading += `<span class="default_value"> = ${doc.default_value}</span>`;
                        break;
                    default:
                        heading = `<span class="name">${doc.fullname}</span>`;
                        break;
                }
                html += `
                        <section class="search-result">
                        <a href="${url}" class="attr ${doc.kind}">${heading}</a>
                        <div class="docstring">${doc.doc}</div>
                        </section>
                    `;

            }
            return html;
        })());
    }

    if (getSearchTerm()) {
        initialize();
        searchBox.value = getSearchTerm();
        onInput();
    } else {
        searchBox.addEventListener("focus", initialize, {once: true});
    }

    searchBox.addEventListener("keydown", e => {
        if (["ArrowDown", "ArrowUp", "Enter"].includes(e.key)) {
            let focused = currentContent.querySelector(".search-result.focused");
            if (!focused) {
                currentContent.querySelector(".search-result").classList.add("focused");
            } else if (
                e.key === "ArrowDown"
                && focused.nextElementSibling
                && focused.nextElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.nextElementSibling.classList.add("focused");
                focused.nextElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "ArrowUp"
                && focused.previousElementSibling
                && focused.previousElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.previousElementSibling.classList.add("focused");
                focused.previousElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "Enter"
            ) {
                focused.querySelector("a").click();
            }
        }
    });
</script></body>
</html>