<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="pdoc 14.5.0"/>
    <title>weavingspace.topology_elements API documentation</title>

    <style>/*! * Bootstrap Reboot v5.0.0 (https://getbootstrap.com/) * Copyright 2011-2021 The Bootstrap Authors * Copyright 2011-2021 Twitter, Inc. * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE) * Forked from Normalize.css, licensed MIT (https://github.com/necolas/normalize.css/blob/master/LICENSE.md) */*,::after,::before{box-sizing:border-box}@media (prefers-reduced-motion:no-preference){:root{scroll-behavior:smooth}}body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Liberation Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;background-color:#fff;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}hr{margin:1rem 0;color:inherit;background-color:currentColor;border:0;opacity:.25}hr:not([size]){height:1px}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem;font-weight:500;line-height:1.2}h1{font-size:calc(1.375rem + 1.5vw)}@media (min-width:1200px){h1{font-size:2.5rem}}h2{font-size:calc(1.325rem + .9vw)}@media (min-width:1200px){h2{font-size:2rem}}h3{font-size:calc(1.3rem + .6vw)}@media (min-width:1200px){h3{font-size:1.75rem}}h4{font-size:calc(1.275rem + .3vw)}@media (min-width:1200px){h4{font-size:1.5rem}}h5{font-size:1.25rem}h6{font-size:1rem}p{margin-top:0;margin-bottom:1rem}abbr[data-bs-original-title],abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address{margin-bottom:1rem;font-style:normal;line-height:inherit}ol,ul{padding-left:2rem}dl,ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}dt{font-weight:700}dd{margin-bottom:.5rem;margin-left:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}small{font-size:.875em}mark{padding:.2em;background-color:#fcf8e3}sub,sup{position:relative;font-size:.75em;line-height:0;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}a{color:#0d6efd;text-decoration:underline}a:hover{color:#0a58ca}a:not([href]):not([class]),a:not([href]):not([class]):hover{color:inherit;text-decoration:none}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em;direction:ltr;unicode-bidi:bidi-override}pre{display:block;margin-top:0;margin-bottom:1rem;overflow:auto;font-size:.875em}pre code{font-size:inherit;color:inherit;word-break:normal}code{font-size:.875em;color:#d63384;word-wrap:break-word}a>code{color:inherit}kbd{padding:.2rem .4rem;font-size:.875em;color:#fff;background-color:#212529;border-radius:.2rem}kbd kbd{padding:0;font-size:1em;font-weight:700}figure{margin:0 0 1rem}img,svg{vertical-align:middle}table{caption-side:bottom;border-collapse:collapse}caption{padding-top:.5rem;padding-bottom:.5rem;color:#6c757d;text-align:left}th{text-align:inherit;text-align:-webkit-match-parent}tbody,td,tfoot,th,thead,tr{border-color:inherit;border-style:solid;border-width:0}label{display:inline-block}button{border-radius:0}button:focus:not(:focus-visible){outline:0}button,input,optgroup,select,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,select{text-transform:none}[role=button]{cursor:pointer}select{word-wrap:normal}select:disabled{opacity:1}[list]::-webkit-calendar-picker-indicator{display:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled),button:not(:disabled){cursor:pointer}::-moz-focus-inner{padding:0;border-style:none}textarea{resize:vertical}fieldset{min-width:0;padding:0;margin:0;border:0}legend{float:left;width:100%;padding:0;margin-bottom:.5rem;font-size:calc(1.275rem + .3vw);line-height:inherit}@media (min-width:1200px){legend{font-size:1.5rem}}legend+*{clear:left}::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-fields-wrapper,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-text,::-webkit-datetime-edit-year-field{padding:0}::-webkit-inner-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:textfield}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-color-swatch-wrapper{padding:0}::file-selector-button{font:inherit}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}output{display:inline-block}iframe{border:0}summary{display:list-item;cursor:pointer}progress{vertical-align:baseline}[hidden]{display:none!important}</style>
    <style>/*! syntax-highlighting.css */pre{line-height:125%;}span.linenos{color:inherit; background-color:transparent; padding-left:5px; padding-right:20px;}.pdoc-code .hll{background-color:#ffffcc}.pdoc-code{background:#f8f8f8;}.pdoc-code .c{color:#3D7B7B; font-style:italic}.pdoc-code .err{border:1px solid #FF0000}.pdoc-code .k{color:#008000; font-weight:bold}.pdoc-code .o{color:#666666}.pdoc-code .ch{color:#3D7B7B; font-style:italic}.pdoc-code .cm{color:#3D7B7B; font-style:italic}.pdoc-code .cp{color:#9C6500}.pdoc-code .cpf{color:#3D7B7B; font-style:italic}.pdoc-code .c1{color:#3D7B7B; font-style:italic}.pdoc-code .cs{color:#3D7B7B; font-style:italic}.pdoc-code .gd{color:#A00000}.pdoc-code .ge{font-style:italic}.pdoc-code .gr{color:#E40000}.pdoc-code .gh{color:#000080; font-weight:bold}.pdoc-code .gi{color:#008400}.pdoc-code .go{color:#717171}.pdoc-code .gp{color:#000080; font-weight:bold}.pdoc-code .gs{font-weight:bold}.pdoc-code .gu{color:#800080; font-weight:bold}.pdoc-code .gt{color:#0044DD}.pdoc-code .kc{color:#008000; font-weight:bold}.pdoc-code .kd{color:#008000; font-weight:bold}.pdoc-code .kn{color:#008000; font-weight:bold}.pdoc-code .kp{color:#008000}.pdoc-code .kr{color:#008000; font-weight:bold}.pdoc-code .kt{color:#B00040}.pdoc-code .m{color:#666666}.pdoc-code .s{color:#BA2121}.pdoc-code .na{color:#687822}.pdoc-code .nb{color:#008000}.pdoc-code .nc{color:#0000FF; font-weight:bold}.pdoc-code .no{color:#880000}.pdoc-code .nd{color:#AA22FF}.pdoc-code .ni{color:#717171; font-weight:bold}.pdoc-code .ne{color:#CB3F38; font-weight:bold}.pdoc-code .nf{color:#0000FF}.pdoc-code .nl{color:#767600}.pdoc-code .nn{color:#0000FF; font-weight:bold}.pdoc-code .nt{color:#008000; font-weight:bold}.pdoc-code .nv{color:#19177C}.pdoc-code .ow{color:#AA22FF; font-weight:bold}.pdoc-code .w{color:#bbbbbb}.pdoc-code .mb{color:#666666}.pdoc-code .mf{color:#666666}.pdoc-code .mh{color:#666666}.pdoc-code .mi{color:#666666}.pdoc-code .mo{color:#666666}.pdoc-code .sa{color:#BA2121}.pdoc-code .sb{color:#BA2121}.pdoc-code .sc{color:#BA2121}.pdoc-code .dl{color:#BA2121}.pdoc-code .sd{color:#BA2121; font-style:italic}.pdoc-code .s2{color:#BA2121}.pdoc-code .se{color:#AA5D1F; font-weight:bold}.pdoc-code .sh{color:#BA2121}.pdoc-code .si{color:#A45A77; font-weight:bold}.pdoc-code .sx{color:#008000}.pdoc-code .sr{color:#A45A77}.pdoc-code .s1{color:#BA2121}.pdoc-code .ss{color:#19177C}.pdoc-code .bp{color:#008000}.pdoc-code .fm{color:#0000FF}.pdoc-code .vc{color:#19177C}.pdoc-code .vg{color:#19177C}.pdoc-code .vi{color:#19177C}.pdoc-code .vm{color:#19177C}.pdoc-code .il{color:#666666}</style>
    <style>/*! theme.css */:root{--pdoc-background:#fff;}.pdoc{--text:#212529;--muted:#6c757d;--link:#3660a5;--link-hover:#1659c5;--code:#f8f8f8;--active:#fff598;--accent:#eee;--accent2:#c1c1c1;--nav-hover:rgba(255, 255, 255, 0.5);--name:#0066BB;--def:#008800;--annotation:#007020;}</style>
    <style>/*! layout.css */html, body{width:100%;height:100%;}html, main{scroll-behavior:smooth;}body{background-color:var(--pdoc-background);}@media (max-width:769px){#navtoggle{cursor:pointer;position:absolute;width:50px;height:40px;top:1rem;right:1rem;border-color:var(--text);color:var(--text);display:flex;opacity:0.8;z-index:999;}#navtoggle:hover{opacity:1;}#togglestate + div{display:none;}#togglestate:checked + div{display:inherit;}main, header{padding:2rem 3vw;}header + main{margin-top:-3rem;}.git-button{display:none !important;}nav input[type="search"]{max-width:77%;}nav input[type="search"]:first-child{margin-top:-6px;}nav input[type="search"]:valid ~ *{display:none !important;}}@media (min-width:770px){:root{--sidebar-width:clamp(12.5rem, 28vw, 22rem);}nav{position:fixed;overflow:auto;height:100vh;width:var(--sidebar-width);}main, header{padding:3rem 2rem 3rem calc(var(--sidebar-width) + 3rem);width:calc(54rem + var(--sidebar-width));max-width:100%;}header + main{margin-top:-4rem;}#navtoggle{display:none;}}#togglestate{position:absolute;height:0;opacity:0;}nav.pdoc{--pad:clamp(0.5rem, 2vw, 1.75rem);--indent:1.5rem;background-color:var(--accent);border-right:1px solid var(--accent2);box-shadow:0 0 20px rgba(50, 50, 50, .2) inset;padding:0 0 0 var(--pad);overflow-wrap:anywhere;scrollbar-width:thin; scrollbar-color:var(--accent2) transparent; z-index:1}nav.pdoc::-webkit-scrollbar{width:.4rem; }nav.pdoc::-webkit-scrollbar-thumb{background-color:var(--accent2); }nav.pdoc > div{padding:var(--pad) 0;}nav.pdoc .module-list-button{display:inline-flex;align-items:center;color:var(--text);border-color:var(--muted);margin-bottom:1rem;}nav.pdoc .module-list-button:hover{border-color:var(--text);}nav.pdoc input[type=search]{display:block;outline-offset:0;width:calc(100% - var(--pad));}nav.pdoc .logo{max-width:calc(100% - var(--pad));max-height:35vh;display:block;margin:0 auto 1rem;transform:translate(calc(-.5 * var(--pad)), 0);}nav.pdoc ul{list-style:none;padding-left:0;}nav.pdoc > div > ul{margin-left:calc(0px - var(--pad));}nav.pdoc li a{padding:.2rem 0 .2rem calc(var(--pad) + var(--indent));}nav.pdoc > div > ul > li > a{padding-left:var(--pad);}nav.pdoc li{transition:all 100ms;}nav.pdoc li:hover{background-color:var(--nav-hover);}nav.pdoc a, nav.pdoc a:hover{color:var(--text);}nav.pdoc a{display:block;}nav.pdoc > h2:first-of-type{margin-top:1.5rem;}nav.pdoc .class:before{content:"class ";color:var(--muted);}nav.pdoc .function:after{content:"()";color:var(--muted);}nav.pdoc footer:before{content:"";display:block;width:calc(100% - var(--pad));border-top:solid var(--accent2) 1px;margin-top:1.5rem;padding-top:.5rem;}nav.pdoc footer{font-size:small;}</style>
    <style>/*! content.css */.pdoc{color:var(--text);box-sizing:border-box;line-height:1.5;background:none;}.pdoc .pdoc-button{cursor:pointer;display:inline-block;border:solid black 1px;border-radius:2px;font-size:.75rem;padding:calc(0.5em - 1px) 1em;transition:100ms all;}.pdoc .pdoc-alert{padding:1rem 1rem 1rem calc(1.5rem + 24px);border:1px solid transparent;border-radius:.25rem;background-repeat:no-repeat;background-position:1rem center;margin-bottom:1rem;}.pdoc .pdoc-alert > *:last-child{margin-bottom:0;}.pdoc .pdoc-alert-note {color:#084298;background-color:#cfe2ff;border-color:#b6d4fe;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23084298%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8%2016A8%208%200%201%200%208%200a8%208%200%200%200%200%2016zm.93-9.412-1%204.705c-.07.34.029.533.304.533.194%200%20.487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703%200-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381%202.29-.287zM8%205.5a1%201%200%201%201%200-2%201%201%200%200%201%200%202z%22/%3E%3C/svg%3E");}.pdoc .pdoc-alert-warning{color:#664d03;background-color:#fff3cd;border-color:#ffecb5;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23664d03%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8.982%201.566a1.13%201.13%200%200%200-1.96%200L.165%2013.233c-.457.778.091%201.767.98%201.767h13.713c.889%200%201.438-.99.98-1.767L8.982%201.566zM8%205c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%205.995A.905.905%200%200%201%208%205zm.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2z%22/%3E%3C/svg%3E");}.pdoc .pdoc-alert-danger{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M5.52.359A.5.5%200%200%201%206%200h4a.5.5%200%200%201%20.474.658L8.694%206H12.5a.5.5%200%200%201%20.395.807l-7%209a.5.5%200%200%201-.873-.454L6.823%209.5H3.5a.5.5%200%200%201-.48-.641l2.5-8.5z%22/%3E%3C/svg%3E");}.pdoc .visually-hidden{position:absolute !important;width:1px !important;height:1px !important;padding:0 !important;margin:-1px !important;overflow:hidden !important;clip:rect(0, 0, 0, 0) !important;white-space:nowrap !important;border:0 !important;}.pdoc h1, .pdoc h2, .pdoc h3{font-weight:300;margin:.3em 0;padding:.2em 0;}.pdoc > section:not(.module-info) h1{font-size:1.5rem;font-weight:500;}.pdoc > section:not(.module-info) h2{font-size:1.4rem;font-weight:500;}.pdoc > section:not(.module-info) h3{font-size:1.3rem;font-weight:500;}.pdoc > section:not(.module-info) h4{font-size:1.2rem;}.pdoc > section:not(.module-info) h5{font-size:1.1rem;}.pdoc a{text-decoration:none;color:var(--link);}.pdoc a:hover{color:var(--link-hover);}.pdoc blockquote{margin-left:2rem;}.pdoc pre{border-top:1px solid var(--accent2);border-bottom:1px solid var(--accent2);margin-top:0;margin-bottom:1em;padding:.5rem 0 .5rem .5rem;overflow-x:auto;background-color:var(--code);}.pdoc code{color:var(--text);padding:.2em .4em;margin:0;font-size:85%;background-color:var(--accent);border-radius:6px;}.pdoc a > code{color:inherit;}.pdoc pre > code{display:inline-block;font-size:inherit;background:none;border:none;padding:0;}.pdoc > section:not(.module-info){margin-bottom:1.5rem;}.pdoc .modulename{margin-top:0;font-weight:bold;}.pdoc .modulename a{color:var(--link);transition:100ms all;}.pdoc .git-button{float:right;border:solid var(--link) 1px;}.pdoc .git-button:hover{background-color:var(--link);color:var(--pdoc-background);}.view-source-toggle-state,.view-source-toggle-state ~ .pdoc-code{display:none;}.view-source-toggle-state:checked ~ .pdoc-code{display:block;}.view-source-button{display:inline-block;float:right;font-size:.75rem;line-height:1.5rem;color:var(--muted);padding:0 .4rem 0 1.3rem;cursor:pointer;text-indent:-2px;}.view-source-button > span{visibility:hidden;}.module-info .view-source-button{float:none;display:flex;justify-content:flex-end;margin:-1.2rem .4rem -.2rem 0;}.view-source-button::before{position:absolute;content:"View Source";display:list-item;list-style-type:disclosure-closed;}.view-source-toggle-state:checked ~ .attr .view-source-button::before,.view-source-toggle-state:checked ~ .view-source-button::before{list-style-type:disclosure-open;}.pdoc .docstring{margin-bottom:1.5rem;}.pdoc section:not(.module-info) .docstring{margin-left:clamp(0rem, 5vw - 2rem, 1rem);}.pdoc .docstring .pdoc-code{margin-left:1em;margin-right:1em;}.pdoc h1:target,.pdoc h2:target,.pdoc h3:target,.pdoc h4:target,.pdoc h5:target,.pdoc h6:target,.pdoc .pdoc-code > pre > span:target{background-color:var(--active);box-shadow:-1rem 0 0 0 var(--active);}.pdoc .pdoc-code > pre > span:target{display:block;}.pdoc div:target > .attr,.pdoc section:target > .attr,.pdoc dd:target > a{background-color:var(--active);}.pdoc *{scroll-margin:2rem;}.pdoc .pdoc-code .linenos{user-select:none;}.pdoc .attr:hover{filter:contrast(0.95);}.pdoc section, .pdoc .classattr{position:relative;}.pdoc .headerlink{--width:clamp(1rem, 3vw, 2rem);position:absolute;top:0;left:calc(0rem - var(--width));transition:all 100ms ease-in-out;opacity:0;}.pdoc .headerlink::before{content:"#";display:block;text-align:center;width:var(--width);height:2.3rem;line-height:2.3rem;font-size:1.5rem;}.pdoc .attr:hover ~ .headerlink,.pdoc *:target > .headerlink,.pdoc .headerlink:hover{opacity:1;}.pdoc .attr{display:block;margin:.5rem 0 .5rem;padding:.4rem .4rem .4rem 1rem;background-color:var(--accent);overflow-x:auto;}.pdoc .classattr{margin-left:2rem;}.pdoc .name{color:var(--name);font-weight:bold;}.pdoc .def{color:var(--def);font-weight:bold;}.pdoc .signature{background-color:transparent;}.pdoc .param, .pdoc .return-annotation{white-space:pre;}.pdoc .signature.multiline .param{display:block;}.pdoc .signature.condensed .param{display:inline-block;}.pdoc .annotation{color:var(--annotation);}.pdoc .view-value-toggle-state,.pdoc .view-value-toggle-state ~ .default_value{display:none;}.pdoc .view-value-toggle-state:checked ~ .default_value{display:inherit;}.pdoc .view-value-button{font-size:.5rem;vertical-align:middle;border-style:dashed;margin-top:-0.1rem;}.pdoc .view-value-button:hover{background:white;}.pdoc .view-value-button::before{content:"show";text-align:center;width:2.2em;display:inline-block;}.pdoc .view-value-toggle-state:checked ~ .view-value-button::before{content:"hide";}.pdoc .inherited{margin-left:2rem;}.pdoc .inherited dt{font-weight:700;}.pdoc .inherited dt, .pdoc .inherited dd{display:inline;margin-left:0;margin-bottom:.5rem;}.pdoc .inherited dd:not(:last-child):after{content:", ";}.pdoc .inherited .class:before{content:"class ";}.pdoc .inherited .function a:after{content:"()";}.pdoc .search-result .docstring{overflow:auto;max-height:25vh;}.pdoc .search-result.focused > .attr{background-color:var(--active);}.pdoc .attribution{margin-top:2rem;display:block;opacity:0.5;transition:all 200ms;filter:grayscale(100%);}.pdoc .attribution:hover{opacity:1;filter:grayscale(0%);}.pdoc .attribution img{margin-left:5px;height:35px;vertical-align:middle;width:70px;transition:all 200ms;}.pdoc table{display:block;width:max-content;max-width:100%;overflow:auto;margin-bottom:1rem;}.pdoc table th{font-weight:600;}.pdoc table th, .pdoc table td{padding:6px 13px;border:1px solid var(--accent2);}</style>
    <style>/*! custom.css */</style></head>
<body>
    <nav class="pdoc">
        <label id="navtoggle" for="togglestate" class="pdoc-button"><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'><path stroke-linecap='round' stroke="currentColor" stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/></svg></label>
        <input id="togglestate" type="checkbox" aria-hidden="true" tabindex="-1">
        <div>            <a class="pdoc-button module-list-button" href="../weavingspace.html">
<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-box-arrow-in-left" viewBox="0 0 16 16">
  <path fill-rule="evenodd" d="M10 3.5a.5.5 0 0 0-.5-.5h-8a.5.5 0 0 0-.5.5v9a.5.5 0 0 0 .5.5h8a.5.5 0 0 0 .5-.5v-2a.5.5 0 0 1 1 0v2A1.5 1.5 0 0 1 9.5 14h-8A1.5 1.5 0 0 1 0 12.5v-9A1.5 1.5 0 0 1 1.5 2h8A1.5 1.5 0 0 1 11 3.5v2a.5.5 0 0 1-1 0v-2z"/>
  <path fill-rule="evenodd" d="M4.146 8.354a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5H14.5a.5.5 0 0 1 0 1H5.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3z"/>
</svg>                &nbsp;weavingspace</a>


            <input type="search" placeholder="Search..." role="searchbox" aria-label="search"
                   pattern=".+" required>



            <h2>API Documentation</h2>
                <ul class="memberlist">
            <li>
                    <a class="class" href="#Tile">Tile</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#Tile.__init__">Tile</a>
                        </li>
                        <li>
                                <a class="variable" href="#Tile.ID">ID</a>
                        </li>
                        <li>
                                <a class="variable" href="#Tile.base_ID">base_ID</a>
                        </li>
                        <li>
                                <a class="variable" href="#Tile.corners">corners</a>
                        </li>
                        <li>
                                <a class="variable" href="#Tile.edges">edges</a>
                        </li>
                        <li>
                                <a class="variable" href="#Tile.edges_CW">edges_CW</a>
                        </li>
                        <li>
                                <a class="variable" href="#Tile.label">label</a>
                        </li>
                        <li>
                                <a class="variable" href="#Tile.vertex_labels">vertex_labels</a>
                        </li>
                        <li>
                                <a class="variable" href="#Tile.edge_labels">edge_labels</a>
                        </li>
                        <li>
                                <a class="variable" href="#Tile.shape">shape</a>
                        </li>
                        <li>
                                <a class="variable" href="#Tile.centre">centre</a>
                        </li>
                        <li>
                                <a class="variable" href="#Tile.shape_group">shape_group</a>
                        </li>
                        <li>
                                <a class="variable" href="#Tile.transitivity_class">transitivity_class</a>
                        </li>
                        <li>
                                <a class="function" href="#Tile.get_corner_IDs">get_corner_IDs</a>
                        </li>
                        <li>
                                <a class="function" href="#Tile.get_edge_IDs">get_edge_IDs</a>
                        </li>
                        <li>
                                <a class="function" href="#Tile.set_shape_from_corners">set_shape_from_corners</a>
                        </li>
                        <li>
                                <a class="function" href="#Tile.set_corners_from_edges">set_corners_from_edges</a>
                        </li>
                        <li>
                                <a class="function" href="#Tile.set_edge_directions">set_edge_directions</a>
                        </li>
                        <li>
                                <a class="function" href="#Tile.insert_vertex_at">insert_vertex_at</a>
                        </li>
                        <li>
                                <a class="function" href="#Tile.merge_edges_at_vertex">merge_edges_at_vertex</a>
                        </li>
                        <li>
                                <a class="function" href="#Tile.get_updated_edges_from_merge">get_updated_edges_from_merge</a>
                        </li>
                        <li>
                                <a class="function" href="#Tile.get_edge_IDs_including_vertex">get_edge_IDs_including_vertex</a>
                        </li>
                        <li>
                                <a class="function" href="#Tile.get_merged_edge">get_merged_edge</a>
                        </li>
                        <li>
                                <a class="function" href="#Tile.offset_corners">offset_corners</a>
                        </li>
                        <li>
                                <a class="function" href="#Tile.get_edge_label">get_edge_label</a>
                        </li>
                        <li>
                                <a class="function" href="#Tile.get_corner_label">get_corner_label</a>
                        </li>
                        <li>
                                <a class="function" href="#Tile.get_vertex_label_positions">get_vertex_label_positions</a>
                        </li>
                        <li>
                                <a class="function" href="#Tile.get_edge_label_positions">get_edge_label_positions</a>
                        </li>
                        <li>
                                <a class="function" href="#Tile.angle_at">angle_at</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#Vertex">Vertex</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#Vertex.__init__">Vertex</a>
                        </li>
                        <li>
                                <a class="variable" href="#Vertex.point">point</a>
                        </li>
                        <li>
                                <a class="variable" href="#Vertex.ID">ID</a>
                        </li>
                        <li>
                                <a class="variable" href="#Vertex.tiles">tiles</a>
                        </li>
                        <li>
                                <a class="variable" href="#Vertex.neighbours">neighbours</a>
                        </li>
                        <li>
                                <a class="variable" href="#Vertex.base_ID">base_ID</a>
                        </li>
                        <li>
                                <a class="variable" href="#Vertex.transitivity_class">transitivity_class</a>
                        </li>
                        <li>
                                <a class="variable" href="#Vertex.label">label</a>
                        </li>
                        <li>
                                <a class="variable" href="#Vertex.is_tiling_vertex">is_tiling_vertex</a>
                        </li>
                        <li>
                                <a class="function" href="#Vertex.get_tile_IDs">get_tile_IDs</a>
                        </li>
                        <li>
                                <a class="function" href="#Vertex.add_tile">add_tile</a>
                        </li>
                        <li>
                                <a class="function" href="#Vertex.add_neighbour">add_neighbour</a>
                        </li>
                        <li>
                                <a class="function" href="#Vertex.clockwise_order_incident_tiles">clockwise_order_incident_tiles</a>
                        </li>
                        <li>
                                <a class="function" href="#Vertex.is_interior">is_interior</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#Edge">Edge</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#Edge.__init__">Edge</a>
                        </li>
                        <li>
                                <a class="variable" href="#Edge.ID">ID</a>
                        </li>
                        <li>
                                <a class="variable" href="#Edge.vertices">vertices</a>
                        </li>
                        <li>
                                <a class="variable" href="#Edge.corners">corners</a>
                        </li>
                        <li>
                                <a class="variable" href="#Edge.right_tile">right_tile</a>
                        </li>
                        <li>
                                <a class="variable" href="#Edge.left_tile">left_tile</a>
                        </li>
                        <li>
                                <a class="variable" href="#Edge.base_ID">base_ID</a>
                        </li>
                        <li>
                                <a class="variable" href="#Edge.transitivity_class">transitivity_class</a>
                        </li>
                        <li>
                                <a class="variable" href="#Edge.label">label</a>
                        </li>
                        <li>
                                <a class="function" href="#Edge.get_corner_IDs">get_corner_IDs</a>
                        </li>
                        <li>
                                <a class="function" href="#Edge.get_vertex_IDs">get_vertex_IDs</a>
                        </li>
                        <li>
                                <a class="function" href="#Edge.insert_vertex">insert_vertex</a>
                        </li>
                        <li>
                                <a class="function" href="#Edge.get_geometry">get_geometry</a>
                        </li>
                        <li>
                                <a class="function" href="#Edge.get_topology">get_topology</a>
                        </li>
                </ul>

            </li>
    </ul>



        <a class="attribution" title="pdoc: Python API documentation generator" href="https://pdoc.dev" target="_blank">
            built with <span class="visually-hidden">pdoc</span><img
                alt="pdoc logo"
                src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20role%3D%22img%22%20aria-label%3D%22pdoc%20logo%22%20width%3D%22300%22%20height%3D%22150%22%20viewBox%3D%22-1%200%2060%2030%22%3E%3Ctitle%3Epdoc%3C/title%3E%3Cpath%20d%3D%22M29.621%2021.293c-.011-.273-.214-.475-.511-.481a.5.5%200%200%200-.489.503l-.044%201.393c-.097.551-.695%201.215-1.566%201.704-.577.428-1.306.486-2.193.182-1.426-.617-2.467-1.654-3.304-2.487l-.173-.172a3.43%203.43%200%200%200-.365-.306.49.49%200%200%200-.286-.196c-1.718-1.06-4.931-1.47-7.353.191l-.219.15c-1.707%201.187-3.413%202.131-4.328%201.03-.02-.027-.49-.685-.141-1.763.233-.721.546-2.408.772-4.076.042-.09.067-.187.046-.288.166-1.347.277-2.625.241-3.351%201.378-1.008%202.271-2.586%202.271-4.362%200-.976-.272-1.935-.788-2.774-.057-.094-.122-.18-.184-.268.033-.167.052-.339.052-.516%200-1.477-1.202-2.679-2.679-2.679-.791%200-1.496.352-1.987.9a6.3%206.3%200%200%200-1.001.029c-.492-.564-1.207-.929-2.012-.929-1.477%200-2.679%201.202-2.679%202.679A2.65%202.65%200%200%200%20.97%206.554c-.383.747-.595%201.572-.595%202.41%200%202.311%201.507%204.29%203.635%205.107-.037.699-.147%202.27-.423%203.294l-.137.461c-.622%202.042-2.515%208.257%201.727%2010.643%201.614.908%203.06%201.248%204.317%201.248%202.665%200%204.492-1.524%205.322-2.401%201.476-1.559%202.886-1.854%206.491.82%201.877%201.393%203.514%201.753%204.861%201.068%202.223-1.713%202.811-3.867%203.399-6.374.077-.846.056-1.469.054-1.537zm-4.835%204.313c-.054.305-.156.586-.242.629-.034-.007-.131-.022-.307-.157-.145-.111-.314-.478-.456-.908.221.121.432.25.675.355.115.039.219.051.33.081zm-2.251-1.238c-.05.33-.158.648-.252.694-.022.001-.125-.018-.307-.157-.217-.166-.488-.906-.639-1.573.358.344.754.693%201.198%201.036zm-3.887-2.337c-.006-.116-.018-.231-.041-.342.635.145%201.189.368%201.599.625.097.231.166.481.174.642-.03.049-.055.101-.067.158-.046.013-.128.026-.298.004-.278-.037-.901-.57-1.367-1.087zm-1.127-.497c.116.306.176.625.12.71-.019.014-.117.045-.345.016-.206-.027-.604-.332-.986-.695.41-.051.816-.056%201.211-.031zm-4.535%201.535c.209.22.379.47.358.598-.006.041-.088.138-.351.234-.144.055-.539-.063-.979-.259a11.66%2011.66%200%200%200%20.972-.573zm.983-.664c.359-.237.738-.418%201.126-.554.25.237.479.548.457.694-.006.042-.087.138-.351.235-.174.064-.694-.105-1.232-.375zm-3.381%201.794c-.022.145-.061.29-.149.401-.133.166-.358.248-.69.251h-.002c-.133%200-.306-.26-.45-.621.417.091.854.07%201.291-.031zm-2.066-8.077a4.78%204.78%200%200%201-.775-.584c.172-.115.505-.254.88-.378l-.105.962zm-.331%202.302a10.32%2010.32%200%200%201-.828-.502c.202-.143.576-.328.984-.49l-.156.992zm-.45%202.157l-.701-.403c.214-.115.536-.249.891-.376a11.57%2011.57%200%200%201-.19.779zm-.181%201.716c.064.398.194.702.298.893-.194-.051-.435-.162-.736-.398.061-.119.224-.3.438-.495zM8.87%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zm-.735-.389a1.15%201.15%200%200%200-.314.783%201.16%201.16%200%200%200%201.162%201.162c.457%200%20.842-.27%201.032-.653.026.117.042.238.042.362a1.68%201.68%200%200%201-1.679%201.679%201.68%201.68%200%200%201-1.679-1.679c0-.843.626-1.535%201.436-1.654zM5.059%205.406A1.68%201.68%200%200%201%203.38%207.085a1.68%201.68%200%200%201-1.679-1.679c0-.037.009-.072.011-.109.21.3.541.508.935.508a1.16%201.16%200%200%200%201.162-1.162%201.14%201.14%200%200%200-.474-.912c.015%200%20.03-.005.045-.005.926.001%201.679.754%201.679%201.68zM3.198%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zM1.375%208.964c0-.52.103-1.035.288-1.52.466.394%201.06.64%201.717.64%201.144%200%202.116-.725%202.499-1.738.383%201.012%201.355%201.738%202.499%201.738.867%200%201.631-.421%202.121-1.062.307.605.478%201.267.478%201.942%200%202.486-2.153%204.51-4.801%204.51s-4.801-2.023-4.801-4.51zm24.342%2019.349c-.985.498-2.267.168-3.813-.979-3.073-2.281-5.453-3.199-7.813-.705-1.315%201.391-4.163%203.365-8.423.97-3.174-1.786-2.239-6.266-1.261-9.479l.146-.492c.276-1.02.395-2.457.444-3.268a6.11%206.11%200%200%200%201.18.115%206.01%206.01%200%200%200%202.536-.562l-.006.175c-.802.215-1.848.612-2.021%201.25-.079.295.021.601.274.837.219.203.415.364.598.501-.667.304-1.243.698-1.311%201.179-.02.144-.022.507.393.787.213.144.395.26.564.365-1.285.521-1.361.96-1.381%201.126-.018.142-.011.496.427.746l.854.489c-.473.389-.971.914-.999%201.429-.018.278.095.532.316.713.675.556%201.231.721%201.653.721.059%200%20.104-.014.158-.02.207.707.641%201.64%201.513%201.64h.013c.8-.008%201.236-.345%201.462-.626.173-.216.268-.457.325-.692.424.195.93.374%201.372.374.151%200%20.294-.021.423-.068.732-.27.944-.704.993-1.021.009-.061.003-.119.002-.179.266.086.538.147.789.147.15%200%20.294-.021.423-.069.542-.2.797-.489.914-.754.237.147.478.258.704.288.106.014.205.021.296.021.356%200%20.595-.101.767-.229.438.435%201.094.992%201.656%201.067.106.014.205.021.296.021a1.56%201.56%200%200%200%20.323-.035c.17.575.453%201.289.866%201.605.358.273.665.362.914.362a.99.99%200%200%200%20.421-.093%201.03%201.03%200%200%200%20.245-.164c.168.428.39.846.68%201.068.358.273.665.362.913.362a.99.99%200%200%200%20.421-.093c.317-.148.512-.448.639-.762.251.157.495.257.726.257.127%200%20.25-.024.37-.071.427-.17.706-.617.841-1.314.022-.015.047-.022.068-.038.067-.051.133-.104.196-.159-.443%201.486-1.107%202.761-2.086%203.257zM8.66%209.925a.5.5%200%201%200-1%200c0%20.653-.818%201.205-1.787%201.205s-1.787-.552-1.787-1.205a.5.5%200%201%200-1%200c0%201.216%201.25%202.205%202.787%202.205s2.787-.989%202.787-2.205zm4.4%2015.965l-.208.097c-2.661%201.258-4.708%201.436-6.086.527-1.542-1.017-1.88-3.19-1.844-4.198a.4.4%200%200%200-.385-.414c-.242-.029-.406.164-.414.385-.046%201.249.367%203.686%202.202%204.896.708.467%201.547.7%202.51.7%201.248%200%202.706-.392%204.362-1.174l.185-.086a.4.4%200%200%200%20.205-.527c-.089-.204-.326-.291-.527-.206zM9.547%202.292c.093.077.205.114.317.114a.5.5%200%200%200%20.318-.886L8.817.397a.5.5%200%200%200-.703.068.5.5%200%200%200%20.069.703l1.364%201.124zm-7.661-.065c.086%200%20.173-.022.253-.068l1.523-.893a.5.5%200%200%200-.506-.863l-1.523.892a.5.5%200%200%200-.179.685c.094.158.261.247.432.247z%22%20transform%3D%22matrix%28-1%200%200%201%2058%200%29%22%20fill%3D%22%233bb300%22/%3E%3Cpath%20d%3D%22M.3%2021.86V10.18q0-.46.02-.68.04-.22.18-.5.28-.54%201.34-.54%201.06%200%201.42.28.38.26.44.78.76-1.04%202.38-1.04%201.64%200%203.1%201.54%201.46%201.54%201.46%203.58%200%202.04-1.46%203.58-1.44%201.54-3.08%201.54-1.64%200-2.38-.92v4.04q0%20.46-.04.68-.02.22-.18.5-.14.3-.5.42-.36.12-.98.12-.62%200-1-.12-.36-.12-.52-.4-.14-.28-.18-.5-.02-.22-.02-.68zm3.96-9.42q-.46.54-.46%201.18%200%20.64.46%201.18.48.52%201.2.52.74%200%201.24-.52.52-.52.52-1.18%200-.66-.48-1.18-.48-.54-1.26-.54-.76%200-1.22.54zm14.741-8.36q.16-.3.54-.42.38-.12%201-.12.64%200%201.02.12.38.12.52.42.16.3.18.54.04.22.04.68v11.94q0%20.46-.04.7-.02.22-.18.5-.3.54-1.7.54-1.38%200-1.54-.98-.84.96-2.34.96-1.8%200-3.28-1.56-1.48-1.58-1.48-3.66%200-2.1%201.48-3.68%201.5-1.58%203.28-1.58%201.48%200%202.3%201v-4.2q0-.46.02-.68.04-.24.18-.52zm-3.24%2010.86q.52.54%201.26.54.74%200%201.22-.54.5-.54.5-1.18%200-.66-.48-1.22-.46-.56-1.26-.56-.8%200-1.28.56-.48.54-.48%201.2%200%20.66.52%201.2zm7.833-1.2q0-2.4%201.68-3.96%201.68-1.56%203.84-1.56%202.16%200%203.82%201.56%201.66%201.54%201.66%203.94%200%201.66-.86%202.96-.86%201.28-2.1%201.9-1.22.6-2.54.6-1.32%200-2.56-.64-1.24-.66-2.1-1.92-.84-1.28-.84-2.88zm4.18%201.44q.64.48%201.3.48.66%200%201.32-.5.66-.5.66-1.48%200-.98-.62-1.46-.62-.48-1.34-.48-.72%200-1.34.5-.62.5-.62%201.48%200%20.96.64%201.46zm11.412-1.44q0%20.84.56%201.32.56.46%201.18.46.64%200%201.18-.36.56-.38.9-.38.6%200%201.46%201.06.46.58.46%201.04%200%20.76-1.1%201.42-1.14.8-2.8.8-1.86%200-3.58-1.34-.82-.64-1.34-1.7-.52-1.08-.52-2.36%200-1.3.52-2.34.52-1.06%201.34-1.7%201.66-1.32%203.54-1.32.76%200%201.48.22.72.2%201.06.4l.32.2q.36.24.56.38.52.4.52.92%200%20.5-.42%201.14-.72%201.1-1.38%201.1-.38%200-1.08-.44-.36-.34-1.04-.34-.66%200-1.24.48-.58.48-.58%201.34z%22%20fill%3D%22green%22/%3E%3C/svg%3E"/>
        </a>
</div>
    </nav>
    <main class="pdoc">
            <section class="module-info">
                    <h1 class="modulename">
<a href="./../weavingspace.html">weavingspace</a><wbr>.topology_elements    </h1>

                
                        <input id="mod-topology_elements-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">

                        <label class="view-source-button" for="mod-topology_elements-view-source"><span>View Source</span></label>

                        <div class="pdoc-code codehilite"><pre><span></span><span id="L-1"><a href="#L-1"><span class="linenos">  1</span></a><span class="ch">#!/usr/bin/env python</span>
</span><span id="L-2"><a href="#L-2"><span class="linenos">  2</span></a><span class="c1"># coding: utf-8</span>
</span><span id="L-3"><a href="#L-3"><span class="linenos">  3</span></a>
</span><span id="L-4"><a href="#L-4"><span class="linenos">  4</span></a><span class="kn">import</span> <span class="nn">shapely.geometry</span> <span class="k">as</span> <span class="nn">geom</span>
</span><span id="L-5"><a href="#L-5"><span class="linenos">  5</span></a><span class="kn">import</span> <span class="nn">weavingspace.tiling_utils</span> <span class="k">as</span> <span class="nn">tiling_utils</span>
</span><span id="L-6"><a href="#L-6"><span class="linenos">  6</span></a>
</span><span id="L-7"><a href="#L-7"><span class="linenos">  7</span></a><span class="k">class</span> <span class="nc">Tile</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
</span><span id="L-8"><a href="#L-8"><span class="linenos">  8</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;Class to capture and manipulate essential features of polygons in a tiling.</span>
</span><span id="L-9"><a href="#L-9"><span class="linenos">  9</span></a><span class="sd">  &quot;&quot;&quot;</span>
</span><span id="L-10"><a href="#L-10"><span class="linenos"> 10</span></a>  <span class="n">ID</span><span class="p">:</span> <span class="nb">int</span>
</span><span id="L-11"><a href="#L-11"><span class="linenos"> 11</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;integer ID number which indexes the Tile in the containing Topology tiles </span>
</span><span id="L-12"><a href="#L-12"><span class="linenos"> 12</span></a><span class="sd">  list.&quot;&quot;&quot;</span>
</span><span id="L-13"><a href="#L-13"><span class="linenos"> 13</span></a>  <span class="n">base_ID</span><span class="p">:</span> <span class="nb">int</span>
</span><span id="L-14"><a href="#L-14"><span class="linenos"> 14</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;ID of corresponding Tile in the base tileable unit&quot;&quot;&quot;</span>
</span><span id="L-15"><a href="#L-15"><span class="linenos"> 15</span></a>  <span class="n">corners</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="s2">&quot;Vertex&quot;</span><span class="p">]</span>
</span><span id="L-16"><a href="#L-16"><span class="linenos"> 16</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;list of Vertex objects. This includes all corners of the original polygon </span>
</span><span id="L-17"><a href="#L-17"><span class="linenos"> 17</span></a><span class="sd">  and any tiling vertices induced by (for example) a the corner of an adjacent </span>
</span><span id="L-18"><a href="#L-18"><span class="linenos"> 18</span></a><span class="sd">  tile lying halfway along an edge of the original polygon on which this tile </span>
</span><span id="L-19"><a href="#L-19"><span class="linenos"> 19</span></a><span class="sd">  is based. Vertex objects are stored in strictly clockwise sequence.&quot;&quot;&quot;</span>
</span><span id="L-20"><a href="#L-20"><span class="linenos"> 20</span></a>  <span class="n">edges</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="s2">&quot;Edge&quot;</span><span class="p">]</span>
</span><span id="L-21"><a href="#L-21"><span class="linenos"> 21</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;list of Edge objects that together compose the tile boundary.&quot;&quot;&quot;</span>
</span><span id="L-22"><a href="#L-22"><span class="linenos"> 22</span></a>  <span class="n">edges_CW</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span>
</span><span id="L-23"><a href="#L-23"><span class="linenos"> 23</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;list of Edge direction. Edges are stored only once in a Topology so some </span>
</span><span id="L-24"><a href="#L-24"><span class="linenos"> 24</span></a><span class="sd">  edges are in clockwise order and others  are in counter-clockwise order. </span>
</span><span id="L-25"><a href="#L-25"><span class="linenos"> 25</span></a><span class="sd">  These boolean flags are True if the corresponding Edge is clockwise, False if </span>
</span><span id="L-26"><a href="#L-26"><span class="linenos"> 26</span></a><span class="sd">  counter-clockwise.&quot;&quot;&quot;</span>
</span><span id="L-27"><a href="#L-27"><span class="linenos"> 27</span></a>  <span class="n">label</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="L-28"><a href="#L-28"><span class="linenos"> 28</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;tile_id label from the tileable source&quot;&quot;&quot;</span>
</span><span id="L-29"><a href="#L-29"><span class="linenos"> 29</span></a>  <span class="n">vertex_labels</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
</span><span id="L-30"><a href="#L-30"><span class="linenos"> 30</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;list of (upper case) letter labels of the tile corners (i.e. all corners, </span>
</span><span id="L-31"><a href="#L-31"><span class="linenos"> 31</span></a><span class="sd">  not only tiling vertices).&quot;&quot;&quot;</span>
</span><span id="L-32"><a href="#L-32"><span class="linenos"> 32</span></a>  <span class="n">edge_labels</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
</span><span id="L-33"><a href="#L-33"><span class="linenos"> 33</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;list of (lower case) letter labels of the tile edges (tiling edges, not </span>
</span><span id="L-34"><a href="#L-34"><span class="linenos"> 34</span></a><span class="sd">  tile sides).&quot;&quot;&quot;</span>
</span><span id="L-35"><a href="#L-35"><span class="linenos"> 35</span></a>  <span class="n">shape</span><span class="p">:</span> <span class="n">geom</span><span class="o">.</span><span class="n">Polygon</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-36"><a href="#L-36"><span class="linenos"> 36</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;the tile geometry (which may include some redundant points along sides </span>
</span><span id="L-37"><a href="#L-37"><span class="linenos"> 37</span></a><span class="sd">  where neighbouring tiles induce a tiling vertex). So for example a rectangle </span>
</span><span id="L-38"><a href="#L-38"><span class="linenos"> 38</span></a><span class="sd">  might have additional points along its sides:</span>
</span><span id="L-39"><a href="#L-39"><span class="linenos"> 39</span></a><span class="sd">      </span>
</span><span id="L-40"><a href="#L-40"><span class="linenos"> 40</span></a><span class="sd">        +---+-------+</span>
</span><span id="L-41"><a href="#L-41"><span class="linenos"> 41</span></a><span class="sd">        |   |   2   |</span>
</span><span id="L-42"><a href="#L-42"><span class="linenos"> 42</span></a><span class="sd">        | 1 A---B---E---+</span>
</span><span id="L-43"><a href="#L-43"><span class="linenos"> 43</span></a><span class="sd">        |   |   |   4   |</span>
</span><span id="L-44"><a href="#L-44"><span class="linenos"> 44</span></a><span class="sd">        +---C 3 D-------+</span>
</span><span id="L-45"><a href="#L-45"><span class="linenos"> 45</span></a><span class="sd">            |   |</span>
</span><span id="L-46"><a href="#L-46"><span class="linenos"> 46</span></a><span class="sd">            +---+</span>
</span><span id="L-47"><a href="#L-47"><span class="linenos"> 47</span></a><span class="sd">      </span>
</span><span id="L-48"><a href="#L-48"><span class="linenos"> 48</span></a><span class="sd">  In the above Tile 1 has additional point A, 2 has B and 3 has C and D induced </span>
</span><span id="L-49"><a href="#L-49"><span class="linenos"> 49</span></a><span class="sd">  by the corners of neighbouring tiles.&quot;&quot;&quot;</span>
</span><span id="L-50"><a href="#L-50"><span class="linenos"> 50</span></a>  <span class="n">centre</span><span class="p">:</span> <span class="n">geom</span><span class="o">.</span><span class="n">Point</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-51"><a href="#L-51"><span class="linenos"> 51</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;a point centre for the Tile (determined by weavingspace.tiling_utils.</span>
</span><span id="L-52"><a href="#L-52"><span class="linenos"> 52</span></a><span class="sd">  incentre).&quot;&quot;&quot;</span>
</span><span id="L-53"><a href="#L-53"><span class="linenos"> 53</span></a>  <span class="n">shape_group</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-54"><a href="#L-54"><span class="linenos"> 54</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;the tile shape group of this tile in its containing Topology.&quot;&quot;&quot;</span>
</span><span id="L-55"><a href="#L-55"><span class="linenos"> 55</span></a>  <span class="n">transitivity_class</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-56"><a href="#L-56"><span class="linenos"> 56</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;the tile transitivity class of this tile its containing Topology&quot;&quot;&quot;</span>
</span><span id="L-57"><a href="#L-57"><span class="linenos"> 57</span></a>  
</span><span id="L-58"><a href="#L-58"><span class="linenos"> 58</span></a>  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ID</span><span class="p">:</span><span class="nb">int</span><span class="p">):</span>
</span><span id="L-59"><a href="#L-59"><span class="linenos"> 59</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Class constructor.</span>
</span><span id="L-60"><a href="#L-60"><span class="linenos"> 60</span></a>
</span><span id="L-61"><a href="#L-61"><span class="linenos"> 61</span></a><span class="sd">    Args:</span>
</span><span id="L-62"><a href="#L-62"><span class="linenos"> 62</span></a><span class="sd">      ID (int): Tile ID which indexes it in the containing Topology tiles list.</span>
</span><span id="L-63"><a href="#L-63"><span class="linenos"> 63</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-64"><a href="#L-64"><span class="linenos"> 64</span></a>    <span class="c1"># self.set_shape(tiling_utils.get_clean_polygon(shape))</span>
</span><span id="L-65"><a href="#L-65"><span class="linenos"> 65</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">ID</span> <span class="o">=</span> <span class="n">ID</span>
</span><span id="L-66"><a href="#L-66"><span class="linenos"> 66</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">corners</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-67"><a href="#L-67"><span class="linenos"> 67</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">edges</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-68"><a href="#L-68"><span class="linenos"> 68</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">edges_CW</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-69"><a href="#L-69"><span class="linenos"> 69</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">vertex_labels</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-70"><a href="#L-70"><span class="linenos"> 70</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">edge_labels</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-71"><a href="#L-71"><span class="linenos"> 71</span></a>
</span><span id="L-72"><a href="#L-72"><span class="linenos"> 72</span></a>  <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="L-73"><a href="#L-73"><span class="linenos"> 73</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns string representation of the Tile.</span>
</span><span id="L-74"><a href="#L-74"><span class="linenos"> 74</span></a>
</span><span id="L-75"><a href="#L-75"><span class="linenos"> 75</span></a><span class="sd">    Returns:</span>
</span><span id="L-76"><a href="#L-76"><span class="linenos"> 76</span></a><span class="sd">      str: string including Tile ID, list of corner vertex IDs and list of</span>
</span><span id="L-77"><a href="#L-77"><span class="linenos"> 77</span></a><span class="sd">        edge IDs.</span>
</span><span id="L-78"><a href="#L-78"><span class="linenos"> 78</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-79"><a href="#L-79"><span class="linenos"> 79</span></a>    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;Tile </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">ID</span><span class="si">}</span><span class="s2"> Corners: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">get_corner_IDs</span><span class="p">()</span><span class="si">}</span><span class="s2"> Edges: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">get_edge_IDs</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="L-80"><a href="#L-80"><span class="linenos"> 80</span></a>  
</span><span id="L-81"><a href="#L-81"><span class="linenos"> 81</span></a>  <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="L-82"><a href="#L-82"><span class="linenos"> 82</span></a>    <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="L-83"><a href="#L-83"><span class="linenos"> 83</span></a>
</span><span id="L-84"><a href="#L-84"><span class="linenos"> 84</span></a>  <span class="k">def</span> <span class="nf">get_corner_IDs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
</span><span id="L-85"><a href="#L-85"><span class="linenos"> 85</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Convenience method to return list of corner IDs (not Vertex objects).</span>
</span><span id="L-86"><a href="#L-86"><span class="linenos"> 86</span></a>
</span><span id="L-87"><a href="#L-87"><span class="linenos"> 87</span></a><span class="sd">    Returns:</span>
</span><span id="L-88"><a href="#L-88"><span class="linenos"> 88</span></a><span class="sd">      list[int]: list of integer IDs of tile corners.</span>
</span><span id="L-89"><a href="#L-89"><span class="linenos"> 89</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-90"><a href="#L-90"><span class="linenos"> 90</span></a>    <span class="k">return</span> <span class="p">[</span><span class="n">c</span><span class="o">.</span><span class="n">ID</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">corners</span><span class="p">]</span>
</span><span id="L-91"><a href="#L-91"><span class="linenos"> 91</span></a>
</span><span id="L-92"><a href="#L-92"><span class="linenos"> 92</span></a>  <span class="k">def</span> <span class="nf">get_edge_IDs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">]]:</span>
</span><span id="L-93"><a href="#L-93"><span class="linenos"> 93</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Convenience method to return list of edge IDs (not Edge objects).</span>
</span><span id="L-94"><a href="#L-94"><span class="linenos"> 94</span></a>
</span><span id="L-95"><a href="#L-95"><span class="linenos"> 95</span></a><span class="sd">    Returns:</span>
</span><span id="L-96"><a href="#L-96"><span class="linenos"> 96</span></a><span class="sd">      list[tuple[int]]: list of 2-element tuples of the start and end Vertex IDs</span>
</span><span id="L-97"><a href="#L-97"><span class="linenos"> 97</span></a><span class="sd">        of each edge.</span>
</span><span id="L-98"><a href="#L-98"><span class="linenos"> 98</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-99"><a href="#L-99"><span class="linenos"> 99</span></a>    <span class="k">return</span> <span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">ID</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">]</span>
</span><span id="L-100"><a href="#L-100"><span class="linenos">100</span></a>
</span><span id="L-101"><a href="#L-101"><span class="linenos">101</span></a>  <span class="k">def</span> <span class="nf">set_shape_from_corners</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-102"><a href="#L-102"><span class="linenos">102</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Sets the shape attribute based on the current list of corners, and sets </span>
</span><span id="L-103"><a href="#L-103"><span class="linenos">103</span></a><span class="sd">    the associated tile centre.</span>
</span><span id="L-104"><a href="#L-104"><span class="linenos">104</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-105"><a href="#L-105"><span class="linenos">105</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">shape</span> <span class="o">=</span> <span class="n">geom</span><span class="o">.</span><span class="n">Polygon</span><span class="p">([</span><span class="n">c</span><span class="o">.</span><span class="n">point</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">corners</span><span class="p">])</span>
</span><span id="L-106"><a href="#L-106"><span class="linenos">106</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">centre</span> <span class="o">=</span> <span class="n">tiling_utils</span><span class="o">.</span><span class="n">incentre</span><span class="p">(</span>
</span><span id="L-107"><a href="#L-107"><span class="linenos">107</span></a>      <span class="n">tiling_utils</span><span class="o">.</span><span class="n">get_clean_polygon</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
</span><span id="L-108"><a href="#L-108"><span class="linenos">108</span></a>
</span><span id="L-109"><a href="#L-109"><span class="linenos">109</span></a>  <span class="k">def</span> <span class="nf">set_corners_from_edges</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">update_shape</span><span class="p">:</span><span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">):</span>
</span><span id="L-110"><a href="#L-110"><span class="linenos">110</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Sets the corners attribute from the edges attribute. Typically called </span>
</span><span id="L-111"><a href="#L-111"><span class="linenos">111</span></a><span class="sd">    after modification of topology edges. Optionally the shape attribute is NOT</span>
</span><span id="L-112"><a href="#L-112"><span class="linenos">112</span></a><span class="sd">    updated, which may save time when multiple changes to the edges of a tile</span>
</span><span id="L-113"><a href="#L-113"><span class="linenos">113</span></a><span class="sd">    are in process (i.e., only update the shape after all changes are complete).</span>
</span><span id="L-114"><a href="#L-114"><span class="linenos">114</span></a>
</span><span id="L-115"><a href="#L-115"><span class="linenos">115</span></a><span class="sd">    Args:</span>
</span><span id="L-116"><a href="#L-116"><span class="linenos">116</span></a><span class="sd">      update_shape (bool, optional): if True the shape attribute will be </span>
</span><span id="L-117"><a href="#L-117"><span class="linenos">117</span></a><span class="sd">        updated, otherwise not. Defaults to True.</span>
</span><span id="L-118"><a href="#L-118"><span class="linenos">118</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-119"><a href="#L-119"><span class="linenos">119</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">corners</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-120"><a href="#L-120"><span class="linenos">120</span></a>    <span class="k">for</span> <span class="n">e</span><span class="p">,</span> <span class="n">cw</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges_CW</span><span class="p">):</span>
</span><span id="L-121"><a href="#L-121"><span class="linenos">121</span></a>      <span class="k">if</span> <span class="n">cw</span><span class="p">:</span> <span class="c1"># clockwise to extend by all but the first corner</span>
</span><span id="L-122"><a href="#L-122"><span class="linenos">122</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">corners</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">corners</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</span><span id="L-123"><a href="#L-123"><span class="linenos">123</span></a>      <span class="k">else</span><span class="p">:</span> <span class="c1"># counter-clockwise so extend in reverse</span>
</span><span id="L-124"><a href="#L-124"><span class="linenos">124</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">corners</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">corners</span><span class="p">[</span><span class="mi">1</span><span class="p">:][::</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</span><span id="L-125"><a href="#L-125"><span class="linenos">125</span></a>    <span class="k">if</span> <span class="n">update_shape</span><span class="p">:</span>
</span><span id="L-126"><a href="#L-126"><span class="linenos">126</span></a>      <span class="bp">self</span><span class="o">.</span><span class="n">set_shape_from_corners</span><span class="p">()</span>
</span><span id="L-127"><a href="#L-127"><span class="linenos">127</span></a>
</span><span id="L-128"><a href="#L-128"><span class="linenos">128</span></a>  <span class="k">def</span> <span class="nf">set_edge_directions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-129"><a href="#L-129"><span class="linenos">129</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Sets up the edges_CW attribute by inspection of the edges list.</span>
</span><span id="L-130"><a href="#L-130"><span class="linenos">130</span></a><span class="sd">    It is (frankly!) hard to keep track of the correct sequence of CW/CCW order</span>
</span><span id="L-131"><a href="#L-131"><span class="linenos">131</span></a><span class="sd">    of edges as new ones are created or old ones merged. This method inspects</span>
</span><span id="L-132"><a href="#L-132"><span class="linenos">132</span></a><span class="sd">    the &#39;tail-head&#39; relations between consecutive edges to set these flags </span>
</span><span id="L-133"><a href="#L-133"><span class="linenos">133</span></a><span class="sd">    correctly.</span>
</span><span id="L-134"><a href="#L-134"><span class="linenos">134</span></a>
</span><span id="L-135"><a href="#L-135"><span class="linenos">135</span></a><span class="sd">    The test is simply to check if the &#39;tail&#39; Vertex ID in each edge appears</span>
</span><span id="L-136"><a href="#L-136"><span class="linenos">136</span></a><span class="sd">    in the ID tuple of the following edge, i.e. if successive edge </span>
</span><span id="L-137"><a href="#L-137"><span class="linenos">137</span></a><span class="sd">    IDs are (0, 1) (2, 1) or (0, 1) (1, 2), then edge (0, 1) is in clockwise</span>
</span><span id="L-138"><a href="#L-138"><span class="linenos">138</span></a><span class="sd">    direction, but if we have (0, 1) (2, 3) then it is not.</span>
</span><span id="L-139"><a href="#L-139"><span class="linenos">139</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-140"><a href="#L-140"><span class="linenos">140</span></a>    <span class="n">edge_IDs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_edge_IDs</span><span class="p">()</span>
</span><span id="L-141"><a href="#L-141"><span class="linenos">141</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">edges_CW</span> <span class="o">=</span> <span class="p">[</span><span class="n">e1</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="n">e2</span> <span class="k">for</span> <span class="n">e1</span><span class="p">,</span> <span class="n">e2</span> <span class="ow">in</span> 
</span><span id="L-142"><a href="#L-142"><span class="linenos">142</span></a>                     <span class="nb">zip</span><span class="p">(</span><span class="n">edge_IDs</span><span class="p">,</span> <span class="n">edge_IDs</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">+</span> <span class="n">edge_IDs</span><span class="p">[:</span><span class="mi">1</span><span class="p">])]</span>
</span><span id="L-143"><a href="#L-143"><span class="linenos">143</span></a>
</span><span id="L-144"><a href="#L-144"><span class="linenos">144</span></a>  <span class="k">def</span> <span class="nf">insert_vertex_at</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">v</span><span class="p">:</span><span class="s2">&quot;Vertex&quot;</span><span class="p">,</span> <span class="n">i</span><span class="p">:</span><span class="nb">int</span><span class="p">,</span> 
</span><span id="L-145"><a href="#L-145"><span class="linenos">145</span></a>                       <span class="n">update_shape</span><span class="p">:</span><span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
</span><span id="L-146"><a href="#L-146"><span class="linenos">146</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Method to insert the supplied Vertex into tile at index position i, </span>
</span><span id="L-147"><a href="#L-147"><span class="linenos">147</span></a><span class="sd">    optionally updating the shape attribute. Both corners and edges attributes</span>
</span><span id="L-148"><a href="#L-148"><span class="linenos">148</span></a><span class="sd">    are updated, and the old edge IDs for removal and the new edge itself are</span>
</span><span id="L-149"><a href="#L-149"><span class="linenos">149</span></a><span class="sd">    returned to the calling context (the containing Topology) for update of its</span>
</span><span id="L-150"><a href="#L-150"><span class="linenos">150</span></a><span class="sd">    edges collection.</span>
</span><span id="L-151"><a href="#L-151"><span class="linenos">151</span></a>
</span><span id="L-152"><a href="#L-152"><span class="linenos">152</span></a><span class="sd">    This is NOT a generic vertex insertion method: it is only for use during </span>
</span><span id="L-153"><a href="#L-153"><span class="linenos">153</span></a><span class="sd">    Topology initialisation, and does not guarantee correct maintenance of </span>
</span><span id="L-154"><a href="#L-154"><span class="linenos">154</span></a><span class="sd">    all tile, edge and vertex relations in the general case---at any rate it</span>
</span><span id="L-155"><a href="#L-155"><span class="linenos">155</span></a><span class="sd">    has not been tested for this!</span>
</span><span id="L-156"><a href="#L-156"><span class="linenos">156</span></a>
</span><span id="L-157"><a href="#L-157"><span class="linenos">157</span></a><span class="sd">    Args:</span>
</span><span id="L-158"><a href="#L-158"><span class="linenos">158</span></a><span class="sd">        v (Vertex): the Vertex to insert.</span>
</span><span id="L-159"><a href="#L-159"><span class="linenos">159</span></a><span class="sd">        i (int): index position in current corners after which to insert </span>
</span><span id="L-160"><a href="#L-160"><span class="linenos">160</span></a><span class="sd">          supplied Vertex.</span>
</span><span id="L-161"><a href="#L-161"><span class="linenos">161</span></a><span class="sd">        update_shape (bool, optional): if True shape attribute is updated. </span>
</span><span id="L-162"><a href="#L-162"><span class="linenos">162</span></a><span class="sd">          Defaults to False.</span>
</span><span id="L-163"><a href="#L-163"><span class="linenos">163</span></a>
</span><span id="L-164"><a href="#L-164"><span class="linenos">164</span></a><span class="sd">    Returns:</span>
</span><span id="L-165"><a href="#L-165"><span class="linenos">165</span></a><span class="sd">      tuple: the (tuple) ID of the old edge which should be deleted, and </span>
</span><span id="L-166"><a href="#L-166"><span class="linenos">166</span></a><span class="sd">        the new Edges arising from insertion of this Vertex.</span>
</span><span id="L-167"><a href="#L-167"><span class="linenos">167</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-168"><a href="#L-168"><span class="linenos">168</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">corners</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">corners</span><span class="p">[:</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">corners</span><span class="p">[</span><span class="n">i</span><span class="p">:]</span>
</span><span id="L-169"><a href="#L-169"><span class="linenos">169</span></a>    <span class="n">old_edge</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
</span><span id="L-170"><a href="#L-170"><span class="linenos">170</span></a>    <span class="c1"># store current ID of the affected edge for return to calling context</span>
</span><span id="L-171"><a href="#L-171"><span class="linenos">171</span></a>    <span class="n">old_edge_ID</span> <span class="o">=</span> <span class="n">old_edge</span><span class="o">.</span><span class="n">ID</span>
</span><span id="L-172"><a href="#L-172"><span class="linenos">172</span></a>    <span class="n">new_edges</span> <span class="o">=</span> <span class="n">old_edge</span><span class="o">.</span><span class="n">insert_vertex</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">corners</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">])</span>
</span><span id="L-173"><a href="#L-173"><span class="linenos">173</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">edges</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">[:(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)]</span> <span class="o">+</span> <span class="n">new_edges</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">i</span><span class="p">:]</span>
</span><span id="L-174"><a href="#L-174"><span class="linenos">174</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">set_edge_directions</span><span class="p">()</span>
</span><span id="L-175"><a href="#L-175"><span class="linenos">175</span></a>    <span class="k">if</span> <span class="n">update_shape</span><span class="p">:</span>
</span><span id="L-176"><a href="#L-176"><span class="linenos">176</span></a>      <span class="bp">self</span><span class="o">.</span><span class="n">set_shape_from_corners</span><span class="p">()</span>
</span><span id="L-177"><a href="#L-177"><span class="linenos">177</span></a>    <span class="k">return</span> <span class="n">old_edge_ID</span><span class="p">,</span> <span class="n">new_edges</span>
</span><span id="L-178"><a href="#L-178"><span class="linenos">178</span></a>
</span><span id="L-179"><a href="#L-179"><span class="linenos">179</span></a>  <span class="k">def</span> <span class="nf">merge_edges_at_vertex</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">v</span><span class="p">:</span><span class="s2">&quot;Vertex&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
</span><span id="L-180"><a href="#L-180"><span class="linenos">180</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Method to merge the edges that meet at the supplied Vertex. It is </span>
</span><span id="L-181"><a href="#L-181"><span class="linenos">181</span></a><span class="sd">    assumed that only two tiles are impacted this one, and its neighbour across</span>
</span><span id="L-182"><a href="#L-182"><span class="linenos">182</span></a><span class="sd">    the Edge on which v lies. Both are updated. For this reason the work is</span>
</span><span id="L-183"><a href="#L-183"><span class="linenos">183</span></a><span class="sd">    delegated to get_updated_edges_from_merge which is run on both affected</span>
</span><span id="L-184"><a href="#L-184"><span class="linenos">184</span></a><span class="sd">    tiles, but only determines the edges to remove and the new edge to be added</span>
</span><span id="L-185"><a href="#L-185"><span class="linenos">185</span></a><span class="sd">    once. See that method for details.</span>
</span><span id="L-186"><a href="#L-186"><span class="linenos">186</span></a><span class="sd">    </span>
</span><span id="L-187"><a href="#L-187"><span class="linenos">187</span></a><span class="sd">    Args:</span>
</span><span id="L-188"><a href="#L-188"><span class="linenos">188</span></a><span class="sd">      v (Vertex): Vertex at which to merge Edges. This should currently be an</span>
</span><span id="L-189"><a href="#L-189"><span class="linenos">189</span></a><span class="sd">        end</span>
</span><span id="L-190"><a href="#L-190"><span class="linenos">190</span></a><span class="sd">    </span>
</span><span id="L-191"><a href="#L-191"><span class="linenos">191</span></a><span class="sd">    Returns:</span>
</span><span id="L-192"><a href="#L-192"><span class="linenos">192</span></a><span class="sd">      tuple: 2 item list of the edge IDs to be removed and a new Edge object to</span>
</span><span id="L-193"><a href="#L-193"><span class="linenos">193</span></a><span class="sd">        be added by the calling context (i.e. the containing Topology).</span>
</span><span id="L-194"><a href="#L-194"><span class="linenos">194</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-195"><a href="#L-195"><span class="linenos">195</span></a>    <span class="n">to_remove</span><span class="p">,</span> <span class="n">new_edge</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_updated_edges_from_merge</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
</span><span id="L-196"><a href="#L-196"><span class="linenos">196</span></a>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">tiles</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="L-197"><a href="#L-197"><span class="linenos">197</span></a>      <span class="n">v</span><span class="o">.</span><span class="n">tiles</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">get_updated_edges_from_merge</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">new_edge</span><span class="p">)</span>
</span><span id="L-198"><a href="#L-198"><span class="linenos">198</span></a>    <span class="k">return</span> <span class="n">to_remove</span><span class="p">,</span> <span class="n">new_edge</span>
</span><span id="L-199"><a href="#L-199"><span class="linenos">199</span></a>
</span><span id="L-200"><a href="#L-200"><span class="linenos">200</span></a>  <span class="k">def</span> <span class="nf">get_updated_edges_from_merge</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">v</span><span class="p">:</span><span class="s2">&quot;Vertex&quot;</span><span class="p">,</span> <span class="n">new_edge</span><span class="p">:</span><span class="s2">&quot;Edge&quot;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
</span><span id="L-201"><a href="#L-201"><span class="linenos">201</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Updates the edges and edges_CW attributes based on insertion of </span>
</span><span id="L-202"><a href="#L-202"><span class="linenos">202</span></a><span class="sd">    the supplied Vertex. If new_edge is supplied then the neighbour tile at</span>
</span><span id="L-203"><a href="#L-203"><span class="linenos">203</span></a><span class="sd">    v has already created the needed new Edge and this Edge is the one that</span>
</span><span id="L-204"><a href="#L-204"><span class="linenos">204</span></a><span class="sd">    will be &#39;slotted in&#39; at the appropriate spot in the edges list.</span>
</span><span id="L-205"><a href="#L-205"><span class="linenos">205</span></a>
</span><span id="L-206"><a href="#L-206"><span class="linenos">206</span></a><span class="sd">    The edges_CW is also updated to maintain correct directions of the edges.</span>
</span><span id="L-207"><a href="#L-207"><span class="linenos">207</span></a><span class="sd">    The corners attribute is unaffected by these changes.</span>
</span><span id="L-208"><a href="#L-208"><span class="linenos">208</span></a>
</span><span id="L-209"><a href="#L-209"><span class="linenos">209</span></a><span class="sd">    Args:</span>
</span><span id="L-210"><a href="#L-210"><span class="linenos">210</span></a><span class="sd">      v (Vertex): existing Vertex at which to carry out the merge.</span>
</span><span id="L-211"><a href="#L-211"><span class="linenos">211</span></a><span class="sd">      new_edge (Edge, optional): if another Tile has already carried out this </span>
</span><span id="L-212"><a href="#L-212"><span class="linenos">212</span></a><span class="sd">        merge this should be the resulting new Edge for insertion into this </span>
</span><span id="L-213"><a href="#L-213"><span class="linenos">213</span></a><span class="sd">        Tile. Defaults to None (when the new Edge will be constructed).</span>
</span><span id="L-214"><a href="#L-214"><span class="linenos">214</span></a><span class="sd">  </span>
</span><span id="L-215"><a href="#L-215"><span class="linenos">215</span></a><span class="sd">    Returns:</span>
</span><span id="L-216"><a href="#L-216"><span class="linenos">216</span></a><span class="sd">      Union[None, tuple]: either None (if a new edge was supplied) or a tuple </span>
</span><span id="L-217"><a href="#L-217"><span class="linenos">217</span></a><span class="sd">        of the two edge IDs to be removed and the new edge added for return to</span>
</span><span id="L-218"><a href="#L-218"><span class="linenos">218</span></a><span class="sd">        the calling context (i.e. the containing Topology).</span>
</span><span id="L-219"><a href="#L-219"><span class="linenos">219</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-220"><a href="#L-220"><span class="linenos">220</span></a>    <span class="c1"># get the two edge list index positions in which Vertex v is found</span>
</span><span id="L-221"><a href="#L-221"><span class="linenos">221</span></a>    <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_edge_IDs_including_vertex</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
</span><span id="L-222"><a href="#L-222"><span class="linenos">222</span></a>    <span class="k">if</span> <span class="n">new_edge</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="c1"># then we must make a new one</span>
</span><span id="L-223"><a href="#L-223"><span class="linenos">223</span></a>      <span class="c1"># also record existing edge IDs to be removed</span>
</span><span id="L-224"><a href="#L-224"><span class="linenos">224</span></a>      <span class="n">to_remove</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">ID</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">ID</span><span class="p">]</span>
</span><span id="L-225"><a href="#L-225"><span class="linenos">225</span></a>      <span class="n">new_edge</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_merged_edge</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span>
</span><span id="L-226"><a href="#L-226"><span class="linenos">226</span></a>      <span class="n">return_edge_updates</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="L-227"><a href="#L-227"><span class="linenos">227</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="L-228"><a href="#L-228"><span class="linenos">228</span></a>      <span class="n">return_edge_updates</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-229"><a href="#L-229"><span class="linenos">229</span></a>    <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">i</span> <span class="o">-</span> <span class="n">j</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="L-230"><a href="#L-230"><span class="linenos">230</span></a>      <span class="c1"># edge indices &#39;wrap&#39; around from end of edge list to start so drop </span>
</span><span id="L-231"><a href="#L-231"><span class="linenos">231</span></a>      <span class="c1"># first and last current edges and stick new one on at the end</span>
</span><span id="L-232"><a href="#L-232"><span class="linenos">232</span></a>      <span class="bp">self</span><span class="o">.</span><span class="n">edges</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="n">new_edge</span><span class="p">]</span> 
</span><span id="L-233"><a href="#L-233"><span class="linenos">233</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="L-234"><a href="#L-234"><span class="linenos">234</span></a>      <span class="c1"># insert new edge into list in place of the two old ones</span>
</span><span id="L-235"><a href="#L-235"><span class="linenos">235</span></a>      <span class="bp">self</span><span class="o">.</span><span class="n">edges</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">[:</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="n">new_edge</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">:]</span>
</span><span id="L-236"><a href="#L-236"><span class="linenos">236</span></a>    <span class="c1"># update the edge directions</span>
</span><span id="L-237"><a href="#L-237"><span class="linenos">237</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">set_edge_directions</span><span class="p">()</span>
</span><span id="L-238"><a href="#L-238"><span class="linenos">238</span></a>    <span class="k">if</span> <span class="n">return_edge_updates</span><span class="p">:</span>
</span><span id="L-239"><a href="#L-239"><span class="linenos">239</span></a>      <span class="k">return</span> <span class="n">to_remove</span><span class="p">,</span> <span class="n">new_edge</span>
</span><span id="L-240"><a href="#L-240"><span class="linenos">240</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="L-241"><a href="#L-241"><span class="linenos">241</span></a>      <span class="k">return</span> <span class="kc">None</span>
</span><span id="L-242"><a href="#L-242"><span class="linenos">242</span></a>
</span><span id="L-243"><a href="#L-243"><span class="linenos">243</span></a>  <span class="k">def</span> <span class="nf">get_edge_IDs_including_vertex</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">v</span><span class="p">:</span><span class="s2">&quot;Vertex&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
</span><span id="L-244"><a href="#L-244"><span class="linenos">244</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Gets the (two) index positions of the edges that include supplied Vertex.</span>
</span><span id="L-245"><a href="#L-245"><span class="linenos">245</span></a>
</span><span id="L-246"><a href="#L-246"><span class="linenos">246</span></a><span class="sd">    Args:</span>
</span><span id="L-247"><a href="#L-247"><span class="linenos">247</span></a><span class="sd">        v (Vertex): Vertex of interest.</span>
</span><span id="L-248"><a href="#L-248"><span class="linenos">248</span></a>
</span><span id="L-249"><a href="#L-249"><span class="linenos">249</span></a><span class="sd">    Returns:</span>
</span><span id="L-250"><a href="#L-250"><span class="linenos">250</span></a><span class="sd">      tuple[int]: two index positions of Edges in edges list that contain v.</span>
</span><span id="L-251"><a href="#L-251"><span class="linenos">251</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-252"><a href="#L-252"><span class="linenos">252</span></a>    <span class="k">return</span> <span class="p">(</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">e</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">)</span> <span class="k">if</span> <span class="n">v</span><span class="o">.</span><span class="n">ID</span> <span class="ow">in</span> <span class="n">e</span><span class="o">.</span><span class="n">ID</span><span class="p">)</span>
</span><span id="L-253"><a href="#L-253"><span class="linenos">253</span></a>
</span><span id="L-254"><a href="#L-254"><span class="linenos">254</span></a>  <span class="k">def</span> <span class="nf">get_merged_edge</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">:</span><span class="nb">int</span><span class="p">,</span> <span class="n">j</span><span class="p">:</span><span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Edge&quot;</span><span class="p">:</span>
</span><span id="L-255"><a href="#L-255"><span class="linenos">255</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns the new edge resulting from merging the two existing edges at</span>
</span><span id="L-256"><a href="#L-256"><span class="linenos">256</span></a><span class="sd">    index positions i and j in the edges list. For example, if the current list </span>
</span><span id="L-257"><a href="#L-257"><span class="linenos">257</span></a><span class="sd">    of edge IDs was</span>
</span><span id="L-258"><a href="#L-258"><span class="linenos">258</span></a>
</span><span id="L-259"><a href="#L-259"><span class="linenos">259</span></a><span class="sd">        (0 1 2) (4 2) (4 5) (5 0)</span>
</span><span id="L-260"><a href="#L-260"><span class="linenos">260</span></a>
</span><span id="L-261"><a href="#L-261"><span class="linenos">261</span></a><span class="sd">    and the merge Vertex was #2, the resulting new edge is constructed from </span>
</span><span id="L-262"><a href="#L-262"><span class="linenos">262</span></a><span class="sd">    vertices (0 1 2 4). </span>
</span><span id="L-263"><a href="#L-263"><span class="linenos">263</span></a>
</span><span id="L-264"><a href="#L-264"><span class="linenos">264</span></a><span class="sd">    Returns:</span>
</span><span id="L-265"><a href="#L-265"><span class="linenos">265</span></a><span class="sd">      Edge: the requested new Edge.</span>
</span><span id="L-266"><a href="#L-266"><span class="linenos">266</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-267"><a href="#L-267"><span class="linenos">267</span></a>    <span class="c1"># if i and j are not consecutive, then j is predecessor edge</span>
</span><span id="L-268"><a href="#L-268"><span class="linenos">268</span></a>    <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">i</span> <span class="o">-</span> <span class="n">j</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="L-269"><a href="#L-269"><span class="linenos">269</span></a>      <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="n">j</span><span class="p">,</span> <span class="n">i</span>
</span><span id="L-270"><a href="#L-270"><span class="linenos">270</span></a>    <span class="c1"># get edges and their directions</span>
</span><span id="L-271"><a href="#L-271"><span class="linenos">271</span></a>    <span class="n">ei</span><span class="p">,</span> <span class="n">ej</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
</span><span id="L-272"><a href="#L-272"><span class="linenos">272</span></a>    <span class="n">CWi</span><span class="p">,</span> <span class="n">CWj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges_CW</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges_CW</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
</span><span id="L-273"><a href="#L-273"><span class="linenos">273</span></a>    <span class="c1"># DON&#39;T MESS WITH THIS!!!</span>
</span><span id="L-274"><a href="#L-274"><span class="linenos">274</span></a>    <span class="c1"># for predecessors (the head) we want everything including the Vertex </span>
</span><span id="L-275"><a href="#L-275"><span class="linenos">275</span></a>    <span class="c1"># where the merge is occurring; for successors (the tail) we want all but </span>
</span><span id="L-276"><a href="#L-276"><span class="linenos">276</span></a>    <span class="c1"># the first Vertex (which is the one where the merge is occurring). In both </span>
</span><span id="L-277"><a href="#L-277"><span class="linenos">277</span></a>    <span class="c1"># cases contingent on whether existing Edges are CW or CCW we may need to </span>
</span><span id="L-278"><a href="#L-278"><span class="linenos">278</span></a>    <span class="c1"># flip the Vertex sequence to ensure that the merge Vertex is in the middle </span>
</span><span id="L-279"><a href="#L-279"><span class="linenos">279</span></a>    <span class="c1"># of the new edge that will be created</span>
</span><span id="L-280"><a href="#L-280"><span class="linenos">280</span></a>    <span class="n">head</span> <span class="o">=</span> <span class="n">ei</span><span class="o">.</span><span class="n">corners</span> <span class="k">if</span> <span class="n">CWi</span> <span class="k">else</span> <span class="n">ei</span><span class="o">.</span><span class="n">corners</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-281"><a href="#L-281"><span class="linenos">281</span></a>    <span class="n">tail</span> <span class="o">=</span> <span class="n">ej</span><span class="o">.</span><span class="n">corners</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="k">if</span> <span class="n">CWj</span> <span class="k">else</span> <span class="n">ej</span><span class="o">.</span><span class="n">corners</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">:]</span>
</span><span id="L-282"><a href="#L-282"><span class="linenos">282</span></a>    <span class="n">v_sequence</span> <span class="o">=</span> <span class="p">(</span><span class="n">head</span> <span class="k">if</span> <span class="n">CWi</span> <span class="k">else</span> <span class="n">head</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="p">(</span><span class="n">tail</span> <span class="k">if</span> <span class="n">CWj</span> <span class="k">else</span> <span class="n">tail</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</span><span id="L-283"><a href="#L-283"><span class="linenos">283</span></a>    <span class="k">return</span> <span class="n">Edge</span><span class="p">(</span><span class="n">v_sequence</span><span class="p">)</span>
</span><span id="L-284"><a href="#L-284"><span class="linenos">284</span></a>
</span><span id="L-285"><a href="#L-285"><span class="linenos">285</span></a>  <span class="k">def</span> <span class="nf">offset_corners</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">offset</span><span class="p">:</span><span class="nb">int</span><span class="p">):</span>
</span><span id="L-286"><a href="#L-286"><span class="linenos">286</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Shifts shape, corners, edges, and edges_CW by an offset amount. This is</span>
</span><span id="L-287"><a href="#L-287"><span class="linenos">287</span></a><span class="sd">    used to align tiles that are similar, which is required for correct </span>
</span><span id="L-288"><a href="#L-288"><span class="linenos">288</span></a><span class="sd">    transfer of &#39;base&#39; tile labelling on to &#39;radius 1&#39; tiles during Topology </span>
</span><span id="L-289"><a href="#L-289"><span class="linenos">289</span></a><span class="sd">    construction.</span>
</span><span id="L-290"><a href="#L-290"><span class="linenos">290</span></a>
</span><span id="L-291"><a href="#L-291"><span class="linenos">291</span></a><span class="sd">    Args:</span>
</span><span id="L-292"><a href="#L-292"><span class="linenos">292</span></a><span class="sd">      offset int: the number of positions to shift the lists.</span>
</span><span id="L-293"><a href="#L-293"><span class="linenos">293</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-294"><a href="#L-294"><span class="linenos">294</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">offset</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">offset</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-295"><a href="#L-295"><span class="linenos">295</span></a>      <span class="bp">self</span><span class="o">.</span><span class="n">shape</span> <span class="o">=</span> <span class="n">tiling_utils</span><span class="o">.</span><span class="n">offset_polygon_corners</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">offset</span><span class="p">)</span>
</span><span id="L-296"><a href="#L-296"><span class="linenos">296</span></a>      <span class="bp">self</span><span class="o">.</span><span class="n">corners</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">corners</span><span class="p">[</span><span class="n">offset</span><span class="p">:]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">corners</span><span class="p">[:</span><span class="n">offset</span><span class="p">]</span>
</span><span id="L-297"><a href="#L-297"><span class="linenos">297</span></a>      <span class="bp">self</span><span class="o">.</span><span class="n">edges</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">offset</span><span class="p">:]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">[:</span><span class="n">offset</span><span class="p">]</span>
</span><span id="L-298"><a href="#L-298"><span class="linenos">298</span></a>      <span class="bp">self</span><span class="o">.</span><span class="n">edges_CW</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges_CW</span><span class="p">[</span><span class="n">offset</span><span class="p">:]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges_CW</span><span class="p">[:</span><span class="n">offset</span><span class="p">]</span>
</span><span id="L-299"><a href="#L-299"><span class="linenos">299</span></a>
</span><span id="L-300"><a href="#L-300"><span class="linenos">300</span></a>  <span class="k">def</span> <span class="nf">get_edge_label</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">e</span><span class="p">:</span><span class="s2">&quot;Edge&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="L-301"><a href="#L-301"><span class="linenos">301</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns edge label of specified edge.</span>
</span><span id="L-302"><a href="#L-302"><span class="linenos">302</span></a>
</span><span id="L-303"><a href="#L-303"><span class="linenos">303</span></a><span class="sd">    Args:</span>
</span><span id="L-304"><a href="#L-304"><span class="linenos">304</span></a><span class="sd">        e (Edge): Edge whose label is required.</span>
</span><span id="L-305"><a href="#L-305"><span class="linenos">305</span></a>
</span><span id="L-306"><a href="#L-306"><span class="linenos">306</span></a><span class="sd">    Returns:</span>
</span><span id="L-307"><a href="#L-307"><span class="linenos">307</span></a><span class="sd">        str: requested edge label.</span>
</span><span id="L-308"><a href="#L-308"><span class="linenos">308</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-309"><a href="#L-309"><span class="linenos">309</span></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">edge_labels</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">get_edge_IDs</span><span class="p">()</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">ID</span><span class="p">)]</span>
</span><span id="L-310"><a href="#L-310"><span class="linenos">310</span></a>
</span><span id="L-311"><a href="#L-311"><span class="linenos">311</span></a>  <span class="k">def</span> <span class="nf">get_corner_label</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">v</span><span class="p">:</span><span class="s2">&quot;Vertex&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="L-312"><a href="#L-312"><span class="linenos">312</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns corner label of specified corner.</span>
</span><span id="L-313"><a href="#L-313"><span class="linenos">313</span></a>
</span><span id="L-314"><a href="#L-314"><span class="linenos">314</span></a><span class="sd">    Args:</span>
</span><span id="L-315"><a href="#L-315"><span class="linenos">315</span></a><span class="sd">        v (Vertex): corner whose label is required.</span>
</span><span id="L-316"><a href="#L-316"><span class="linenos">316</span></a>
</span><span id="L-317"><a href="#L-317"><span class="linenos">317</span></a><span class="sd">    Returns:</span>
</span><span id="L-318"><a href="#L-318"><span class="linenos">318</span></a><span class="sd">        str: requested corner label.</span>
</span><span id="L-319"><a href="#L-319"><span class="linenos">319</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-320"><a href="#L-320"><span class="linenos">320</span></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">edge_labels</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">get_corner_IDs</span><span class="p">()</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">ID</span><span class="p">)]</span>
</span><span id="L-321"><a href="#L-321"><span class="linenos">321</span></a>
</span><span id="L-322"><a href="#L-322"><span class="linenos">322</span></a>  <span class="k">def</span> <span class="nf">get_vertex_label_positions</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">geom</span><span class="o">.</span><span class="n">Point</span><span class="p">]:</span>
</span><span id="L-323"><a href="#L-323"><span class="linenos">323</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns a viable location at which to position corner labels inside</span>
</span><span id="L-324"><a href="#L-324"><span class="linenos">324</span></a><span class="sd">    tile shape. The method is convoluted because a negative buffer may remove</span>
</span><span id="L-325"><a href="#L-325"><span class="linenos">325</span></a><span class="sd">    colinear corners resulting in fewer positions than we have corners in the</span>
</span><span id="L-326"><a href="#L-326"><span class="linenos">326</span></a><span class="sd">    tile shape!</span>
</span><span id="L-327"><a href="#L-327"><span class="linenos">327</span></a>
</span><span id="L-328"><a href="#L-328"><span class="linenos">328</span></a><span class="sd">    Returns:</span>
</span><span id="L-329"><a href="#L-329"><span class="linenos">329</span></a><span class="sd">        list[geom.Point]: list of locations.</span>
</span><span id="L-330"><a href="#L-330"><span class="linenos">330</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-331"><a href="#L-331"><span class="linenos">331</span></a>    <span class="n">d</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="o">.</span><span class="n">area</span> <span class="o">**</span> <span class="mf">0.5</span><span class="p">)</span> <span class="o">/</span> <span class="mi">8</span>
</span><span id="L-332"><a href="#L-332"><span class="linenos">332</span></a>    <span class="n">c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">centre</span>
</span><span id="L-333"><a href="#L-333"><span class="linenos">333</span></a>    <span class="n">corners</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span><span class="o">.</span><span class="n">point</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">corners</span><span class="p">]</span>
</span><span id="L-334"><a href="#L-334"><span class="linenos">334</span></a>    <span class="k">return</span> <span class="p">[</span><span class="n">geom</span><span class="o">.</span><span class="n">LineString</span><span class="p">([</span><span class="n">p</span><span class="p">,</span> <span class="n">c</span><span class="p">])</span><span class="o">.</span><span class="n">line_interpolate_point</span><span class="p">(</span><span class="n">d</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">corners</span><span class="p">]</span>
</span><span id="L-335"><a href="#L-335"><span class="linenos">335</span></a>    
</span><span id="L-336"><a href="#L-336"><span class="linenos">336</span></a>  <span class="k">def</span> <span class="nf">get_edge_label_positions</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">geom</span><span class="o">.</span><span class="n">Point</span><span class="p">]:</span>
</span><span id="L-337"><a href="#L-337"><span class="linenos">337</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns a reasonable location at which to position edge labels inside</span>
</span><span id="L-338"><a href="#L-338"><span class="linenos">338</span></a><span class="sd">    tile shape.</span>
</span><span id="L-339"><a href="#L-339"><span class="linenos">339</span></a>
</span><span id="L-340"><a href="#L-340"><span class="linenos">340</span></a><span class="sd">    Returns:</span>
</span><span id="L-341"><a href="#L-341"><span class="linenos">341</span></a><span class="sd">        list[geom.Point]: list of locations</span>
</span><span id="L-342"><a href="#L-342"><span class="linenos">342</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-343"><a href="#L-343"><span class="linenos">343</span></a>    <span class="n">d</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="o">.</span><span class="n">area</span> <span class="o">**</span> <span class="mf">0.5</span><span class="p">)</span> <span class="o">/</span> <span class="mi">8</span>
</span><span id="L-344"><a href="#L-344"><span class="linenos">344</span></a>    <span class="n">c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">centre</span>
</span><span id="L-345"><a href="#L-345"><span class="linenos">345</span></a>    <span class="c1"># note direction is important as edge might not be a simple line segment</span>
</span><span id="L-346"><a href="#L-346"><span class="linenos">346</span></a>    <span class="n">sides</span> <span class="o">=</span> <span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">get_geometry</span><span class="p">(</span><span class="n">CW</span><span class="p">)</span> <span class="k">for</span> <span class="n">e</span><span class="p">,</span> <span class="n">CW</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges_CW</span><span class="p">)]</span>
</span><span id="L-347"><a href="#L-347"><span class="linenos">347</span></a>    <span class="k">return</span> <span class="p">[</span><span class="n">geom</span><span class="o">.</span><span class="n">LineString</span><span class="p">([</span><span class="n">s</span><span class="o">.</span><span class="n">centroid</span><span class="p">,</span> <span class="n">c</span><span class="p">])</span><span class="o">.</span><span class="n">line_interpolate_point</span><span class="p">(</span><span class="n">d</span><span class="p">)</span> 
</span><span id="L-348"><a href="#L-348"><span class="linenos">348</span></a>            <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">sides</span><span class="p">]</span>
</span><span id="L-349"><a href="#L-349"><span class="linenos">349</span></a>
</span><span id="L-350"><a href="#L-350"><span class="linenos">350</span></a>  <span class="k">def</span> <span class="nf">angle_at</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">v</span><span class="p">:</span><span class="s2">&quot;Vertex&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="L-351"><a href="#L-351"><span class="linenos">351</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns interior angle at the specified corner (in degrees).</span>
</span><span id="L-352"><a href="#L-352"><span class="linenos">352</span></a>
</span><span id="L-353"><a href="#L-353"><span class="linenos">353</span></a><span class="sd">    Args:</span>
</span><span id="L-354"><a href="#L-354"><span class="linenos">354</span></a><span class="sd">        v (Vertex): corner where angle is requested.</span>
</span><span id="L-355"><a href="#L-355"><span class="linenos">355</span></a>
</span><span id="L-356"><a href="#L-356"><span class="linenos">356</span></a><span class="sd">    Returns:</span>
</span><span id="L-357"><a href="#L-357"><span class="linenos">357</span></a><span class="sd">        float: angle at corner v in degrees.</span>
</span><span id="L-358"><a href="#L-358"><span class="linenos">358</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-359"><a href="#L-359"><span class="linenos">359</span></a>    <span class="n">i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">corners</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
</span><span id="L-360"><a href="#L-360"><span class="linenos">360</span></a>    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">corners</span><span class="p">)</span>
</span><span id="L-361"><a href="#L-361"><span class="linenos">361</span></a>    <span class="k">return</span> <span class="n">tiling_utils</span><span class="o">.</span><span class="n">get_inner_angle</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">corners</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">point</span><span class="p">,</span>
</span><span id="L-362"><a href="#L-362"><span class="linenos">362</span></a>                                        <span class="bp">self</span><span class="o">.</span><span class="n">corners</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">point</span><span class="p">,</span>
</span><span id="L-363"><a href="#L-363"><span class="linenos">363</span></a>                                        <span class="bp">self</span><span class="o">.</span><span class="n">corners</span><span class="p">[(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="n">n</span><span class="p">]</span><span class="o">.</span><span class="n">point</span><span class="p">)</span>
</span><span id="L-364"><a href="#L-364"><span class="linenos">364</span></a>
</span><span id="L-365"><a href="#L-365"><span class="linenos">365</span></a>
</span><span id="L-366"><a href="#L-366"><span class="linenos">366</span></a><span class="k">class</span> <span class="nc">Vertex</span><span class="p">:</span>
</span><span id="L-367"><a href="#L-367"><span class="linenos">367</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;Class to store attributes of a vertex in a tiling.&quot;&quot;&quot;</span>
</span><span id="L-368"><a href="#L-368"><span class="linenos">368</span></a>  <span class="n">point</span><span class="p">:</span> <span class="n">geom</span><span class="o">.</span><span class="n">Point</span>
</span><span id="L-369"><a href="#L-369"><span class="linenos">369</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;point (geom.Point): point location of the vertex.&quot;&quot;&quot;</span>
</span><span id="L-370"><a href="#L-370"><span class="linenos">370</span></a>  <span class="n">ID</span><span class="p">:</span> <span class="nb">int</span>
</span><span id="L-371"><a href="#L-371"><span class="linenos">371</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;integer (mostly but not necessarily in sequence) of vertex keyed into the </span>
</span><span id="L-372"><a href="#L-372"><span class="linenos">372</span></a><span class="sd">  points dictionary of the containing Topology.&quot;&quot;&quot;</span>
</span><span id="L-373"><a href="#L-373"><span class="linenos">373</span></a>  <span class="n">tiles</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="s2">&quot;Tile&quot;</span><span class="p">]</span>
</span><span id="L-374"><a href="#L-374"><span class="linenos">374</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;list of Tiles incident on this vertex.&quot;&quot;&quot;</span>
</span><span id="L-375"><a href="#L-375"><span class="linenos">375</span></a>  <span class="n">neighbours</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span>
</span><span id="L-376"><a href="#L-376"><span class="linenos">376</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;list of the immediately adjacent other corner IDs. Only required to </span>
</span><span id="L-377"><a href="#L-377"><span class="linenos">377</span></a><span class="sd">  determine if a point is a tiling vertex (when it will have) three or more </span>
</span><span id="L-378"><a href="#L-378"><span class="linenos">378</span></a><span class="sd">  neighbours, so only IDs are stored.&quot;&quot;&quot;</span>
</span><span id="L-379"><a href="#L-379"><span class="linenos">379</span></a>  <span class="n">base_ID</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1_000_000</span>
</span><span id="L-380"><a href="#L-380"><span class="linenos">380</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;ID of corresponding Vertex in the tileable base_unit&quot;&quot;&quot;</span>
</span><span id="L-381"><a href="#L-381"><span class="linenos">381</span></a>  <span class="n">transitivity_class</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-382"><a href="#L-382"><span class="linenos">382</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;transitivity class of the vertex under symmetries of the tiling&quot;&quot;&quot;</span>
</span><span id="L-383"><a href="#L-383"><span class="linenos">383</span></a>  <span class="n">label</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="L-384"><a href="#L-384"><span class="linenos">384</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;the (upper case letter) label of the vertex under the symmetries of the </span>
</span><span id="L-385"><a href="#L-385"><span class="linenos">385</span></a><span class="sd">  tiling.&quot;&quot;&quot;</span>
</span><span id="L-386"><a href="#L-386"><span class="linenos">386</span></a>  <span class="n">is_tiling_vertex</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="L-387"><a href="#L-387"><span class="linenos">387</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;is_tiling_vertex (bool): True if this is a tiling vertex, rather than a </span>
</span><span id="L-388"><a href="#L-388"><span class="linenos">388</span></a><span class="sd">  tile corner. E.g., A below is a corner, not a tiling vertex. B is a tiling </span>
</span><span id="L-389"><a href="#L-389"><span class="linenos">389</span></a><span class="sd">  vertex:</span>
</span><span id="L-390"><a href="#L-390"><span class="linenos">390</span></a><span class="sd">      </span>
</span><span id="L-391"><a href="#L-391"><span class="linenos">391</span></a><span class="sd">      +-------+</span>
</span><span id="L-392"><a href="#L-392"><span class="linenos">392</span></a><span class="sd">      | 1     |</span>
</span><span id="L-393"><a href="#L-393"><span class="linenos">393</span></a><span class="sd">      |   A---B---+</span>
</span><span id="L-394"><a href="#L-394"><span class="linenos">394</span></a><span class="sd">      |   | 2     |</span>
</span><span id="L-395"><a href="#L-395"><span class="linenos">395</span></a><span class="sd">      +---C   +---+</span>
</span><span id="L-396"><a href="#L-396"><span class="linenos">396</span></a><span class="sd">          |   |</span>
</span><span id="L-397"><a href="#L-397"><span class="linenos">397</span></a><span class="sd">          +---+&quot;&quot;&quot;</span>
</span><span id="L-398"><a href="#L-398"><span class="linenos">398</span></a>  
</span><span id="L-399"><a href="#L-399"><span class="linenos">399</span></a>  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">point</span><span class="p">:</span><span class="n">geom</span><span class="o">.</span><span class="n">Point</span><span class="p">,</span> <span class="n">ID</span><span class="p">:</span><span class="nb">int</span><span class="p">):</span>
</span><span id="L-400"><a href="#L-400"><span class="linenos">400</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Class constructor.</span>
</span><span id="L-401"><a href="#L-401"><span class="linenos">401</span></a>
</span><span id="L-402"><a href="#L-402"><span class="linenos">402</span></a><span class="sd">    Args:</span>
</span><span id="L-403"><a href="#L-403"><span class="linenos">403</span></a><span class="sd">      point (geom.Point): point location of the vertex.</span>
</span><span id="L-404"><a href="#L-404"><span class="linenos">404</span></a><span class="sd">      ID (int): a unique integer ID (which will be its key in the containing</span>
</span><span id="L-405"><a href="#L-405"><span class="linenos">405</span></a><span class="sd">        Topology points dictionary).</span>
</span><span id="L-406"><a href="#L-406"><span class="linenos">406</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-407"><a href="#L-407"><span class="linenos">407</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">point</span> <span class="o">=</span> <span class="n">point</span>
</span><span id="L-408"><a href="#L-408"><span class="linenos">408</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">ID</span> <span class="o">=</span> <span class="n">ID</span>
</span><span id="L-409"><a href="#L-409"><span class="linenos">409</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">base_ID</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ID</span>
</span><span id="L-410"><a href="#L-410"><span class="linenos">410</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">tiles</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-411"><a href="#L-411"><span class="linenos">411</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">neighbours</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-412"><a href="#L-412"><span class="linenos">412</span></a>
</span><span id="L-413"><a href="#L-413"><span class="linenos">413</span></a>  <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="L-414"><a href="#L-414"><span class="linenos">414</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns string representation of Vertex.</span>
</span><span id="L-415"><a href="#L-415"><span class="linenos">415</span></a><span class="sd">    </span>
</span><span id="L-416"><a href="#L-416"><span class="linenos">416</span></a><span class="sd">    Returns:</span>
</span><span id="L-417"><a href="#L-417"><span class="linenos">417</span></a><span class="sd">        str: string including ID, point and list of incident Tiles.</span>
</span><span id="L-418"><a href="#L-418"><span class="linenos">418</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-419"><a href="#L-419"><span class="linenos">419</span></a>    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;Vertex </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">ID</span><span class="si">}</span><span class="s2"> at </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">point</span><span class="si">}</span><span class="s2"> Tiles: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">get_tile_IDs</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="L-420"><a href="#L-420"><span class="linenos">420</span></a>
</span><span id="L-421"><a href="#L-421"><span class="linenos">421</span></a>  <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="L-422"><a href="#L-422"><span class="linenos">422</span></a>    <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="L-423"><a href="#L-423"><span class="linenos">423</span></a>
</span><span id="L-424"><a href="#L-424"><span class="linenos">424</span></a>  <span class="k">def</span> <span class="nf">get_tile_IDs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
</span><span id="L-425"><a href="#L-425"><span class="linenos">425</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Convenience method to return list of Tile IDs (not the Tiles themselves).</span>
</span><span id="L-426"><a href="#L-426"><span class="linenos">426</span></a>
</span><span id="L-427"><a href="#L-427"><span class="linenos">427</span></a><span class="sd">    Returns:</span>
</span><span id="L-428"><a href="#L-428"><span class="linenos">428</span></a><span class="sd">        list[int]: list of Tile IDs</span>
</span><span id="L-429"><a href="#L-429"><span class="linenos">429</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-430"><a href="#L-430"><span class="linenos">430</span></a>    <span class="k">return</span> <span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">ID</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tiles</span><span class="p">]</span>
</span><span id="L-431"><a href="#L-431"><span class="linenos">431</span></a>
</span><span id="L-432"><a href="#L-432"><span class="linenos">432</span></a>  <span class="k">def</span> <span class="nf">add_tile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tile</span><span class="p">:</span><span class="n">Tile</span><span class="p">):</span>
</span><span id="L-433"><a href="#L-433"><span class="linenos">433</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Adds supplied Tile to the tiles list if it is not already present.</span>
</span><span id="L-434"><a href="#L-434"><span class="linenos">434</span></a>
</span><span id="L-435"><a href="#L-435"><span class="linenos">435</span></a><span class="sd">    Args:</span>
</span><span id="L-436"><a href="#L-436"><span class="linenos">436</span></a><span class="sd">        tile (Tile): Tile to add.</span>
</span><span id="L-437"><a href="#L-437"><span class="linenos">437</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-438"><a href="#L-438"><span class="linenos">438</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">tile</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tiles</span><span class="p">:</span>
</span><span id="L-439"><a href="#L-439"><span class="linenos">439</span></a>      <span class="bp">self</span><span class="o">.</span><span class="n">tiles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tile</span><span class="p">)</span>
</span><span id="L-440"><a href="#L-440"><span class="linenos">440</span></a>
</span><span id="L-441"><a href="#L-441"><span class="linenos">441</span></a>  <span class="k">def</span> <span class="nf">add_neighbour</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vertex_id</span><span class="p">:</span><span class="nb">int</span><span class="p">):</span>
</span><span id="L-442"><a href="#L-442"><span class="linenos">442</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Adds supplied ID to the neighbours list if it is not already present</span>
</span><span id="L-443"><a href="#L-443"><span class="linenos">443</span></a>
</span><span id="L-444"><a href="#L-444"><span class="linenos">444</span></a><span class="sd">    Args:</span>
</span><span id="L-445"><a href="#L-445"><span class="linenos">445</span></a><span class="sd">      vertex_id (int): ID to add to the neighbours list.</span>
</span><span id="L-446"><a href="#L-446"><span class="linenos">446</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-447"><a href="#L-447"><span class="linenos">447</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">vertex_id</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">neighbours</span><span class="p">:</span>
</span><span id="L-448"><a href="#L-448"><span class="linenos">448</span></a>      <span class="bp">self</span><span class="o">.</span><span class="n">neighbours</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">vertex_id</span><span class="p">)</span>
</span><span id="L-449"><a href="#L-449"><span class="linenos">449</span></a>
</span><span id="L-450"><a href="#L-450"><span class="linenos">450</span></a>  <span class="k">def</span> <span class="nf">clockwise_order_incident_tiles</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-451"><a href="#L-451"><span class="linenos">451</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Reorders the tiles list clockwise (this is for dual tiling construction)</span>
</span><span id="L-452"><a href="#L-452"><span class="linenos">452</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-453"><a href="#L-453"><span class="linenos">453</span></a>    <span class="n">cw_order</span> <span class="o">=</span> <span class="n">tiling_utils</span><span class="o">.</span><span class="n">order_of_pts_cw_around_centre</span><span class="p">(</span>
</span><span id="L-454"><a href="#L-454"><span class="linenos">454</span></a>      <span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">centre</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tiles</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">point</span><span class="p">)</span>
</span><span id="L-455"><a href="#L-455"><span class="linenos">455</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">tiles</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">tiles</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">cw_order</span><span class="p">]</span>
</span><span id="L-456"><a href="#L-456"><span class="linenos">456</span></a>
</span><span id="L-457"><a href="#L-457"><span class="linenos">457</span></a>  <span class="k">def</span> <span class="nf">is_interior</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="L-458"><a href="#L-458"><span class="linenos">458</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Tests if vertex is completely enclosed by its incident Tiles. Based on</span>
</span><span id="L-459"><a href="#L-459"><span class="linenos">459</span></a><span class="sd">    summing the interior angles of the incident tiles at this vertex.</span>
</span><span id="L-460"><a href="#L-460"><span class="linenos">460</span></a>
</span><span id="L-461"><a href="#L-461"><span class="linenos">461</span></a><span class="sd">    Returns:</span>
</span><span id="L-462"><a href="#L-462"><span class="linenos">462</span></a><span class="sd">        bool: True if vertex is completely enclosed by incident Tiles.</span>
</span><span id="L-463"><a href="#L-463"><span class="linenos">463</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-464"><a href="#L-464"><span class="linenos">464</span></a>    <span class="k">return</span> <span class="nb">abs</span><span class="p">(</span><span class="mi">360</span> <span class="o">-</span> <span class="nb">sum</span><span class="p">([</span><span class="n">t</span><span class="o">.</span><span class="n">angle_at</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tiles</span><span class="p">]))</span> \
</span><span id="L-465"><a href="#L-465"><span class="linenos">465</span></a>                     <span class="o">&lt;</span> <span class="n">tiling_utils</span><span class="o">.</span><span class="n">RESOLUTION</span>
</span><span id="L-466"><a href="#L-466"><span class="linenos">466</span></a>
</span><span id="L-467"><a href="#L-467"><span class="linenos">467</span></a>
</span><span id="L-468"><a href="#L-468"><span class="linenos">468</span></a><span class="k">class</span> <span class="nc">Edge</span><span class="p">:</span>
</span><span id="L-469"><a href="#L-469"><span class="linenos">469</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;Class to represent edges in a tiling (not tile sides) per the definitions</span>
</span><span id="L-470"><a href="#L-470"><span class="linenos">470</span></a><span class="sd">  in Grünbaum and Shephard.</span>
</span><span id="L-471"><a href="#L-471"><span class="linenos">471</span></a><span class="sd">  &quot;&quot;&quot;</span>
</span><span id="L-472"><a href="#L-472"><span class="linenos">472</span></a>  <span class="n">ID</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span>
</span><span id="L-473"><a href="#L-473"><span class="linenos">473</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;IDs of the vertices at ends of the edge. Used as key in the containing </span>
</span><span id="L-474"><a href="#L-474"><span class="linenos">474</span></a><span class="sd">  Topology&#39;s edges dictionary.&quot;&quot;&quot;</span>
</span><span id="L-475"><a href="#L-475"><span class="linenos">475</span></a>  <span class="n">vertices</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="s2">&quot;Vertex&quot;</span><span class="p">]</span>
</span><span id="L-476"><a href="#L-476"><span class="linenos">476</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;two item list of the end vertices.&quot;&quot;&quot;</span>
</span><span id="L-477"><a href="#L-477"><span class="linenos">477</span></a>  <span class="n">corners</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="s2">&quot;Vertex&quot;</span><span class="p">]</span>
</span><span id="L-478"><a href="#L-478"><span class="linenos">478</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;list of all the vertices in the edge (including its end vertices). In a </span>
</span><span id="L-479"><a href="#L-479"><span class="linenos">479</span></a><span class="sd">  &#39;normal&#39; edge to edge tiling corners and vertices will be identical.&quot;&quot;&quot;</span>
</span><span id="L-480"><a href="#L-480"><span class="linenos">480</span></a>  <span class="n">right_tile</span><span class="p">:</span> <span class="s2">&quot;Tile&quot;</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-481"><a href="#L-481"><span class="linenos">481</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;the tile to the right of the edge traversed from its first to its last </span>
</span><span id="L-482"><a href="#L-482"><span class="linenos">482</span></a><span class="sd">  vertex. Given clockwise winding default, all edges will have a right_tile.&quot;&quot;&quot;</span>
</span><span id="L-483"><a href="#L-483"><span class="linenos">483</span></a>  <span class="n">left_tile</span><span class="p">:</span> <span class="s2">&quot;Tile&quot;</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-484"><a href="#L-484"><span class="linenos">484</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;the tile to the left of the edge traversed from its first to its last </span>
</span><span id="L-485"><a href="#L-485"><span class="linenos">485</span></a><span class="sd">  vertex. Exterior edges of the tiles in a Topology will not have a left_tile.</span>
</span><span id="L-486"><a href="#L-486"><span class="linenos">486</span></a><span class="sd">  &quot;&quot;&quot;</span>
</span><span id="L-487"><a href="#L-487"><span class="linenos">487</span></a>  <span class="n">base_ID</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1_000_000</span><span class="p">,</span> <span class="mi">1_000_000</span><span class="p">)</span>
</span><span id="L-488"><a href="#L-488"><span class="linenos">488</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;ID of corresponding edge in the base tileable&quot;&quot;&quot;</span>
</span><span id="L-489"><a href="#L-489"><span class="linenos">489</span></a>  <span class="n">transitivity_class</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-490"><a href="#L-490"><span class="linenos">490</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;transitivity class of the edge under symmetries of the tiling&quot;&quot;&quot;</span>
</span><span id="L-491"><a href="#L-491"><span class="linenos">491</span></a>  <span class="n">label</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="L-492"><a href="#L-492"><span class="linenos">492</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;the (lower case letter) label of the edge under the symmetries of the </span>
</span><span id="L-493"><a href="#L-493"><span class="linenos">493</span></a><span class="sd">  tiling.&quot;&quot;&quot;</span>
</span><span id="L-494"><a href="#L-494"><span class="linenos">494</span></a>  
</span><span id="L-495"><a href="#L-495"><span class="linenos">495</span></a>  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">corners</span><span class="p">:</span><span class="nb">list</span><span class="p">[</span><span class="n">Vertex</span><span class="p">]):</span>
</span><span id="L-496"><a href="#L-496"><span class="linenos">496</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Class constructor. Initialises the corners and vertices lists and sets ID</span>
</span><span id="L-497"><a href="#L-497"><span class="linenos">497</span></a><span class="sd">    to (vertices[0].ID, vertices[1].ID). The vertices list is all the corners</span>
</span><span id="L-498"><a href="#L-498"><span class="linenos">498</span></a><span class="sd">    with is_tiling_vertex property True -- Note that during initialisation the</span>
</span><span id="L-499"><a href="#L-499"><span class="linenos">499</span></a><span class="sd">    default of this property is True until after the relations between tiles and</span>
</span><span id="L-500"><a href="#L-500"><span class="linenos">500</span></a><span class="sd">    vertices have been determined.</span>
</span><span id="L-501"><a href="#L-501"><span class="linenos">501</span></a>
</span><span id="L-502"><a href="#L-502"><span class="linenos">502</span></a><span class="sd">    Args:</span>
</span><span id="L-503"><a href="#L-503"><span class="linenos">503</span></a><span class="sd">      corners (list[Vertex]): list of all corners along the edge.</span>
</span><span id="L-504"><a href="#L-504"><span class="linenos">504</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-505"><a href="#L-505"><span class="linenos">505</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">corners</span> <span class="o">=</span> <span class="n">corners</span>
</span><span id="L-506"><a href="#L-506"><span class="linenos">506</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">corners</span> <span class="k">if</span> <span class="n">v</span><span class="o">.</span><span class="n">is_tiling_vertex</span><span class="p">]</span>
</span><span id="L-507"><a href="#L-507"><span class="linenos">507</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">ID</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">ID</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">)</span>
</span><span id="L-508"><a href="#L-508"><span class="linenos">508</span></a>
</span><span id="L-509"><a href="#L-509"><span class="linenos">509</span></a>  <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="L-510"><a href="#L-510"><span class="linenos">510</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns a string representation of  the Edge.</span>
</span><span id="L-511"><a href="#L-511"><span class="linenos">511</span></a>
</span><span id="L-512"><a href="#L-512"><span class="linenos">512</span></a><span class="sd">    Returns:</span>
</span><span id="L-513"><a href="#L-513"><span class="linenos">513</span></a><span class="sd">        str: include ID and a list of corner vertex IDs.</span>
</span><span id="L-514"><a href="#L-514"><span class="linenos">514</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-515"><a href="#L-515"><span class="linenos">515</span></a>    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;Edge </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">ID</span><span class="si">}</span><span class="s2"> Corners: </span><span class="si">{</span><span class="p">[</span><span class="n">c</span><span class="o">.</span><span class="n">ID</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">corners</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="L-516"><a href="#L-516"><span class="linenos">516</span></a>
</span><span id="L-517"><a href="#L-517"><span class="linenos">517</span></a>  <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="L-518"><a href="#L-518"><span class="linenos">518</span></a>    <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="L-519"><a href="#L-519"><span class="linenos">519</span></a>
</span><span id="L-520"><a href="#L-520"><span class="linenos">520</span></a>  <span class="k">def</span> <span class="nf">get_corner_IDs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
</span><span id="L-521"><a href="#L-521"><span class="linenos">521</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Convenience method to get the IDs of edge corners.</span>
</span><span id="L-522"><a href="#L-522"><span class="linenos">522</span></a>
</span><span id="L-523"><a href="#L-523"><span class="linenos">523</span></a><span class="sd">    Returns:</span>
</span><span id="L-524"><a href="#L-524"><span class="linenos">524</span></a><span class="sd">        list[int]: IDs of all corners.</span>
</span><span id="L-525"><a href="#L-525"><span class="linenos">525</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-526"><a href="#L-526"><span class="linenos">526</span></a>    <span class="k">return</span> <span class="p">[</span><span class="n">c</span><span class="o">.</span><span class="n">ID</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">corners</span><span class="p">]</span>
</span><span id="L-527"><a href="#L-527"><span class="linenos">527</span></a>
</span><span id="L-528"><a href="#L-528"><span class="linenos">528</span></a>  <span class="k">def</span> <span class="nf">get_vertex_IDs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
</span><span id="L-529"><a href="#L-529"><span class="linenos">529</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Convenience method to get IDs of edge vertices.</span>
</span><span id="L-530"><a href="#L-530"><span class="linenos">530</span></a>
</span><span id="L-531"><a href="#L-531"><span class="linenos">531</span></a><span class="sd">    Returns:</span>
</span><span id="L-532"><a href="#L-532"><span class="linenos">532</span></a><span class="sd">        list[int]: list of IDs of the vertices.</span>
</span><span id="L-533"><a href="#L-533"><span class="linenos">533</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-534"><a href="#L-534"><span class="linenos">534</span></a>    <span class="k">return</span> <span class="p">[</span><span class="n">v</span><span class="o">.</span><span class="n">ID</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">]</span>
</span><span id="L-535"><a href="#L-535"><span class="linenos">535</span></a>
</span><span id="L-536"><a href="#L-536"><span class="linenos">536</span></a>  <span class="k">def</span> <span class="nf">insert_vertex</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">v</span><span class="p">:</span><span class="s2">&quot;Vertex&quot;</span><span class="p">,</span> <span class="n">predecessor</span><span class="p">:</span><span class="s2">&quot;Vertex&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="s2">&quot;Edge&quot;</span><span class="p">]:</span>
</span><span id="L-537"><a href="#L-537"><span class="linenos">537</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Inserts a vertex along this edge after the specified predecessor </span>
</span><span id="L-538"><a href="#L-538"><span class="linenos">538</span></a><span class="sd">    Vertex and returns this edge modified and a new edge. </span>
</span><span id="L-539"><a href="#L-539"><span class="linenos">539</span></a><span class="sd">    </span>
</span><span id="L-540"><a href="#L-540"><span class="linenos">540</span></a><span class="sd">    If the initial edge was (say) (0 1 2 5) and the predecessor was set to 1 </span>
</span><span id="L-541"><a href="#L-541"><span class="linenos">541</span></a><span class="sd">    the returned edges would be (0 1 v) and (v 2 5).</span>
</span><span id="L-542"><a href="#L-542"><span class="linenos">542</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-543"><a href="#L-543"><span class="linenos">543</span></a>    <span class="n">i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">corners</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">predecessor</span><span class="p">)</span>
</span><span id="L-544"><a href="#L-544"><span class="linenos">544</span></a>    <span class="n">new_edge</span> <span class="o">=</span> <span class="n">Edge</span><span class="p">([</span><span class="n">v</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">corners</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">):])</span>
</span><span id="L-545"><a href="#L-545"><span class="linenos">545</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">right_tile</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-546"><a href="#L-546"><span class="linenos">546</span></a>      <span class="n">new_edge</span><span class="o">.</span><span class="n">right_tile</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">right_tile</span>
</span><span id="L-547"><a href="#L-547"><span class="linenos">547</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">left_tile</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-548"><a href="#L-548"><span class="linenos">548</span></a>      <span class="n">new_edge</span><span class="o">.</span><span class="n">left_tile</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">left_tile</span>
</span><span id="L-549"><a href="#L-549"><span class="linenos">549</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">corners</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">corners</span><span class="p">[:(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)]</span> <span class="o">+</span> <span class="p">[</span><span class="n">v</span><span class="p">]</span>
</span><span id="L-550"><a href="#L-550"><span class="linenos">550</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">v</span><span class="p">]</span>
</span><span id="L-551"><a href="#L-551"><span class="linenos">551</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">ID</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">ID</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">)</span>
</span><span id="L-552"><a href="#L-552"><span class="linenos">552</span></a>    <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_edge</span><span class="p">]</span>
</span><span id="L-553"><a href="#L-553"><span class="linenos">553</span></a>
</span><span id="L-554"><a href="#L-554"><span class="linenos">554</span></a>  <span class="k">def</span> <span class="nf">get_geometry</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">forward</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">geom</span><span class="o">.</span><span class="n">LineString</span><span class="p">:</span>
</span><span id="L-555"><a href="#L-555"><span class="linenos">555</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns a geom.LineString representing the geometry (including all</span>
</span><span id="L-556"><a href="#L-556"><span class="linenos">556</span></a><span class="sd">    corners) of this Edge, optionally starting at either end.</span>
</span><span id="L-557"><a href="#L-557"><span class="linenos">557</span></a>
</span><span id="L-558"><a href="#L-558"><span class="linenos">558</span></a><span class="sd">    Args:</span>
</span><span id="L-559"><a href="#L-559"><span class="linenos">559</span></a><span class="sd">      forward (bool, optional): if True the returned LineString starts at</span>
</span><span id="L-560"><a href="#L-560"><span class="linenos">560</span></a><span class="sd">        corners[0], else at corners[-1]. Defaults to True.</span>
</span><span id="L-561"><a href="#L-561"><span class="linenos">561</span></a>
</span><span id="L-562"><a href="#L-562"><span class="linenos">562</span></a><span class="sd">    Returns:</span>
</span><span id="L-563"><a href="#L-563"><span class="linenos">563</span></a><span class="sd">      geom.LineString: the required LineString.</span>
</span><span id="L-564"><a href="#L-564"><span class="linenos">564</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-565"><a href="#L-565"><span class="linenos">565</span></a>    <span class="k">if</span> <span class="n">forward</span><span class="p">:</span>
</span><span id="L-566"><a href="#L-566"><span class="linenos">566</span></a>      <span class="k">return</span> <span class="n">geom</span><span class="o">.</span><span class="n">LineString</span><span class="p">([</span><span class="n">v</span><span class="o">.</span><span class="n">point</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">corners</span><span class="p">])</span>
</span><span id="L-567"><a href="#L-567"><span class="linenos">567</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="L-568"><a href="#L-568"><span class="linenos">568</span></a>      <span class="k">return</span> <span class="n">geom</span><span class="o">.</span><span class="n">LineString</span><span class="p">([</span><span class="n">v</span><span class="o">.</span><span class="n">point</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">corners</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]])</span>
</span><span id="L-569"><a href="#L-569"><span class="linenos">569</span></a>
</span><span id="L-570"><a href="#L-570"><span class="linenos">570</span></a>  <span class="k">def</span> <span class="nf">get_topology</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">forward</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">geom</span><span class="o">.</span><span class="n">LineString</span><span class="p">:</span>
</span><span id="L-571"><a href="#L-571"><span class="linenos">571</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns a LineString connecting the first and last corners (i.e. the</span>
</span><span id="L-572"><a href="#L-572"><span class="linenos">572</span></a><span class="sd">    vertices) of this tilin edge, optionally starting from either end.</span>
</span><span id="L-573"><a href="#L-573"><span class="linenos">573</span></a>
</span><span id="L-574"><a href="#L-574"><span class="linenos">574</span></a><span class="sd">    Args:</span>
</span><span id="L-575"><a href="#L-575"><span class="linenos">575</span></a><span class="sd">      forward (bool, optional): if True LineString starts at vertices[0], </span>
</span><span id="L-576"><a href="#L-576"><span class="linenos">576</span></a><span class="sd">        else at vertices[1]. Defaults to True.</span>
</span><span id="L-577"><a href="#L-577"><span class="linenos">577</span></a>
</span><span id="L-578"><a href="#L-578"><span class="linenos">578</span></a><span class="sd">    Returns:</span>
</span><span id="L-579"><a href="#L-579"><span class="linenos">579</span></a><span class="sd">        geom.LineString: the required LineString.</span>
</span><span id="L-580"><a href="#L-580"><span class="linenos">580</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-581"><a href="#L-581"><span class="linenos">581</span></a>    <span class="k">if</span> <span class="n">forward</span><span class="p">:</span>
</span><span id="L-582"><a href="#L-582"><span class="linenos">582</span></a>      <span class="k">return</span> <span class="n">geom</span><span class="o">.</span><span class="n">LineString</span><span class="p">([</span><span class="n">v</span><span class="o">.</span><span class="n">point</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">])</span>
</span><span id="L-583"><a href="#L-583"><span class="linenos">583</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="L-584"><a href="#L-584"><span class="linenos">584</span></a>      <span class="k">return</span> <span class="n">geom</span><span class="o">.</span><span class="n">LineString</span><span class="p">([</span><span class="n">v</span><span class="o">.</span><span class="n">point</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]])</span>
</span></pre></div>


            </section>
                <section id="Tile">
                            <input id="Tile-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">Tile</span>:

                <label class="view-source-button" for="Tile-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Tile"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Tile-8"><a href="#Tile-8"><span class="linenos">  8</span></a><span class="k">class</span> <span class="nc">Tile</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
</span><span id="Tile-9"><a href="#Tile-9"><span class="linenos">  9</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;Class to capture and manipulate essential features of polygons in a tiling.</span>
</span><span id="Tile-10"><a href="#Tile-10"><span class="linenos"> 10</span></a><span class="sd">  &quot;&quot;&quot;</span>
</span><span id="Tile-11"><a href="#Tile-11"><span class="linenos"> 11</span></a>  <span class="n">ID</span><span class="p">:</span> <span class="nb">int</span>
</span><span id="Tile-12"><a href="#Tile-12"><span class="linenos"> 12</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;integer ID number which indexes the Tile in the containing Topology tiles </span>
</span><span id="Tile-13"><a href="#Tile-13"><span class="linenos"> 13</span></a><span class="sd">  list.&quot;&quot;&quot;</span>
</span><span id="Tile-14"><a href="#Tile-14"><span class="linenos"> 14</span></a>  <span class="n">base_ID</span><span class="p">:</span> <span class="nb">int</span>
</span><span id="Tile-15"><a href="#Tile-15"><span class="linenos"> 15</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;ID of corresponding Tile in the base tileable unit&quot;&quot;&quot;</span>
</span><span id="Tile-16"><a href="#Tile-16"><span class="linenos"> 16</span></a>  <span class="n">corners</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="s2">&quot;Vertex&quot;</span><span class="p">]</span>
</span><span id="Tile-17"><a href="#Tile-17"><span class="linenos"> 17</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;list of Vertex objects. This includes all corners of the original polygon </span>
</span><span id="Tile-18"><a href="#Tile-18"><span class="linenos"> 18</span></a><span class="sd">  and any tiling vertices induced by (for example) a the corner of an adjacent </span>
</span><span id="Tile-19"><a href="#Tile-19"><span class="linenos"> 19</span></a><span class="sd">  tile lying halfway along an edge of the original polygon on which this tile </span>
</span><span id="Tile-20"><a href="#Tile-20"><span class="linenos"> 20</span></a><span class="sd">  is based. Vertex objects are stored in strictly clockwise sequence.&quot;&quot;&quot;</span>
</span><span id="Tile-21"><a href="#Tile-21"><span class="linenos"> 21</span></a>  <span class="n">edges</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="s2">&quot;Edge&quot;</span><span class="p">]</span>
</span><span id="Tile-22"><a href="#Tile-22"><span class="linenos"> 22</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;list of Edge objects that together compose the tile boundary.&quot;&quot;&quot;</span>
</span><span id="Tile-23"><a href="#Tile-23"><span class="linenos"> 23</span></a>  <span class="n">edges_CW</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span>
</span><span id="Tile-24"><a href="#Tile-24"><span class="linenos"> 24</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;list of Edge direction. Edges are stored only once in a Topology so some </span>
</span><span id="Tile-25"><a href="#Tile-25"><span class="linenos"> 25</span></a><span class="sd">  edges are in clockwise order and others  are in counter-clockwise order. </span>
</span><span id="Tile-26"><a href="#Tile-26"><span class="linenos"> 26</span></a><span class="sd">  These boolean flags are True if the corresponding Edge is clockwise, False if </span>
</span><span id="Tile-27"><a href="#Tile-27"><span class="linenos"> 27</span></a><span class="sd">  counter-clockwise.&quot;&quot;&quot;</span>
</span><span id="Tile-28"><a href="#Tile-28"><span class="linenos"> 28</span></a>  <span class="n">label</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="Tile-29"><a href="#Tile-29"><span class="linenos"> 29</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;tile_id label from the tileable source&quot;&quot;&quot;</span>
</span><span id="Tile-30"><a href="#Tile-30"><span class="linenos"> 30</span></a>  <span class="n">vertex_labels</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
</span><span id="Tile-31"><a href="#Tile-31"><span class="linenos"> 31</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;list of (upper case) letter labels of the tile corners (i.e. all corners, </span>
</span><span id="Tile-32"><a href="#Tile-32"><span class="linenos"> 32</span></a><span class="sd">  not only tiling vertices).&quot;&quot;&quot;</span>
</span><span id="Tile-33"><a href="#Tile-33"><span class="linenos"> 33</span></a>  <span class="n">edge_labels</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
</span><span id="Tile-34"><a href="#Tile-34"><span class="linenos"> 34</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;list of (lower case) letter labels of the tile edges (tiling edges, not </span>
</span><span id="Tile-35"><a href="#Tile-35"><span class="linenos"> 35</span></a><span class="sd">  tile sides).&quot;&quot;&quot;</span>
</span><span id="Tile-36"><a href="#Tile-36"><span class="linenos"> 36</span></a>  <span class="n">shape</span><span class="p">:</span> <span class="n">geom</span><span class="o">.</span><span class="n">Polygon</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Tile-37"><a href="#Tile-37"><span class="linenos"> 37</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;the tile geometry (which may include some redundant points along sides </span>
</span><span id="Tile-38"><a href="#Tile-38"><span class="linenos"> 38</span></a><span class="sd">  where neighbouring tiles induce a tiling vertex). So for example a rectangle </span>
</span><span id="Tile-39"><a href="#Tile-39"><span class="linenos"> 39</span></a><span class="sd">  might have additional points along its sides:</span>
</span><span id="Tile-40"><a href="#Tile-40"><span class="linenos"> 40</span></a><span class="sd">      </span>
</span><span id="Tile-41"><a href="#Tile-41"><span class="linenos"> 41</span></a><span class="sd">        +---+-------+</span>
</span><span id="Tile-42"><a href="#Tile-42"><span class="linenos"> 42</span></a><span class="sd">        |   |   2   |</span>
</span><span id="Tile-43"><a href="#Tile-43"><span class="linenos"> 43</span></a><span class="sd">        | 1 A---B---E---+</span>
</span><span id="Tile-44"><a href="#Tile-44"><span class="linenos"> 44</span></a><span class="sd">        |   |   |   4   |</span>
</span><span id="Tile-45"><a href="#Tile-45"><span class="linenos"> 45</span></a><span class="sd">        +---C 3 D-------+</span>
</span><span id="Tile-46"><a href="#Tile-46"><span class="linenos"> 46</span></a><span class="sd">            |   |</span>
</span><span id="Tile-47"><a href="#Tile-47"><span class="linenos"> 47</span></a><span class="sd">            +---+</span>
</span><span id="Tile-48"><a href="#Tile-48"><span class="linenos"> 48</span></a><span class="sd">      </span>
</span><span id="Tile-49"><a href="#Tile-49"><span class="linenos"> 49</span></a><span class="sd">  In the above Tile 1 has additional point A, 2 has B and 3 has C and D induced </span>
</span><span id="Tile-50"><a href="#Tile-50"><span class="linenos"> 50</span></a><span class="sd">  by the corners of neighbouring tiles.&quot;&quot;&quot;</span>
</span><span id="Tile-51"><a href="#Tile-51"><span class="linenos"> 51</span></a>  <span class="n">centre</span><span class="p">:</span> <span class="n">geom</span><span class="o">.</span><span class="n">Point</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Tile-52"><a href="#Tile-52"><span class="linenos"> 52</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;a point centre for the Tile (determined by weavingspace.tiling_utils.</span>
</span><span id="Tile-53"><a href="#Tile-53"><span class="linenos"> 53</span></a><span class="sd">  incentre).&quot;&quot;&quot;</span>
</span><span id="Tile-54"><a href="#Tile-54"><span class="linenos"> 54</span></a>  <span class="n">shape_group</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Tile-55"><a href="#Tile-55"><span class="linenos"> 55</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;the tile shape group of this tile in its containing Topology.&quot;&quot;&quot;</span>
</span><span id="Tile-56"><a href="#Tile-56"><span class="linenos"> 56</span></a>  <span class="n">transitivity_class</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Tile-57"><a href="#Tile-57"><span class="linenos"> 57</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;the tile transitivity class of this tile its containing Topology&quot;&quot;&quot;</span>
</span><span id="Tile-58"><a href="#Tile-58"><span class="linenos"> 58</span></a>  
</span><span id="Tile-59"><a href="#Tile-59"><span class="linenos"> 59</span></a>  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ID</span><span class="p">:</span><span class="nb">int</span><span class="p">):</span>
</span><span id="Tile-60"><a href="#Tile-60"><span class="linenos"> 60</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Class constructor.</span>
</span><span id="Tile-61"><a href="#Tile-61"><span class="linenos"> 61</span></a>
</span><span id="Tile-62"><a href="#Tile-62"><span class="linenos"> 62</span></a><span class="sd">    Args:</span>
</span><span id="Tile-63"><a href="#Tile-63"><span class="linenos"> 63</span></a><span class="sd">      ID (int): Tile ID which indexes it in the containing Topology tiles list.</span>
</span><span id="Tile-64"><a href="#Tile-64"><span class="linenos"> 64</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Tile-65"><a href="#Tile-65"><span class="linenos"> 65</span></a>    <span class="c1"># self.set_shape(tiling_utils.get_clean_polygon(shape))</span>
</span><span id="Tile-66"><a href="#Tile-66"><span class="linenos"> 66</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">ID</span> <span class="o">=</span> <span class="n">ID</span>
</span><span id="Tile-67"><a href="#Tile-67"><span class="linenos"> 67</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">corners</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Tile-68"><a href="#Tile-68"><span class="linenos"> 68</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">edges</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Tile-69"><a href="#Tile-69"><span class="linenos"> 69</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">edges_CW</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Tile-70"><a href="#Tile-70"><span class="linenos"> 70</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">vertex_labels</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Tile-71"><a href="#Tile-71"><span class="linenos"> 71</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">edge_labels</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Tile-72"><a href="#Tile-72"><span class="linenos"> 72</span></a>
</span><span id="Tile-73"><a href="#Tile-73"><span class="linenos"> 73</span></a>  <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="Tile-74"><a href="#Tile-74"><span class="linenos"> 74</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns string representation of the Tile.</span>
</span><span id="Tile-75"><a href="#Tile-75"><span class="linenos"> 75</span></a>
</span><span id="Tile-76"><a href="#Tile-76"><span class="linenos"> 76</span></a><span class="sd">    Returns:</span>
</span><span id="Tile-77"><a href="#Tile-77"><span class="linenos"> 77</span></a><span class="sd">      str: string including Tile ID, list of corner vertex IDs and list of</span>
</span><span id="Tile-78"><a href="#Tile-78"><span class="linenos"> 78</span></a><span class="sd">        edge IDs.</span>
</span><span id="Tile-79"><a href="#Tile-79"><span class="linenos"> 79</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Tile-80"><a href="#Tile-80"><span class="linenos"> 80</span></a>    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;Tile </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">ID</span><span class="si">}</span><span class="s2"> Corners: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">get_corner_IDs</span><span class="p">()</span><span class="si">}</span><span class="s2"> Edges: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">get_edge_IDs</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="Tile-81"><a href="#Tile-81"><span class="linenos"> 81</span></a>  
</span><span id="Tile-82"><a href="#Tile-82"><span class="linenos"> 82</span></a>  <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="Tile-83"><a href="#Tile-83"><span class="linenos"> 83</span></a>    <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="Tile-84"><a href="#Tile-84"><span class="linenos"> 84</span></a>
</span><span id="Tile-85"><a href="#Tile-85"><span class="linenos"> 85</span></a>  <span class="k">def</span> <span class="nf">get_corner_IDs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
</span><span id="Tile-86"><a href="#Tile-86"><span class="linenos"> 86</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Convenience method to return list of corner IDs (not Vertex objects).</span>
</span><span id="Tile-87"><a href="#Tile-87"><span class="linenos"> 87</span></a>
</span><span id="Tile-88"><a href="#Tile-88"><span class="linenos"> 88</span></a><span class="sd">    Returns:</span>
</span><span id="Tile-89"><a href="#Tile-89"><span class="linenos"> 89</span></a><span class="sd">      list[int]: list of integer IDs of tile corners.</span>
</span><span id="Tile-90"><a href="#Tile-90"><span class="linenos"> 90</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Tile-91"><a href="#Tile-91"><span class="linenos"> 91</span></a>    <span class="k">return</span> <span class="p">[</span><span class="n">c</span><span class="o">.</span><span class="n">ID</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">corners</span><span class="p">]</span>
</span><span id="Tile-92"><a href="#Tile-92"><span class="linenos"> 92</span></a>
</span><span id="Tile-93"><a href="#Tile-93"><span class="linenos"> 93</span></a>  <span class="k">def</span> <span class="nf">get_edge_IDs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">]]:</span>
</span><span id="Tile-94"><a href="#Tile-94"><span class="linenos"> 94</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Convenience method to return list of edge IDs (not Edge objects).</span>
</span><span id="Tile-95"><a href="#Tile-95"><span class="linenos"> 95</span></a>
</span><span id="Tile-96"><a href="#Tile-96"><span class="linenos"> 96</span></a><span class="sd">    Returns:</span>
</span><span id="Tile-97"><a href="#Tile-97"><span class="linenos"> 97</span></a><span class="sd">      list[tuple[int]]: list of 2-element tuples of the start and end Vertex IDs</span>
</span><span id="Tile-98"><a href="#Tile-98"><span class="linenos"> 98</span></a><span class="sd">        of each edge.</span>
</span><span id="Tile-99"><a href="#Tile-99"><span class="linenos"> 99</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Tile-100"><a href="#Tile-100"><span class="linenos">100</span></a>    <span class="k">return</span> <span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">ID</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">]</span>
</span><span id="Tile-101"><a href="#Tile-101"><span class="linenos">101</span></a>
</span><span id="Tile-102"><a href="#Tile-102"><span class="linenos">102</span></a>  <span class="k">def</span> <span class="nf">set_shape_from_corners</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Tile-103"><a href="#Tile-103"><span class="linenos">103</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Sets the shape attribute based on the current list of corners, and sets </span>
</span><span id="Tile-104"><a href="#Tile-104"><span class="linenos">104</span></a><span class="sd">    the associated tile centre.</span>
</span><span id="Tile-105"><a href="#Tile-105"><span class="linenos">105</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Tile-106"><a href="#Tile-106"><span class="linenos">106</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">shape</span> <span class="o">=</span> <span class="n">geom</span><span class="o">.</span><span class="n">Polygon</span><span class="p">([</span><span class="n">c</span><span class="o">.</span><span class="n">point</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">corners</span><span class="p">])</span>
</span><span id="Tile-107"><a href="#Tile-107"><span class="linenos">107</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">centre</span> <span class="o">=</span> <span class="n">tiling_utils</span><span class="o">.</span><span class="n">incentre</span><span class="p">(</span>
</span><span id="Tile-108"><a href="#Tile-108"><span class="linenos">108</span></a>      <span class="n">tiling_utils</span><span class="o">.</span><span class="n">get_clean_polygon</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
</span><span id="Tile-109"><a href="#Tile-109"><span class="linenos">109</span></a>
</span><span id="Tile-110"><a href="#Tile-110"><span class="linenos">110</span></a>  <span class="k">def</span> <span class="nf">set_corners_from_edges</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">update_shape</span><span class="p">:</span><span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">):</span>
</span><span id="Tile-111"><a href="#Tile-111"><span class="linenos">111</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Sets the corners attribute from the edges attribute. Typically called </span>
</span><span id="Tile-112"><a href="#Tile-112"><span class="linenos">112</span></a><span class="sd">    after modification of topology edges. Optionally the shape attribute is NOT</span>
</span><span id="Tile-113"><a href="#Tile-113"><span class="linenos">113</span></a><span class="sd">    updated, which may save time when multiple changes to the edges of a tile</span>
</span><span id="Tile-114"><a href="#Tile-114"><span class="linenos">114</span></a><span class="sd">    are in process (i.e., only update the shape after all changes are complete).</span>
</span><span id="Tile-115"><a href="#Tile-115"><span class="linenos">115</span></a>
</span><span id="Tile-116"><a href="#Tile-116"><span class="linenos">116</span></a><span class="sd">    Args:</span>
</span><span id="Tile-117"><a href="#Tile-117"><span class="linenos">117</span></a><span class="sd">      update_shape (bool, optional): if True the shape attribute will be </span>
</span><span id="Tile-118"><a href="#Tile-118"><span class="linenos">118</span></a><span class="sd">        updated, otherwise not. Defaults to True.</span>
</span><span id="Tile-119"><a href="#Tile-119"><span class="linenos">119</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Tile-120"><a href="#Tile-120"><span class="linenos">120</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">corners</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Tile-121"><a href="#Tile-121"><span class="linenos">121</span></a>    <span class="k">for</span> <span class="n">e</span><span class="p">,</span> <span class="n">cw</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges_CW</span><span class="p">):</span>
</span><span id="Tile-122"><a href="#Tile-122"><span class="linenos">122</span></a>      <span class="k">if</span> <span class="n">cw</span><span class="p">:</span> <span class="c1"># clockwise to extend by all but the first corner</span>
</span><span id="Tile-123"><a href="#Tile-123"><span class="linenos">123</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">corners</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">corners</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</span><span id="Tile-124"><a href="#Tile-124"><span class="linenos">124</span></a>      <span class="k">else</span><span class="p">:</span> <span class="c1"># counter-clockwise so extend in reverse</span>
</span><span id="Tile-125"><a href="#Tile-125"><span class="linenos">125</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">corners</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">corners</span><span class="p">[</span><span class="mi">1</span><span class="p">:][::</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</span><span id="Tile-126"><a href="#Tile-126"><span class="linenos">126</span></a>    <span class="k">if</span> <span class="n">update_shape</span><span class="p">:</span>
</span><span id="Tile-127"><a href="#Tile-127"><span class="linenos">127</span></a>      <span class="bp">self</span><span class="o">.</span><span class="n">set_shape_from_corners</span><span class="p">()</span>
</span><span id="Tile-128"><a href="#Tile-128"><span class="linenos">128</span></a>
</span><span id="Tile-129"><a href="#Tile-129"><span class="linenos">129</span></a>  <span class="k">def</span> <span class="nf">set_edge_directions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Tile-130"><a href="#Tile-130"><span class="linenos">130</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Sets up the edges_CW attribute by inspection of the edges list.</span>
</span><span id="Tile-131"><a href="#Tile-131"><span class="linenos">131</span></a><span class="sd">    It is (frankly!) hard to keep track of the correct sequence of CW/CCW order</span>
</span><span id="Tile-132"><a href="#Tile-132"><span class="linenos">132</span></a><span class="sd">    of edges as new ones are created or old ones merged. This method inspects</span>
</span><span id="Tile-133"><a href="#Tile-133"><span class="linenos">133</span></a><span class="sd">    the &#39;tail-head&#39; relations between consecutive edges to set these flags </span>
</span><span id="Tile-134"><a href="#Tile-134"><span class="linenos">134</span></a><span class="sd">    correctly.</span>
</span><span id="Tile-135"><a href="#Tile-135"><span class="linenos">135</span></a>
</span><span id="Tile-136"><a href="#Tile-136"><span class="linenos">136</span></a><span class="sd">    The test is simply to check if the &#39;tail&#39; Vertex ID in each edge appears</span>
</span><span id="Tile-137"><a href="#Tile-137"><span class="linenos">137</span></a><span class="sd">    in the ID tuple of the following edge, i.e. if successive edge </span>
</span><span id="Tile-138"><a href="#Tile-138"><span class="linenos">138</span></a><span class="sd">    IDs are (0, 1) (2, 1) or (0, 1) (1, 2), then edge (0, 1) is in clockwise</span>
</span><span id="Tile-139"><a href="#Tile-139"><span class="linenos">139</span></a><span class="sd">    direction, but if we have (0, 1) (2, 3) then it is not.</span>
</span><span id="Tile-140"><a href="#Tile-140"><span class="linenos">140</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Tile-141"><a href="#Tile-141"><span class="linenos">141</span></a>    <span class="n">edge_IDs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_edge_IDs</span><span class="p">()</span>
</span><span id="Tile-142"><a href="#Tile-142"><span class="linenos">142</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">edges_CW</span> <span class="o">=</span> <span class="p">[</span><span class="n">e1</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="n">e2</span> <span class="k">for</span> <span class="n">e1</span><span class="p">,</span> <span class="n">e2</span> <span class="ow">in</span> 
</span><span id="Tile-143"><a href="#Tile-143"><span class="linenos">143</span></a>                     <span class="nb">zip</span><span class="p">(</span><span class="n">edge_IDs</span><span class="p">,</span> <span class="n">edge_IDs</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">+</span> <span class="n">edge_IDs</span><span class="p">[:</span><span class="mi">1</span><span class="p">])]</span>
</span><span id="Tile-144"><a href="#Tile-144"><span class="linenos">144</span></a>
</span><span id="Tile-145"><a href="#Tile-145"><span class="linenos">145</span></a>  <span class="k">def</span> <span class="nf">insert_vertex_at</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">v</span><span class="p">:</span><span class="s2">&quot;Vertex&quot;</span><span class="p">,</span> <span class="n">i</span><span class="p">:</span><span class="nb">int</span><span class="p">,</span> 
</span><span id="Tile-146"><a href="#Tile-146"><span class="linenos">146</span></a>                       <span class="n">update_shape</span><span class="p">:</span><span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
</span><span id="Tile-147"><a href="#Tile-147"><span class="linenos">147</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Method to insert the supplied Vertex into tile at index position i, </span>
</span><span id="Tile-148"><a href="#Tile-148"><span class="linenos">148</span></a><span class="sd">    optionally updating the shape attribute. Both corners and edges attributes</span>
</span><span id="Tile-149"><a href="#Tile-149"><span class="linenos">149</span></a><span class="sd">    are updated, and the old edge IDs for removal and the new edge itself are</span>
</span><span id="Tile-150"><a href="#Tile-150"><span class="linenos">150</span></a><span class="sd">    returned to the calling context (the containing Topology) for update of its</span>
</span><span id="Tile-151"><a href="#Tile-151"><span class="linenos">151</span></a><span class="sd">    edges collection.</span>
</span><span id="Tile-152"><a href="#Tile-152"><span class="linenos">152</span></a>
</span><span id="Tile-153"><a href="#Tile-153"><span class="linenos">153</span></a><span class="sd">    This is NOT a generic vertex insertion method: it is only for use during </span>
</span><span id="Tile-154"><a href="#Tile-154"><span class="linenos">154</span></a><span class="sd">    Topology initialisation, and does not guarantee correct maintenance of </span>
</span><span id="Tile-155"><a href="#Tile-155"><span class="linenos">155</span></a><span class="sd">    all tile, edge and vertex relations in the general case---at any rate it</span>
</span><span id="Tile-156"><a href="#Tile-156"><span class="linenos">156</span></a><span class="sd">    has not been tested for this!</span>
</span><span id="Tile-157"><a href="#Tile-157"><span class="linenos">157</span></a>
</span><span id="Tile-158"><a href="#Tile-158"><span class="linenos">158</span></a><span class="sd">    Args:</span>
</span><span id="Tile-159"><a href="#Tile-159"><span class="linenos">159</span></a><span class="sd">        v (Vertex): the Vertex to insert.</span>
</span><span id="Tile-160"><a href="#Tile-160"><span class="linenos">160</span></a><span class="sd">        i (int): index position in current corners after which to insert </span>
</span><span id="Tile-161"><a href="#Tile-161"><span class="linenos">161</span></a><span class="sd">          supplied Vertex.</span>
</span><span id="Tile-162"><a href="#Tile-162"><span class="linenos">162</span></a><span class="sd">        update_shape (bool, optional): if True shape attribute is updated. </span>
</span><span id="Tile-163"><a href="#Tile-163"><span class="linenos">163</span></a><span class="sd">          Defaults to False.</span>
</span><span id="Tile-164"><a href="#Tile-164"><span class="linenos">164</span></a>
</span><span id="Tile-165"><a href="#Tile-165"><span class="linenos">165</span></a><span class="sd">    Returns:</span>
</span><span id="Tile-166"><a href="#Tile-166"><span class="linenos">166</span></a><span class="sd">      tuple: the (tuple) ID of the old edge which should be deleted, and </span>
</span><span id="Tile-167"><a href="#Tile-167"><span class="linenos">167</span></a><span class="sd">        the new Edges arising from insertion of this Vertex.</span>
</span><span id="Tile-168"><a href="#Tile-168"><span class="linenos">168</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Tile-169"><a href="#Tile-169"><span class="linenos">169</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">corners</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">corners</span><span class="p">[:</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">corners</span><span class="p">[</span><span class="n">i</span><span class="p">:]</span>
</span><span id="Tile-170"><a href="#Tile-170"><span class="linenos">170</span></a>    <span class="n">old_edge</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
</span><span id="Tile-171"><a href="#Tile-171"><span class="linenos">171</span></a>    <span class="c1"># store current ID of the affected edge for return to calling context</span>
</span><span id="Tile-172"><a href="#Tile-172"><span class="linenos">172</span></a>    <span class="n">old_edge_ID</span> <span class="o">=</span> <span class="n">old_edge</span><span class="o">.</span><span class="n">ID</span>
</span><span id="Tile-173"><a href="#Tile-173"><span class="linenos">173</span></a>    <span class="n">new_edges</span> <span class="o">=</span> <span class="n">old_edge</span><span class="o">.</span><span class="n">insert_vertex</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">corners</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">])</span>
</span><span id="Tile-174"><a href="#Tile-174"><span class="linenos">174</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">edges</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">[:(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)]</span> <span class="o">+</span> <span class="n">new_edges</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">i</span><span class="p">:]</span>
</span><span id="Tile-175"><a href="#Tile-175"><span class="linenos">175</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">set_edge_directions</span><span class="p">()</span>
</span><span id="Tile-176"><a href="#Tile-176"><span class="linenos">176</span></a>    <span class="k">if</span> <span class="n">update_shape</span><span class="p">:</span>
</span><span id="Tile-177"><a href="#Tile-177"><span class="linenos">177</span></a>      <span class="bp">self</span><span class="o">.</span><span class="n">set_shape_from_corners</span><span class="p">()</span>
</span><span id="Tile-178"><a href="#Tile-178"><span class="linenos">178</span></a>    <span class="k">return</span> <span class="n">old_edge_ID</span><span class="p">,</span> <span class="n">new_edges</span>
</span><span id="Tile-179"><a href="#Tile-179"><span class="linenos">179</span></a>
</span><span id="Tile-180"><a href="#Tile-180"><span class="linenos">180</span></a>  <span class="k">def</span> <span class="nf">merge_edges_at_vertex</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">v</span><span class="p">:</span><span class="s2">&quot;Vertex&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
</span><span id="Tile-181"><a href="#Tile-181"><span class="linenos">181</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Method to merge the edges that meet at the supplied Vertex. It is </span>
</span><span id="Tile-182"><a href="#Tile-182"><span class="linenos">182</span></a><span class="sd">    assumed that only two tiles are impacted this one, and its neighbour across</span>
</span><span id="Tile-183"><a href="#Tile-183"><span class="linenos">183</span></a><span class="sd">    the Edge on which v lies. Both are updated. For this reason the work is</span>
</span><span id="Tile-184"><a href="#Tile-184"><span class="linenos">184</span></a><span class="sd">    delegated to get_updated_edges_from_merge which is run on both affected</span>
</span><span id="Tile-185"><a href="#Tile-185"><span class="linenos">185</span></a><span class="sd">    tiles, but only determines the edges to remove and the new edge to be added</span>
</span><span id="Tile-186"><a href="#Tile-186"><span class="linenos">186</span></a><span class="sd">    once. See that method for details.</span>
</span><span id="Tile-187"><a href="#Tile-187"><span class="linenos">187</span></a><span class="sd">    </span>
</span><span id="Tile-188"><a href="#Tile-188"><span class="linenos">188</span></a><span class="sd">    Args:</span>
</span><span id="Tile-189"><a href="#Tile-189"><span class="linenos">189</span></a><span class="sd">      v (Vertex): Vertex at which to merge Edges. This should currently be an</span>
</span><span id="Tile-190"><a href="#Tile-190"><span class="linenos">190</span></a><span class="sd">        end</span>
</span><span id="Tile-191"><a href="#Tile-191"><span class="linenos">191</span></a><span class="sd">    </span>
</span><span id="Tile-192"><a href="#Tile-192"><span class="linenos">192</span></a><span class="sd">    Returns:</span>
</span><span id="Tile-193"><a href="#Tile-193"><span class="linenos">193</span></a><span class="sd">      tuple: 2 item list of the edge IDs to be removed and a new Edge object to</span>
</span><span id="Tile-194"><a href="#Tile-194"><span class="linenos">194</span></a><span class="sd">        be added by the calling context (i.e. the containing Topology).</span>
</span><span id="Tile-195"><a href="#Tile-195"><span class="linenos">195</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Tile-196"><a href="#Tile-196"><span class="linenos">196</span></a>    <span class="n">to_remove</span><span class="p">,</span> <span class="n">new_edge</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_updated_edges_from_merge</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
</span><span id="Tile-197"><a href="#Tile-197"><span class="linenos">197</span></a>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">tiles</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="Tile-198"><a href="#Tile-198"><span class="linenos">198</span></a>      <span class="n">v</span><span class="o">.</span><span class="n">tiles</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">get_updated_edges_from_merge</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">new_edge</span><span class="p">)</span>
</span><span id="Tile-199"><a href="#Tile-199"><span class="linenos">199</span></a>    <span class="k">return</span> <span class="n">to_remove</span><span class="p">,</span> <span class="n">new_edge</span>
</span><span id="Tile-200"><a href="#Tile-200"><span class="linenos">200</span></a>
</span><span id="Tile-201"><a href="#Tile-201"><span class="linenos">201</span></a>  <span class="k">def</span> <span class="nf">get_updated_edges_from_merge</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">v</span><span class="p">:</span><span class="s2">&quot;Vertex&quot;</span><span class="p">,</span> <span class="n">new_edge</span><span class="p">:</span><span class="s2">&quot;Edge&quot;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
</span><span id="Tile-202"><a href="#Tile-202"><span class="linenos">202</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Updates the edges and edges_CW attributes based on insertion of </span>
</span><span id="Tile-203"><a href="#Tile-203"><span class="linenos">203</span></a><span class="sd">    the supplied Vertex. If new_edge is supplied then the neighbour tile at</span>
</span><span id="Tile-204"><a href="#Tile-204"><span class="linenos">204</span></a><span class="sd">    v has already created the needed new Edge and this Edge is the one that</span>
</span><span id="Tile-205"><a href="#Tile-205"><span class="linenos">205</span></a><span class="sd">    will be &#39;slotted in&#39; at the appropriate spot in the edges list.</span>
</span><span id="Tile-206"><a href="#Tile-206"><span class="linenos">206</span></a>
</span><span id="Tile-207"><a href="#Tile-207"><span class="linenos">207</span></a><span class="sd">    The edges_CW is also updated to maintain correct directions of the edges.</span>
</span><span id="Tile-208"><a href="#Tile-208"><span class="linenos">208</span></a><span class="sd">    The corners attribute is unaffected by these changes.</span>
</span><span id="Tile-209"><a href="#Tile-209"><span class="linenos">209</span></a>
</span><span id="Tile-210"><a href="#Tile-210"><span class="linenos">210</span></a><span class="sd">    Args:</span>
</span><span id="Tile-211"><a href="#Tile-211"><span class="linenos">211</span></a><span class="sd">      v (Vertex): existing Vertex at which to carry out the merge.</span>
</span><span id="Tile-212"><a href="#Tile-212"><span class="linenos">212</span></a><span class="sd">      new_edge (Edge, optional): if another Tile has already carried out this </span>
</span><span id="Tile-213"><a href="#Tile-213"><span class="linenos">213</span></a><span class="sd">        merge this should be the resulting new Edge for insertion into this </span>
</span><span id="Tile-214"><a href="#Tile-214"><span class="linenos">214</span></a><span class="sd">        Tile. Defaults to None (when the new Edge will be constructed).</span>
</span><span id="Tile-215"><a href="#Tile-215"><span class="linenos">215</span></a><span class="sd">  </span>
</span><span id="Tile-216"><a href="#Tile-216"><span class="linenos">216</span></a><span class="sd">    Returns:</span>
</span><span id="Tile-217"><a href="#Tile-217"><span class="linenos">217</span></a><span class="sd">      Union[None, tuple]: either None (if a new edge was supplied) or a tuple </span>
</span><span id="Tile-218"><a href="#Tile-218"><span class="linenos">218</span></a><span class="sd">        of the two edge IDs to be removed and the new edge added for return to</span>
</span><span id="Tile-219"><a href="#Tile-219"><span class="linenos">219</span></a><span class="sd">        the calling context (i.e. the containing Topology).</span>
</span><span id="Tile-220"><a href="#Tile-220"><span class="linenos">220</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Tile-221"><a href="#Tile-221"><span class="linenos">221</span></a>    <span class="c1"># get the two edge list index positions in which Vertex v is found</span>
</span><span id="Tile-222"><a href="#Tile-222"><span class="linenos">222</span></a>    <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_edge_IDs_including_vertex</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
</span><span id="Tile-223"><a href="#Tile-223"><span class="linenos">223</span></a>    <span class="k">if</span> <span class="n">new_edge</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="c1"># then we must make a new one</span>
</span><span id="Tile-224"><a href="#Tile-224"><span class="linenos">224</span></a>      <span class="c1"># also record existing edge IDs to be removed</span>
</span><span id="Tile-225"><a href="#Tile-225"><span class="linenos">225</span></a>      <span class="n">to_remove</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">ID</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">ID</span><span class="p">]</span>
</span><span id="Tile-226"><a href="#Tile-226"><span class="linenos">226</span></a>      <span class="n">new_edge</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_merged_edge</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span>
</span><span id="Tile-227"><a href="#Tile-227"><span class="linenos">227</span></a>      <span class="n">return_edge_updates</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="Tile-228"><a href="#Tile-228"><span class="linenos">228</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="Tile-229"><a href="#Tile-229"><span class="linenos">229</span></a>      <span class="n">return_edge_updates</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="Tile-230"><a href="#Tile-230"><span class="linenos">230</span></a>    <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">i</span> <span class="o">-</span> <span class="n">j</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="Tile-231"><a href="#Tile-231"><span class="linenos">231</span></a>      <span class="c1"># edge indices &#39;wrap&#39; around from end of edge list to start so drop </span>
</span><span id="Tile-232"><a href="#Tile-232"><span class="linenos">232</span></a>      <span class="c1"># first and last current edges and stick new one on at the end</span>
</span><span id="Tile-233"><a href="#Tile-233"><span class="linenos">233</span></a>      <span class="bp">self</span><span class="o">.</span><span class="n">edges</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="n">new_edge</span><span class="p">]</span> 
</span><span id="Tile-234"><a href="#Tile-234"><span class="linenos">234</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="Tile-235"><a href="#Tile-235"><span class="linenos">235</span></a>      <span class="c1"># insert new edge into list in place of the two old ones</span>
</span><span id="Tile-236"><a href="#Tile-236"><span class="linenos">236</span></a>      <span class="bp">self</span><span class="o">.</span><span class="n">edges</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">[:</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="n">new_edge</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">:]</span>
</span><span id="Tile-237"><a href="#Tile-237"><span class="linenos">237</span></a>    <span class="c1"># update the edge directions</span>
</span><span id="Tile-238"><a href="#Tile-238"><span class="linenos">238</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">set_edge_directions</span><span class="p">()</span>
</span><span id="Tile-239"><a href="#Tile-239"><span class="linenos">239</span></a>    <span class="k">if</span> <span class="n">return_edge_updates</span><span class="p">:</span>
</span><span id="Tile-240"><a href="#Tile-240"><span class="linenos">240</span></a>      <span class="k">return</span> <span class="n">to_remove</span><span class="p">,</span> <span class="n">new_edge</span>
</span><span id="Tile-241"><a href="#Tile-241"><span class="linenos">241</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="Tile-242"><a href="#Tile-242"><span class="linenos">242</span></a>      <span class="k">return</span> <span class="kc">None</span>
</span><span id="Tile-243"><a href="#Tile-243"><span class="linenos">243</span></a>
</span><span id="Tile-244"><a href="#Tile-244"><span class="linenos">244</span></a>  <span class="k">def</span> <span class="nf">get_edge_IDs_including_vertex</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">v</span><span class="p">:</span><span class="s2">&quot;Vertex&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
</span><span id="Tile-245"><a href="#Tile-245"><span class="linenos">245</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Gets the (two) index positions of the edges that include supplied Vertex.</span>
</span><span id="Tile-246"><a href="#Tile-246"><span class="linenos">246</span></a>
</span><span id="Tile-247"><a href="#Tile-247"><span class="linenos">247</span></a><span class="sd">    Args:</span>
</span><span id="Tile-248"><a href="#Tile-248"><span class="linenos">248</span></a><span class="sd">        v (Vertex): Vertex of interest.</span>
</span><span id="Tile-249"><a href="#Tile-249"><span class="linenos">249</span></a>
</span><span id="Tile-250"><a href="#Tile-250"><span class="linenos">250</span></a><span class="sd">    Returns:</span>
</span><span id="Tile-251"><a href="#Tile-251"><span class="linenos">251</span></a><span class="sd">      tuple[int]: two index positions of Edges in edges list that contain v.</span>
</span><span id="Tile-252"><a href="#Tile-252"><span class="linenos">252</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Tile-253"><a href="#Tile-253"><span class="linenos">253</span></a>    <span class="k">return</span> <span class="p">(</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">e</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">)</span> <span class="k">if</span> <span class="n">v</span><span class="o">.</span><span class="n">ID</span> <span class="ow">in</span> <span class="n">e</span><span class="o">.</span><span class="n">ID</span><span class="p">)</span>
</span><span id="Tile-254"><a href="#Tile-254"><span class="linenos">254</span></a>
</span><span id="Tile-255"><a href="#Tile-255"><span class="linenos">255</span></a>  <span class="k">def</span> <span class="nf">get_merged_edge</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">:</span><span class="nb">int</span><span class="p">,</span> <span class="n">j</span><span class="p">:</span><span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Edge&quot;</span><span class="p">:</span>
</span><span id="Tile-256"><a href="#Tile-256"><span class="linenos">256</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns the new edge resulting from merging the two existing edges at</span>
</span><span id="Tile-257"><a href="#Tile-257"><span class="linenos">257</span></a><span class="sd">    index positions i and j in the edges list. For example, if the current list </span>
</span><span id="Tile-258"><a href="#Tile-258"><span class="linenos">258</span></a><span class="sd">    of edge IDs was</span>
</span><span id="Tile-259"><a href="#Tile-259"><span class="linenos">259</span></a>
</span><span id="Tile-260"><a href="#Tile-260"><span class="linenos">260</span></a><span class="sd">        (0 1 2) (4 2) (4 5) (5 0)</span>
</span><span id="Tile-261"><a href="#Tile-261"><span class="linenos">261</span></a>
</span><span id="Tile-262"><a href="#Tile-262"><span class="linenos">262</span></a><span class="sd">    and the merge Vertex was #2, the resulting new edge is constructed from </span>
</span><span id="Tile-263"><a href="#Tile-263"><span class="linenos">263</span></a><span class="sd">    vertices (0 1 2 4). </span>
</span><span id="Tile-264"><a href="#Tile-264"><span class="linenos">264</span></a>
</span><span id="Tile-265"><a href="#Tile-265"><span class="linenos">265</span></a><span class="sd">    Returns:</span>
</span><span id="Tile-266"><a href="#Tile-266"><span class="linenos">266</span></a><span class="sd">      Edge: the requested new Edge.</span>
</span><span id="Tile-267"><a href="#Tile-267"><span class="linenos">267</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Tile-268"><a href="#Tile-268"><span class="linenos">268</span></a>    <span class="c1"># if i and j are not consecutive, then j is predecessor edge</span>
</span><span id="Tile-269"><a href="#Tile-269"><span class="linenos">269</span></a>    <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">i</span> <span class="o">-</span> <span class="n">j</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="Tile-270"><a href="#Tile-270"><span class="linenos">270</span></a>      <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="n">j</span><span class="p">,</span> <span class="n">i</span>
</span><span id="Tile-271"><a href="#Tile-271"><span class="linenos">271</span></a>    <span class="c1"># get edges and their directions</span>
</span><span id="Tile-272"><a href="#Tile-272"><span class="linenos">272</span></a>    <span class="n">ei</span><span class="p">,</span> <span class="n">ej</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
</span><span id="Tile-273"><a href="#Tile-273"><span class="linenos">273</span></a>    <span class="n">CWi</span><span class="p">,</span> <span class="n">CWj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges_CW</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges_CW</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
</span><span id="Tile-274"><a href="#Tile-274"><span class="linenos">274</span></a>    <span class="c1"># DON&#39;T MESS WITH THIS!!!</span>
</span><span id="Tile-275"><a href="#Tile-275"><span class="linenos">275</span></a>    <span class="c1"># for predecessors (the head) we want everything including the Vertex </span>
</span><span id="Tile-276"><a href="#Tile-276"><span class="linenos">276</span></a>    <span class="c1"># where the merge is occurring; for successors (the tail) we want all but </span>
</span><span id="Tile-277"><a href="#Tile-277"><span class="linenos">277</span></a>    <span class="c1"># the first Vertex (which is the one where the merge is occurring). In both </span>
</span><span id="Tile-278"><a href="#Tile-278"><span class="linenos">278</span></a>    <span class="c1"># cases contingent on whether existing Edges are CW or CCW we may need to </span>
</span><span id="Tile-279"><a href="#Tile-279"><span class="linenos">279</span></a>    <span class="c1"># flip the Vertex sequence to ensure that the merge Vertex is in the middle </span>
</span><span id="Tile-280"><a href="#Tile-280"><span class="linenos">280</span></a>    <span class="c1"># of the new edge that will be created</span>
</span><span id="Tile-281"><a href="#Tile-281"><span class="linenos">281</span></a>    <span class="n">head</span> <span class="o">=</span> <span class="n">ei</span><span class="o">.</span><span class="n">corners</span> <span class="k">if</span> <span class="n">CWi</span> <span class="k">else</span> <span class="n">ei</span><span class="o">.</span><span class="n">corners</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="Tile-282"><a href="#Tile-282"><span class="linenos">282</span></a>    <span class="n">tail</span> <span class="o">=</span> <span class="n">ej</span><span class="o">.</span><span class="n">corners</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="k">if</span> <span class="n">CWj</span> <span class="k">else</span> <span class="n">ej</span><span class="o">.</span><span class="n">corners</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">:]</span>
</span><span id="Tile-283"><a href="#Tile-283"><span class="linenos">283</span></a>    <span class="n">v_sequence</span> <span class="o">=</span> <span class="p">(</span><span class="n">head</span> <span class="k">if</span> <span class="n">CWi</span> <span class="k">else</span> <span class="n">head</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="p">(</span><span class="n">tail</span> <span class="k">if</span> <span class="n">CWj</span> <span class="k">else</span> <span class="n">tail</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</span><span id="Tile-284"><a href="#Tile-284"><span class="linenos">284</span></a>    <span class="k">return</span> <span class="n">Edge</span><span class="p">(</span><span class="n">v_sequence</span><span class="p">)</span>
</span><span id="Tile-285"><a href="#Tile-285"><span class="linenos">285</span></a>
</span><span id="Tile-286"><a href="#Tile-286"><span class="linenos">286</span></a>  <span class="k">def</span> <span class="nf">offset_corners</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">offset</span><span class="p">:</span><span class="nb">int</span><span class="p">):</span>
</span><span id="Tile-287"><a href="#Tile-287"><span class="linenos">287</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Shifts shape, corners, edges, and edges_CW by an offset amount. This is</span>
</span><span id="Tile-288"><a href="#Tile-288"><span class="linenos">288</span></a><span class="sd">    used to align tiles that are similar, which is required for correct </span>
</span><span id="Tile-289"><a href="#Tile-289"><span class="linenos">289</span></a><span class="sd">    transfer of &#39;base&#39; tile labelling on to &#39;radius 1&#39; tiles during Topology </span>
</span><span id="Tile-290"><a href="#Tile-290"><span class="linenos">290</span></a><span class="sd">    construction.</span>
</span><span id="Tile-291"><a href="#Tile-291"><span class="linenos">291</span></a>
</span><span id="Tile-292"><a href="#Tile-292"><span class="linenos">292</span></a><span class="sd">    Args:</span>
</span><span id="Tile-293"><a href="#Tile-293"><span class="linenos">293</span></a><span class="sd">      offset int: the number of positions to shift the lists.</span>
</span><span id="Tile-294"><a href="#Tile-294"><span class="linenos">294</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Tile-295"><a href="#Tile-295"><span class="linenos">295</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">offset</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">offset</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Tile-296"><a href="#Tile-296"><span class="linenos">296</span></a>      <span class="bp">self</span><span class="o">.</span><span class="n">shape</span> <span class="o">=</span> <span class="n">tiling_utils</span><span class="o">.</span><span class="n">offset_polygon_corners</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">offset</span><span class="p">)</span>
</span><span id="Tile-297"><a href="#Tile-297"><span class="linenos">297</span></a>      <span class="bp">self</span><span class="o">.</span><span class="n">corners</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">corners</span><span class="p">[</span><span class="n">offset</span><span class="p">:]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">corners</span><span class="p">[:</span><span class="n">offset</span><span class="p">]</span>
</span><span id="Tile-298"><a href="#Tile-298"><span class="linenos">298</span></a>      <span class="bp">self</span><span class="o">.</span><span class="n">edges</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">offset</span><span class="p">:]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">[:</span><span class="n">offset</span><span class="p">]</span>
</span><span id="Tile-299"><a href="#Tile-299"><span class="linenos">299</span></a>      <span class="bp">self</span><span class="o">.</span><span class="n">edges_CW</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges_CW</span><span class="p">[</span><span class="n">offset</span><span class="p">:]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges_CW</span><span class="p">[:</span><span class="n">offset</span><span class="p">]</span>
</span><span id="Tile-300"><a href="#Tile-300"><span class="linenos">300</span></a>
</span><span id="Tile-301"><a href="#Tile-301"><span class="linenos">301</span></a>  <span class="k">def</span> <span class="nf">get_edge_label</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">e</span><span class="p">:</span><span class="s2">&quot;Edge&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="Tile-302"><a href="#Tile-302"><span class="linenos">302</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns edge label of specified edge.</span>
</span><span id="Tile-303"><a href="#Tile-303"><span class="linenos">303</span></a>
</span><span id="Tile-304"><a href="#Tile-304"><span class="linenos">304</span></a><span class="sd">    Args:</span>
</span><span id="Tile-305"><a href="#Tile-305"><span class="linenos">305</span></a><span class="sd">        e (Edge): Edge whose label is required.</span>
</span><span id="Tile-306"><a href="#Tile-306"><span class="linenos">306</span></a>
</span><span id="Tile-307"><a href="#Tile-307"><span class="linenos">307</span></a><span class="sd">    Returns:</span>
</span><span id="Tile-308"><a href="#Tile-308"><span class="linenos">308</span></a><span class="sd">        str: requested edge label.</span>
</span><span id="Tile-309"><a href="#Tile-309"><span class="linenos">309</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Tile-310"><a href="#Tile-310"><span class="linenos">310</span></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">edge_labels</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">get_edge_IDs</span><span class="p">()</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">ID</span><span class="p">)]</span>
</span><span id="Tile-311"><a href="#Tile-311"><span class="linenos">311</span></a>
</span><span id="Tile-312"><a href="#Tile-312"><span class="linenos">312</span></a>  <span class="k">def</span> <span class="nf">get_corner_label</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">v</span><span class="p">:</span><span class="s2">&quot;Vertex&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="Tile-313"><a href="#Tile-313"><span class="linenos">313</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns corner label of specified corner.</span>
</span><span id="Tile-314"><a href="#Tile-314"><span class="linenos">314</span></a>
</span><span id="Tile-315"><a href="#Tile-315"><span class="linenos">315</span></a><span class="sd">    Args:</span>
</span><span id="Tile-316"><a href="#Tile-316"><span class="linenos">316</span></a><span class="sd">        v (Vertex): corner whose label is required.</span>
</span><span id="Tile-317"><a href="#Tile-317"><span class="linenos">317</span></a>
</span><span id="Tile-318"><a href="#Tile-318"><span class="linenos">318</span></a><span class="sd">    Returns:</span>
</span><span id="Tile-319"><a href="#Tile-319"><span class="linenos">319</span></a><span class="sd">        str: requested corner label.</span>
</span><span id="Tile-320"><a href="#Tile-320"><span class="linenos">320</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Tile-321"><a href="#Tile-321"><span class="linenos">321</span></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">edge_labels</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">get_corner_IDs</span><span class="p">()</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">ID</span><span class="p">)]</span>
</span><span id="Tile-322"><a href="#Tile-322"><span class="linenos">322</span></a>
</span><span id="Tile-323"><a href="#Tile-323"><span class="linenos">323</span></a>  <span class="k">def</span> <span class="nf">get_vertex_label_positions</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">geom</span><span class="o">.</span><span class="n">Point</span><span class="p">]:</span>
</span><span id="Tile-324"><a href="#Tile-324"><span class="linenos">324</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns a viable location at which to position corner labels inside</span>
</span><span id="Tile-325"><a href="#Tile-325"><span class="linenos">325</span></a><span class="sd">    tile shape. The method is convoluted because a negative buffer may remove</span>
</span><span id="Tile-326"><a href="#Tile-326"><span class="linenos">326</span></a><span class="sd">    colinear corners resulting in fewer positions than we have corners in the</span>
</span><span id="Tile-327"><a href="#Tile-327"><span class="linenos">327</span></a><span class="sd">    tile shape!</span>
</span><span id="Tile-328"><a href="#Tile-328"><span class="linenos">328</span></a>
</span><span id="Tile-329"><a href="#Tile-329"><span class="linenos">329</span></a><span class="sd">    Returns:</span>
</span><span id="Tile-330"><a href="#Tile-330"><span class="linenos">330</span></a><span class="sd">        list[geom.Point]: list of locations.</span>
</span><span id="Tile-331"><a href="#Tile-331"><span class="linenos">331</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Tile-332"><a href="#Tile-332"><span class="linenos">332</span></a>    <span class="n">d</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="o">.</span><span class="n">area</span> <span class="o">**</span> <span class="mf">0.5</span><span class="p">)</span> <span class="o">/</span> <span class="mi">8</span>
</span><span id="Tile-333"><a href="#Tile-333"><span class="linenos">333</span></a>    <span class="n">c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">centre</span>
</span><span id="Tile-334"><a href="#Tile-334"><span class="linenos">334</span></a>    <span class="n">corners</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span><span class="o">.</span><span class="n">point</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">corners</span><span class="p">]</span>
</span><span id="Tile-335"><a href="#Tile-335"><span class="linenos">335</span></a>    <span class="k">return</span> <span class="p">[</span><span class="n">geom</span><span class="o">.</span><span class="n">LineString</span><span class="p">([</span><span class="n">p</span><span class="p">,</span> <span class="n">c</span><span class="p">])</span><span class="o">.</span><span class="n">line_interpolate_point</span><span class="p">(</span><span class="n">d</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">corners</span><span class="p">]</span>
</span><span id="Tile-336"><a href="#Tile-336"><span class="linenos">336</span></a>    
</span><span id="Tile-337"><a href="#Tile-337"><span class="linenos">337</span></a>  <span class="k">def</span> <span class="nf">get_edge_label_positions</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">geom</span><span class="o">.</span><span class="n">Point</span><span class="p">]:</span>
</span><span id="Tile-338"><a href="#Tile-338"><span class="linenos">338</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns a reasonable location at which to position edge labels inside</span>
</span><span id="Tile-339"><a href="#Tile-339"><span class="linenos">339</span></a><span class="sd">    tile shape.</span>
</span><span id="Tile-340"><a href="#Tile-340"><span class="linenos">340</span></a>
</span><span id="Tile-341"><a href="#Tile-341"><span class="linenos">341</span></a><span class="sd">    Returns:</span>
</span><span id="Tile-342"><a href="#Tile-342"><span class="linenos">342</span></a><span class="sd">        list[geom.Point]: list of locations</span>
</span><span id="Tile-343"><a href="#Tile-343"><span class="linenos">343</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Tile-344"><a href="#Tile-344"><span class="linenos">344</span></a>    <span class="n">d</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="o">.</span><span class="n">area</span> <span class="o">**</span> <span class="mf">0.5</span><span class="p">)</span> <span class="o">/</span> <span class="mi">8</span>
</span><span id="Tile-345"><a href="#Tile-345"><span class="linenos">345</span></a>    <span class="n">c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">centre</span>
</span><span id="Tile-346"><a href="#Tile-346"><span class="linenos">346</span></a>    <span class="c1"># note direction is important as edge might not be a simple line segment</span>
</span><span id="Tile-347"><a href="#Tile-347"><span class="linenos">347</span></a>    <span class="n">sides</span> <span class="o">=</span> <span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">get_geometry</span><span class="p">(</span><span class="n">CW</span><span class="p">)</span> <span class="k">for</span> <span class="n">e</span><span class="p">,</span> <span class="n">CW</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges_CW</span><span class="p">)]</span>
</span><span id="Tile-348"><a href="#Tile-348"><span class="linenos">348</span></a>    <span class="k">return</span> <span class="p">[</span><span class="n">geom</span><span class="o">.</span><span class="n">LineString</span><span class="p">([</span><span class="n">s</span><span class="o">.</span><span class="n">centroid</span><span class="p">,</span> <span class="n">c</span><span class="p">])</span><span class="o">.</span><span class="n">line_interpolate_point</span><span class="p">(</span><span class="n">d</span><span class="p">)</span> 
</span><span id="Tile-349"><a href="#Tile-349"><span class="linenos">349</span></a>            <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">sides</span><span class="p">]</span>
</span><span id="Tile-350"><a href="#Tile-350"><span class="linenos">350</span></a>
</span><span id="Tile-351"><a href="#Tile-351"><span class="linenos">351</span></a>  <span class="k">def</span> <span class="nf">angle_at</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">v</span><span class="p">:</span><span class="s2">&quot;Vertex&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="Tile-352"><a href="#Tile-352"><span class="linenos">352</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns interior angle at the specified corner (in degrees).</span>
</span><span id="Tile-353"><a href="#Tile-353"><span class="linenos">353</span></a>
</span><span id="Tile-354"><a href="#Tile-354"><span class="linenos">354</span></a><span class="sd">    Args:</span>
</span><span id="Tile-355"><a href="#Tile-355"><span class="linenos">355</span></a><span class="sd">        v (Vertex): corner where angle is requested.</span>
</span><span id="Tile-356"><a href="#Tile-356"><span class="linenos">356</span></a>
</span><span id="Tile-357"><a href="#Tile-357"><span class="linenos">357</span></a><span class="sd">    Returns:</span>
</span><span id="Tile-358"><a href="#Tile-358"><span class="linenos">358</span></a><span class="sd">        float: angle at corner v in degrees.</span>
</span><span id="Tile-359"><a href="#Tile-359"><span class="linenos">359</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Tile-360"><a href="#Tile-360"><span class="linenos">360</span></a>    <span class="n">i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">corners</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
</span><span id="Tile-361"><a href="#Tile-361"><span class="linenos">361</span></a>    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">corners</span><span class="p">)</span>
</span><span id="Tile-362"><a href="#Tile-362"><span class="linenos">362</span></a>    <span class="k">return</span> <span class="n">tiling_utils</span><span class="o">.</span><span class="n">get_inner_angle</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">corners</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">point</span><span class="p">,</span>
</span><span id="Tile-363"><a href="#Tile-363"><span class="linenos">363</span></a>                                        <span class="bp">self</span><span class="o">.</span><span class="n">corners</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">point</span><span class="p">,</span>
</span><span id="Tile-364"><a href="#Tile-364"><span class="linenos">364</span></a>                                        <span class="bp">self</span><span class="o">.</span><span class="n">corners</span><span class="p">[(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="n">n</span><span class="p">]</span><span class="o">.</span><span class="n">point</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Class to capture and manipulate essential features of polygons in a tiling.</p>
</div>


                            <div id="Tile.__init__" class="classattr">
                                        <input id="Tile.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">Tile</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">ID</span><span class="p">:</span> <span class="nb">int</span></span>)</span>

                <label class="view-source-button" for="Tile.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Tile.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Tile.__init__-59"><a href="#Tile.__init__-59"><span class="linenos">59</span></a>  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ID</span><span class="p">:</span><span class="nb">int</span><span class="p">):</span>
</span><span id="Tile.__init__-60"><a href="#Tile.__init__-60"><span class="linenos">60</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Class constructor.</span>
</span><span id="Tile.__init__-61"><a href="#Tile.__init__-61"><span class="linenos">61</span></a>
</span><span id="Tile.__init__-62"><a href="#Tile.__init__-62"><span class="linenos">62</span></a><span class="sd">    Args:</span>
</span><span id="Tile.__init__-63"><a href="#Tile.__init__-63"><span class="linenos">63</span></a><span class="sd">      ID (int): Tile ID which indexes it in the containing Topology tiles list.</span>
</span><span id="Tile.__init__-64"><a href="#Tile.__init__-64"><span class="linenos">64</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Tile.__init__-65"><a href="#Tile.__init__-65"><span class="linenos">65</span></a>    <span class="c1"># self.set_shape(tiling_utils.get_clean_polygon(shape))</span>
</span><span id="Tile.__init__-66"><a href="#Tile.__init__-66"><span class="linenos">66</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">ID</span> <span class="o">=</span> <span class="n">ID</span>
</span><span id="Tile.__init__-67"><a href="#Tile.__init__-67"><span class="linenos">67</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">corners</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Tile.__init__-68"><a href="#Tile.__init__-68"><span class="linenos">68</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">edges</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Tile.__init__-69"><a href="#Tile.__init__-69"><span class="linenos">69</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">edges_CW</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Tile.__init__-70"><a href="#Tile.__init__-70"><span class="linenos">70</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">vertex_labels</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Tile.__init__-71"><a href="#Tile.__init__-71"><span class="linenos">71</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">edge_labels</span> <span class="o">=</span> <span class="p">[]</span>
</span></pre></div>


            <div class="docstring"><p>Class constructor.</p>

<p>Args:
  ID (int): Tile ID which indexes it in the containing Topology tiles list.</p>
</div>


                            </div>
                            <div id="Tile.ID" class="classattr">
                                <div class="attr variable">
            <span class="name">ID</span><span class="annotation">: int</span>

        
    </div>
    <a class="headerlink" href="#Tile.ID"></a>
    
            <div class="docstring"><p>integer ID number which indexes the Tile in the containing Topology tiles 
list.</p>
</div>


                            </div>
                            <div id="Tile.base_ID" class="classattr">
                                <div class="attr variable">
            <span class="name">base_ID</span><span class="annotation">: int</span>

        
    </div>
    <a class="headerlink" href="#Tile.base_ID"></a>
    
            <div class="docstring"><p>ID of corresponding Tile in the base tileable unit</p>
</div>


                            </div>
                            <div id="Tile.corners" class="classattr">
                                <div class="attr variable">
            <span class="name">corners</span><span class="annotation">: list[<a href="#Vertex">Vertex</a>]</span>

        
    </div>
    <a class="headerlink" href="#Tile.corners"></a>
    
            <div class="docstring"><p>list of Vertex objects. This includes all corners of the original polygon 
and any tiling vertices induced by (for example) a the corner of an adjacent 
tile lying halfway along an edge of the original polygon on which this tile 
is based. Vertex objects are stored in strictly clockwise sequence.</p>
</div>


                            </div>
                            <div id="Tile.edges" class="classattr">
                                <div class="attr variable">
            <span class="name">edges</span><span class="annotation">: list[<a href="#Edge">Edge</a>]</span>

        
    </div>
    <a class="headerlink" href="#Tile.edges"></a>
    
            <div class="docstring"><p>list of Edge objects that together compose the tile boundary.</p>
</div>


                            </div>
                            <div id="Tile.edges_CW" class="classattr">
                                <div class="attr variable">
            <span class="name">edges_CW</span><span class="annotation">: list[bool]</span>

        
    </div>
    <a class="headerlink" href="#Tile.edges_CW"></a>
    
            <div class="docstring"><p>list of Edge direction. Edges are stored only once in a Topology so some 
edges are in clockwise order and others  are in counter-clockwise order. 
These boolean flags are True if the corresponding Edge is clockwise, False if 
counter-clockwise.</p>
</div>


                            </div>
                            <div id="Tile.label" class="classattr">
                                <div class="attr variable">
            <span class="name">label</span><span class="annotation">: str</span>

        
    </div>
    <a class="headerlink" href="#Tile.label"></a>
    
            <div class="docstring"><p>tile_id label from the tileable source</p>
</div>


                            </div>
                            <div id="Tile.vertex_labels" class="classattr">
                                <div class="attr variable">
            <span class="name">vertex_labels</span><span class="annotation">: list[str]</span>

        
    </div>
    <a class="headerlink" href="#Tile.vertex_labels"></a>
    
            <div class="docstring"><p>list of (upper case) letter labels of the tile corners (i.e. all corners, 
not only tiling vertices).</p>
</div>


                            </div>
                            <div id="Tile.edge_labels" class="classattr">
                                <div class="attr variable">
            <span class="name">edge_labels</span><span class="annotation">: list[str]</span>

        
    </div>
    <a class="headerlink" href="#Tile.edge_labels"></a>
    
            <div class="docstring"><p>list of (lower case) letter labels of the tile edges (tiling edges, not 
tile sides).</p>
</div>


                            </div>
                            <div id="Tile.shape" class="classattr">
                                <div class="attr variable">
            <span class="name">shape</span><span class="annotation">: shapely.geometry.polygon.Polygon</span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#Tile.shape"></a>
    
            <div class="docstring"><p>the tile geometry (which may include some redundant points along sides 
where neighbouring tiles induce a tiling vertex). So for example a rectangle 
might have additional points along its sides:</p>

<pre><code>  +---+-------+
  |   |   2   |
  | 1 A---B---E---+
  |   |   |   4   |
  +---C 3 D-------+
      |   |
      +---+
</code></pre>

<p>In the above Tile 1 has additional point A, 2 has B and 3 has C and D induced 
by the corners of neighbouring tiles.</p>
</div>


                            </div>
                            <div id="Tile.centre" class="classattr">
                                <div class="attr variable">
            <span class="name">centre</span><span class="annotation">: shapely.geometry.point.Point</span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#Tile.centre"></a>
    
            <div class="docstring"><p>a point centre for the Tile (determined by <a href="tiling_utils.html">weavingspace.tiling_utils</a>.
incentre).</p>
</div>


                            </div>
                            <div id="Tile.shape_group" class="classattr">
                                <div class="attr variable">
            <span class="name">shape_group</span><span class="annotation">: int</span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#Tile.shape_group"></a>
    
            <div class="docstring"><p>the tile shape group of this tile in its containing Topology.</p>
</div>


                            </div>
                            <div id="Tile.transitivity_class" class="classattr">
                                <div class="attr variable">
            <span class="name">transitivity_class</span><span class="annotation">: int</span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#Tile.transitivity_class"></a>
    
            <div class="docstring"><p>the tile transitivity class of this tile its containing Topology</p>
</div>


                            </div>
                            <div id="Tile.get_corner_IDs" class="classattr">
                                        <input id="Tile.get_corner_IDs-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_corner_IDs</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="Tile.get_corner_IDs-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Tile.get_corner_IDs"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Tile.get_corner_IDs-85"><a href="#Tile.get_corner_IDs-85"><span class="linenos">85</span></a>  <span class="k">def</span> <span class="nf">get_corner_IDs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
</span><span id="Tile.get_corner_IDs-86"><a href="#Tile.get_corner_IDs-86"><span class="linenos">86</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Convenience method to return list of corner IDs (not Vertex objects).</span>
</span><span id="Tile.get_corner_IDs-87"><a href="#Tile.get_corner_IDs-87"><span class="linenos">87</span></a>
</span><span id="Tile.get_corner_IDs-88"><a href="#Tile.get_corner_IDs-88"><span class="linenos">88</span></a><span class="sd">    Returns:</span>
</span><span id="Tile.get_corner_IDs-89"><a href="#Tile.get_corner_IDs-89"><span class="linenos">89</span></a><span class="sd">      list[int]: list of integer IDs of tile corners.</span>
</span><span id="Tile.get_corner_IDs-90"><a href="#Tile.get_corner_IDs-90"><span class="linenos">90</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Tile.get_corner_IDs-91"><a href="#Tile.get_corner_IDs-91"><span class="linenos">91</span></a>    <span class="k">return</span> <span class="p">[</span><span class="n">c</span><span class="o">.</span><span class="n">ID</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">corners</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Convenience method to return list of corner IDs (not Vertex objects).</p>

<p>Returns:
  list[int]: list of integer IDs of tile corners.</p>
</div>


                            </div>
                            <div id="Tile.get_edge_IDs" class="classattr">
                                        <input id="Tile.get_edge_IDs-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_edge_IDs</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">]]</span>:</span></span>

                <label class="view-source-button" for="Tile.get_edge_IDs-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Tile.get_edge_IDs"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Tile.get_edge_IDs-93"><a href="#Tile.get_edge_IDs-93"><span class="linenos"> 93</span></a>  <span class="k">def</span> <span class="nf">get_edge_IDs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">]]:</span>
</span><span id="Tile.get_edge_IDs-94"><a href="#Tile.get_edge_IDs-94"><span class="linenos"> 94</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Convenience method to return list of edge IDs (not Edge objects).</span>
</span><span id="Tile.get_edge_IDs-95"><a href="#Tile.get_edge_IDs-95"><span class="linenos"> 95</span></a>
</span><span id="Tile.get_edge_IDs-96"><a href="#Tile.get_edge_IDs-96"><span class="linenos"> 96</span></a><span class="sd">    Returns:</span>
</span><span id="Tile.get_edge_IDs-97"><a href="#Tile.get_edge_IDs-97"><span class="linenos"> 97</span></a><span class="sd">      list[tuple[int]]: list of 2-element tuples of the start and end Vertex IDs</span>
</span><span id="Tile.get_edge_IDs-98"><a href="#Tile.get_edge_IDs-98"><span class="linenos"> 98</span></a><span class="sd">        of each edge.</span>
</span><span id="Tile.get_edge_IDs-99"><a href="#Tile.get_edge_IDs-99"><span class="linenos"> 99</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Tile.get_edge_IDs-100"><a href="#Tile.get_edge_IDs-100"><span class="linenos">100</span></a>    <span class="k">return</span> <span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">ID</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Convenience method to return list of edge IDs (not Edge objects).</p>

<p>Returns:
  list[tuple[int]]: list of 2-element tuples of the start and end Vertex IDs
    of each edge.</p>
</div>


                            </div>
                            <div id="Tile.set_shape_from_corners" class="classattr">
                                        <input id="Tile.set_shape_from_corners-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">set_shape_from_corners</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Tile.set_shape_from_corners-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Tile.set_shape_from_corners"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Tile.set_shape_from_corners-102"><a href="#Tile.set_shape_from_corners-102"><span class="linenos">102</span></a>  <span class="k">def</span> <span class="nf">set_shape_from_corners</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Tile.set_shape_from_corners-103"><a href="#Tile.set_shape_from_corners-103"><span class="linenos">103</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Sets the shape attribute based on the current list of corners, and sets </span>
</span><span id="Tile.set_shape_from_corners-104"><a href="#Tile.set_shape_from_corners-104"><span class="linenos">104</span></a><span class="sd">    the associated tile centre.</span>
</span><span id="Tile.set_shape_from_corners-105"><a href="#Tile.set_shape_from_corners-105"><span class="linenos">105</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Tile.set_shape_from_corners-106"><a href="#Tile.set_shape_from_corners-106"><span class="linenos">106</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">shape</span> <span class="o">=</span> <span class="n">geom</span><span class="o">.</span><span class="n">Polygon</span><span class="p">([</span><span class="n">c</span><span class="o">.</span><span class="n">point</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">corners</span><span class="p">])</span>
</span><span id="Tile.set_shape_from_corners-107"><a href="#Tile.set_shape_from_corners-107"><span class="linenos">107</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">centre</span> <span class="o">=</span> <span class="n">tiling_utils</span><span class="o">.</span><span class="n">incentre</span><span class="p">(</span>
</span><span id="Tile.set_shape_from_corners-108"><a href="#Tile.set_shape_from_corners-108"><span class="linenos">108</span></a>      <span class="n">tiling_utils</span><span class="o">.</span><span class="n">get_clean_polygon</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
</span></pre></div>


            <div class="docstring"><p>Sets the shape attribute based on the current list of corners, and sets 
the associated tile centre.</p>
</div>


                            </div>
                            <div id="Tile.set_corners_from_edges" class="classattr">
                                        <input id="Tile.set_corners_from_edges-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">set_corners_from_edges</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">update_shape</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Tile.set_corners_from_edges-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Tile.set_corners_from_edges"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Tile.set_corners_from_edges-110"><a href="#Tile.set_corners_from_edges-110"><span class="linenos">110</span></a>  <span class="k">def</span> <span class="nf">set_corners_from_edges</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">update_shape</span><span class="p">:</span><span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">):</span>
</span><span id="Tile.set_corners_from_edges-111"><a href="#Tile.set_corners_from_edges-111"><span class="linenos">111</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Sets the corners attribute from the edges attribute. Typically called </span>
</span><span id="Tile.set_corners_from_edges-112"><a href="#Tile.set_corners_from_edges-112"><span class="linenos">112</span></a><span class="sd">    after modification of topology edges. Optionally the shape attribute is NOT</span>
</span><span id="Tile.set_corners_from_edges-113"><a href="#Tile.set_corners_from_edges-113"><span class="linenos">113</span></a><span class="sd">    updated, which may save time when multiple changes to the edges of a tile</span>
</span><span id="Tile.set_corners_from_edges-114"><a href="#Tile.set_corners_from_edges-114"><span class="linenos">114</span></a><span class="sd">    are in process (i.e., only update the shape after all changes are complete).</span>
</span><span id="Tile.set_corners_from_edges-115"><a href="#Tile.set_corners_from_edges-115"><span class="linenos">115</span></a>
</span><span id="Tile.set_corners_from_edges-116"><a href="#Tile.set_corners_from_edges-116"><span class="linenos">116</span></a><span class="sd">    Args:</span>
</span><span id="Tile.set_corners_from_edges-117"><a href="#Tile.set_corners_from_edges-117"><span class="linenos">117</span></a><span class="sd">      update_shape (bool, optional): if True the shape attribute will be </span>
</span><span id="Tile.set_corners_from_edges-118"><a href="#Tile.set_corners_from_edges-118"><span class="linenos">118</span></a><span class="sd">        updated, otherwise not. Defaults to True.</span>
</span><span id="Tile.set_corners_from_edges-119"><a href="#Tile.set_corners_from_edges-119"><span class="linenos">119</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Tile.set_corners_from_edges-120"><a href="#Tile.set_corners_from_edges-120"><span class="linenos">120</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">corners</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Tile.set_corners_from_edges-121"><a href="#Tile.set_corners_from_edges-121"><span class="linenos">121</span></a>    <span class="k">for</span> <span class="n">e</span><span class="p">,</span> <span class="n">cw</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges_CW</span><span class="p">):</span>
</span><span id="Tile.set_corners_from_edges-122"><a href="#Tile.set_corners_from_edges-122"><span class="linenos">122</span></a>      <span class="k">if</span> <span class="n">cw</span><span class="p">:</span> <span class="c1"># clockwise to extend by all but the first corner</span>
</span><span id="Tile.set_corners_from_edges-123"><a href="#Tile.set_corners_from_edges-123"><span class="linenos">123</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">corners</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">corners</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</span><span id="Tile.set_corners_from_edges-124"><a href="#Tile.set_corners_from_edges-124"><span class="linenos">124</span></a>      <span class="k">else</span><span class="p">:</span> <span class="c1"># counter-clockwise so extend in reverse</span>
</span><span id="Tile.set_corners_from_edges-125"><a href="#Tile.set_corners_from_edges-125"><span class="linenos">125</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">corners</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">corners</span><span class="p">[</span><span class="mi">1</span><span class="p">:][::</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</span><span id="Tile.set_corners_from_edges-126"><a href="#Tile.set_corners_from_edges-126"><span class="linenos">126</span></a>    <span class="k">if</span> <span class="n">update_shape</span><span class="p">:</span>
</span><span id="Tile.set_corners_from_edges-127"><a href="#Tile.set_corners_from_edges-127"><span class="linenos">127</span></a>      <span class="bp">self</span><span class="o">.</span><span class="n">set_shape_from_corners</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Sets the corners attribute from the edges attribute. Typically called 
after modification of topology edges. Optionally the shape attribute is NOT
updated, which may save time when multiple changes to the edges of a tile
are in process (i.e., only update the shape after all changes are complete).</p>

<p>Args:
  update_shape (bool, optional): if True the shape attribute will be 
    updated, otherwise not. Defaults to True.</p>
</div>


                            </div>
                            <div id="Tile.set_edge_directions" class="classattr">
                                        <input id="Tile.set_edge_directions-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">set_edge_directions</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Tile.set_edge_directions-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Tile.set_edge_directions"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Tile.set_edge_directions-129"><a href="#Tile.set_edge_directions-129"><span class="linenos">129</span></a>  <span class="k">def</span> <span class="nf">set_edge_directions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Tile.set_edge_directions-130"><a href="#Tile.set_edge_directions-130"><span class="linenos">130</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Sets up the edges_CW attribute by inspection of the edges list.</span>
</span><span id="Tile.set_edge_directions-131"><a href="#Tile.set_edge_directions-131"><span class="linenos">131</span></a><span class="sd">    It is (frankly!) hard to keep track of the correct sequence of CW/CCW order</span>
</span><span id="Tile.set_edge_directions-132"><a href="#Tile.set_edge_directions-132"><span class="linenos">132</span></a><span class="sd">    of edges as new ones are created or old ones merged. This method inspects</span>
</span><span id="Tile.set_edge_directions-133"><a href="#Tile.set_edge_directions-133"><span class="linenos">133</span></a><span class="sd">    the &#39;tail-head&#39; relations between consecutive edges to set these flags </span>
</span><span id="Tile.set_edge_directions-134"><a href="#Tile.set_edge_directions-134"><span class="linenos">134</span></a><span class="sd">    correctly.</span>
</span><span id="Tile.set_edge_directions-135"><a href="#Tile.set_edge_directions-135"><span class="linenos">135</span></a>
</span><span id="Tile.set_edge_directions-136"><a href="#Tile.set_edge_directions-136"><span class="linenos">136</span></a><span class="sd">    The test is simply to check if the &#39;tail&#39; Vertex ID in each edge appears</span>
</span><span id="Tile.set_edge_directions-137"><a href="#Tile.set_edge_directions-137"><span class="linenos">137</span></a><span class="sd">    in the ID tuple of the following edge, i.e. if successive edge </span>
</span><span id="Tile.set_edge_directions-138"><a href="#Tile.set_edge_directions-138"><span class="linenos">138</span></a><span class="sd">    IDs are (0, 1) (2, 1) or (0, 1) (1, 2), then edge (0, 1) is in clockwise</span>
</span><span id="Tile.set_edge_directions-139"><a href="#Tile.set_edge_directions-139"><span class="linenos">139</span></a><span class="sd">    direction, but if we have (0, 1) (2, 3) then it is not.</span>
</span><span id="Tile.set_edge_directions-140"><a href="#Tile.set_edge_directions-140"><span class="linenos">140</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Tile.set_edge_directions-141"><a href="#Tile.set_edge_directions-141"><span class="linenos">141</span></a>    <span class="n">edge_IDs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_edge_IDs</span><span class="p">()</span>
</span><span id="Tile.set_edge_directions-142"><a href="#Tile.set_edge_directions-142"><span class="linenos">142</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">edges_CW</span> <span class="o">=</span> <span class="p">[</span><span class="n">e1</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="n">e2</span> <span class="k">for</span> <span class="n">e1</span><span class="p">,</span> <span class="n">e2</span> <span class="ow">in</span> 
</span><span id="Tile.set_edge_directions-143"><a href="#Tile.set_edge_directions-143"><span class="linenos">143</span></a>                     <span class="nb">zip</span><span class="p">(</span><span class="n">edge_IDs</span><span class="p">,</span> <span class="n">edge_IDs</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">+</span> <span class="n">edge_IDs</span><span class="p">[:</span><span class="mi">1</span><span class="p">])]</span>
</span></pre></div>


            <div class="docstring"><p>Sets up the edges_CW attribute by inspection of the edges list.
It is (frankly!) hard to keep track of the correct sequence of CW/CCW order
of edges as new ones are created or old ones merged. This method inspects
the 'tail-head' relations between consecutive edges to set these flags 
correctly.</p>

<p>The test is simply to check if the 'tail' Vertex ID in each edge appears
in the ID tuple of the following edge, i.e. if successive edge 
IDs are (0, 1) (2, 1) or (0, 1) (1, 2), then edge (0, 1) is in clockwise
direction, but if we have (0, 1) (2, 3) then it is not.</p>
</div>


                            </div>
                            <div id="Tile.insert_vertex_at" class="classattr">
                                        <input id="Tile.insert_vertex_at-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">insert_vertex_at</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">v</span><span class="p">:</span> <span class="n"><a href="#Vertex">Vertex</a></span>,</span><span class="param">	<span class="n">i</span><span class="p">:</span> <span class="nb">int</span>,</span><span class="param">	<span class="n">update_shape</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span></span><span class="return-annotation">) -> <span class="nb">tuple</span>:</span></span>

                <label class="view-source-button" for="Tile.insert_vertex_at-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Tile.insert_vertex_at"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Tile.insert_vertex_at-145"><a href="#Tile.insert_vertex_at-145"><span class="linenos">145</span></a>  <span class="k">def</span> <span class="nf">insert_vertex_at</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">v</span><span class="p">:</span><span class="s2">&quot;Vertex&quot;</span><span class="p">,</span> <span class="n">i</span><span class="p">:</span><span class="nb">int</span><span class="p">,</span> 
</span><span id="Tile.insert_vertex_at-146"><a href="#Tile.insert_vertex_at-146"><span class="linenos">146</span></a>                       <span class="n">update_shape</span><span class="p">:</span><span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
</span><span id="Tile.insert_vertex_at-147"><a href="#Tile.insert_vertex_at-147"><span class="linenos">147</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Method to insert the supplied Vertex into tile at index position i, </span>
</span><span id="Tile.insert_vertex_at-148"><a href="#Tile.insert_vertex_at-148"><span class="linenos">148</span></a><span class="sd">    optionally updating the shape attribute. Both corners and edges attributes</span>
</span><span id="Tile.insert_vertex_at-149"><a href="#Tile.insert_vertex_at-149"><span class="linenos">149</span></a><span class="sd">    are updated, and the old edge IDs for removal and the new edge itself are</span>
</span><span id="Tile.insert_vertex_at-150"><a href="#Tile.insert_vertex_at-150"><span class="linenos">150</span></a><span class="sd">    returned to the calling context (the containing Topology) for update of its</span>
</span><span id="Tile.insert_vertex_at-151"><a href="#Tile.insert_vertex_at-151"><span class="linenos">151</span></a><span class="sd">    edges collection.</span>
</span><span id="Tile.insert_vertex_at-152"><a href="#Tile.insert_vertex_at-152"><span class="linenos">152</span></a>
</span><span id="Tile.insert_vertex_at-153"><a href="#Tile.insert_vertex_at-153"><span class="linenos">153</span></a><span class="sd">    This is NOT a generic vertex insertion method: it is only for use during </span>
</span><span id="Tile.insert_vertex_at-154"><a href="#Tile.insert_vertex_at-154"><span class="linenos">154</span></a><span class="sd">    Topology initialisation, and does not guarantee correct maintenance of </span>
</span><span id="Tile.insert_vertex_at-155"><a href="#Tile.insert_vertex_at-155"><span class="linenos">155</span></a><span class="sd">    all tile, edge and vertex relations in the general case---at any rate it</span>
</span><span id="Tile.insert_vertex_at-156"><a href="#Tile.insert_vertex_at-156"><span class="linenos">156</span></a><span class="sd">    has not been tested for this!</span>
</span><span id="Tile.insert_vertex_at-157"><a href="#Tile.insert_vertex_at-157"><span class="linenos">157</span></a>
</span><span id="Tile.insert_vertex_at-158"><a href="#Tile.insert_vertex_at-158"><span class="linenos">158</span></a><span class="sd">    Args:</span>
</span><span id="Tile.insert_vertex_at-159"><a href="#Tile.insert_vertex_at-159"><span class="linenos">159</span></a><span class="sd">        v (Vertex): the Vertex to insert.</span>
</span><span id="Tile.insert_vertex_at-160"><a href="#Tile.insert_vertex_at-160"><span class="linenos">160</span></a><span class="sd">        i (int): index position in current corners after which to insert </span>
</span><span id="Tile.insert_vertex_at-161"><a href="#Tile.insert_vertex_at-161"><span class="linenos">161</span></a><span class="sd">          supplied Vertex.</span>
</span><span id="Tile.insert_vertex_at-162"><a href="#Tile.insert_vertex_at-162"><span class="linenos">162</span></a><span class="sd">        update_shape (bool, optional): if True shape attribute is updated. </span>
</span><span id="Tile.insert_vertex_at-163"><a href="#Tile.insert_vertex_at-163"><span class="linenos">163</span></a><span class="sd">          Defaults to False.</span>
</span><span id="Tile.insert_vertex_at-164"><a href="#Tile.insert_vertex_at-164"><span class="linenos">164</span></a>
</span><span id="Tile.insert_vertex_at-165"><a href="#Tile.insert_vertex_at-165"><span class="linenos">165</span></a><span class="sd">    Returns:</span>
</span><span id="Tile.insert_vertex_at-166"><a href="#Tile.insert_vertex_at-166"><span class="linenos">166</span></a><span class="sd">      tuple: the (tuple) ID of the old edge which should be deleted, and </span>
</span><span id="Tile.insert_vertex_at-167"><a href="#Tile.insert_vertex_at-167"><span class="linenos">167</span></a><span class="sd">        the new Edges arising from insertion of this Vertex.</span>
</span><span id="Tile.insert_vertex_at-168"><a href="#Tile.insert_vertex_at-168"><span class="linenos">168</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Tile.insert_vertex_at-169"><a href="#Tile.insert_vertex_at-169"><span class="linenos">169</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">corners</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">corners</span><span class="p">[:</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">corners</span><span class="p">[</span><span class="n">i</span><span class="p">:]</span>
</span><span id="Tile.insert_vertex_at-170"><a href="#Tile.insert_vertex_at-170"><span class="linenos">170</span></a>    <span class="n">old_edge</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
</span><span id="Tile.insert_vertex_at-171"><a href="#Tile.insert_vertex_at-171"><span class="linenos">171</span></a>    <span class="c1"># store current ID of the affected edge for return to calling context</span>
</span><span id="Tile.insert_vertex_at-172"><a href="#Tile.insert_vertex_at-172"><span class="linenos">172</span></a>    <span class="n">old_edge_ID</span> <span class="o">=</span> <span class="n">old_edge</span><span class="o">.</span><span class="n">ID</span>
</span><span id="Tile.insert_vertex_at-173"><a href="#Tile.insert_vertex_at-173"><span class="linenos">173</span></a>    <span class="n">new_edges</span> <span class="o">=</span> <span class="n">old_edge</span><span class="o">.</span><span class="n">insert_vertex</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">corners</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">])</span>
</span><span id="Tile.insert_vertex_at-174"><a href="#Tile.insert_vertex_at-174"><span class="linenos">174</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">edges</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">[:(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)]</span> <span class="o">+</span> <span class="n">new_edges</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">i</span><span class="p">:]</span>
</span><span id="Tile.insert_vertex_at-175"><a href="#Tile.insert_vertex_at-175"><span class="linenos">175</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">set_edge_directions</span><span class="p">()</span>
</span><span id="Tile.insert_vertex_at-176"><a href="#Tile.insert_vertex_at-176"><span class="linenos">176</span></a>    <span class="k">if</span> <span class="n">update_shape</span><span class="p">:</span>
</span><span id="Tile.insert_vertex_at-177"><a href="#Tile.insert_vertex_at-177"><span class="linenos">177</span></a>      <span class="bp">self</span><span class="o">.</span><span class="n">set_shape_from_corners</span><span class="p">()</span>
</span><span id="Tile.insert_vertex_at-178"><a href="#Tile.insert_vertex_at-178"><span class="linenos">178</span></a>    <span class="k">return</span> <span class="n">old_edge_ID</span><span class="p">,</span> <span class="n">new_edges</span>
</span></pre></div>


            <div class="docstring"><p>Method to insert the supplied Vertex into tile at index position i, 
optionally updating the shape attribute. Both corners and edges attributes
are updated, and the old edge IDs for removal and the new edge itself are
returned to the calling context (the containing Topology) for update of its
edges collection.</p>

<p>This is NOT a generic vertex insertion method: it is only for use during 
Topology initialisation, and does not guarantee correct maintenance of 
all tile, edge and vertex relations in the general case---at any rate it
has not been tested for this!</p>

<p>Args:
    v (Vertex): the Vertex to insert.
    i (int): index position in current corners after which to insert 
      supplied Vertex.
    update_shape (bool, optional): if True shape attribute is updated. 
      Defaults to False.</p>

<p>Returns:
  tuple: the (tuple) ID of the old edge which should be deleted, and 
    the new Edges arising from insertion of this Vertex.</p>
</div>


                            </div>
                            <div id="Tile.merge_edges_at_vertex" class="classattr">
                                        <input id="Tile.merge_edges_at_vertex-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">merge_edges_at_vertex</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">v</span><span class="p">:</span> <span class="n"><a href="#Vertex">Vertex</a></span></span><span class="return-annotation">) -> <span class="nb">tuple</span>:</span></span>

                <label class="view-source-button" for="Tile.merge_edges_at_vertex-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Tile.merge_edges_at_vertex"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Tile.merge_edges_at_vertex-180"><a href="#Tile.merge_edges_at_vertex-180"><span class="linenos">180</span></a>  <span class="k">def</span> <span class="nf">merge_edges_at_vertex</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">v</span><span class="p">:</span><span class="s2">&quot;Vertex&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
</span><span id="Tile.merge_edges_at_vertex-181"><a href="#Tile.merge_edges_at_vertex-181"><span class="linenos">181</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Method to merge the edges that meet at the supplied Vertex. It is </span>
</span><span id="Tile.merge_edges_at_vertex-182"><a href="#Tile.merge_edges_at_vertex-182"><span class="linenos">182</span></a><span class="sd">    assumed that only two tiles are impacted this one, and its neighbour across</span>
</span><span id="Tile.merge_edges_at_vertex-183"><a href="#Tile.merge_edges_at_vertex-183"><span class="linenos">183</span></a><span class="sd">    the Edge on which v lies. Both are updated. For this reason the work is</span>
</span><span id="Tile.merge_edges_at_vertex-184"><a href="#Tile.merge_edges_at_vertex-184"><span class="linenos">184</span></a><span class="sd">    delegated to get_updated_edges_from_merge which is run on both affected</span>
</span><span id="Tile.merge_edges_at_vertex-185"><a href="#Tile.merge_edges_at_vertex-185"><span class="linenos">185</span></a><span class="sd">    tiles, but only determines the edges to remove and the new edge to be added</span>
</span><span id="Tile.merge_edges_at_vertex-186"><a href="#Tile.merge_edges_at_vertex-186"><span class="linenos">186</span></a><span class="sd">    once. See that method for details.</span>
</span><span id="Tile.merge_edges_at_vertex-187"><a href="#Tile.merge_edges_at_vertex-187"><span class="linenos">187</span></a><span class="sd">    </span>
</span><span id="Tile.merge_edges_at_vertex-188"><a href="#Tile.merge_edges_at_vertex-188"><span class="linenos">188</span></a><span class="sd">    Args:</span>
</span><span id="Tile.merge_edges_at_vertex-189"><a href="#Tile.merge_edges_at_vertex-189"><span class="linenos">189</span></a><span class="sd">      v (Vertex): Vertex at which to merge Edges. This should currently be an</span>
</span><span id="Tile.merge_edges_at_vertex-190"><a href="#Tile.merge_edges_at_vertex-190"><span class="linenos">190</span></a><span class="sd">        end</span>
</span><span id="Tile.merge_edges_at_vertex-191"><a href="#Tile.merge_edges_at_vertex-191"><span class="linenos">191</span></a><span class="sd">    </span>
</span><span id="Tile.merge_edges_at_vertex-192"><a href="#Tile.merge_edges_at_vertex-192"><span class="linenos">192</span></a><span class="sd">    Returns:</span>
</span><span id="Tile.merge_edges_at_vertex-193"><a href="#Tile.merge_edges_at_vertex-193"><span class="linenos">193</span></a><span class="sd">      tuple: 2 item list of the edge IDs to be removed and a new Edge object to</span>
</span><span id="Tile.merge_edges_at_vertex-194"><a href="#Tile.merge_edges_at_vertex-194"><span class="linenos">194</span></a><span class="sd">        be added by the calling context (i.e. the containing Topology).</span>
</span><span id="Tile.merge_edges_at_vertex-195"><a href="#Tile.merge_edges_at_vertex-195"><span class="linenos">195</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Tile.merge_edges_at_vertex-196"><a href="#Tile.merge_edges_at_vertex-196"><span class="linenos">196</span></a>    <span class="n">to_remove</span><span class="p">,</span> <span class="n">new_edge</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_updated_edges_from_merge</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
</span><span id="Tile.merge_edges_at_vertex-197"><a href="#Tile.merge_edges_at_vertex-197"><span class="linenos">197</span></a>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">tiles</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="Tile.merge_edges_at_vertex-198"><a href="#Tile.merge_edges_at_vertex-198"><span class="linenos">198</span></a>      <span class="n">v</span><span class="o">.</span><span class="n">tiles</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">get_updated_edges_from_merge</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">new_edge</span><span class="p">)</span>
</span><span id="Tile.merge_edges_at_vertex-199"><a href="#Tile.merge_edges_at_vertex-199"><span class="linenos">199</span></a>    <span class="k">return</span> <span class="n">to_remove</span><span class="p">,</span> <span class="n">new_edge</span>
</span></pre></div>


            <div class="docstring"><p>Method to merge the edges that meet at the supplied Vertex. It is 
assumed that only two tiles are impacted this one, and its neighbour across
the Edge on which v lies. Both are updated. For this reason the work is
delegated to get_updated_edges_from_merge which is run on both affected
tiles, but only determines the edges to remove and the new edge to be added
once. See that method for details.</p>

<p>Args:
  v (Vertex): Vertex at which to merge Edges. This should currently be an
    end</p>

<p>Returns:
  tuple: 2 item list of the edge IDs to be removed and a new Edge object to
    be added by the calling context (i.e. the containing Topology).</p>
</div>


                            </div>
                            <div id="Tile.get_updated_edges_from_merge" class="classattr">
                                        <input id="Tile.get_updated_edges_from_merge-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_updated_edges_from_merge</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">v</span><span class="p">:</span> <span class="n"><a href="#Vertex">Vertex</a></span>,</span><span class="param">	<span class="n">new_edge</span><span class="p">:</span> <span class="n"><a href="#Edge">Edge</a></span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Tile.get_updated_edges_from_merge-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Tile.get_updated_edges_from_merge"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Tile.get_updated_edges_from_merge-201"><a href="#Tile.get_updated_edges_from_merge-201"><span class="linenos">201</span></a>  <span class="k">def</span> <span class="nf">get_updated_edges_from_merge</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">v</span><span class="p">:</span><span class="s2">&quot;Vertex&quot;</span><span class="p">,</span> <span class="n">new_edge</span><span class="p">:</span><span class="s2">&quot;Edge&quot;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
</span><span id="Tile.get_updated_edges_from_merge-202"><a href="#Tile.get_updated_edges_from_merge-202"><span class="linenos">202</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Updates the edges and edges_CW attributes based on insertion of </span>
</span><span id="Tile.get_updated_edges_from_merge-203"><a href="#Tile.get_updated_edges_from_merge-203"><span class="linenos">203</span></a><span class="sd">    the supplied Vertex. If new_edge is supplied then the neighbour tile at</span>
</span><span id="Tile.get_updated_edges_from_merge-204"><a href="#Tile.get_updated_edges_from_merge-204"><span class="linenos">204</span></a><span class="sd">    v has already created the needed new Edge and this Edge is the one that</span>
</span><span id="Tile.get_updated_edges_from_merge-205"><a href="#Tile.get_updated_edges_from_merge-205"><span class="linenos">205</span></a><span class="sd">    will be &#39;slotted in&#39; at the appropriate spot in the edges list.</span>
</span><span id="Tile.get_updated_edges_from_merge-206"><a href="#Tile.get_updated_edges_from_merge-206"><span class="linenos">206</span></a>
</span><span id="Tile.get_updated_edges_from_merge-207"><a href="#Tile.get_updated_edges_from_merge-207"><span class="linenos">207</span></a><span class="sd">    The edges_CW is also updated to maintain correct directions of the edges.</span>
</span><span id="Tile.get_updated_edges_from_merge-208"><a href="#Tile.get_updated_edges_from_merge-208"><span class="linenos">208</span></a><span class="sd">    The corners attribute is unaffected by these changes.</span>
</span><span id="Tile.get_updated_edges_from_merge-209"><a href="#Tile.get_updated_edges_from_merge-209"><span class="linenos">209</span></a>
</span><span id="Tile.get_updated_edges_from_merge-210"><a href="#Tile.get_updated_edges_from_merge-210"><span class="linenos">210</span></a><span class="sd">    Args:</span>
</span><span id="Tile.get_updated_edges_from_merge-211"><a href="#Tile.get_updated_edges_from_merge-211"><span class="linenos">211</span></a><span class="sd">      v (Vertex): existing Vertex at which to carry out the merge.</span>
</span><span id="Tile.get_updated_edges_from_merge-212"><a href="#Tile.get_updated_edges_from_merge-212"><span class="linenos">212</span></a><span class="sd">      new_edge (Edge, optional): if another Tile has already carried out this </span>
</span><span id="Tile.get_updated_edges_from_merge-213"><a href="#Tile.get_updated_edges_from_merge-213"><span class="linenos">213</span></a><span class="sd">        merge this should be the resulting new Edge for insertion into this </span>
</span><span id="Tile.get_updated_edges_from_merge-214"><a href="#Tile.get_updated_edges_from_merge-214"><span class="linenos">214</span></a><span class="sd">        Tile. Defaults to None (when the new Edge will be constructed).</span>
</span><span id="Tile.get_updated_edges_from_merge-215"><a href="#Tile.get_updated_edges_from_merge-215"><span class="linenos">215</span></a><span class="sd">  </span>
</span><span id="Tile.get_updated_edges_from_merge-216"><a href="#Tile.get_updated_edges_from_merge-216"><span class="linenos">216</span></a><span class="sd">    Returns:</span>
</span><span id="Tile.get_updated_edges_from_merge-217"><a href="#Tile.get_updated_edges_from_merge-217"><span class="linenos">217</span></a><span class="sd">      Union[None, tuple]: either None (if a new edge was supplied) or a tuple </span>
</span><span id="Tile.get_updated_edges_from_merge-218"><a href="#Tile.get_updated_edges_from_merge-218"><span class="linenos">218</span></a><span class="sd">        of the two edge IDs to be removed and the new edge added for return to</span>
</span><span id="Tile.get_updated_edges_from_merge-219"><a href="#Tile.get_updated_edges_from_merge-219"><span class="linenos">219</span></a><span class="sd">        the calling context (i.e. the containing Topology).</span>
</span><span id="Tile.get_updated_edges_from_merge-220"><a href="#Tile.get_updated_edges_from_merge-220"><span class="linenos">220</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Tile.get_updated_edges_from_merge-221"><a href="#Tile.get_updated_edges_from_merge-221"><span class="linenos">221</span></a>    <span class="c1"># get the two edge list index positions in which Vertex v is found</span>
</span><span id="Tile.get_updated_edges_from_merge-222"><a href="#Tile.get_updated_edges_from_merge-222"><span class="linenos">222</span></a>    <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_edge_IDs_including_vertex</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
</span><span id="Tile.get_updated_edges_from_merge-223"><a href="#Tile.get_updated_edges_from_merge-223"><span class="linenos">223</span></a>    <span class="k">if</span> <span class="n">new_edge</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="c1"># then we must make a new one</span>
</span><span id="Tile.get_updated_edges_from_merge-224"><a href="#Tile.get_updated_edges_from_merge-224"><span class="linenos">224</span></a>      <span class="c1"># also record existing edge IDs to be removed</span>
</span><span id="Tile.get_updated_edges_from_merge-225"><a href="#Tile.get_updated_edges_from_merge-225"><span class="linenos">225</span></a>      <span class="n">to_remove</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">ID</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">ID</span><span class="p">]</span>
</span><span id="Tile.get_updated_edges_from_merge-226"><a href="#Tile.get_updated_edges_from_merge-226"><span class="linenos">226</span></a>      <span class="n">new_edge</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_merged_edge</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span>
</span><span id="Tile.get_updated_edges_from_merge-227"><a href="#Tile.get_updated_edges_from_merge-227"><span class="linenos">227</span></a>      <span class="n">return_edge_updates</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="Tile.get_updated_edges_from_merge-228"><a href="#Tile.get_updated_edges_from_merge-228"><span class="linenos">228</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="Tile.get_updated_edges_from_merge-229"><a href="#Tile.get_updated_edges_from_merge-229"><span class="linenos">229</span></a>      <span class="n">return_edge_updates</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="Tile.get_updated_edges_from_merge-230"><a href="#Tile.get_updated_edges_from_merge-230"><span class="linenos">230</span></a>    <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">i</span> <span class="o">-</span> <span class="n">j</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="Tile.get_updated_edges_from_merge-231"><a href="#Tile.get_updated_edges_from_merge-231"><span class="linenos">231</span></a>      <span class="c1"># edge indices &#39;wrap&#39; around from end of edge list to start so drop </span>
</span><span id="Tile.get_updated_edges_from_merge-232"><a href="#Tile.get_updated_edges_from_merge-232"><span class="linenos">232</span></a>      <span class="c1"># first and last current edges and stick new one on at the end</span>
</span><span id="Tile.get_updated_edges_from_merge-233"><a href="#Tile.get_updated_edges_from_merge-233"><span class="linenos">233</span></a>      <span class="bp">self</span><span class="o">.</span><span class="n">edges</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="n">new_edge</span><span class="p">]</span> 
</span><span id="Tile.get_updated_edges_from_merge-234"><a href="#Tile.get_updated_edges_from_merge-234"><span class="linenos">234</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="Tile.get_updated_edges_from_merge-235"><a href="#Tile.get_updated_edges_from_merge-235"><span class="linenos">235</span></a>      <span class="c1"># insert new edge into list in place of the two old ones</span>
</span><span id="Tile.get_updated_edges_from_merge-236"><a href="#Tile.get_updated_edges_from_merge-236"><span class="linenos">236</span></a>      <span class="bp">self</span><span class="o">.</span><span class="n">edges</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">[:</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="n">new_edge</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">:]</span>
</span><span id="Tile.get_updated_edges_from_merge-237"><a href="#Tile.get_updated_edges_from_merge-237"><span class="linenos">237</span></a>    <span class="c1"># update the edge directions</span>
</span><span id="Tile.get_updated_edges_from_merge-238"><a href="#Tile.get_updated_edges_from_merge-238"><span class="linenos">238</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">set_edge_directions</span><span class="p">()</span>
</span><span id="Tile.get_updated_edges_from_merge-239"><a href="#Tile.get_updated_edges_from_merge-239"><span class="linenos">239</span></a>    <span class="k">if</span> <span class="n">return_edge_updates</span><span class="p">:</span>
</span><span id="Tile.get_updated_edges_from_merge-240"><a href="#Tile.get_updated_edges_from_merge-240"><span class="linenos">240</span></a>      <span class="k">return</span> <span class="n">to_remove</span><span class="p">,</span> <span class="n">new_edge</span>
</span><span id="Tile.get_updated_edges_from_merge-241"><a href="#Tile.get_updated_edges_from_merge-241"><span class="linenos">241</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="Tile.get_updated_edges_from_merge-242"><a href="#Tile.get_updated_edges_from_merge-242"><span class="linenos">242</span></a>      <span class="k">return</span> <span class="kc">None</span>
</span></pre></div>


            <div class="docstring"><p>Updates the edges and edges_CW attributes based on insertion of 
the supplied Vertex. If new_edge is supplied then the neighbour tile at
v has already created the needed new Edge and this Edge is the one that
will be 'slotted in' at the appropriate spot in the edges list.</p>

<p>The edges_CW is also updated to maintain correct directions of the edges.
The corners attribute is unaffected by these changes.</p>

<p>Args:
  v (Vertex): existing Vertex at which to carry out the merge.
  new_edge (Edge, optional): if another Tile has already carried out this 
    merge this should be the resulting new Edge for insertion into this 
    Tile. Defaults to None (when the new Edge will be constructed).</p>

<p>Returns:
  Union[None, tuple]: either None (if a new edge was supplied) or a tuple 
    of the two edge IDs to be removed and the new edge added for return to
    the calling context (i.e. the containing Topology).</p>
</div>


                            </div>
                            <div id="Tile.get_edge_IDs_including_vertex" class="classattr">
                                        <input id="Tile.get_edge_IDs_including_vertex-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_edge_IDs_including_vertex</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">v</span><span class="p">:</span> <span class="n"><a href="#Vertex">Vertex</a></span></span><span class="return-annotation">) -> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="Tile.get_edge_IDs_including_vertex-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Tile.get_edge_IDs_including_vertex"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Tile.get_edge_IDs_including_vertex-244"><a href="#Tile.get_edge_IDs_including_vertex-244"><span class="linenos">244</span></a>  <span class="k">def</span> <span class="nf">get_edge_IDs_including_vertex</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">v</span><span class="p">:</span><span class="s2">&quot;Vertex&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
</span><span id="Tile.get_edge_IDs_including_vertex-245"><a href="#Tile.get_edge_IDs_including_vertex-245"><span class="linenos">245</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Gets the (two) index positions of the edges that include supplied Vertex.</span>
</span><span id="Tile.get_edge_IDs_including_vertex-246"><a href="#Tile.get_edge_IDs_including_vertex-246"><span class="linenos">246</span></a>
</span><span id="Tile.get_edge_IDs_including_vertex-247"><a href="#Tile.get_edge_IDs_including_vertex-247"><span class="linenos">247</span></a><span class="sd">    Args:</span>
</span><span id="Tile.get_edge_IDs_including_vertex-248"><a href="#Tile.get_edge_IDs_including_vertex-248"><span class="linenos">248</span></a><span class="sd">        v (Vertex): Vertex of interest.</span>
</span><span id="Tile.get_edge_IDs_including_vertex-249"><a href="#Tile.get_edge_IDs_including_vertex-249"><span class="linenos">249</span></a>
</span><span id="Tile.get_edge_IDs_including_vertex-250"><a href="#Tile.get_edge_IDs_including_vertex-250"><span class="linenos">250</span></a><span class="sd">    Returns:</span>
</span><span id="Tile.get_edge_IDs_including_vertex-251"><a href="#Tile.get_edge_IDs_including_vertex-251"><span class="linenos">251</span></a><span class="sd">      tuple[int]: two index positions of Edges in edges list that contain v.</span>
</span><span id="Tile.get_edge_IDs_including_vertex-252"><a href="#Tile.get_edge_IDs_including_vertex-252"><span class="linenos">252</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Tile.get_edge_IDs_including_vertex-253"><a href="#Tile.get_edge_IDs_including_vertex-253"><span class="linenos">253</span></a>    <span class="k">return</span> <span class="p">(</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">e</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">)</span> <span class="k">if</span> <span class="n">v</span><span class="o">.</span><span class="n">ID</span> <span class="ow">in</span> <span class="n">e</span><span class="o">.</span><span class="n">ID</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Gets the (two) index positions of the edges that include supplied Vertex.</p>

<p>Args:
    v (Vertex): Vertex of interest.</p>

<p>Returns:
  tuple[int]: two index positions of Edges in edges list that contain v.</p>
</div>


                            </div>
                            <div id="Tile.get_merged_edge" class="classattr">
                                        <input id="Tile.get_merged_edge-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_merged_edge</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">i</span><span class="p">:</span> <span class="nb">int</span>, </span><span class="param"><span class="n">j</span><span class="p">:</span> <span class="nb">int</span></span><span class="return-annotation">) -> <span class="n"><a href="#Edge">Edge</a></span>:</span></span>

                <label class="view-source-button" for="Tile.get_merged_edge-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Tile.get_merged_edge"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Tile.get_merged_edge-255"><a href="#Tile.get_merged_edge-255"><span class="linenos">255</span></a>  <span class="k">def</span> <span class="nf">get_merged_edge</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">:</span><span class="nb">int</span><span class="p">,</span> <span class="n">j</span><span class="p">:</span><span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Edge&quot;</span><span class="p">:</span>
</span><span id="Tile.get_merged_edge-256"><a href="#Tile.get_merged_edge-256"><span class="linenos">256</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns the new edge resulting from merging the two existing edges at</span>
</span><span id="Tile.get_merged_edge-257"><a href="#Tile.get_merged_edge-257"><span class="linenos">257</span></a><span class="sd">    index positions i and j in the edges list. For example, if the current list </span>
</span><span id="Tile.get_merged_edge-258"><a href="#Tile.get_merged_edge-258"><span class="linenos">258</span></a><span class="sd">    of edge IDs was</span>
</span><span id="Tile.get_merged_edge-259"><a href="#Tile.get_merged_edge-259"><span class="linenos">259</span></a>
</span><span id="Tile.get_merged_edge-260"><a href="#Tile.get_merged_edge-260"><span class="linenos">260</span></a><span class="sd">        (0 1 2) (4 2) (4 5) (5 0)</span>
</span><span id="Tile.get_merged_edge-261"><a href="#Tile.get_merged_edge-261"><span class="linenos">261</span></a>
</span><span id="Tile.get_merged_edge-262"><a href="#Tile.get_merged_edge-262"><span class="linenos">262</span></a><span class="sd">    and the merge Vertex was #2, the resulting new edge is constructed from </span>
</span><span id="Tile.get_merged_edge-263"><a href="#Tile.get_merged_edge-263"><span class="linenos">263</span></a><span class="sd">    vertices (0 1 2 4). </span>
</span><span id="Tile.get_merged_edge-264"><a href="#Tile.get_merged_edge-264"><span class="linenos">264</span></a>
</span><span id="Tile.get_merged_edge-265"><a href="#Tile.get_merged_edge-265"><span class="linenos">265</span></a><span class="sd">    Returns:</span>
</span><span id="Tile.get_merged_edge-266"><a href="#Tile.get_merged_edge-266"><span class="linenos">266</span></a><span class="sd">      Edge: the requested new Edge.</span>
</span><span id="Tile.get_merged_edge-267"><a href="#Tile.get_merged_edge-267"><span class="linenos">267</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Tile.get_merged_edge-268"><a href="#Tile.get_merged_edge-268"><span class="linenos">268</span></a>    <span class="c1"># if i and j are not consecutive, then j is predecessor edge</span>
</span><span id="Tile.get_merged_edge-269"><a href="#Tile.get_merged_edge-269"><span class="linenos">269</span></a>    <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">i</span> <span class="o">-</span> <span class="n">j</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="Tile.get_merged_edge-270"><a href="#Tile.get_merged_edge-270"><span class="linenos">270</span></a>      <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="n">j</span><span class="p">,</span> <span class="n">i</span>
</span><span id="Tile.get_merged_edge-271"><a href="#Tile.get_merged_edge-271"><span class="linenos">271</span></a>    <span class="c1"># get edges and their directions</span>
</span><span id="Tile.get_merged_edge-272"><a href="#Tile.get_merged_edge-272"><span class="linenos">272</span></a>    <span class="n">ei</span><span class="p">,</span> <span class="n">ej</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
</span><span id="Tile.get_merged_edge-273"><a href="#Tile.get_merged_edge-273"><span class="linenos">273</span></a>    <span class="n">CWi</span><span class="p">,</span> <span class="n">CWj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges_CW</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges_CW</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
</span><span id="Tile.get_merged_edge-274"><a href="#Tile.get_merged_edge-274"><span class="linenos">274</span></a>    <span class="c1"># DON&#39;T MESS WITH THIS!!!</span>
</span><span id="Tile.get_merged_edge-275"><a href="#Tile.get_merged_edge-275"><span class="linenos">275</span></a>    <span class="c1"># for predecessors (the head) we want everything including the Vertex </span>
</span><span id="Tile.get_merged_edge-276"><a href="#Tile.get_merged_edge-276"><span class="linenos">276</span></a>    <span class="c1"># where the merge is occurring; for successors (the tail) we want all but </span>
</span><span id="Tile.get_merged_edge-277"><a href="#Tile.get_merged_edge-277"><span class="linenos">277</span></a>    <span class="c1"># the first Vertex (which is the one where the merge is occurring). In both </span>
</span><span id="Tile.get_merged_edge-278"><a href="#Tile.get_merged_edge-278"><span class="linenos">278</span></a>    <span class="c1"># cases contingent on whether existing Edges are CW or CCW we may need to </span>
</span><span id="Tile.get_merged_edge-279"><a href="#Tile.get_merged_edge-279"><span class="linenos">279</span></a>    <span class="c1"># flip the Vertex sequence to ensure that the merge Vertex is in the middle </span>
</span><span id="Tile.get_merged_edge-280"><a href="#Tile.get_merged_edge-280"><span class="linenos">280</span></a>    <span class="c1"># of the new edge that will be created</span>
</span><span id="Tile.get_merged_edge-281"><a href="#Tile.get_merged_edge-281"><span class="linenos">281</span></a>    <span class="n">head</span> <span class="o">=</span> <span class="n">ei</span><span class="o">.</span><span class="n">corners</span> <span class="k">if</span> <span class="n">CWi</span> <span class="k">else</span> <span class="n">ei</span><span class="o">.</span><span class="n">corners</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="Tile.get_merged_edge-282"><a href="#Tile.get_merged_edge-282"><span class="linenos">282</span></a>    <span class="n">tail</span> <span class="o">=</span> <span class="n">ej</span><span class="o">.</span><span class="n">corners</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="k">if</span> <span class="n">CWj</span> <span class="k">else</span> <span class="n">ej</span><span class="o">.</span><span class="n">corners</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">:]</span>
</span><span id="Tile.get_merged_edge-283"><a href="#Tile.get_merged_edge-283"><span class="linenos">283</span></a>    <span class="n">v_sequence</span> <span class="o">=</span> <span class="p">(</span><span class="n">head</span> <span class="k">if</span> <span class="n">CWi</span> <span class="k">else</span> <span class="n">head</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="p">(</span><span class="n">tail</span> <span class="k">if</span> <span class="n">CWj</span> <span class="k">else</span> <span class="n">tail</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</span><span id="Tile.get_merged_edge-284"><a href="#Tile.get_merged_edge-284"><span class="linenos">284</span></a>    <span class="k">return</span> <span class="n">Edge</span><span class="p">(</span><span class="n">v_sequence</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Returns the new edge resulting from merging the two existing edges at
index positions i and j in the edges list. For example, if the current list 
of edge IDs was</p>

<pre><code>(0 1 2) (4 2) (4 5) (5 0)
</code></pre>

<p>and the merge Vertex was #2, the resulting new edge is constructed from 
vertices (0 1 2 4). </p>

<p>Returns:
  Edge: the requested new Edge.</p>
</div>


                            </div>
                            <div id="Tile.offset_corners" class="classattr">
                                        <input id="Tile.offset_corners-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">offset_corners</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">offset</span><span class="p">:</span> <span class="nb">int</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Tile.offset_corners-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Tile.offset_corners"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Tile.offset_corners-286"><a href="#Tile.offset_corners-286"><span class="linenos">286</span></a>  <span class="k">def</span> <span class="nf">offset_corners</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">offset</span><span class="p">:</span><span class="nb">int</span><span class="p">):</span>
</span><span id="Tile.offset_corners-287"><a href="#Tile.offset_corners-287"><span class="linenos">287</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Shifts shape, corners, edges, and edges_CW by an offset amount. This is</span>
</span><span id="Tile.offset_corners-288"><a href="#Tile.offset_corners-288"><span class="linenos">288</span></a><span class="sd">    used to align tiles that are similar, which is required for correct </span>
</span><span id="Tile.offset_corners-289"><a href="#Tile.offset_corners-289"><span class="linenos">289</span></a><span class="sd">    transfer of &#39;base&#39; tile labelling on to &#39;radius 1&#39; tiles during Topology </span>
</span><span id="Tile.offset_corners-290"><a href="#Tile.offset_corners-290"><span class="linenos">290</span></a><span class="sd">    construction.</span>
</span><span id="Tile.offset_corners-291"><a href="#Tile.offset_corners-291"><span class="linenos">291</span></a>
</span><span id="Tile.offset_corners-292"><a href="#Tile.offset_corners-292"><span class="linenos">292</span></a><span class="sd">    Args:</span>
</span><span id="Tile.offset_corners-293"><a href="#Tile.offset_corners-293"><span class="linenos">293</span></a><span class="sd">      offset int: the number of positions to shift the lists.</span>
</span><span id="Tile.offset_corners-294"><a href="#Tile.offset_corners-294"><span class="linenos">294</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Tile.offset_corners-295"><a href="#Tile.offset_corners-295"><span class="linenos">295</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">offset</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">offset</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Tile.offset_corners-296"><a href="#Tile.offset_corners-296"><span class="linenos">296</span></a>      <span class="bp">self</span><span class="o">.</span><span class="n">shape</span> <span class="o">=</span> <span class="n">tiling_utils</span><span class="o">.</span><span class="n">offset_polygon_corners</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">offset</span><span class="p">)</span>
</span><span id="Tile.offset_corners-297"><a href="#Tile.offset_corners-297"><span class="linenos">297</span></a>      <span class="bp">self</span><span class="o">.</span><span class="n">corners</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">corners</span><span class="p">[</span><span class="n">offset</span><span class="p">:]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">corners</span><span class="p">[:</span><span class="n">offset</span><span class="p">]</span>
</span><span id="Tile.offset_corners-298"><a href="#Tile.offset_corners-298"><span class="linenos">298</span></a>      <span class="bp">self</span><span class="o">.</span><span class="n">edges</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">offset</span><span class="p">:]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">[:</span><span class="n">offset</span><span class="p">]</span>
</span><span id="Tile.offset_corners-299"><a href="#Tile.offset_corners-299"><span class="linenos">299</span></a>      <span class="bp">self</span><span class="o">.</span><span class="n">edges_CW</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges_CW</span><span class="p">[</span><span class="n">offset</span><span class="p">:]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges_CW</span><span class="p">[:</span><span class="n">offset</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Shifts shape, corners, edges, and edges_CW by an offset amount. This is
used to align tiles that are similar, which is required for correct 
transfer of 'base' tile labelling on to 'radius 1' tiles during Topology 
construction.</p>

<p>Args:
  offset int: the number of positions to shift the lists.</p>
</div>


                            </div>
                            <div id="Tile.get_edge_label" class="classattr">
                                        <input id="Tile.get_edge_label-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_edge_label</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">e</span><span class="p">:</span> <span class="n"><a href="#Edge">Edge</a></span></span><span class="return-annotation">) -> <span class="nb">str</span>:</span></span>

                <label class="view-source-button" for="Tile.get_edge_label-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Tile.get_edge_label"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Tile.get_edge_label-301"><a href="#Tile.get_edge_label-301"><span class="linenos">301</span></a>  <span class="k">def</span> <span class="nf">get_edge_label</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">e</span><span class="p">:</span><span class="s2">&quot;Edge&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="Tile.get_edge_label-302"><a href="#Tile.get_edge_label-302"><span class="linenos">302</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns edge label of specified edge.</span>
</span><span id="Tile.get_edge_label-303"><a href="#Tile.get_edge_label-303"><span class="linenos">303</span></a>
</span><span id="Tile.get_edge_label-304"><a href="#Tile.get_edge_label-304"><span class="linenos">304</span></a><span class="sd">    Args:</span>
</span><span id="Tile.get_edge_label-305"><a href="#Tile.get_edge_label-305"><span class="linenos">305</span></a><span class="sd">        e (Edge): Edge whose label is required.</span>
</span><span id="Tile.get_edge_label-306"><a href="#Tile.get_edge_label-306"><span class="linenos">306</span></a>
</span><span id="Tile.get_edge_label-307"><a href="#Tile.get_edge_label-307"><span class="linenos">307</span></a><span class="sd">    Returns:</span>
</span><span id="Tile.get_edge_label-308"><a href="#Tile.get_edge_label-308"><span class="linenos">308</span></a><span class="sd">        str: requested edge label.</span>
</span><span id="Tile.get_edge_label-309"><a href="#Tile.get_edge_label-309"><span class="linenos">309</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Tile.get_edge_label-310"><a href="#Tile.get_edge_label-310"><span class="linenos">310</span></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">edge_labels</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">get_edge_IDs</span><span class="p">()</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">ID</span><span class="p">)]</span>
</span></pre></div>


            <div class="docstring"><p>Returns edge label of specified edge.</p>

<p>Args:
    e (Edge): Edge whose label is required.</p>

<p>Returns:
    str: requested edge label.</p>
</div>


                            </div>
                            <div id="Tile.get_corner_label" class="classattr">
                                        <input id="Tile.get_corner_label-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_corner_label</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">v</span><span class="p">:</span> <span class="n"><a href="#Vertex">Vertex</a></span></span><span class="return-annotation">) -> <span class="nb">str</span>:</span></span>

                <label class="view-source-button" for="Tile.get_corner_label-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Tile.get_corner_label"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Tile.get_corner_label-312"><a href="#Tile.get_corner_label-312"><span class="linenos">312</span></a>  <span class="k">def</span> <span class="nf">get_corner_label</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">v</span><span class="p">:</span><span class="s2">&quot;Vertex&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="Tile.get_corner_label-313"><a href="#Tile.get_corner_label-313"><span class="linenos">313</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns corner label of specified corner.</span>
</span><span id="Tile.get_corner_label-314"><a href="#Tile.get_corner_label-314"><span class="linenos">314</span></a>
</span><span id="Tile.get_corner_label-315"><a href="#Tile.get_corner_label-315"><span class="linenos">315</span></a><span class="sd">    Args:</span>
</span><span id="Tile.get_corner_label-316"><a href="#Tile.get_corner_label-316"><span class="linenos">316</span></a><span class="sd">        v (Vertex): corner whose label is required.</span>
</span><span id="Tile.get_corner_label-317"><a href="#Tile.get_corner_label-317"><span class="linenos">317</span></a>
</span><span id="Tile.get_corner_label-318"><a href="#Tile.get_corner_label-318"><span class="linenos">318</span></a><span class="sd">    Returns:</span>
</span><span id="Tile.get_corner_label-319"><a href="#Tile.get_corner_label-319"><span class="linenos">319</span></a><span class="sd">        str: requested corner label.</span>
</span><span id="Tile.get_corner_label-320"><a href="#Tile.get_corner_label-320"><span class="linenos">320</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Tile.get_corner_label-321"><a href="#Tile.get_corner_label-321"><span class="linenos">321</span></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">edge_labels</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">get_corner_IDs</span><span class="p">()</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">ID</span><span class="p">)]</span>
</span></pre></div>


            <div class="docstring"><p>Returns corner label of specified corner.</p>

<p>Args:
    v (Vertex): corner whose label is required.</p>

<p>Returns:
    str: requested corner label.</p>
</div>


                            </div>
                            <div id="Tile.get_vertex_label_positions" class="classattr">
                                        <input id="Tile.get_vertex_label_positions-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_vertex_label_positions</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="nb">list</span><span class="p">[</span><span class="n">shapely</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">point</span><span class="o">.</span><span class="n">Point</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="Tile.get_vertex_label_positions-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Tile.get_vertex_label_positions"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Tile.get_vertex_label_positions-323"><a href="#Tile.get_vertex_label_positions-323"><span class="linenos">323</span></a>  <span class="k">def</span> <span class="nf">get_vertex_label_positions</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">geom</span><span class="o">.</span><span class="n">Point</span><span class="p">]:</span>
</span><span id="Tile.get_vertex_label_positions-324"><a href="#Tile.get_vertex_label_positions-324"><span class="linenos">324</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns a viable location at which to position corner labels inside</span>
</span><span id="Tile.get_vertex_label_positions-325"><a href="#Tile.get_vertex_label_positions-325"><span class="linenos">325</span></a><span class="sd">    tile shape. The method is convoluted because a negative buffer may remove</span>
</span><span id="Tile.get_vertex_label_positions-326"><a href="#Tile.get_vertex_label_positions-326"><span class="linenos">326</span></a><span class="sd">    colinear corners resulting in fewer positions than we have corners in the</span>
</span><span id="Tile.get_vertex_label_positions-327"><a href="#Tile.get_vertex_label_positions-327"><span class="linenos">327</span></a><span class="sd">    tile shape!</span>
</span><span id="Tile.get_vertex_label_positions-328"><a href="#Tile.get_vertex_label_positions-328"><span class="linenos">328</span></a>
</span><span id="Tile.get_vertex_label_positions-329"><a href="#Tile.get_vertex_label_positions-329"><span class="linenos">329</span></a><span class="sd">    Returns:</span>
</span><span id="Tile.get_vertex_label_positions-330"><a href="#Tile.get_vertex_label_positions-330"><span class="linenos">330</span></a><span class="sd">        list[geom.Point]: list of locations.</span>
</span><span id="Tile.get_vertex_label_positions-331"><a href="#Tile.get_vertex_label_positions-331"><span class="linenos">331</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Tile.get_vertex_label_positions-332"><a href="#Tile.get_vertex_label_positions-332"><span class="linenos">332</span></a>    <span class="n">d</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="o">.</span><span class="n">area</span> <span class="o">**</span> <span class="mf">0.5</span><span class="p">)</span> <span class="o">/</span> <span class="mi">8</span>
</span><span id="Tile.get_vertex_label_positions-333"><a href="#Tile.get_vertex_label_positions-333"><span class="linenos">333</span></a>    <span class="n">c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">centre</span>
</span><span id="Tile.get_vertex_label_positions-334"><a href="#Tile.get_vertex_label_positions-334"><span class="linenos">334</span></a>    <span class="n">corners</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span><span class="o">.</span><span class="n">point</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">corners</span><span class="p">]</span>
</span><span id="Tile.get_vertex_label_positions-335"><a href="#Tile.get_vertex_label_positions-335"><span class="linenos">335</span></a>    <span class="k">return</span> <span class="p">[</span><span class="n">geom</span><span class="o">.</span><span class="n">LineString</span><span class="p">([</span><span class="n">p</span><span class="p">,</span> <span class="n">c</span><span class="p">])</span><span class="o">.</span><span class="n">line_interpolate_point</span><span class="p">(</span><span class="n">d</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">corners</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Returns a viable location at which to position corner labels inside
tile shape. The method is convoluted because a negative buffer may remove
colinear corners resulting in fewer positions than we have corners in the
tile shape!</p>

<p>Returns:
    list[geom.Point]: list of locations.</p>
</div>


                            </div>
                            <div id="Tile.get_edge_label_positions" class="classattr">
                                        <input id="Tile.get_edge_label_positions-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_edge_label_positions</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="nb">list</span><span class="p">[</span><span class="n">shapely</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">point</span><span class="o">.</span><span class="n">Point</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="Tile.get_edge_label_positions-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Tile.get_edge_label_positions"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Tile.get_edge_label_positions-337"><a href="#Tile.get_edge_label_positions-337"><span class="linenos">337</span></a>  <span class="k">def</span> <span class="nf">get_edge_label_positions</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">geom</span><span class="o">.</span><span class="n">Point</span><span class="p">]:</span>
</span><span id="Tile.get_edge_label_positions-338"><a href="#Tile.get_edge_label_positions-338"><span class="linenos">338</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns a reasonable location at which to position edge labels inside</span>
</span><span id="Tile.get_edge_label_positions-339"><a href="#Tile.get_edge_label_positions-339"><span class="linenos">339</span></a><span class="sd">    tile shape.</span>
</span><span id="Tile.get_edge_label_positions-340"><a href="#Tile.get_edge_label_positions-340"><span class="linenos">340</span></a>
</span><span id="Tile.get_edge_label_positions-341"><a href="#Tile.get_edge_label_positions-341"><span class="linenos">341</span></a><span class="sd">    Returns:</span>
</span><span id="Tile.get_edge_label_positions-342"><a href="#Tile.get_edge_label_positions-342"><span class="linenos">342</span></a><span class="sd">        list[geom.Point]: list of locations</span>
</span><span id="Tile.get_edge_label_positions-343"><a href="#Tile.get_edge_label_positions-343"><span class="linenos">343</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Tile.get_edge_label_positions-344"><a href="#Tile.get_edge_label_positions-344"><span class="linenos">344</span></a>    <span class="n">d</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="o">.</span><span class="n">area</span> <span class="o">**</span> <span class="mf">0.5</span><span class="p">)</span> <span class="o">/</span> <span class="mi">8</span>
</span><span id="Tile.get_edge_label_positions-345"><a href="#Tile.get_edge_label_positions-345"><span class="linenos">345</span></a>    <span class="n">c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">centre</span>
</span><span id="Tile.get_edge_label_positions-346"><a href="#Tile.get_edge_label_positions-346"><span class="linenos">346</span></a>    <span class="c1"># note direction is important as edge might not be a simple line segment</span>
</span><span id="Tile.get_edge_label_positions-347"><a href="#Tile.get_edge_label_positions-347"><span class="linenos">347</span></a>    <span class="n">sides</span> <span class="o">=</span> <span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">get_geometry</span><span class="p">(</span><span class="n">CW</span><span class="p">)</span> <span class="k">for</span> <span class="n">e</span><span class="p">,</span> <span class="n">CW</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges_CW</span><span class="p">)]</span>
</span><span id="Tile.get_edge_label_positions-348"><a href="#Tile.get_edge_label_positions-348"><span class="linenos">348</span></a>    <span class="k">return</span> <span class="p">[</span><span class="n">geom</span><span class="o">.</span><span class="n">LineString</span><span class="p">([</span><span class="n">s</span><span class="o">.</span><span class="n">centroid</span><span class="p">,</span> <span class="n">c</span><span class="p">])</span><span class="o">.</span><span class="n">line_interpolate_point</span><span class="p">(</span><span class="n">d</span><span class="p">)</span> 
</span><span id="Tile.get_edge_label_positions-349"><a href="#Tile.get_edge_label_positions-349"><span class="linenos">349</span></a>            <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">sides</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Returns a reasonable location at which to position edge labels inside
tile shape.</p>

<p>Returns:
    list[geom.Point]: list of locations</p>
</div>


                            </div>
                            <div id="Tile.angle_at" class="classattr">
                                        <input id="Tile.angle_at-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">angle_at</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">v</span><span class="p">:</span> <span class="n"><a href="#Vertex">Vertex</a></span></span><span class="return-annotation">) -> <span class="nb">float</span>:</span></span>

                <label class="view-source-button" for="Tile.angle_at-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Tile.angle_at"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Tile.angle_at-351"><a href="#Tile.angle_at-351"><span class="linenos">351</span></a>  <span class="k">def</span> <span class="nf">angle_at</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">v</span><span class="p">:</span><span class="s2">&quot;Vertex&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="Tile.angle_at-352"><a href="#Tile.angle_at-352"><span class="linenos">352</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns interior angle at the specified corner (in degrees).</span>
</span><span id="Tile.angle_at-353"><a href="#Tile.angle_at-353"><span class="linenos">353</span></a>
</span><span id="Tile.angle_at-354"><a href="#Tile.angle_at-354"><span class="linenos">354</span></a><span class="sd">    Args:</span>
</span><span id="Tile.angle_at-355"><a href="#Tile.angle_at-355"><span class="linenos">355</span></a><span class="sd">        v (Vertex): corner where angle is requested.</span>
</span><span id="Tile.angle_at-356"><a href="#Tile.angle_at-356"><span class="linenos">356</span></a>
</span><span id="Tile.angle_at-357"><a href="#Tile.angle_at-357"><span class="linenos">357</span></a><span class="sd">    Returns:</span>
</span><span id="Tile.angle_at-358"><a href="#Tile.angle_at-358"><span class="linenos">358</span></a><span class="sd">        float: angle at corner v in degrees.</span>
</span><span id="Tile.angle_at-359"><a href="#Tile.angle_at-359"><span class="linenos">359</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Tile.angle_at-360"><a href="#Tile.angle_at-360"><span class="linenos">360</span></a>    <span class="n">i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">corners</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
</span><span id="Tile.angle_at-361"><a href="#Tile.angle_at-361"><span class="linenos">361</span></a>    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">corners</span><span class="p">)</span>
</span><span id="Tile.angle_at-362"><a href="#Tile.angle_at-362"><span class="linenos">362</span></a>    <span class="k">return</span> <span class="n">tiling_utils</span><span class="o">.</span><span class="n">get_inner_angle</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">corners</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">point</span><span class="p">,</span>
</span><span id="Tile.angle_at-363"><a href="#Tile.angle_at-363"><span class="linenos">363</span></a>                                        <span class="bp">self</span><span class="o">.</span><span class="n">corners</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">point</span><span class="p">,</span>
</span><span id="Tile.angle_at-364"><a href="#Tile.angle_at-364"><span class="linenos">364</span></a>                                        <span class="bp">self</span><span class="o">.</span><span class="n">corners</span><span class="p">[(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="n">n</span><span class="p">]</span><span class="o">.</span><span class="n">point</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Returns interior angle at the specified corner (in degrees).</p>

<p>Args:
    v (Vertex): corner where angle is requested.</p>

<p>Returns:
    float: angle at corner v in degrees.</p>
</div>


                            </div>
                </section>
                <section id="Vertex">
                            <input id="Vertex-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">Vertex</span>:

                <label class="view-source-button" for="Vertex-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Vertex"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Vertex-367"><a href="#Vertex-367"><span class="linenos">367</span></a><span class="k">class</span> <span class="nc">Vertex</span><span class="p">:</span>
</span><span id="Vertex-368"><a href="#Vertex-368"><span class="linenos">368</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;Class to store attributes of a vertex in a tiling.&quot;&quot;&quot;</span>
</span><span id="Vertex-369"><a href="#Vertex-369"><span class="linenos">369</span></a>  <span class="n">point</span><span class="p">:</span> <span class="n">geom</span><span class="o">.</span><span class="n">Point</span>
</span><span id="Vertex-370"><a href="#Vertex-370"><span class="linenos">370</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;point (geom.Point): point location of the vertex.&quot;&quot;&quot;</span>
</span><span id="Vertex-371"><a href="#Vertex-371"><span class="linenos">371</span></a>  <span class="n">ID</span><span class="p">:</span> <span class="nb">int</span>
</span><span id="Vertex-372"><a href="#Vertex-372"><span class="linenos">372</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;integer (mostly but not necessarily in sequence) of vertex keyed into the </span>
</span><span id="Vertex-373"><a href="#Vertex-373"><span class="linenos">373</span></a><span class="sd">  points dictionary of the containing Topology.&quot;&quot;&quot;</span>
</span><span id="Vertex-374"><a href="#Vertex-374"><span class="linenos">374</span></a>  <span class="n">tiles</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="s2">&quot;Tile&quot;</span><span class="p">]</span>
</span><span id="Vertex-375"><a href="#Vertex-375"><span class="linenos">375</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;list of Tiles incident on this vertex.&quot;&quot;&quot;</span>
</span><span id="Vertex-376"><a href="#Vertex-376"><span class="linenos">376</span></a>  <span class="n">neighbours</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span>
</span><span id="Vertex-377"><a href="#Vertex-377"><span class="linenos">377</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;list of the immediately adjacent other corner IDs. Only required to </span>
</span><span id="Vertex-378"><a href="#Vertex-378"><span class="linenos">378</span></a><span class="sd">  determine if a point is a tiling vertex (when it will have) three or more </span>
</span><span id="Vertex-379"><a href="#Vertex-379"><span class="linenos">379</span></a><span class="sd">  neighbours, so only IDs are stored.&quot;&quot;&quot;</span>
</span><span id="Vertex-380"><a href="#Vertex-380"><span class="linenos">380</span></a>  <span class="n">base_ID</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1_000_000</span>
</span><span id="Vertex-381"><a href="#Vertex-381"><span class="linenos">381</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;ID of corresponding Vertex in the tileable base_unit&quot;&quot;&quot;</span>
</span><span id="Vertex-382"><a href="#Vertex-382"><span class="linenos">382</span></a>  <span class="n">transitivity_class</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Vertex-383"><a href="#Vertex-383"><span class="linenos">383</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;transitivity class of the vertex under symmetries of the tiling&quot;&quot;&quot;</span>
</span><span id="Vertex-384"><a href="#Vertex-384"><span class="linenos">384</span></a>  <span class="n">label</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="Vertex-385"><a href="#Vertex-385"><span class="linenos">385</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;the (upper case letter) label of the vertex under the symmetries of the </span>
</span><span id="Vertex-386"><a href="#Vertex-386"><span class="linenos">386</span></a><span class="sd">  tiling.&quot;&quot;&quot;</span>
</span><span id="Vertex-387"><a href="#Vertex-387"><span class="linenos">387</span></a>  <span class="n">is_tiling_vertex</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="Vertex-388"><a href="#Vertex-388"><span class="linenos">388</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;is_tiling_vertex (bool): True if this is a tiling vertex, rather than a </span>
</span><span id="Vertex-389"><a href="#Vertex-389"><span class="linenos">389</span></a><span class="sd">  tile corner. E.g., A below is a corner, not a tiling vertex. B is a tiling </span>
</span><span id="Vertex-390"><a href="#Vertex-390"><span class="linenos">390</span></a><span class="sd">  vertex:</span>
</span><span id="Vertex-391"><a href="#Vertex-391"><span class="linenos">391</span></a><span class="sd">      </span>
</span><span id="Vertex-392"><a href="#Vertex-392"><span class="linenos">392</span></a><span class="sd">      +-------+</span>
</span><span id="Vertex-393"><a href="#Vertex-393"><span class="linenos">393</span></a><span class="sd">      | 1     |</span>
</span><span id="Vertex-394"><a href="#Vertex-394"><span class="linenos">394</span></a><span class="sd">      |   A---B---+</span>
</span><span id="Vertex-395"><a href="#Vertex-395"><span class="linenos">395</span></a><span class="sd">      |   | 2     |</span>
</span><span id="Vertex-396"><a href="#Vertex-396"><span class="linenos">396</span></a><span class="sd">      +---C   +---+</span>
</span><span id="Vertex-397"><a href="#Vertex-397"><span class="linenos">397</span></a><span class="sd">          |   |</span>
</span><span id="Vertex-398"><a href="#Vertex-398"><span class="linenos">398</span></a><span class="sd">          +---+&quot;&quot;&quot;</span>
</span><span id="Vertex-399"><a href="#Vertex-399"><span class="linenos">399</span></a>  
</span><span id="Vertex-400"><a href="#Vertex-400"><span class="linenos">400</span></a>  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">point</span><span class="p">:</span><span class="n">geom</span><span class="o">.</span><span class="n">Point</span><span class="p">,</span> <span class="n">ID</span><span class="p">:</span><span class="nb">int</span><span class="p">):</span>
</span><span id="Vertex-401"><a href="#Vertex-401"><span class="linenos">401</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Class constructor.</span>
</span><span id="Vertex-402"><a href="#Vertex-402"><span class="linenos">402</span></a>
</span><span id="Vertex-403"><a href="#Vertex-403"><span class="linenos">403</span></a><span class="sd">    Args:</span>
</span><span id="Vertex-404"><a href="#Vertex-404"><span class="linenos">404</span></a><span class="sd">      point (geom.Point): point location of the vertex.</span>
</span><span id="Vertex-405"><a href="#Vertex-405"><span class="linenos">405</span></a><span class="sd">      ID (int): a unique integer ID (which will be its key in the containing</span>
</span><span id="Vertex-406"><a href="#Vertex-406"><span class="linenos">406</span></a><span class="sd">        Topology points dictionary).</span>
</span><span id="Vertex-407"><a href="#Vertex-407"><span class="linenos">407</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Vertex-408"><a href="#Vertex-408"><span class="linenos">408</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">point</span> <span class="o">=</span> <span class="n">point</span>
</span><span id="Vertex-409"><a href="#Vertex-409"><span class="linenos">409</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">ID</span> <span class="o">=</span> <span class="n">ID</span>
</span><span id="Vertex-410"><a href="#Vertex-410"><span class="linenos">410</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">base_ID</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ID</span>
</span><span id="Vertex-411"><a href="#Vertex-411"><span class="linenos">411</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">tiles</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Vertex-412"><a href="#Vertex-412"><span class="linenos">412</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">neighbours</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Vertex-413"><a href="#Vertex-413"><span class="linenos">413</span></a>
</span><span id="Vertex-414"><a href="#Vertex-414"><span class="linenos">414</span></a>  <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="Vertex-415"><a href="#Vertex-415"><span class="linenos">415</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns string representation of Vertex.</span>
</span><span id="Vertex-416"><a href="#Vertex-416"><span class="linenos">416</span></a><span class="sd">    </span>
</span><span id="Vertex-417"><a href="#Vertex-417"><span class="linenos">417</span></a><span class="sd">    Returns:</span>
</span><span id="Vertex-418"><a href="#Vertex-418"><span class="linenos">418</span></a><span class="sd">        str: string including ID, point and list of incident Tiles.</span>
</span><span id="Vertex-419"><a href="#Vertex-419"><span class="linenos">419</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Vertex-420"><a href="#Vertex-420"><span class="linenos">420</span></a>    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;Vertex </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">ID</span><span class="si">}</span><span class="s2"> at </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">point</span><span class="si">}</span><span class="s2"> Tiles: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">get_tile_IDs</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="Vertex-421"><a href="#Vertex-421"><span class="linenos">421</span></a>
</span><span id="Vertex-422"><a href="#Vertex-422"><span class="linenos">422</span></a>  <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="Vertex-423"><a href="#Vertex-423"><span class="linenos">423</span></a>    <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="Vertex-424"><a href="#Vertex-424"><span class="linenos">424</span></a>
</span><span id="Vertex-425"><a href="#Vertex-425"><span class="linenos">425</span></a>  <span class="k">def</span> <span class="nf">get_tile_IDs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
</span><span id="Vertex-426"><a href="#Vertex-426"><span class="linenos">426</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Convenience method to return list of Tile IDs (not the Tiles themselves).</span>
</span><span id="Vertex-427"><a href="#Vertex-427"><span class="linenos">427</span></a>
</span><span id="Vertex-428"><a href="#Vertex-428"><span class="linenos">428</span></a><span class="sd">    Returns:</span>
</span><span id="Vertex-429"><a href="#Vertex-429"><span class="linenos">429</span></a><span class="sd">        list[int]: list of Tile IDs</span>
</span><span id="Vertex-430"><a href="#Vertex-430"><span class="linenos">430</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Vertex-431"><a href="#Vertex-431"><span class="linenos">431</span></a>    <span class="k">return</span> <span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">ID</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tiles</span><span class="p">]</span>
</span><span id="Vertex-432"><a href="#Vertex-432"><span class="linenos">432</span></a>
</span><span id="Vertex-433"><a href="#Vertex-433"><span class="linenos">433</span></a>  <span class="k">def</span> <span class="nf">add_tile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tile</span><span class="p">:</span><span class="n">Tile</span><span class="p">):</span>
</span><span id="Vertex-434"><a href="#Vertex-434"><span class="linenos">434</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Adds supplied Tile to the tiles list if it is not already present.</span>
</span><span id="Vertex-435"><a href="#Vertex-435"><span class="linenos">435</span></a>
</span><span id="Vertex-436"><a href="#Vertex-436"><span class="linenos">436</span></a><span class="sd">    Args:</span>
</span><span id="Vertex-437"><a href="#Vertex-437"><span class="linenos">437</span></a><span class="sd">        tile (Tile): Tile to add.</span>
</span><span id="Vertex-438"><a href="#Vertex-438"><span class="linenos">438</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Vertex-439"><a href="#Vertex-439"><span class="linenos">439</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">tile</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tiles</span><span class="p">:</span>
</span><span id="Vertex-440"><a href="#Vertex-440"><span class="linenos">440</span></a>      <span class="bp">self</span><span class="o">.</span><span class="n">tiles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tile</span><span class="p">)</span>
</span><span id="Vertex-441"><a href="#Vertex-441"><span class="linenos">441</span></a>
</span><span id="Vertex-442"><a href="#Vertex-442"><span class="linenos">442</span></a>  <span class="k">def</span> <span class="nf">add_neighbour</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vertex_id</span><span class="p">:</span><span class="nb">int</span><span class="p">):</span>
</span><span id="Vertex-443"><a href="#Vertex-443"><span class="linenos">443</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Adds supplied ID to the neighbours list if it is not already present</span>
</span><span id="Vertex-444"><a href="#Vertex-444"><span class="linenos">444</span></a>
</span><span id="Vertex-445"><a href="#Vertex-445"><span class="linenos">445</span></a><span class="sd">    Args:</span>
</span><span id="Vertex-446"><a href="#Vertex-446"><span class="linenos">446</span></a><span class="sd">      vertex_id (int): ID to add to the neighbours list.</span>
</span><span id="Vertex-447"><a href="#Vertex-447"><span class="linenos">447</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Vertex-448"><a href="#Vertex-448"><span class="linenos">448</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">vertex_id</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">neighbours</span><span class="p">:</span>
</span><span id="Vertex-449"><a href="#Vertex-449"><span class="linenos">449</span></a>      <span class="bp">self</span><span class="o">.</span><span class="n">neighbours</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">vertex_id</span><span class="p">)</span>
</span><span id="Vertex-450"><a href="#Vertex-450"><span class="linenos">450</span></a>
</span><span id="Vertex-451"><a href="#Vertex-451"><span class="linenos">451</span></a>  <span class="k">def</span> <span class="nf">clockwise_order_incident_tiles</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Vertex-452"><a href="#Vertex-452"><span class="linenos">452</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Reorders the tiles list clockwise (this is for dual tiling construction)</span>
</span><span id="Vertex-453"><a href="#Vertex-453"><span class="linenos">453</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Vertex-454"><a href="#Vertex-454"><span class="linenos">454</span></a>    <span class="n">cw_order</span> <span class="o">=</span> <span class="n">tiling_utils</span><span class="o">.</span><span class="n">order_of_pts_cw_around_centre</span><span class="p">(</span>
</span><span id="Vertex-455"><a href="#Vertex-455"><span class="linenos">455</span></a>      <span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">centre</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tiles</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">point</span><span class="p">)</span>
</span><span id="Vertex-456"><a href="#Vertex-456"><span class="linenos">456</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">tiles</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">tiles</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">cw_order</span><span class="p">]</span>
</span><span id="Vertex-457"><a href="#Vertex-457"><span class="linenos">457</span></a>
</span><span id="Vertex-458"><a href="#Vertex-458"><span class="linenos">458</span></a>  <span class="k">def</span> <span class="nf">is_interior</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="Vertex-459"><a href="#Vertex-459"><span class="linenos">459</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Tests if vertex is completely enclosed by its incident Tiles. Based on</span>
</span><span id="Vertex-460"><a href="#Vertex-460"><span class="linenos">460</span></a><span class="sd">    summing the interior angles of the incident tiles at this vertex.</span>
</span><span id="Vertex-461"><a href="#Vertex-461"><span class="linenos">461</span></a>
</span><span id="Vertex-462"><a href="#Vertex-462"><span class="linenos">462</span></a><span class="sd">    Returns:</span>
</span><span id="Vertex-463"><a href="#Vertex-463"><span class="linenos">463</span></a><span class="sd">        bool: True if vertex is completely enclosed by incident Tiles.</span>
</span><span id="Vertex-464"><a href="#Vertex-464"><span class="linenos">464</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Vertex-465"><a href="#Vertex-465"><span class="linenos">465</span></a>    <span class="k">return</span> <span class="nb">abs</span><span class="p">(</span><span class="mi">360</span> <span class="o">-</span> <span class="nb">sum</span><span class="p">([</span><span class="n">t</span><span class="o">.</span><span class="n">angle_at</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tiles</span><span class="p">]))</span> \
</span><span id="Vertex-466"><a href="#Vertex-466"><span class="linenos">466</span></a>                     <span class="o">&lt;</span> <span class="n">tiling_utils</span><span class="o">.</span><span class="n">RESOLUTION</span>
</span></pre></div>


            <div class="docstring"><p>Class to store attributes of a vertex in a tiling.</p>
</div>


                            <div id="Vertex.__init__" class="classattr">
                                        <input id="Vertex.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">Vertex</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">point</span><span class="p">:</span> <span class="n">shapely</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">point</span><span class="o">.</span><span class="n">Point</span>, </span><span class="param"><span class="n">ID</span><span class="p">:</span> <span class="nb">int</span></span>)</span>

                <label class="view-source-button" for="Vertex.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Vertex.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Vertex.__init__-400"><a href="#Vertex.__init__-400"><span class="linenos">400</span></a>  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">point</span><span class="p">:</span><span class="n">geom</span><span class="o">.</span><span class="n">Point</span><span class="p">,</span> <span class="n">ID</span><span class="p">:</span><span class="nb">int</span><span class="p">):</span>
</span><span id="Vertex.__init__-401"><a href="#Vertex.__init__-401"><span class="linenos">401</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Class constructor.</span>
</span><span id="Vertex.__init__-402"><a href="#Vertex.__init__-402"><span class="linenos">402</span></a>
</span><span id="Vertex.__init__-403"><a href="#Vertex.__init__-403"><span class="linenos">403</span></a><span class="sd">    Args:</span>
</span><span id="Vertex.__init__-404"><a href="#Vertex.__init__-404"><span class="linenos">404</span></a><span class="sd">      point (geom.Point): point location of the vertex.</span>
</span><span id="Vertex.__init__-405"><a href="#Vertex.__init__-405"><span class="linenos">405</span></a><span class="sd">      ID (int): a unique integer ID (which will be its key in the containing</span>
</span><span id="Vertex.__init__-406"><a href="#Vertex.__init__-406"><span class="linenos">406</span></a><span class="sd">        Topology points dictionary).</span>
</span><span id="Vertex.__init__-407"><a href="#Vertex.__init__-407"><span class="linenos">407</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Vertex.__init__-408"><a href="#Vertex.__init__-408"><span class="linenos">408</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">point</span> <span class="o">=</span> <span class="n">point</span>
</span><span id="Vertex.__init__-409"><a href="#Vertex.__init__-409"><span class="linenos">409</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">ID</span> <span class="o">=</span> <span class="n">ID</span>
</span><span id="Vertex.__init__-410"><a href="#Vertex.__init__-410"><span class="linenos">410</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">base_ID</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ID</span>
</span><span id="Vertex.__init__-411"><a href="#Vertex.__init__-411"><span class="linenos">411</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">tiles</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Vertex.__init__-412"><a href="#Vertex.__init__-412"><span class="linenos">412</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">neighbours</span> <span class="o">=</span> <span class="p">[]</span>
</span></pre></div>


            <div class="docstring"><p>Class constructor.</p>

<p>Args:
  point (geom.Point): point location of the vertex.
  ID (int): a unique integer ID (which will be its key in the containing
    Topology points dictionary).</p>
</div>


                            </div>
                            <div id="Vertex.point" class="classattr">
                                <div class="attr variable">
            <span class="name">point</span><span class="annotation">: shapely.geometry.point.Point</span>

        
    </div>
    <a class="headerlink" href="#Vertex.point"></a>
    
            <div class="docstring"><p>point (geom.Point): point location of the vertex.</p>
</div>


                            </div>
                            <div id="Vertex.ID" class="classattr">
                                <div class="attr variable">
            <span class="name">ID</span><span class="annotation">: int</span>

        
    </div>
    <a class="headerlink" href="#Vertex.ID"></a>
    
            <div class="docstring"><p>integer (mostly but not necessarily in sequence) of vertex keyed into the 
points dictionary of the containing Topology.</p>
</div>


                            </div>
                            <div id="Vertex.tiles" class="classattr">
                                <div class="attr variable">
            <span class="name">tiles</span><span class="annotation">: list[<a href="#Tile">Tile</a>]</span>

        
    </div>
    <a class="headerlink" href="#Vertex.tiles"></a>
    
            <div class="docstring"><p>list of Tiles incident on this vertex.</p>
</div>


                            </div>
                            <div id="Vertex.neighbours" class="classattr">
                                <div class="attr variable">
            <span class="name">neighbours</span><span class="annotation">: list[int]</span>

        
    </div>
    <a class="headerlink" href="#Vertex.neighbours"></a>
    
            <div class="docstring"><p>list of the immediately adjacent other corner IDs. Only required to 
determine if a point is a tiling vertex (when it will have) three or more 
neighbours, so only IDs are stored.</p>
</div>


                            </div>
                            <div id="Vertex.base_ID" class="classattr">
                                <div class="attr variable">
            <span class="name">base_ID</span><span class="annotation">: int</span>        =
<span class="default_value">1000000</span>

        
    </div>
    <a class="headerlink" href="#Vertex.base_ID"></a>
    
            <div class="docstring"><p>ID of corresponding Vertex in the tileable base_unit</p>
</div>


                            </div>
                            <div id="Vertex.transitivity_class" class="classattr">
                                <div class="attr variable">
            <span class="name">transitivity_class</span><span class="annotation">: int</span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#Vertex.transitivity_class"></a>
    
            <div class="docstring"><p>transitivity class of the vertex under symmetries of the tiling</p>
</div>


                            </div>
                            <div id="Vertex.label" class="classattr">
                                <div class="attr variable">
            <span class="name">label</span><span class="annotation">: str</span>        =
<span class="default_value">&#39;&#39;</span>

        
    </div>
    <a class="headerlink" href="#Vertex.label"></a>
    
            <div class="docstring"><p>the (upper case letter) label of the vertex under the symmetries of the 
tiling.</p>
</div>


                            </div>
                            <div id="Vertex.is_tiling_vertex" class="classattr">
                                <div class="attr variable">
            <span class="name">is_tiling_vertex</span><span class="annotation">: bool</span>        =
<span class="default_value">True</span>

        
    </div>
    <a class="headerlink" href="#Vertex.is_tiling_vertex"></a>
    
            <div class="docstring"><p>is_tiling_vertex (bool): True if this is a tiling vertex, rather than a 
tile corner. E.g., A below is a corner, not a tiling vertex. B is a tiling 
vertex:</p>

<pre><code>+-------+
| 1     |
|   A---B---+
|   | 2     |
+---C   +---+
    |   |
    +---+
</code></pre>
</div>


                            </div>
                            <div id="Vertex.get_tile_IDs" class="classattr">
                                        <input id="Vertex.get_tile_IDs-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_tile_IDs</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="Vertex.get_tile_IDs-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Vertex.get_tile_IDs"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Vertex.get_tile_IDs-425"><a href="#Vertex.get_tile_IDs-425"><span class="linenos">425</span></a>  <span class="k">def</span> <span class="nf">get_tile_IDs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
</span><span id="Vertex.get_tile_IDs-426"><a href="#Vertex.get_tile_IDs-426"><span class="linenos">426</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Convenience method to return list of Tile IDs (not the Tiles themselves).</span>
</span><span id="Vertex.get_tile_IDs-427"><a href="#Vertex.get_tile_IDs-427"><span class="linenos">427</span></a>
</span><span id="Vertex.get_tile_IDs-428"><a href="#Vertex.get_tile_IDs-428"><span class="linenos">428</span></a><span class="sd">    Returns:</span>
</span><span id="Vertex.get_tile_IDs-429"><a href="#Vertex.get_tile_IDs-429"><span class="linenos">429</span></a><span class="sd">        list[int]: list of Tile IDs</span>
</span><span id="Vertex.get_tile_IDs-430"><a href="#Vertex.get_tile_IDs-430"><span class="linenos">430</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Vertex.get_tile_IDs-431"><a href="#Vertex.get_tile_IDs-431"><span class="linenos">431</span></a>    <span class="k">return</span> <span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">ID</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tiles</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Convenience method to return list of Tile IDs (not the Tiles themselves).</p>

<p>Returns:
    list[int]: list of Tile IDs</p>
</div>


                            </div>
                            <div id="Vertex.add_tile" class="classattr">
                                        <input id="Vertex.add_tile-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">add_tile</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">tile</span><span class="p">:</span> <span class="n"><a href="#Tile">Tile</a></span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Vertex.add_tile-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Vertex.add_tile"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Vertex.add_tile-433"><a href="#Vertex.add_tile-433"><span class="linenos">433</span></a>  <span class="k">def</span> <span class="nf">add_tile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tile</span><span class="p">:</span><span class="n">Tile</span><span class="p">):</span>
</span><span id="Vertex.add_tile-434"><a href="#Vertex.add_tile-434"><span class="linenos">434</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Adds supplied Tile to the tiles list if it is not already present.</span>
</span><span id="Vertex.add_tile-435"><a href="#Vertex.add_tile-435"><span class="linenos">435</span></a>
</span><span id="Vertex.add_tile-436"><a href="#Vertex.add_tile-436"><span class="linenos">436</span></a><span class="sd">    Args:</span>
</span><span id="Vertex.add_tile-437"><a href="#Vertex.add_tile-437"><span class="linenos">437</span></a><span class="sd">        tile (Tile): Tile to add.</span>
</span><span id="Vertex.add_tile-438"><a href="#Vertex.add_tile-438"><span class="linenos">438</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Vertex.add_tile-439"><a href="#Vertex.add_tile-439"><span class="linenos">439</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">tile</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tiles</span><span class="p">:</span>
</span><span id="Vertex.add_tile-440"><a href="#Vertex.add_tile-440"><span class="linenos">440</span></a>      <span class="bp">self</span><span class="o">.</span><span class="n">tiles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tile</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Adds supplied Tile to the tiles list if it is not already present.</p>

<p>Args:
    tile (Tile): Tile to add.</p>
</div>


                            </div>
                            <div id="Vertex.add_neighbour" class="classattr">
                                        <input id="Vertex.add_neighbour-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">add_neighbour</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">vertex_id</span><span class="p">:</span> <span class="nb">int</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Vertex.add_neighbour-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Vertex.add_neighbour"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Vertex.add_neighbour-442"><a href="#Vertex.add_neighbour-442"><span class="linenos">442</span></a>  <span class="k">def</span> <span class="nf">add_neighbour</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vertex_id</span><span class="p">:</span><span class="nb">int</span><span class="p">):</span>
</span><span id="Vertex.add_neighbour-443"><a href="#Vertex.add_neighbour-443"><span class="linenos">443</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Adds supplied ID to the neighbours list if it is not already present</span>
</span><span id="Vertex.add_neighbour-444"><a href="#Vertex.add_neighbour-444"><span class="linenos">444</span></a>
</span><span id="Vertex.add_neighbour-445"><a href="#Vertex.add_neighbour-445"><span class="linenos">445</span></a><span class="sd">    Args:</span>
</span><span id="Vertex.add_neighbour-446"><a href="#Vertex.add_neighbour-446"><span class="linenos">446</span></a><span class="sd">      vertex_id (int): ID to add to the neighbours list.</span>
</span><span id="Vertex.add_neighbour-447"><a href="#Vertex.add_neighbour-447"><span class="linenos">447</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Vertex.add_neighbour-448"><a href="#Vertex.add_neighbour-448"><span class="linenos">448</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">vertex_id</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">neighbours</span><span class="p">:</span>
</span><span id="Vertex.add_neighbour-449"><a href="#Vertex.add_neighbour-449"><span class="linenos">449</span></a>      <span class="bp">self</span><span class="o">.</span><span class="n">neighbours</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">vertex_id</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Adds supplied ID to the neighbours list if it is not already present</p>

<p>Args:
  vertex_id (int): ID to add to the neighbours list.</p>
</div>


                            </div>
                            <div id="Vertex.clockwise_order_incident_tiles" class="classattr">
                                        <input id="Vertex.clockwise_order_incident_tiles-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">clockwise_order_incident_tiles</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Vertex.clockwise_order_incident_tiles-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Vertex.clockwise_order_incident_tiles"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Vertex.clockwise_order_incident_tiles-451"><a href="#Vertex.clockwise_order_incident_tiles-451"><span class="linenos">451</span></a>  <span class="k">def</span> <span class="nf">clockwise_order_incident_tiles</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Vertex.clockwise_order_incident_tiles-452"><a href="#Vertex.clockwise_order_incident_tiles-452"><span class="linenos">452</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Reorders the tiles list clockwise (this is for dual tiling construction)</span>
</span><span id="Vertex.clockwise_order_incident_tiles-453"><a href="#Vertex.clockwise_order_incident_tiles-453"><span class="linenos">453</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Vertex.clockwise_order_incident_tiles-454"><a href="#Vertex.clockwise_order_incident_tiles-454"><span class="linenos">454</span></a>    <span class="n">cw_order</span> <span class="o">=</span> <span class="n">tiling_utils</span><span class="o">.</span><span class="n">order_of_pts_cw_around_centre</span><span class="p">(</span>
</span><span id="Vertex.clockwise_order_incident_tiles-455"><a href="#Vertex.clockwise_order_incident_tiles-455"><span class="linenos">455</span></a>      <span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">centre</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tiles</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">point</span><span class="p">)</span>
</span><span id="Vertex.clockwise_order_incident_tiles-456"><a href="#Vertex.clockwise_order_incident_tiles-456"><span class="linenos">456</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">tiles</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">tiles</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">cw_order</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Reorders the tiles list clockwise (this is for dual tiling construction)</p>
</div>


                            </div>
                            <div id="Vertex.is_interior" class="classattr">
                                        <input id="Vertex.is_interior-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">is_interior</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <label class="view-source-button" for="Vertex.is_interior-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Vertex.is_interior"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Vertex.is_interior-458"><a href="#Vertex.is_interior-458"><span class="linenos">458</span></a>  <span class="k">def</span> <span class="nf">is_interior</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="Vertex.is_interior-459"><a href="#Vertex.is_interior-459"><span class="linenos">459</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Tests if vertex is completely enclosed by its incident Tiles. Based on</span>
</span><span id="Vertex.is_interior-460"><a href="#Vertex.is_interior-460"><span class="linenos">460</span></a><span class="sd">    summing the interior angles of the incident tiles at this vertex.</span>
</span><span id="Vertex.is_interior-461"><a href="#Vertex.is_interior-461"><span class="linenos">461</span></a>
</span><span id="Vertex.is_interior-462"><a href="#Vertex.is_interior-462"><span class="linenos">462</span></a><span class="sd">    Returns:</span>
</span><span id="Vertex.is_interior-463"><a href="#Vertex.is_interior-463"><span class="linenos">463</span></a><span class="sd">        bool: True if vertex is completely enclosed by incident Tiles.</span>
</span><span id="Vertex.is_interior-464"><a href="#Vertex.is_interior-464"><span class="linenos">464</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Vertex.is_interior-465"><a href="#Vertex.is_interior-465"><span class="linenos">465</span></a>    <span class="k">return</span> <span class="nb">abs</span><span class="p">(</span><span class="mi">360</span> <span class="o">-</span> <span class="nb">sum</span><span class="p">([</span><span class="n">t</span><span class="o">.</span><span class="n">angle_at</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tiles</span><span class="p">]))</span> \
</span><span id="Vertex.is_interior-466"><a href="#Vertex.is_interior-466"><span class="linenos">466</span></a>                     <span class="o">&lt;</span> <span class="n">tiling_utils</span><span class="o">.</span><span class="n">RESOLUTION</span>
</span></pre></div>


            <div class="docstring"><p>Tests if vertex is completely enclosed by its incident Tiles. Based on
summing the interior angles of the incident tiles at this vertex.</p>

<p>Returns:
    bool: True if vertex is completely enclosed by incident Tiles.</p>
</div>


                            </div>
                </section>
                <section id="Edge">
                            <input id="Edge-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">Edge</span>:

                <label class="view-source-button" for="Edge-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Edge"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Edge-469"><a href="#Edge-469"><span class="linenos">469</span></a><span class="k">class</span> <span class="nc">Edge</span><span class="p">:</span>
</span><span id="Edge-470"><a href="#Edge-470"><span class="linenos">470</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;Class to represent edges in a tiling (not tile sides) per the definitions</span>
</span><span id="Edge-471"><a href="#Edge-471"><span class="linenos">471</span></a><span class="sd">  in Grünbaum and Shephard.</span>
</span><span id="Edge-472"><a href="#Edge-472"><span class="linenos">472</span></a><span class="sd">  &quot;&quot;&quot;</span>
</span><span id="Edge-473"><a href="#Edge-473"><span class="linenos">473</span></a>  <span class="n">ID</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span>
</span><span id="Edge-474"><a href="#Edge-474"><span class="linenos">474</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;IDs of the vertices at ends of the edge. Used as key in the containing </span>
</span><span id="Edge-475"><a href="#Edge-475"><span class="linenos">475</span></a><span class="sd">  Topology&#39;s edges dictionary.&quot;&quot;&quot;</span>
</span><span id="Edge-476"><a href="#Edge-476"><span class="linenos">476</span></a>  <span class="n">vertices</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="s2">&quot;Vertex&quot;</span><span class="p">]</span>
</span><span id="Edge-477"><a href="#Edge-477"><span class="linenos">477</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;two item list of the end vertices.&quot;&quot;&quot;</span>
</span><span id="Edge-478"><a href="#Edge-478"><span class="linenos">478</span></a>  <span class="n">corners</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="s2">&quot;Vertex&quot;</span><span class="p">]</span>
</span><span id="Edge-479"><a href="#Edge-479"><span class="linenos">479</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;list of all the vertices in the edge (including its end vertices). In a </span>
</span><span id="Edge-480"><a href="#Edge-480"><span class="linenos">480</span></a><span class="sd">  &#39;normal&#39; edge to edge tiling corners and vertices will be identical.&quot;&quot;&quot;</span>
</span><span id="Edge-481"><a href="#Edge-481"><span class="linenos">481</span></a>  <span class="n">right_tile</span><span class="p">:</span> <span class="s2">&quot;Tile&quot;</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Edge-482"><a href="#Edge-482"><span class="linenos">482</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;the tile to the right of the edge traversed from its first to its last </span>
</span><span id="Edge-483"><a href="#Edge-483"><span class="linenos">483</span></a><span class="sd">  vertex. Given clockwise winding default, all edges will have a right_tile.&quot;&quot;&quot;</span>
</span><span id="Edge-484"><a href="#Edge-484"><span class="linenos">484</span></a>  <span class="n">left_tile</span><span class="p">:</span> <span class="s2">&quot;Tile&quot;</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Edge-485"><a href="#Edge-485"><span class="linenos">485</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;the tile to the left of the edge traversed from its first to its last </span>
</span><span id="Edge-486"><a href="#Edge-486"><span class="linenos">486</span></a><span class="sd">  vertex. Exterior edges of the tiles in a Topology will not have a left_tile.</span>
</span><span id="Edge-487"><a href="#Edge-487"><span class="linenos">487</span></a><span class="sd">  &quot;&quot;&quot;</span>
</span><span id="Edge-488"><a href="#Edge-488"><span class="linenos">488</span></a>  <span class="n">base_ID</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1_000_000</span><span class="p">,</span> <span class="mi">1_000_000</span><span class="p">)</span>
</span><span id="Edge-489"><a href="#Edge-489"><span class="linenos">489</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;ID of corresponding edge in the base tileable&quot;&quot;&quot;</span>
</span><span id="Edge-490"><a href="#Edge-490"><span class="linenos">490</span></a>  <span class="n">transitivity_class</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Edge-491"><a href="#Edge-491"><span class="linenos">491</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;transitivity class of the edge under symmetries of the tiling&quot;&quot;&quot;</span>
</span><span id="Edge-492"><a href="#Edge-492"><span class="linenos">492</span></a>  <span class="n">label</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="Edge-493"><a href="#Edge-493"><span class="linenos">493</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;the (lower case letter) label of the edge under the symmetries of the </span>
</span><span id="Edge-494"><a href="#Edge-494"><span class="linenos">494</span></a><span class="sd">  tiling.&quot;&quot;&quot;</span>
</span><span id="Edge-495"><a href="#Edge-495"><span class="linenos">495</span></a>  
</span><span id="Edge-496"><a href="#Edge-496"><span class="linenos">496</span></a>  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">corners</span><span class="p">:</span><span class="nb">list</span><span class="p">[</span><span class="n">Vertex</span><span class="p">]):</span>
</span><span id="Edge-497"><a href="#Edge-497"><span class="linenos">497</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Class constructor. Initialises the corners and vertices lists and sets ID</span>
</span><span id="Edge-498"><a href="#Edge-498"><span class="linenos">498</span></a><span class="sd">    to (vertices[0].ID, vertices[1].ID). The vertices list is all the corners</span>
</span><span id="Edge-499"><a href="#Edge-499"><span class="linenos">499</span></a><span class="sd">    with is_tiling_vertex property True -- Note that during initialisation the</span>
</span><span id="Edge-500"><a href="#Edge-500"><span class="linenos">500</span></a><span class="sd">    default of this property is True until after the relations between tiles and</span>
</span><span id="Edge-501"><a href="#Edge-501"><span class="linenos">501</span></a><span class="sd">    vertices have been determined.</span>
</span><span id="Edge-502"><a href="#Edge-502"><span class="linenos">502</span></a>
</span><span id="Edge-503"><a href="#Edge-503"><span class="linenos">503</span></a><span class="sd">    Args:</span>
</span><span id="Edge-504"><a href="#Edge-504"><span class="linenos">504</span></a><span class="sd">      corners (list[Vertex]): list of all corners along the edge.</span>
</span><span id="Edge-505"><a href="#Edge-505"><span class="linenos">505</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Edge-506"><a href="#Edge-506"><span class="linenos">506</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">corners</span> <span class="o">=</span> <span class="n">corners</span>
</span><span id="Edge-507"><a href="#Edge-507"><span class="linenos">507</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">corners</span> <span class="k">if</span> <span class="n">v</span><span class="o">.</span><span class="n">is_tiling_vertex</span><span class="p">]</span>
</span><span id="Edge-508"><a href="#Edge-508"><span class="linenos">508</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">ID</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">ID</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">)</span>
</span><span id="Edge-509"><a href="#Edge-509"><span class="linenos">509</span></a>
</span><span id="Edge-510"><a href="#Edge-510"><span class="linenos">510</span></a>  <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="Edge-511"><a href="#Edge-511"><span class="linenos">511</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns a string representation of  the Edge.</span>
</span><span id="Edge-512"><a href="#Edge-512"><span class="linenos">512</span></a>
</span><span id="Edge-513"><a href="#Edge-513"><span class="linenos">513</span></a><span class="sd">    Returns:</span>
</span><span id="Edge-514"><a href="#Edge-514"><span class="linenos">514</span></a><span class="sd">        str: include ID and a list of corner vertex IDs.</span>
</span><span id="Edge-515"><a href="#Edge-515"><span class="linenos">515</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Edge-516"><a href="#Edge-516"><span class="linenos">516</span></a>    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;Edge </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">ID</span><span class="si">}</span><span class="s2"> Corners: </span><span class="si">{</span><span class="p">[</span><span class="n">c</span><span class="o">.</span><span class="n">ID</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">corners</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="Edge-517"><a href="#Edge-517"><span class="linenos">517</span></a>
</span><span id="Edge-518"><a href="#Edge-518"><span class="linenos">518</span></a>  <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="Edge-519"><a href="#Edge-519"><span class="linenos">519</span></a>    <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="Edge-520"><a href="#Edge-520"><span class="linenos">520</span></a>
</span><span id="Edge-521"><a href="#Edge-521"><span class="linenos">521</span></a>  <span class="k">def</span> <span class="nf">get_corner_IDs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
</span><span id="Edge-522"><a href="#Edge-522"><span class="linenos">522</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Convenience method to get the IDs of edge corners.</span>
</span><span id="Edge-523"><a href="#Edge-523"><span class="linenos">523</span></a>
</span><span id="Edge-524"><a href="#Edge-524"><span class="linenos">524</span></a><span class="sd">    Returns:</span>
</span><span id="Edge-525"><a href="#Edge-525"><span class="linenos">525</span></a><span class="sd">        list[int]: IDs of all corners.</span>
</span><span id="Edge-526"><a href="#Edge-526"><span class="linenos">526</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Edge-527"><a href="#Edge-527"><span class="linenos">527</span></a>    <span class="k">return</span> <span class="p">[</span><span class="n">c</span><span class="o">.</span><span class="n">ID</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">corners</span><span class="p">]</span>
</span><span id="Edge-528"><a href="#Edge-528"><span class="linenos">528</span></a>
</span><span id="Edge-529"><a href="#Edge-529"><span class="linenos">529</span></a>  <span class="k">def</span> <span class="nf">get_vertex_IDs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
</span><span id="Edge-530"><a href="#Edge-530"><span class="linenos">530</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Convenience method to get IDs of edge vertices.</span>
</span><span id="Edge-531"><a href="#Edge-531"><span class="linenos">531</span></a>
</span><span id="Edge-532"><a href="#Edge-532"><span class="linenos">532</span></a><span class="sd">    Returns:</span>
</span><span id="Edge-533"><a href="#Edge-533"><span class="linenos">533</span></a><span class="sd">        list[int]: list of IDs of the vertices.</span>
</span><span id="Edge-534"><a href="#Edge-534"><span class="linenos">534</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Edge-535"><a href="#Edge-535"><span class="linenos">535</span></a>    <span class="k">return</span> <span class="p">[</span><span class="n">v</span><span class="o">.</span><span class="n">ID</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">]</span>
</span><span id="Edge-536"><a href="#Edge-536"><span class="linenos">536</span></a>
</span><span id="Edge-537"><a href="#Edge-537"><span class="linenos">537</span></a>  <span class="k">def</span> <span class="nf">insert_vertex</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">v</span><span class="p">:</span><span class="s2">&quot;Vertex&quot;</span><span class="p">,</span> <span class="n">predecessor</span><span class="p">:</span><span class="s2">&quot;Vertex&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="s2">&quot;Edge&quot;</span><span class="p">]:</span>
</span><span id="Edge-538"><a href="#Edge-538"><span class="linenos">538</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Inserts a vertex along this edge after the specified predecessor </span>
</span><span id="Edge-539"><a href="#Edge-539"><span class="linenos">539</span></a><span class="sd">    Vertex and returns this edge modified and a new edge. </span>
</span><span id="Edge-540"><a href="#Edge-540"><span class="linenos">540</span></a><span class="sd">    </span>
</span><span id="Edge-541"><a href="#Edge-541"><span class="linenos">541</span></a><span class="sd">    If the initial edge was (say) (0 1 2 5) and the predecessor was set to 1 </span>
</span><span id="Edge-542"><a href="#Edge-542"><span class="linenos">542</span></a><span class="sd">    the returned edges would be (0 1 v) and (v 2 5).</span>
</span><span id="Edge-543"><a href="#Edge-543"><span class="linenos">543</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Edge-544"><a href="#Edge-544"><span class="linenos">544</span></a>    <span class="n">i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">corners</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">predecessor</span><span class="p">)</span>
</span><span id="Edge-545"><a href="#Edge-545"><span class="linenos">545</span></a>    <span class="n">new_edge</span> <span class="o">=</span> <span class="n">Edge</span><span class="p">([</span><span class="n">v</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">corners</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">):])</span>
</span><span id="Edge-546"><a href="#Edge-546"><span class="linenos">546</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">right_tile</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Edge-547"><a href="#Edge-547"><span class="linenos">547</span></a>      <span class="n">new_edge</span><span class="o">.</span><span class="n">right_tile</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">right_tile</span>
</span><span id="Edge-548"><a href="#Edge-548"><span class="linenos">548</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">left_tile</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Edge-549"><a href="#Edge-549"><span class="linenos">549</span></a>      <span class="n">new_edge</span><span class="o">.</span><span class="n">left_tile</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">left_tile</span>
</span><span id="Edge-550"><a href="#Edge-550"><span class="linenos">550</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">corners</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">corners</span><span class="p">[:(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)]</span> <span class="o">+</span> <span class="p">[</span><span class="n">v</span><span class="p">]</span>
</span><span id="Edge-551"><a href="#Edge-551"><span class="linenos">551</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">v</span><span class="p">]</span>
</span><span id="Edge-552"><a href="#Edge-552"><span class="linenos">552</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">ID</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">ID</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">)</span>
</span><span id="Edge-553"><a href="#Edge-553"><span class="linenos">553</span></a>    <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_edge</span><span class="p">]</span>
</span><span id="Edge-554"><a href="#Edge-554"><span class="linenos">554</span></a>
</span><span id="Edge-555"><a href="#Edge-555"><span class="linenos">555</span></a>  <span class="k">def</span> <span class="nf">get_geometry</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">forward</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">geom</span><span class="o">.</span><span class="n">LineString</span><span class="p">:</span>
</span><span id="Edge-556"><a href="#Edge-556"><span class="linenos">556</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns a geom.LineString representing the geometry (including all</span>
</span><span id="Edge-557"><a href="#Edge-557"><span class="linenos">557</span></a><span class="sd">    corners) of this Edge, optionally starting at either end.</span>
</span><span id="Edge-558"><a href="#Edge-558"><span class="linenos">558</span></a>
</span><span id="Edge-559"><a href="#Edge-559"><span class="linenos">559</span></a><span class="sd">    Args:</span>
</span><span id="Edge-560"><a href="#Edge-560"><span class="linenos">560</span></a><span class="sd">      forward (bool, optional): if True the returned LineString starts at</span>
</span><span id="Edge-561"><a href="#Edge-561"><span class="linenos">561</span></a><span class="sd">        corners[0], else at corners[-1]. Defaults to True.</span>
</span><span id="Edge-562"><a href="#Edge-562"><span class="linenos">562</span></a>
</span><span id="Edge-563"><a href="#Edge-563"><span class="linenos">563</span></a><span class="sd">    Returns:</span>
</span><span id="Edge-564"><a href="#Edge-564"><span class="linenos">564</span></a><span class="sd">      geom.LineString: the required LineString.</span>
</span><span id="Edge-565"><a href="#Edge-565"><span class="linenos">565</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Edge-566"><a href="#Edge-566"><span class="linenos">566</span></a>    <span class="k">if</span> <span class="n">forward</span><span class="p">:</span>
</span><span id="Edge-567"><a href="#Edge-567"><span class="linenos">567</span></a>      <span class="k">return</span> <span class="n">geom</span><span class="o">.</span><span class="n">LineString</span><span class="p">([</span><span class="n">v</span><span class="o">.</span><span class="n">point</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">corners</span><span class="p">])</span>
</span><span id="Edge-568"><a href="#Edge-568"><span class="linenos">568</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="Edge-569"><a href="#Edge-569"><span class="linenos">569</span></a>      <span class="k">return</span> <span class="n">geom</span><span class="o">.</span><span class="n">LineString</span><span class="p">([</span><span class="n">v</span><span class="o">.</span><span class="n">point</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">corners</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]])</span>
</span><span id="Edge-570"><a href="#Edge-570"><span class="linenos">570</span></a>
</span><span id="Edge-571"><a href="#Edge-571"><span class="linenos">571</span></a>  <span class="k">def</span> <span class="nf">get_topology</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">forward</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">geom</span><span class="o">.</span><span class="n">LineString</span><span class="p">:</span>
</span><span id="Edge-572"><a href="#Edge-572"><span class="linenos">572</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns a LineString connecting the first and last corners (i.e. the</span>
</span><span id="Edge-573"><a href="#Edge-573"><span class="linenos">573</span></a><span class="sd">    vertices) of this tilin edge, optionally starting from either end.</span>
</span><span id="Edge-574"><a href="#Edge-574"><span class="linenos">574</span></a>
</span><span id="Edge-575"><a href="#Edge-575"><span class="linenos">575</span></a><span class="sd">    Args:</span>
</span><span id="Edge-576"><a href="#Edge-576"><span class="linenos">576</span></a><span class="sd">      forward (bool, optional): if True LineString starts at vertices[0], </span>
</span><span id="Edge-577"><a href="#Edge-577"><span class="linenos">577</span></a><span class="sd">        else at vertices[1]. Defaults to True.</span>
</span><span id="Edge-578"><a href="#Edge-578"><span class="linenos">578</span></a>
</span><span id="Edge-579"><a href="#Edge-579"><span class="linenos">579</span></a><span class="sd">    Returns:</span>
</span><span id="Edge-580"><a href="#Edge-580"><span class="linenos">580</span></a><span class="sd">        geom.LineString: the required LineString.</span>
</span><span id="Edge-581"><a href="#Edge-581"><span class="linenos">581</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Edge-582"><a href="#Edge-582"><span class="linenos">582</span></a>    <span class="k">if</span> <span class="n">forward</span><span class="p">:</span>
</span><span id="Edge-583"><a href="#Edge-583"><span class="linenos">583</span></a>      <span class="k">return</span> <span class="n">geom</span><span class="o">.</span><span class="n">LineString</span><span class="p">([</span><span class="n">v</span><span class="o">.</span><span class="n">point</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">])</span>
</span><span id="Edge-584"><a href="#Edge-584"><span class="linenos">584</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="Edge-585"><a href="#Edge-585"><span class="linenos">585</span></a>      <span class="k">return</span> <span class="n">geom</span><span class="o">.</span><span class="n">LineString</span><span class="p">([</span><span class="n">v</span><span class="o">.</span><span class="n">point</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]])</span>
</span></pre></div>


            <div class="docstring"><p>Class to represent edges in a tiling (not tile sides) per the definitions
in Grünbaum and Shephard.</p>
</div>


                            <div id="Edge.__init__" class="classattr">
                                        <input id="Edge.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">Edge</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">corners</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n"><a href="#Vertex">Vertex</a></span><span class="p">]</span></span>)</span>

                <label class="view-source-button" for="Edge.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Edge.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Edge.__init__-496"><a href="#Edge.__init__-496"><span class="linenos">496</span></a>  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">corners</span><span class="p">:</span><span class="nb">list</span><span class="p">[</span><span class="n">Vertex</span><span class="p">]):</span>
</span><span id="Edge.__init__-497"><a href="#Edge.__init__-497"><span class="linenos">497</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Class constructor. Initialises the corners and vertices lists and sets ID</span>
</span><span id="Edge.__init__-498"><a href="#Edge.__init__-498"><span class="linenos">498</span></a><span class="sd">    to (vertices[0].ID, vertices[1].ID). The vertices list is all the corners</span>
</span><span id="Edge.__init__-499"><a href="#Edge.__init__-499"><span class="linenos">499</span></a><span class="sd">    with is_tiling_vertex property True -- Note that during initialisation the</span>
</span><span id="Edge.__init__-500"><a href="#Edge.__init__-500"><span class="linenos">500</span></a><span class="sd">    default of this property is True until after the relations between tiles and</span>
</span><span id="Edge.__init__-501"><a href="#Edge.__init__-501"><span class="linenos">501</span></a><span class="sd">    vertices have been determined.</span>
</span><span id="Edge.__init__-502"><a href="#Edge.__init__-502"><span class="linenos">502</span></a>
</span><span id="Edge.__init__-503"><a href="#Edge.__init__-503"><span class="linenos">503</span></a><span class="sd">    Args:</span>
</span><span id="Edge.__init__-504"><a href="#Edge.__init__-504"><span class="linenos">504</span></a><span class="sd">      corners (list[Vertex]): list of all corners along the edge.</span>
</span><span id="Edge.__init__-505"><a href="#Edge.__init__-505"><span class="linenos">505</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Edge.__init__-506"><a href="#Edge.__init__-506"><span class="linenos">506</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">corners</span> <span class="o">=</span> <span class="n">corners</span>
</span><span id="Edge.__init__-507"><a href="#Edge.__init__-507"><span class="linenos">507</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">corners</span> <span class="k">if</span> <span class="n">v</span><span class="o">.</span><span class="n">is_tiling_vertex</span><span class="p">]</span>
</span><span id="Edge.__init__-508"><a href="#Edge.__init__-508"><span class="linenos">508</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">ID</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">ID</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Class constructor. Initialises the corners and vertices lists and sets ID
to (vertices[0].ID, vertices[1].ID). The vertices list is all the corners
with is_tiling_vertex property True -- Note that during initialisation the
default of this property is True until after the relations between tiles and
vertices have been determined.</p>

<p>Args:
  corners (list[Vertex]): list of all corners along the edge.</p>
</div>


                            </div>
                            <div id="Edge.ID" class="classattr">
                                <div class="attr variable">
            <span class="name">ID</span><span class="annotation">: tuple[int]</span>

        
    </div>
    <a class="headerlink" href="#Edge.ID"></a>
    
            <div class="docstring"><p>IDs of the vertices at ends of the edge. Used as key in the containing 
Topology's edges dictionary.</p>
</div>


                            </div>
                            <div id="Edge.vertices" class="classattr">
                                <div class="attr variable">
            <span class="name">vertices</span><span class="annotation">: list[<a href="#Vertex">Vertex</a>]</span>

        
    </div>
    <a class="headerlink" href="#Edge.vertices"></a>
    
            <div class="docstring"><p>two item list of the end vertices.</p>
</div>


                            </div>
                            <div id="Edge.corners" class="classattr">
                                <div class="attr variable">
            <span class="name">corners</span><span class="annotation">: list[<a href="#Vertex">Vertex</a>]</span>

        
    </div>
    <a class="headerlink" href="#Edge.corners"></a>
    
            <div class="docstring"><p>list of all the vertices in the edge (including its end vertices). In a 
'normal' edge to edge tiling corners and vertices will be identical.</p>
</div>


                            </div>
                            <div id="Edge.right_tile" class="classattr">
                                <div class="attr variable">
            <span class="name">right_tile</span><span class="annotation">: <a href="#Tile">Tile</a></span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#Edge.right_tile"></a>
    
            <div class="docstring"><p>the tile to the right of the edge traversed from its first to its last 
vertex. Given clockwise winding default, all edges will have a right_tile.</p>
</div>


                            </div>
                            <div id="Edge.left_tile" class="classattr">
                                <div class="attr variable">
            <span class="name">left_tile</span><span class="annotation">: <a href="#Tile">Tile</a></span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#Edge.left_tile"></a>
    
            <div class="docstring"><p>the tile to the left of the edge traversed from its first to its last 
vertex. Exterior edges of the tiles in a Topology will not have a left_tile.</p>
</div>


                            </div>
                            <div id="Edge.base_ID" class="classattr">
                                <div class="attr variable">
            <span class="name">base_ID</span><span class="annotation">: tuple[int]</span>        =
<span class="default_value">(1000000, 1000000)</span>

        
    </div>
    <a class="headerlink" href="#Edge.base_ID"></a>
    
            <div class="docstring"><p>ID of corresponding edge in the base tileable</p>
</div>


                            </div>
                            <div id="Edge.transitivity_class" class="classattr">
                                <div class="attr variable">
            <span class="name">transitivity_class</span><span class="annotation">: int</span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#Edge.transitivity_class"></a>
    
            <div class="docstring"><p>transitivity class of the edge under symmetries of the tiling</p>
</div>


                            </div>
                            <div id="Edge.label" class="classattr">
                                <div class="attr variable">
            <span class="name">label</span><span class="annotation">: str</span>        =
<span class="default_value">&#39;&#39;</span>

        
    </div>
    <a class="headerlink" href="#Edge.label"></a>
    
            <div class="docstring"><p>the (lower case letter) label of the edge under the symmetries of the 
tiling.</p>
</div>


                            </div>
                            <div id="Edge.get_corner_IDs" class="classattr">
                                        <input id="Edge.get_corner_IDs-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_corner_IDs</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="Edge.get_corner_IDs-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Edge.get_corner_IDs"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Edge.get_corner_IDs-521"><a href="#Edge.get_corner_IDs-521"><span class="linenos">521</span></a>  <span class="k">def</span> <span class="nf">get_corner_IDs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
</span><span id="Edge.get_corner_IDs-522"><a href="#Edge.get_corner_IDs-522"><span class="linenos">522</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Convenience method to get the IDs of edge corners.</span>
</span><span id="Edge.get_corner_IDs-523"><a href="#Edge.get_corner_IDs-523"><span class="linenos">523</span></a>
</span><span id="Edge.get_corner_IDs-524"><a href="#Edge.get_corner_IDs-524"><span class="linenos">524</span></a><span class="sd">    Returns:</span>
</span><span id="Edge.get_corner_IDs-525"><a href="#Edge.get_corner_IDs-525"><span class="linenos">525</span></a><span class="sd">        list[int]: IDs of all corners.</span>
</span><span id="Edge.get_corner_IDs-526"><a href="#Edge.get_corner_IDs-526"><span class="linenos">526</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Edge.get_corner_IDs-527"><a href="#Edge.get_corner_IDs-527"><span class="linenos">527</span></a>    <span class="k">return</span> <span class="p">[</span><span class="n">c</span><span class="o">.</span><span class="n">ID</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">corners</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Convenience method to get the IDs of edge corners.</p>

<p>Returns:
    list[int]: IDs of all corners.</p>
</div>


                            </div>
                            <div id="Edge.get_vertex_IDs" class="classattr">
                                        <input id="Edge.get_vertex_IDs-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_vertex_IDs</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="Edge.get_vertex_IDs-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Edge.get_vertex_IDs"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Edge.get_vertex_IDs-529"><a href="#Edge.get_vertex_IDs-529"><span class="linenos">529</span></a>  <span class="k">def</span> <span class="nf">get_vertex_IDs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
</span><span id="Edge.get_vertex_IDs-530"><a href="#Edge.get_vertex_IDs-530"><span class="linenos">530</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Convenience method to get IDs of edge vertices.</span>
</span><span id="Edge.get_vertex_IDs-531"><a href="#Edge.get_vertex_IDs-531"><span class="linenos">531</span></a>
</span><span id="Edge.get_vertex_IDs-532"><a href="#Edge.get_vertex_IDs-532"><span class="linenos">532</span></a><span class="sd">    Returns:</span>
</span><span id="Edge.get_vertex_IDs-533"><a href="#Edge.get_vertex_IDs-533"><span class="linenos">533</span></a><span class="sd">        list[int]: list of IDs of the vertices.</span>
</span><span id="Edge.get_vertex_IDs-534"><a href="#Edge.get_vertex_IDs-534"><span class="linenos">534</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Edge.get_vertex_IDs-535"><a href="#Edge.get_vertex_IDs-535"><span class="linenos">535</span></a>    <span class="k">return</span> <span class="p">[</span><span class="n">v</span><span class="o">.</span><span class="n">ID</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Convenience method to get IDs of edge vertices.</p>

<p>Returns:
    list[int]: list of IDs of the vertices.</p>
</div>


                            </div>
                            <div id="Edge.insert_vertex" class="classattr">
                                        <input id="Edge.insert_vertex-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">insert_vertex</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">v</span><span class="p">:</span> <span class="n"><a href="#Vertex">Vertex</a></span>,</span><span class="param">	<span class="n">predecessor</span><span class="p">:</span> <span class="n"><a href="#Vertex">Vertex</a></span></span><span class="return-annotation">) -> <span class="nb">list</span><span class="p">[</span><span class="n"><a href="#Edge">Edge</a></span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="Edge.insert_vertex-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Edge.insert_vertex"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Edge.insert_vertex-537"><a href="#Edge.insert_vertex-537"><span class="linenos">537</span></a>  <span class="k">def</span> <span class="nf">insert_vertex</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">v</span><span class="p">:</span><span class="s2">&quot;Vertex&quot;</span><span class="p">,</span> <span class="n">predecessor</span><span class="p">:</span><span class="s2">&quot;Vertex&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="s2">&quot;Edge&quot;</span><span class="p">]:</span>
</span><span id="Edge.insert_vertex-538"><a href="#Edge.insert_vertex-538"><span class="linenos">538</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Inserts a vertex along this edge after the specified predecessor </span>
</span><span id="Edge.insert_vertex-539"><a href="#Edge.insert_vertex-539"><span class="linenos">539</span></a><span class="sd">    Vertex and returns this edge modified and a new edge. </span>
</span><span id="Edge.insert_vertex-540"><a href="#Edge.insert_vertex-540"><span class="linenos">540</span></a><span class="sd">    </span>
</span><span id="Edge.insert_vertex-541"><a href="#Edge.insert_vertex-541"><span class="linenos">541</span></a><span class="sd">    If the initial edge was (say) (0 1 2 5) and the predecessor was set to 1 </span>
</span><span id="Edge.insert_vertex-542"><a href="#Edge.insert_vertex-542"><span class="linenos">542</span></a><span class="sd">    the returned edges would be (0 1 v) and (v 2 5).</span>
</span><span id="Edge.insert_vertex-543"><a href="#Edge.insert_vertex-543"><span class="linenos">543</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Edge.insert_vertex-544"><a href="#Edge.insert_vertex-544"><span class="linenos">544</span></a>    <span class="n">i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">corners</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">predecessor</span><span class="p">)</span>
</span><span id="Edge.insert_vertex-545"><a href="#Edge.insert_vertex-545"><span class="linenos">545</span></a>    <span class="n">new_edge</span> <span class="o">=</span> <span class="n">Edge</span><span class="p">([</span><span class="n">v</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">corners</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">):])</span>
</span><span id="Edge.insert_vertex-546"><a href="#Edge.insert_vertex-546"><span class="linenos">546</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">right_tile</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Edge.insert_vertex-547"><a href="#Edge.insert_vertex-547"><span class="linenos">547</span></a>      <span class="n">new_edge</span><span class="o">.</span><span class="n">right_tile</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">right_tile</span>
</span><span id="Edge.insert_vertex-548"><a href="#Edge.insert_vertex-548"><span class="linenos">548</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">left_tile</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Edge.insert_vertex-549"><a href="#Edge.insert_vertex-549"><span class="linenos">549</span></a>      <span class="n">new_edge</span><span class="o">.</span><span class="n">left_tile</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">left_tile</span>
</span><span id="Edge.insert_vertex-550"><a href="#Edge.insert_vertex-550"><span class="linenos">550</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">corners</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">corners</span><span class="p">[:(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)]</span> <span class="o">+</span> <span class="p">[</span><span class="n">v</span><span class="p">]</span>
</span><span id="Edge.insert_vertex-551"><a href="#Edge.insert_vertex-551"><span class="linenos">551</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">v</span><span class="p">]</span>
</span><span id="Edge.insert_vertex-552"><a href="#Edge.insert_vertex-552"><span class="linenos">552</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">ID</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">ID</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">)</span>
</span><span id="Edge.insert_vertex-553"><a href="#Edge.insert_vertex-553"><span class="linenos">553</span></a>    <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_edge</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Inserts a vertex along this edge after the specified predecessor 
Vertex and returns this edge modified and a new edge. </p>

<p>If the initial edge was (say) (0 1 2 5) and the predecessor was set to 1 
the returned edges would be (0 1 v) and (v 2 5).</p>
</div>


                            </div>
                            <div id="Edge.get_geometry" class="classattr">
                                        <input id="Edge.get_geometry-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_geometry</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">forward</span><span class="o">=</span><span class="kc">True</span></span><span class="return-annotation">) -> <span class="n">shapely</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">linestring</span><span class="o">.</span><span class="n">LineString</span>:</span></span>

                <label class="view-source-button" for="Edge.get_geometry-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Edge.get_geometry"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Edge.get_geometry-555"><a href="#Edge.get_geometry-555"><span class="linenos">555</span></a>  <span class="k">def</span> <span class="nf">get_geometry</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">forward</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">geom</span><span class="o">.</span><span class="n">LineString</span><span class="p">:</span>
</span><span id="Edge.get_geometry-556"><a href="#Edge.get_geometry-556"><span class="linenos">556</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns a geom.LineString representing the geometry (including all</span>
</span><span id="Edge.get_geometry-557"><a href="#Edge.get_geometry-557"><span class="linenos">557</span></a><span class="sd">    corners) of this Edge, optionally starting at either end.</span>
</span><span id="Edge.get_geometry-558"><a href="#Edge.get_geometry-558"><span class="linenos">558</span></a>
</span><span id="Edge.get_geometry-559"><a href="#Edge.get_geometry-559"><span class="linenos">559</span></a><span class="sd">    Args:</span>
</span><span id="Edge.get_geometry-560"><a href="#Edge.get_geometry-560"><span class="linenos">560</span></a><span class="sd">      forward (bool, optional): if True the returned LineString starts at</span>
</span><span id="Edge.get_geometry-561"><a href="#Edge.get_geometry-561"><span class="linenos">561</span></a><span class="sd">        corners[0], else at corners[-1]. Defaults to True.</span>
</span><span id="Edge.get_geometry-562"><a href="#Edge.get_geometry-562"><span class="linenos">562</span></a>
</span><span id="Edge.get_geometry-563"><a href="#Edge.get_geometry-563"><span class="linenos">563</span></a><span class="sd">    Returns:</span>
</span><span id="Edge.get_geometry-564"><a href="#Edge.get_geometry-564"><span class="linenos">564</span></a><span class="sd">      geom.LineString: the required LineString.</span>
</span><span id="Edge.get_geometry-565"><a href="#Edge.get_geometry-565"><span class="linenos">565</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Edge.get_geometry-566"><a href="#Edge.get_geometry-566"><span class="linenos">566</span></a>    <span class="k">if</span> <span class="n">forward</span><span class="p">:</span>
</span><span id="Edge.get_geometry-567"><a href="#Edge.get_geometry-567"><span class="linenos">567</span></a>      <span class="k">return</span> <span class="n">geom</span><span class="o">.</span><span class="n">LineString</span><span class="p">([</span><span class="n">v</span><span class="o">.</span><span class="n">point</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">corners</span><span class="p">])</span>
</span><span id="Edge.get_geometry-568"><a href="#Edge.get_geometry-568"><span class="linenos">568</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="Edge.get_geometry-569"><a href="#Edge.get_geometry-569"><span class="linenos">569</span></a>      <span class="k">return</span> <span class="n">geom</span><span class="o">.</span><span class="n">LineString</span><span class="p">([</span><span class="n">v</span><span class="o">.</span><span class="n">point</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">corners</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]])</span>
</span></pre></div>


            <div class="docstring"><p>Returns a geom.LineString representing the geometry (including all
corners) of this Edge, optionally starting at either end.</p>

<p>Args:
  forward (bool, optional): if True the returned LineString starts at
    corners[0], else at corners[-1]. Defaults to True.</p>

<p>Returns:
  geom.LineString: the required LineString.</p>
</div>


                            </div>
                            <div id="Edge.get_topology" class="classattr">
                                        <input id="Edge.get_topology-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_topology</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">forward</span><span class="o">=</span><span class="kc">True</span></span><span class="return-annotation">) -> <span class="n">shapely</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">linestring</span><span class="o">.</span><span class="n">LineString</span>:</span></span>

                <label class="view-source-button" for="Edge.get_topology-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Edge.get_topology"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Edge.get_topology-571"><a href="#Edge.get_topology-571"><span class="linenos">571</span></a>  <span class="k">def</span> <span class="nf">get_topology</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">forward</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">geom</span><span class="o">.</span><span class="n">LineString</span><span class="p">:</span>
</span><span id="Edge.get_topology-572"><a href="#Edge.get_topology-572"><span class="linenos">572</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns a LineString connecting the first and last corners (i.e. the</span>
</span><span id="Edge.get_topology-573"><a href="#Edge.get_topology-573"><span class="linenos">573</span></a><span class="sd">    vertices) of this tilin edge, optionally starting from either end.</span>
</span><span id="Edge.get_topology-574"><a href="#Edge.get_topology-574"><span class="linenos">574</span></a>
</span><span id="Edge.get_topology-575"><a href="#Edge.get_topology-575"><span class="linenos">575</span></a><span class="sd">    Args:</span>
</span><span id="Edge.get_topology-576"><a href="#Edge.get_topology-576"><span class="linenos">576</span></a><span class="sd">      forward (bool, optional): if True LineString starts at vertices[0], </span>
</span><span id="Edge.get_topology-577"><a href="#Edge.get_topology-577"><span class="linenos">577</span></a><span class="sd">        else at vertices[1]. Defaults to True.</span>
</span><span id="Edge.get_topology-578"><a href="#Edge.get_topology-578"><span class="linenos">578</span></a>
</span><span id="Edge.get_topology-579"><a href="#Edge.get_topology-579"><span class="linenos">579</span></a><span class="sd">    Returns:</span>
</span><span id="Edge.get_topology-580"><a href="#Edge.get_topology-580"><span class="linenos">580</span></a><span class="sd">        geom.LineString: the required LineString.</span>
</span><span id="Edge.get_topology-581"><a href="#Edge.get_topology-581"><span class="linenos">581</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Edge.get_topology-582"><a href="#Edge.get_topology-582"><span class="linenos">582</span></a>    <span class="k">if</span> <span class="n">forward</span><span class="p">:</span>
</span><span id="Edge.get_topology-583"><a href="#Edge.get_topology-583"><span class="linenos">583</span></a>      <span class="k">return</span> <span class="n">geom</span><span class="o">.</span><span class="n">LineString</span><span class="p">([</span><span class="n">v</span><span class="o">.</span><span class="n">point</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">])</span>
</span><span id="Edge.get_topology-584"><a href="#Edge.get_topology-584"><span class="linenos">584</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="Edge.get_topology-585"><a href="#Edge.get_topology-585"><span class="linenos">585</span></a>      <span class="k">return</span> <span class="n">geom</span><span class="o">.</span><span class="n">LineString</span><span class="p">([</span><span class="n">v</span><span class="o">.</span><span class="n">point</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]])</span>
</span></pre></div>


            <div class="docstring"><p>Returns a LineString connecting the first and last corners (i.e. the
vertices) of this tilin edge, optionally starting from either end.</p>

<p>Args:
  forward (bool, optional): if True LineString starts at vertices[0], 
    else at vertices[1]. Defaults to True.</p>

<p>Returns:
    geom.LineString: the required LineString.</p>
</div>


                            </div>
                </section>
    </main>
<script>
    function escapeHTML(html) {
        return document.createElement('div').appendChild(document.createTextNode(html)).parentNode.innerHTML;
    }

    const originalContent = document.querySelector("main.pdoc");
    let currentContent = originalContent;

    function setContent(innerHTML) {
        let elem;
        if (innerHTML) {
            elem = document.createElement("main");
            elem.classList.add("pdoc");
            elem.innerHTML = innerHTML;
        } else {
            elem = originalContent;
        }
        if (currentContent !== elem) {
            currentContent.replaceWith(elem);
            currentContent = elem;
        }
    }

    function getSearchTerm() {
        return (new URL(window.location)).searchParams.get("search");
    }

    const searchBox = document.querySelector(".pdoc input[type=search]");
    searchBox.addEventListener("input", function () {
        let url = new URL(window.location);
        if (searchBox.value.trim()) {
            url.hash = "";
            url.searchParams.set("search", searchBox.value);
        } else {
            url.searchParams.delete("search");
        }
        history.replaceState("", "", url.toString());
        onInput();
    });
    window.addEventListener("popstate", onInput);


    let search, searchErr;

    async function initialize() {
        try {
            search = await new Promise((resolve, reject) => {
                const script = document.createElement("script");
                script.type = "text/javascript";
                script.async = true;
                script.onload = () => resolve(window.pdocSearch);
                script.onerror = (e) => reject(e);
                script.src = "../search.js";
                document.getElementsByTagName("head")[0].appendChild(script);
            });
        } catch (e) {
            console.error("Cannot fetch pdoc search index");
            searchErr = "Cannot fetch search index.";
        }
        onInput();

        document.querySelector("nav.pdoc").addEventListener("click", e => {
            if (e.target.hash) {
                searchBox.value = "";
                searchBox.dispatchEvent(new Event("input"));
            }
        });
    }

    function onInput() {
        setContent((() => {
            const term = getSearchTerm();
            if (!term) {
                return null
            }
            if (searchErr) {
                return `<h3>Error: ${searchErr}</h3>`
            }
            if (!search) {
                return "<h3>Searching...</h3>"
            }

            window.scrollTo({top: 0, left: 0, behavior: 'auto'});

            const results = search(term);

            let html;
            if (results.length === 0) {
                html = `No search results for '${escapeHTML(term)}'.`
            } else {
                html = `<h4>${results.length} search result${results.length > 1 ? "s" : ""} for '${escapeHTML(term)}'.</h4>`;
            }
            for (let result of results.slice(0, 10)) {
                let doc = result.doc;
                let url = `../${doc.modulename.replaceAll(".", "/")}.html`;
                if (doc.qualname) {
                    url += `#${doc.qualname}`;
                }

                let heading;
                switch (result.doc.kind) {
                    case "function":
                        if (doc.fullname.endsWith(".__init__")) {
                            heading = `<span class="name">${doc.fullname.replace(/\.__init__$/, "")}</span>${doc.signature}`;
                        } else {
                            heading = `<span class="def">${doc.funcdef}</span> <span class="name">${doc.fullname}</span>${doc.signature}`;
                        }
                        break;
                    case "class":
                        heading = `<span class="def">class</span> <span class="name">${doc.fullname}</span>`;
                        if (doc.bases)
                            heading += `<wbr>(<span class="base">${doc.bases}</span>)`;
                        heading += `:`;
                        break;
                    case "variable":
                        heading = `<span class="name">${doc.fullname}</span>`;
                        if (doc.annotation)
                            heading += `<span class="annotation">${doc.annotation}</span>`;
                        if (doc.default_value)
                            heading += `<span class="default_value"> = ${doc.default_value}</span>`;
                        break;
                    default:
                        heading = `<span class="name">${doc.fullname}</span>`;
                        break;
                }
                html += `
                        <section class="search-result">
                        <a href="${url}" class="attr ${doc.kind}">${heading}</a>
                        <div class="docstring">${doc.doc}</div>
                        </section>
                    `;

            }
            return html;
        })());
    }

    if (getSearchTerm()) {
        initialize();
        searchBox.value = getSearchTerm();
        onInput();
    } else {
        searchBox.addEventListener("focus", initialize, {once: true});
    }

    searchBox.addEventListener("keydown", e => {
        if (["ArrowDown", "ArrowUp", "Enter"].includes(e.key)) {
            let focused = currentContent.querySelector(".search-result.focused");
            if (!focused) {
                currentContent.querySelector(".search-result").classList.add("focused");
            } else if (
                e.key === "ArrowDown"
                && focused.nextElementSibling
                && focused.nextElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.nextElementSibling.classList.add("focused");
                focused.nextElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "ArrowUp"
                && focused.previousElementSibling
                && focused.previousElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.previousElementSibling.classList.add("focused");
                focused.previousElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "Enter"
            ) {
                focused.querySelector("a").click();
            }
        }
    });
</script></body>
</html>